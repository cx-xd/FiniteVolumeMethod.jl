2026-02-09T19:16:22.3830659Z Current runner version: '2.331.0'
2026-02-09T19:16:22.3864127Z ##[group]Runner Image Provisioner
2026-02-09T19:16:22.3865503Z Hosted Compute Agent
2026-02-09T19:16:22.3866440Z Version: 20260123.484
2026-02-09T19:16:22.3867359Z Commit: 6bd6555ca37d84114959e1c76d2c01448ff61c5d
2026-02-09T19:16:22.3868680Z Build Date: 2026-01-23T19:41:17Z
2026-02-09T19:16:22.3869976Z Worker ID: {672e78d6-34bb-4e6c-a20a-beb9116f35b3}
2026-02-09T19:16:22.3871131Z Azure Region: eastus2
2026-02-09T19:16:22.3872115Z ##[endgroup]
2026-02-09T19:16:22.3874534Z ##[group]Operating System
2026-02-09T19:16:22.3875445Z Ubuntu
2026-02-09T19:16:22.3876373Z 24.04.3
2026-02-09T19:16:22.3877077Z LTS
2026-02-09T19:16:22.3877894Z ##[endgroup]
2026-02-09T19:16:22.3878943Z ##[group]Runner Image
2026-02-09T19:16:22.3879827Z Image: ubuntu-24.04
2026-02-09T19:16:22.3880827Z Version: 20260201.15.1
2026-02-09T19:16:22.3882754Z Included Software: https://github.com/actions/runner-images/blob/ubuntu24/20260201.15/images/ubuntu/Ubuntu2404-Readme.md
2026-02-09T19:16:22.3885566Z Image Release: https://github.com/actions/runner-images/releases/tag/ubuntu24%2F20260201.15
2026-02-09T19:16:22.3887231Z ##[endgroup]
2026-02-09T19:16:22.3892328Z ##[group]GITHUB_TOKEN Permissions
2026-02-09T19:16:22.3895307Z Actions: write
2026-02-09T19:16:22.3896216Z ArtifactMetadata: write
2026-02-09T19:16:22.3897177Z Attestations: write
2026-02-09T19:16:22.3898024Z Checks: write
2026-02-09T19:16:22.3898914Z Contents: write
2026-02-09T19:16:22.3899834Z Deployments: write
2026-02-09T19:16:22.3900717Z Discussions: write
2026-02-09T19:16:22.3901528Z Issues: write
2026-02-09T19:16:22.3902402Z Metadata: read
2026-02-09T19:16:22.3903116Z Models: read
2026-02-09T19:16:22.3903918Z Packages: write
2026-02-09T19:16:22.3904795Z Pages: write
2026-02-09T19:16:22.3905774Z PullRequests: write
2026-02-09T19:16:22.3906584Z RepositoryProjects: write
2026-02-09T19:16:22.3907621Z SecurityEvents: write
2026-02-09T19:16:22.3908437Z Statuses: write
2026-02-09T19:16:22.3909519Z ##[endgroup]
2026-02-09T19:16:22.3912809Z Secret source: Actions
2026-02-09T19:16:22.3914133Z Prepare workflow directory
2026-02-09T19:16:22.4360292Z Prepare all required actions
2026-02-09T19:16:22.4416052Z Getting action download info
2026-02-09T19:16:22.7802227Z Download action repository 'actions/checkout@v4' (SHA:34e114876b0b11c390a56381ad16ebd13914f8d5)
2026-02-09T19:16:22.8786718Z Download action repository 'fredrikekre/runic-action@v1' (SHA:b5007693fe5fdf8a4217a07f632a631afdc36e98)
2026-02-09T19:16:23.5689709Z Complete job name: runic
2026-02-09T19:16:23.6466749Z ##[group]Run actions/checkout@v4
2026-02-09T19:16:23.6468013Z with:
2026-02-09T19:16:23.6468956Z   repository: S-AM-I/FiniteVolumeMethod.jl
2026-02-09T19:16:23.6470227Z   token: ***
2026-02-09T19:16:23.6470913Z   ssh-strict: true
2026-02-09T19:16:23.6471630Z   ssh-user: git
2026-02-09T19:16:23.6472360Z   persist-credentials: true
2026-02-09T19:16:23.6473204Z   clean: true
2026-02-09T19:16:23.6473925Z   sparse-checkout-cone-mode: true
2026-02-09T19:16:23.6474823Z   fetch-depth: 1
2026-02-09T19:16:23.6475543Z   fetch-tags: false
2026-02-09T19:16:23.6476372Z   show-progress: true
2026-02-09T19:16:23.6477110Z   lfs: false
2026-02-09T19:16:23.6477784Z   submodules: false
2026-02-09T19:16:23.6478515Z   set-safe-directory: true
2026-02-09T19:16:23.6479746Z ##[endgroup]
2026-02-09T19:16:23.7550098Z Syncing repository: S-AM-I/FiniteVolumeMethod.jl
2026-02-09T19:16:23.7552865Z ##[group]Getting Git version info
2026-02-09T19:16:23.7554536Z Working directory is '/home/runner/work/FiniteVolumeMethod.jl/FiniteVolumeMethod.jl'
2026-02-09T19:16:23.7556663Z [command]/usr/bin/git version
2026-02-09T19:16:23.7633501Z git version 2.52.0
2026-02-09T19:16:23.7659729Z ##[endgroup]
2026-02-09T19:16:23.7674021Z Temporarily overriding HOME='/home/runner/work/_temp/20406aa9-aaab-473c-aee7-690438fcebbd' before making global git config changes
2026-02-09T19:16:23.7676772Z Adding repository directory to the temporary git global config as a safe directory
2026-02-09T19:16:23.7686646Z [command]/usr/bin/git config --global --add safe.directory /home/runner/work/FiniteVolumeMethod.jl/FiniteVolumeMethod.jl
2026-02-09T19:16:23.7724468Z Deleting the contents of '/home/runner/work/FiniteVolumeMethod.jl/FiniteVolumeMethod.jl'
2026-02-09T19:16:23.7727247Z ##[group]Initializing the repository
2026-02-09T19:16:23.7732404Z [command]/usr/bin/git init /home/runner/work/FiniteVolumeMethod.jl/FiniteVolumeMethod.jl
2026-02-09T19:16:23.7844472Z hint: Using 'master' as the name for the initial branch. This default branch name
2026-02-09T19:16:23.7846654Z hint: will change to "main" in Git 3.0. To configure the initial branch name
2026-02-09T19:16:23.7849191Z hint: to use in all of your new repositories, which will suppress this warning,
2026-02-09T19:16:23.7851107Z hint: call:
2026-02-09T19:16:23.7852376Z hint:
2026-02-09T19:16:23.7853928Z hint: 	git config --global init.defaultBranch <name>
2026-02-09T19:16:23.7855928Z hint:
2026-02-09T19:16:23.7857735Z hint: Names commonly chosen instead of 'master' are 'main', 'trunk' and
2026-02-09T19:16:23.7861038Z hint: 'development'. The just-created branch can be renamed via this command:
2026-02-09T19:16:23.7863539Z hint:
2026-02-09T19:16:23.7864712Z hint: 	git branch -m <name>
2026-02-09T19:16:23.7866069Z hint:
2026-02-09T19:16:23.7867907Z hint: Disable this message with "git config set advice.defaultBranchName false"
2026-02-09T19:16:23.7871093Z Initialized empty Git repository in /home/runner/work/FiniteVolumeMethod.jl/FiniteVolumeMethod.jl/.git/
2026-02-09T19:16:23.7874807Z [command]/usr/bin/git remote add origin https://github.com/S-AM-I/FiniteVolumeMethod.jl
2026-02-09T19:16:23.7899412Z ##[endgroup]
2026-02-09T19:16:23.7901698Z ##[group]Disabling automatic garbage collection
2026-02-09T19:16:23.7903854Z [command]/usr/bin/git config --local gc.auto 0
2026-02-09T19:16:23.7933082Z ##[endgroup]
2026-02-09T19:16:23.7935193Z ##[group]Setting up auth
2026-02-09T19:16:23.7940578Z [command]/usr/bin/git config --local --name-only --get-regexp core\.sshCommand
2026-02-09T19:16:23.7972579Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :"
2026-02-09T19:16:23.8345041Z [command]/usr/bin/git config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2026-02-09T19:16:23.8377963Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :"
2026-02-09T19:16:23.8594388Z [command]/usr/bin/git config --local --name-only --get-regexp ^includeIf\.gitdir:
2026-02-09T19:16:23.8623527Z [command]/usr/bin/git submodule foreach --recursive git config --local --show-origin --name-only --get-regexp remote.origin.url
2026-02-09T19:16:23.8850387Z [command]/usr/bin/git config --local http.https://github.com/.extraheader AUTHORIZATION: basic ***
2026-02-09T19:16:23.8883692Z ##[endgroup]
2026-02-09T19:16:23.8884948Z ##[group]Fetching the repository
2026-02-09T19:16:23.8892687Z [command]/usr/bin/git -c protocol.version=2 fetch --no-tags --prune --no-recurse-submodules --depth=1 origin +d09ffe6cae7293c39da2a6612b035305965a905f:refs/remotes/origin/main
2026-02-09T19:16:25.7233554Z From https://github.com/S-AM-I/FiniteVolumeMethod.jl
2026-02-09T19:16:25.7234520Z  * [new ref]         d09ffe6cae7293c39da2a6612b035305965a905f -> origin/main
2026-02-09T19:16:25.7266604Z ##[endgroup]
2026-02-09T19:16:25.7267347Z ##[group]Determining the checkout info
2026-02-09T19:16:25.7269904Z ##[endgroup]
2026-02-09T19:16:25.7276879Z [command]/usr/bin/git sparse-checkout disable
2026-02-09T19:16:25.7319082Z [command]/usr/bin/git config --local --unset-all extensions.worktreeConfig
2026-02-09T19:16:25.7346031Z ##[group]Checking out the ref
2026-02-09T19:16:25.7349970Z [command]/usr/bin/git checkout --progress --force -B main refs/remotes/origin/main
2026-02-09T19:16:26.0944403Z Switched to a new branch 'main'
2026-02-09T19:16:26.0945617Z branch 'main' set up to track 'origin/main'.
2026-02-09T19:16:26.0981671Z ##[endgroup]
2026-02-09T19:16:26.1019871Z [command]/usr/bin/git log -1 --format=%H
2026-02-09T19:16:26.1042144Z d09ffe6cae7293c39da2a6612b035305965a905f
2026-02-09T19:16:26.1256453Z ##[group]Run fredrikekre/runic-action@v1
2026-02-09T19:16:26.1256790Z with:
2026-02-09T19:16:26.1256970Z   version: 1
2026-02-09T19:16:26.1257153Z   format_files: false
2026-02-09T19:16:26.1257346Z ##[endgroup]
2026-02-09T19:16:26.1335405Z ##[group]Run ${GITHUB_ACTION_PATH}/src/dependency-check.sh
2026-02-09T19:16:26.1335852Z [36;1m${GITHUB_ACTION_PATH}/src/dependency-check.sh[0m
2026-02-09T19:16:26.1372492Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2026-02-09T19:16:26.1372845Z ##[endgroup]
2026-02-09T19:16:37.8537548Z ##[group]Run julia --color=yes --project=@runic "${GITHUB_ACTION_PATH}/src/install.jl"
2026-02-09T19:16:37.8538152Z [36;1mjulia --color=yes --project=@runic "${GITHUB_ACTION_PATH}/src/install.jl"[0m
2026-02-09T19:16:37.8569362Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2026-02-09T19:16:37.8569685Z env:
2026-02-09T19:16:37.8569854Z   INPUT_RUNIC_VERSION: 1
2026-02-09T19:16:37.8570062Z ##[endgroup]
2026-02-09T19:16:43.9397999Z [32m[1m  Installing[22m[39m known registries into `~/.julia`
2026-02-09T19:16:45.6475724Z [32m[1m       Added[22m[39m `General` registry to ~/.julia/registries
2026-02-09T19:16:45.9107975Z [32m[1m    Updating[22m[39m registry at `~/.julia/registries/General.toml`
2026-02-09T19:16:45.9583448Z [32m[1m   Resolving[22m[39m package versions...
2026-02-09T19:16:46.6444029Z [32m[1m   Installed[22m[39m Preferences ─ v1.5.1
2026-02-09T19:16:46.6587072Z [32m[1m   Installed[22m[39m JuliaSyntax ─ v0.4.10
2026-02-09T19:16:46.6588117Z [32m[1m   Installed[22m[39m Runic ─────── v1.5.1
2026-02-09T19:16:46.7316073Z [32m[1m    Updating[22m[39m `~/.julia/environments/runic/Project.toml`
2026-02-09T19:16:46.7316988Z   [90m[62bfec6d] [39m[92m+ Runic v1.5.1[39m
2026-02-09T19:16:46.7320310Z [32m[1m    Updating[22m[39m `~/.julia/environments/runic/Manifest.toml`
2026-02-09T19:16:46.7324712Z [33m⌅[39m [90m[70703baa] [39m[92m+ JuliaSyntax v0.4.10[39m
2026-02-09T19:16:46.7325670Z   [90m[21216c6a] [39m[92m+ Preferences v1.5.1[39m
2026-02-09T19:16:46.7326447Z   [90m[62bfec6d] [39m[92m+ Runic v1.5.1[39m
2026-02-09T19:16:46.7327437Z   [90m[ade2ca70] [39m[92m+ Dates v1.11.0[39m
2026-02-09T19:16:46.7329737Z   [90m[de0858da] [39m[92m+ Printf v1.11.0[39m
2026-02-09T19:16:46.7331963Z   [90m[fa267f1f] [39m[92m+ TOML v1.0.3[39m
2026-02-09T19:16:46.7332558Z   [90m[4ec0a83e] [39m[92m+ Unicode v1.11.0[39m
2026-02-09T19:16:46.7334091Z [36m[1m        Info[22m[39m Packages marked with [33m⌅[39m have new versions available but compatibility constraints restrict them from upgrading. To see why use `status --outdated -m`
2026-02-09T19:16:46.8985432Z [32m[1mPrecompiling[22m[39m packages...
2026-02-09T19:16:48.0211034Z    1086.2 ms[32m  ✓ [39m[90mPreferences[39m
2026-02-09T19:17:03.0837120Z   16185.0 ms[32m  ✓ [39m[90mJuliaSyntax[39m
2026-02-09T19:17:19.1406412Z   16056.8 ms[32m  ✓ [39mRunic
2026-02-09T19:17:19.1407280Z   3 dependencies successfully precompiled in 32 seconds. 4 already precompiled.
2026-02-09T19:17:19.2898998Z ##[group]Run julia --color=yes --project=@runic "${GITHUB_ACTION_PATH}/src/check.jl"
2026-02-09T19:17:19.2899554Z [36;1mjulia --color=yes --project=@runic "${GITHUB_ACTION_PATH}/src/check.jl"[0m
2026-02-09T19:17:19.2930247Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2026-02-09T19:17:19.2930565Z env:
2026-02-09T19:17:19.2930745Z   INPUT_RUNIC_FORMAT_FILES: false
2026-02-09T19:17:19.2930971Z ##[endgroup]
2026-02-09T19:17:19.7885622Z [34m[  1/151] Checking `docs/liveserver.jl` ...................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.7939084Z [34m[  2/151] Checking `docs/make.jl` ............................................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8155202Z [1mdiff --git a/make.jl b/make.jl[m
2026-02-09T19:17:19.8179658Z [1mindex 432d8ce..796d000 100644[m
2026-02-09T19:17:19.8180212Z [1m--- a/make.jl[m
2026-02-09T19:17:19.8180567Z [1m+++ b/make.jl[m
2026-02-09T19:17:19.8181466Z [36m@@ -201,6 +201,7 @@[m [mfunction _collect_pages!(set, pages)[m
2026-02-09T19:17:19.8182207Z              _collect_pages!(set, page[2])[m
2026-02-09T19:17:19.8182731Z          end[m
2026-02-09T19:17:19.8183061Z      end[m
2026-02-09T19:17:19.8183377Z [32m+[m[32m    return[m
2026-02-09T19:17:19.8183755Z  end[m
2026-02-09T19:17:19.8184099Z  _collect_pages!(set, _PAGES)[m
2026-02-09T19:17:19.8184551Z  missing_set = String[][m
2026-02-09T19:17:19.8199847Z [34m[  3/151] Checking `docs/src/literate_hyperbolic/amr_sedov_blast.jl` ......... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8216645Z [1mdiff --git a/amr_sedov_blast.jl b/amr_sedov_blast.jl[m
2026-02-09T19:17:19.8217332Z [1mindex 8b44d9a..a975834 100644[m
2026-02-09T19:17:19.8217814Z [1m--- a/amr_sedov_blast.jl[m
2026-02-09T19:17:19.8218282Z [1m+++ b/amr_sedov_blast.jl[m
2026-02-09T19:17:19.8218976Z [36m@@ -32,9 +32,9 @@[m [mdomain_hi = (1.0, 1.0)[m
2026-02-09T19:17:19.8219774Z  # The `GradientRefinement` criterion refines blocks where the density[m
2026-02-09T19:17:19.8220483Z  # gradient exceeds a threshold:[m
2026-02-09T19:17:19.8220967Z  criterion = GradientRefinement([m
2026-02-09T19:17:19.8221648Z [31m-    variable_index=1,              ## monitor density (index 1)[m
2026-02-09T19:17:19.8222286Z [31m-    refine_threshold=0.1,[m
2026-02-09T19:17:19.8222807Z [31m-    coarsen_threshold=0.01[m
2026-02-09T19:17:19.8223479Z [32m+[m[32m    variable_index = 1,              ## monitor density (index 1)[m
2026-02-09T19:17:19.8224185Z [32m+[m[32m    refine_threshold = 0.1,[m
2026-02-09T19:17:19.8224725Z [32m+[m[32m    coarsen_threshold = 0.01[m
2026-02-09T19:17:19.8225174Z  )[m
2026-02-09T19:17:19.8225465Z  [m
2026-02-09T19:17:19.8226103Z  grid = AMRGrid(law, criterion, block_size, max_level, domain_lo, domain_hi, Val(4))[m
2026-02-09T19:17:19.8227264Z [36m@@ -44,7 +44,7 @@[m [mgrid = AMRGrid(law, criterion, block_size, max_level, domain_lo, domain_hi, Val([m
2026-02-09T19:17:19.8228365Z  # uniform density with a high-pressure region near the origin.[m
2026-02-09T19:17:19.8229311Z  root_block = grid.blocks[1][m
2026-02-09T19:17:19.8229791Z  dx_root = root_block.dx[1][m
2026-02-09T19:17:19.8230242Z [31m-P_bg = 1e-5[m
2026-02-09T19:17:19.8230654Z [32m+[m[32mP_bg = 1.0e-5[m
2026-02-09T19:17:19.8231050Z  P_blast = 1.0[m
2026-02-09T19:17:19.8231419Z  r_blast = 3.0 * dx_root[m
2026-02-09T19:17:19.8231780Z  [m
2026-02-09T19:17:19.8232243Z [36m@@ -73,7 +73,7 @@[m [mmax_lev = max_active_level(grid)[m
2026-02-09T19:17:19.8233084Z  bcs = (TransmissiveBC(), TransmissiveBC(), TransmissiveBC(), TransmissiveBC())[m
2026-02-09T19:17:19.8233811Z  prob = AMRProblem([m
2026-02-09T19:17:19.8234300Z      grid, HLLCSolver(), NoReconstruction(), bcs;[m
2026-02-09T19:17:19.8234956Z [31m-    final_time=0.05, cfl=0.3, regrid_interval=4[m
2026-02-09T19:17:19.8235700Z [32m+[m[32m    final_time = 0.05, cfl = 0.3, regrid_interval = 4[m
2026-02-09T19:17:19.8236268Z  )[m
2026-02-09T19:17:19.8236674Z  final_grid, t_final = solve_amr(prob)[m
2026-02-09T19:17:19.8237187Z  final_grid |> tc #hide[m
2026-02-09T19:17:19.8237792Z [36m@@ -104,17 +104,21 @@[m [mfor block in active_blocks(final_grid)[m
2026-02-09T19:17:19.8238371Z      end[m
2026-02-09T19:17:19.8238669Z  end[m
2026-02-09T19:17:19.8239310Z  [m
2026-02-09T19:17:19.8239725Z [31m-fig = Figure(fontsize=24, size=(1100, 500))[m
2026-02-09T19:17:19.8240352Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8241047Z [31m-           title="Density (AMR, t=$(round(t_final, digits=3)))",[m
2026-02-09T19:17:19.8241686Z [31m-           aspect=DataAspect())[m
2026-02-09T19:17:19.8242409Z [31m-sc1 = scatter!(ax1, xs, ys, color=rhos, markersize=4, colormap=:inferno)[m
2026-02-09T19:17:19.8243159Z [31m-Colorbar(fig[1, 2], sc1, label=L"\rho")[m
2026-02-09T19:17:19.8243931Z [31m-[m
2026-02-09T19:17:19.8244384Z [31m-ax2 = Axis(fig[1, 3], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8245215Z [31m-           title="AMR levels", aspect=DataAspect())[m
2026-02-09T19:17:19.8246063Z [31m-sc2 = scatter!(ax2, xs, ys, color=levels, markersize=4, colormap=:Set1_3)[m
2026-02-09T19:17:19.8246818Z [31m-Colorbar(fig[1, 4], sc2, label="Level")[m
2026-02-09T19:17:19.8247501Z [32m+[m[32mfig = Figure(fontsize = 24, size = (1100, 500))[m
2026-02-09T19:17:19.8248190Z [32m+[m[32max1 = Axis([m
2026-02-09T19:17:19.8248572Z [32m+[m[32m    fig[1, 1], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8249287Z [32m+[m[32m    title = "Density (AMR, t=$(round(t_final, digits = 3)))",[m
2026-02-09T19:17:19.8249673Z [32m+[m[32m    aspect = DataAspect()[m
2026-02-09T19:17:19.8249928Z [32m+[m[32m)[m
2026-02-09T19:17:19.8250310Z [32m+[m[32msc1 = scatter!(ax1, xs, ys, color = rhos, markersize = 4, colormap = :inferno)[m
2026-02-09T19:17:19.8250792Z [32m+[m[32mColorbar(fig[1, 2], sc1, label = L"\rho")[m
2026-02-09T19:17:19.8251085Z [32m+[m
2026-02-09T19:17:19.8251273Z [32m+[m[32max2 = Axis([m
2026-02-09T19:17:19.8251567Z [32m+[m[32m    fig[1, 3], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8251931Z [32m+[m[32m    title = "AMR levels", aspect = DataAspect()[m
2026-02-09T19:17:19.8252235Z [32m+[m[32m)[m
2026-02-09T19:17:19.8252622Z [32m+[m[32msc2 = scatter!(ax2, xs, ys, color = levels, markersize = 4, colormap = :Set1_3)[m
2026-02-09T19:17:19.8253085Z [32m+[m[32mColorbar(fig[1, 4], sc2, label = "Level")[m
2026-02-09T19:17:19.8253785Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8254175Z  fig[m
2026-02-09T19:17:19.8254823Z  @test_reference joinpath(@__DIR__, "../figures", "amr_sedov_blast.png") fig #src[m
2026-02-09T19:17:19.8320008Z [34m[  4/151] Checking `docs/src/literate_hyperbolic/balsara_srmhd_shock_tube.jl`  [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8321376Z [1mdiff --git a/balsara_srmhd_shock_tube.jl b/balsara_srmhd_shock_tube.jl[m
2026-02-09T19:17:19.8322525Z [1mindex 0008e39..429ce3e 100644[m
2026-02-09T19:17:19.8323611Z [1m--- a/balsara_srmhd_shock_tube.jl[m
2026-02-09T19:17:19.8324097Z [1m+++ b/balsara_srmhd_shock_tube.jl[m
2026-02-09T19:17:19.8324519Z [36m@@ -35,7 +35,7 @@[m [mic(x) = x < 0.5 ? wL : wR[m
2026-02-09T19:17:19.8324904Z  prob = HyperbolicProblem([m
2026-02-09T19:17:19.8325380Z      law, mesh, HLLSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.8325900Z      TransmissiveBC(), TransmissiveBC(), ic;[m
2026-02-09T19:17:19.8326305Z [31m-    final_time=0.4, cfl=0.4[m
2026-02-09T19:17:19.8326660Z [32m+[m[32m    final_time = 0.4, cfl = 0.4[m
2026-02-09T19:17:19.8326973Z  )[m
2026-02-09T19:17:19.8327253Z  x, U, t_final = solve_hyperbolic(prob)[m
2026-02-09T19:17:19.8327584Z  x |> tc #hide[m
2026-02-09T19:17:19.8328080Z [36m@@ -52,15 +52,15 @@[m [mBy = [conserved_to_primitive(law, U[i])[7] for i in eachindex(U)][m
2026-02-09T19:17:19.8328596Z  # ## Visualisation[m
2026-02-09T19:17:19.8329209Z  using CairoMakie[m
2026-02-09T19:17:19.8329587Z  [m
2026-02-09T19:17:19.8330045Z [31m-fig = Figure(fontsize=20, size=(1200, 400))[m
2026-02-09T19:17:19.8330828Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel=L"\rho", title="Density")[m
2026-02-09T19:17:19.8331618Z [31m-lines!(ax1, x, rho, color=:blue, linewidth=1.5)[m
2026-02-09T19:17:19.8332374Z [32m+[m[32mfig = Figure(fontsize = 20, size = (1200, 400))[m
2026-02-09T19:17:19.8333218Z [32m+[m[32max1 = Axis(fig[1, 1], xlabel = "x", ylabel = L"\rho", title = "Density")[m
2026-02-09T19:17:19.8333831Z [32m+[m[32mlines!(ax1, x, rho, color = :blue, linewidth = 1.5)[m
2026-02-09T19:17:19.8334206Z  [m
2026-02-09T19:17:19.8334589Z [31m-ax2 = Axis(fig[1, 2], xlabel="x", ylabel=L"v_x", title="Velocity")[m
2026-02-09T19:17:19.8335122Z [31m-lines!(ax2, x, vx, color=:blue, linewidth=1.5)[m
2026-02-09T19:17:19.8335681Z [32m+[m[32max2 = Axis(fig[1, 2], xlabel = "x", ylabel = L"v_x", title = "Velocity")[m
2026-02-09T19:17:19.8336477Z [32m+[m[32mlines!(ax2, x, vx, color = :blue, linewidth = 1.5)[m
2026-02-09T19:17:19.8336883Z  [m
2026-02-09T19:17:19.8337434Z [31m-ax3 = Axis(fig[1, 3], xlabel="x", ylabel=L"B_y", title="Magnetic Field (y)")[m
2026-02-09T19:17:19.8338034Z [31m-lines!(ax3, x, By, color=:blue, linewidth=1.5)[m
2026-02-09T19:17:19.8338630Z [32m+[m[32max3 = Axis(fig[1, 3], xlabel = "x", ylabel = L"B_y", title = "Magnetic Field (y)")[m
2026-02-09T19:17:19.8339565Z [32m+[m[32mlines!(ax3, x, By, color = :blue, linewidth = 1.5)[m
2026-02-09T19:17:19.8339944Z  [m
2026-02-09T19:17:19.8340178Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8340440Z  fig[m
2026-02-09T19:17:19.8341010Z [34m[  5/151] Checking `docs/src/literate_hyperbolic/brio_wu_shock_tube.jl` ...... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8341750Z [1mdiff --git a/brio_wu_shock_tube.jl b/brio_wu_shock_tube.jl[m
2026-02-09T19:17:19.8342209Z [1mindex 8a4b163..c9475fa 100644[m
2026-02-09T19:17:19.8342548Z [1m--- a/brio_wu_shock_tube.jl[m
2026-02-09T19:17:19.8342889Z [1m+++ b/brio_wu_shock_tube.jl[m
2026-02-09T19:17:19.8343284Z [36m@@ -39,7 +39,7 @@[m [mbw_ic(x) = x < 0.5 ? wL : wR[m
2026-02-09T19:17:19.8343686Z  prob = HyperbolicProblem([m
2026-02-09T19:17:19.8344170Z      law, mesh, HLLDSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.8344692Z      TransmissiveBC(), TransmissiveBC(), bw_ic;[m
2026-02-09T19:17:19.8345089Z [31m-    final_time=0.1, cfl=0.8[m
2026-02-09T19:17:19.8345439Z [32m+[m[32m    final_time = 0.1, cfl = 0.8[m
2026-02-09T19:17:19.8345749Z  )[m
2026-02-09T19:17:19.8346025Z  x, U, t_final = solve_hyperbolic(prob)[m
2026-02-09T19:17:19.8346367Z  x |> tc #hide[m
2026-02-09T19:17:19.8346849Z [36m@@ -55,14 +55,14 @@[m [mvy = [conserved_to_primitive(law, U[i])[3] for i in eachindex(U)][m
2026-02-09T19:17:19.8347504Z  P = [conserved_to_primitive(law, U[i])[5] for i in eachindex(U)][m
2026-02-09T19:17:19.8348089Z  By = [conserved_to_primitive(law, U[i])[7] for i in eachindex(U)][m
2026-02-09T19:17:19.8348495Z  [m
2026-02-09T19:17:19.8349036Z [31m-fig = Figure(fontsize=20, size=(1200, 800))[m
2026-02-09T19:17:19.8349527Z [32m+[m[32mfig = Figure(fontsize = 20, size = (1200, 800))[m
2026-02-09T19:17:19.8349975Z  titles = [L"\rho", L"v_x", L"v_y", "P", L"B_y"][m
2026-02-09T19:17:19.8350340Z  data = [rho, vx, vy, P, By][m
2026-02-09T19:17:19.8350746Z  for (idx, (title, d)) in enumerate(zip(titles, data))[m
2026-02-09T19:17:19.8351147Z      row = (idx - 1) ÷ 3 + 1[m
2026-02-09T19:17:19.8351425Z      col = (idx - 1) % 3 + 1[m
2026-02-09T19:17:19.8351863Z [31m-    ax = Axis(fig[row, col], xlabel="x", ylabel=title, title=title)[m
2026-02-09T19:17:19.8352392Z [31m-    lines!(ax, x, d, color=:blue, linewidth=1.5)[m
2026-02-09T19:17:19.8352966Z [32m+[m[32m    ax = Axis(fig[row, col], xlabel = "x", ylabel = title, title = title)[m
2026-02-09T19:17:19.8353904Z [32m+[m[32m    lines!(ax, x, d, color = :blue, linewidth = 1.5)[m
2026-02-09T19:17:19.8354500Z  end[m
2026-02-09T19:17:19.8354855Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8355245Z  fig[m
2026-02-09T19:17:19.8355594Z [36m@@ -73,5 +73,5 @@[m [mfig[m
2026-02-09T19:17:19.8356339Z  # contact discontinuity, slow shock, and fast rarefaction on the right.[m
2026-02-09T19:17:19.8357177Z  # Note that $B_x$ remains constant at $0.75$ throughout (not shown).[m
2026-02-09T19:17:19.8357701Z  Bx_vals = [U[i][6] for i in eachindex(U)] #hide[m
2026-02-09T19:17:19.8358168Z [31m-@assert all(b -> abs(b - 0.75) < 1e-10, Bx_vals) #hide[m
2026-02-09T19:17:19.8358686Z [32m+[m[32m@assert all(b -> abs(b - 0.75) < 1.0e-10, Bx_vals) #hide[m
2026-02-09T19:17:19.8359368Z  @assert all(rho .> 0) #hide[m
2026-02-09T19:17:19.8359985Z [34m[  6/151] Checking `docs/src/literate_hyperbolic/couette_flow.jl` ............ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8360650Z [1mdiff --git a/couette_flow.jl b/couette_flow.jl[m
2026-02-09T19:17:19.8361066Z [1mindex 8addedf..21155f2 100644[m
2026-02-09T19:17:19.8361572Z [1m--- a/couette_flow.jl[m
2026-02-09T19:17:19.8361870Z [1m+++ b/couette_flow.jl[m
2026-02-09T19:17:19.8362177Z [36m@@ -23,7 +23,7 @@[m [mgamma = 1.4[m
2026-02-09T19:17:19.8362626Z  eos = IdealGasEOS(gamma)[m
2026-02-09T19:17:19.8362903Z  mu = 0.01[m
2026-02-09T19:17:19.8363128Z  Pr = 0.72[m
2026-02-09T19:17:19.8363519Z [31m-ns = NavierStokesEquations{2}(eos, mu=mu, Pr=Pr)[m
2026-02-09T19:17:19.8364061Z [32m+[m[32mns = NavierStokesEquations{2}(eos, mu = mu, Pr = Pr)[m
2026-02-09T19:17:19.8364451Z  [m
2026-02-09T19:17:19.8364736Z  ## Physical parameters (low Mach number)[m
2026-02-09T19:17:19.8365078Z  rho0 = 1.0[m
2026-02-09T19:17:19.8365409Z [36m@@ -51,7 +51,7 @@[m [mprob = HyperbolicProblem2D([m
2026-02-09T19:17:19.8365870Z      ns, mesh, HLLCSolver(), NoReconstruction(),[m
2026-02-09T19:17:19.8366360Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8366851Z      NoSlipBC(), DirichletHyperbolicBC(w_top),[m
2026-02-09T19:17:19.8367276Z [31m-    ic_couette; final_time=0.5, cfl=0.3[m
2026-02-09T19:17:19.8367719Z [32m+[m[32m    ic_couette; final_time = 0.5, cfl = 0.3[m
2026-02-09T19:17:19.8368066Z  )[m
2026-02-09T19:17:19.8368556Z  coords, U, t_final = solve_hyperbolic(prob)[m
2026-02-09T19:17:19.8370126Z  coords |> tc #hide[m
2026-02-09T19:17:19.8370746Z [36m@@ -69,12 +69,14 @@[m [mmax_err = maximum(abs.(vx_num .- vx_exact))[m
2026-02-09T19:17:19.8371393Z  # ## Visualisation[m
2026-02-09T19:17:19.8371799Z  using CairoMakie[m
2026-02-09T19:17:19.8372062Z  [m
2026-02-09T19:17:19.8372352Z [31m-fig = Figure(fontsize=24, size=(600, 500))[m
2026-02-09T19:17:19.8372801Z [31m-ax = Axis(fig[1, 1], xlabel=L"v_x", ylabel="y",[m
2026-02-09T19:17:19.8373275Z [31m-          title="Couette Flow: velocity profile")[m
2026-02-09T19:17:19.8373914Z [31m-lines!(ax, vx_exact, yc, color=:black, linewidth=2, label="Exact")[m
2026-02-09T19:17:19.8374554Z [31m-scatter!(ax, vx_num, yc, color=:blue, markersize=10, label="Numerical")[m
2026-02-09T19:17:19.8375090Z [31m-axislegend(ax, position=:lt)[m
2026-02-09T19:17:19.8375519Z [32m+[m[32mfig = Figure(fontsize = 24, size = (600, 500))[m
2026-02-09T19:17:19.8375927Z [32m+[m[32max = Axis([m
2026-02-09T19:17:19.8376286Z [32m+[m[32m    fig[1, 1], xlabel = L"v_x", ylabel = "y",[m
2026-02-09T19:17:19.8376763Z [32m+[m[32m    title = "Couette Flow: velocity profile"[m
2026-02-09T19:17:19.8377129Z [32m+[m[32m)[m
2026-02-09T19:17:19.8377571Z [32m+[m[32mlines!(ax, vx_exact, yc, color = :black, linewidth = 2, label = "Exact")[m
2026-02-09T19:17:19.8378293Z [32m+[m[32mscatter!(ax, vx_num, yc, color = :blue, markersize = 10, label = "Numerical")[m
2026-02-09T19:17:19.8379078Z [32m+[m[32maxislegend(ax, position = :lt)[m
2026-02-09T19:17:19.8379448Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8379705Z  fig[m
2026-02-09T19:17:19.8380136Z  @test_reference joinpath(@__DIR__, "../figures", "couette_flow.png") fig #src[m
2026-02-09T19:17:19.8380977Z [34m[  7/151] Checking `docs/src/literate_hyperbolic/field_loop_advection.jl` .... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8381751Z [1mdiff --git a/field_loop_advection.jl b/field_loop_advection.jl[m
2026-02-09T19:17:19.8382239Z [1mindex 62ba894..7826498 100644[m
2026-02-09T19:17:19.8382571Z [1m--- a/field_loop_advection.jl[m
2026-02-09T19:17:19.8382926Z [1m+++ b/field_loop_advection.jl[m
2026-02-09T19:17:19.8383318Z [36m@@ -22,7 +22,7 @@[m [meos = IdealGasEOS(gamma)[m
2026-02-09T19:17:19.8383725Z  law = IdealMHDEquations{2}(eos)[m
2026-02-09T19:17:19.8384013Z  [m
2026-02-09T19:17:19.8384212Z  R0 = 0.3[m
2026-02-09T19:17:19.8384439Z [31m-A0 = 1e-3[m
2026-02-09T19:17:19.8384683Z [32m+[m[32mA0 = 1.0e-3[m
2026-02-09T19:17:19.8384966Z  vx_bg, vy_bg = 1.0, 0.5[m
2026-02-09T19:17:19.8385242Z  rho_bg, P_bg = 1.0, 1.0[m
2026-02-09T19:17:19.8385486Z  [m
2026-02-09T19:17:19.8385808Z [36m@@ -60,19 +60,19 @@[m [mprob = HyperbolicProblem2D([m
2026-02-09T19:17:19.8386357Z      law, mesh, HLLDSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.8387112Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8387631Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8388200Z [31m-    loop_ic; final_time=1.0, cfl=0.4[m
2026-02-09T19:17:19.8388634Z [32m+[m[32m    loop_ic; final_time = 1.0, cfl = 0.4[m
2026-02-09T19:17:19.8389304Z  )[m
2026-02-09T19:17:19.8389602Z  [m
2026-02-09T19:17:19.8390250Z  # The `vector_potential` keyword triggers `initialize_ct_from_potential!`,[m
2026-02-09T19:17:19.8391213Z  # which uses Stokes' theorem to compute face-centred $B$ values:[m
2026-02-09T19:17:19.8392179Z [31m-coords, U, t_final, ct = solve_hyperbolic(prob; vector_potential=Az_loop)[m
2026-02-09T19:17:19.8393087Z [32m+[m[32mcoords, U, t_final, ct = solve_hyperbolic(prob; vector_potential = Az_loop)[m
2026-02-09T19:17:19.8393608Z  coords |> tc #hide[m
2026-02-09T19:17:19.8393838Z  [m
2026-02-09T19:17:19.8394086Z  # ## Checking $\nabla\cdot\vb B$[m
2026-02-09T19:17:19.8394597Z  # With CT + vector potential initialisation, the discrete divergence[m
2026-02-09T19:17:19.8395097Z  # remains at machine precision:[m
2026-02-09T19:17:19.8395451Z  divB_max = max_divB(ct, mesh)[m
2026-02-09T19:17:19.8395788Z [31m-@assert divB_max < 1e-12 #hide[m
2026-02-09T19:17:19.8396161Z [32m+[m[32m@assert divB_max < 1.0e-12 #hide[m
2026-02-09T19:17:19.8396464Z  [m
2026-02-09T19:17:19.8396690Z  # ## Visualisation[m
2026-02-09T19:17:19.8396958Z  using CairoMakie[m
2026-02-09T19:17:19.8397261Z [36m@@ -81,21 +81,27 @@[m [mnx, ny = N, N[m
2026-02-09T19:17:19.8397614Z  xc = [coords[1][i] for i in 1:nx][m
2026-02-09T19:17:19.8397949Z  yc = [coords[2][j] for j in 1:ny][m
2026-02-09T19:17:19.8398288Z  ## Compute |B| from the solution[m
2026-02-09T19:17:19.8398596Z [31m-Bmag = [begin[m
2026-02-09T19:17:19.8399183Z [31m-    w = conserved_to_primitive(law, U[i, j])[m
2026-02-09T19:17:19.8399556Z [31m-    sqrt(w[6]^2 + w[7]^2)[m
2026-02-09T19:17:19.8399877Z [31m-end for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.8400190Z [32m+[m[32mBmag = [[m
2026-02-09T19:17:19.8400455Z [32m+[m[32m    begin[m
2026-02-09T19:17:19.8400829Z [32m+[m[32m            w = conserved_to_primitive(law, U[i, j])[m
2026-02-09T19:17:19.8401260Z [32m+[m[32m            sqrt(w[6]^2 + w[7]^2)[m
2026-02-09T19:17:19.8401642Z [32m+[m[32m        end for i in 1:nx, j in 1:ny[m
2026-02-09T19:17:19.8401962Z [32m+[m[32m][m
2026-02-09T19:17:19.8402380Z  rho = [conserved_to_primitive(law, U[i, j])[1] for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.8402801Z  [m
2026-02-09T19:17:19.8403187Z [31m-fig = Figure(fontsize=24, size=(1100, 500))[m
2026-02-09T19:17:19.8403856Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8404673Z [31m-           title="|B| at t = $(round(t_final, digits=2))", aspect=DataAspect())[m
2026-02-09T19:17:19.8405528Z [31m-hm1 = heatmap!(ax1, xc, yc, Bmag, colormap=:viridis)[m
2026-02-09T19:17:19.8406279Z [32m+[m[32mfig = Figure(fontsize = 24, size = (1100, 500))[m
2026-02-09T19:17:19.8406831Z [32m+[m[32max1 = Axis([m
2026-02-09T19:17:19.8407182Z [32m+[m[32m    fig[1, 1], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8407756Z [32m+[m[32m    title = "|B| at t = $(round(t_final, digits = 2))", aspect = DataAspect()[m
2026-02-09T19:17:19.8408372Z [32m+[m[32m)[m
2026-02-09T19:17:19.8408985Z [32m+[m[32mhm1 = heatmap!(ax1, xc, yc, Bmag, colormap = :viridis)[m
2026-02-09T19:17:19.8409451Z  Colorbar(fig[1, 2], hm1)[m
2026-02-09T19:17:19.8409711Z  [m
2026-02-09T19:17:19.8410012Z [31m-ax2 = Axis(fig[1, 3], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8410455Z [31m-           title="Density", aspect=DataAspect())[m
2026-02-09T19:17:19.8410930Z [31m-hm2 = heatmap!(ax2, xc, yc, rho, colormap=:inferno)[m
2026-02-09T19:17:19.8411315Z [32m+[m[32max2 = Axis([m
2026-02-09T19:17:19.8411658Z [32m+[m[32m    fig[1, 3], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8412107Z [32m+[m[32m    title = "Density", aspect = DataAspect()[m
2026-02-09T19:17:19.8412658Z [32m+[m[32m)[m
2026-02-09T19:17:19.8413041Z [32m+[m[32mhm2 = heatmap!(ax2, xc, yc, rho, colormap = :inferno)[m
2026-02-09T19:17:19.8413469Z  Colorbar(fig[1, 4], hm2)[m
2026-02-09T19:17:19.8413882Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8414143Z  fig[m
2026-02-09T19:17:19.8414720Z [34m[  8/151] Checking `docs/src/literate_hyperbolic/imex_stiff_relaxation.jl` ... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8415480Z [1mdiff --git a/imex_stiff_relaxation.jl b/imex_stiff_relaxation.jl[m
2026-02-09T19:17:19.8415964Z [1mindex 2bf046a..bd86f7e 100644[m
2026-02-09T19:17:19.8416309Z [1m--- a/imex_stiff_relaxation.jl[m
2026-02-09T19:17:19.8416655Z [1m+++ b/imex_stiff_relaxation.jl[m
2026-02-09T19:17:19.8417095Z [36m@@ -39,7 +39,7 @@[m [mlambda_rate = 50.0  ## stiff cooling rate[m
2026-02-09T19:17:19.8417688Z  # molecular weight $\mu$. The temperature is computed as $T = P\mu/\rho$.[m
2026-02-09T19:17:19.8418185Z  T_target = P_target * mu_mol[m
2026-02-09T19:17:19.8418579Z  cooling_func = T -> lambda_rate * (T - T_target)[m
2026-02-09T19:17:19.8419209Z [31m-source = CoolingSource(cooling_func; mu_mol=mu_mol)[m
2026-02-09T19:17:19.8419785Z [32m+[m[32msource = CoolingSource(cooling_func; mu_mol = mu_mol)[m
2026-02-09T19:17:19.8420184Z  [m
2026-02-09T19:17:19.8420468Z  w_init = SVector(rho_init, v_init, P_init)[m
2026-02-09T19:17:19.8420786Z  [m
2026-02-09T19:17:19.8421092Z [36m@@ -53,19 +53,19 @@[m [mprob = HyperbolicProblem([m
2026-02-09T19:17:19.8421545Z      law, mesh, HLLSolver(), NoReconstruction(),[m
2026-02-09T19:17:19.8421984Z      TransmissiveBC(), TransmissiveBC(),[m
2026-02-09T19:17:19.8422317Z      x -> w_init;[m
2026-02-09T19:17:19.8422609Z [31m-    final_time=t_final, cfl=0.4[m
2026-02-09T19:17:19.8422985Z [32m+[m[32m    final_time = t_final, cfl = 0.4[m
2026-02-09T19:17:19.8423306Z  )[m
2026-02-09T19:17:19.8423495Z  [m
2026-02-09T19:17:19.8423786Z  # **SSP3(4,3,3)** — 4-stage, 3rd-order SSP scheme:[m
2026-02-09T19:17:19.8424219Z  x_ssp, U_ssp, t_ssp = solve_hyperbolic_imex([m
2026-02-09T19:17:19.8424637Z [31m-    prob, source; scheme=IMEX_SSP3_433(),[m
2026-02-09T19:17:19.8425046Z [31m-    newton_tol=1e-12, newton_maxiter=10[m
2026-02-09T19:17:19.8425479Z [32m+[m[32m    prob, source; scheme = IMEX_SSP3_433(),[m
2026-02-09T19:17:19.8425953Z [32m+[m[32m    newton_tol = 1.0e-12, newton_maxiter = 10[m
2026-02-09T19:17:19.8426297Z  )[m
2026-02-09T19:17:19.8426489Z  [m
2026-02-09T19:17:19.8426796Z  # **ARS(2,2,2)** — 3-stage, 2nd-order L-stable scheme:[m
2026-02-09T19:17:19.8427225Z  x_ars, U_ars, t_ars = solve_hyperbolic_imex([m
2026-02-09T19:17:19.8427739Z [31m-    prob, source; scheme=IMEX_ARS222(),[m
2026-02-09T19:17:19.8428371Z [31m-    newton_tol=1e-12, newton_maxiter=10[m
2026-02-09T19:17:19.8429221Z [32m+[m[32m    prob, source; scheme = IMEX_ARS222(),[m
2026-02-09T19:17:19.8429920Z [32m+[m[32m    newton_tol = 1.0e-12, newton_maxiter = 10[m
2026-02-09T19:17:19.8430452Z  )[m
2026-02-09T19:17:19.8430785Z  x_ars |> tc #hide[m
2026-02-09T19:17:19.8431139Z  [m
2026-02-09T19:17:19.8431496Z [36m@@ -84,21 +84,25 @@[m [mP_avg_ars = sum(P_ars) / length(P_ars)[m
2026-02-09T19:17:19.8431914Z  # ## Visualisation[m
2026-02-09T19:17:19.8432191Z  using CairoMakie[m
2026-02-09T19:17:19.8432420Z  [m
2026-02-09T19:17:19.8432708Z [31m-fig = Figure(fontsize=24, size=(900, 400))[m
2026-02-09T19:17:19.8433144Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel="P",[m
2026-02-09T19:17:19.8433569Z [31m-           title="Pressure relaxation")[m
2026-02-09T19:17:19.8434120Z [31m-scatter!(ax1, x_ssp, P_ssp, color=:blue, markersize=6, label="SSP3(4,3,3)")[m
2026-02-09T19:17:19.8434789Z [31m-scatter!(ax1, x_ars, P_ars, color=:red, markersize=6, label="ARS(2,2,2)")[m
2026-02-09T19:17:19.8435512Z [31m-hlines!(ax1, [P_target], color=:black, linestyle=:dash, label=L"P_{\mathrm{target}}")[m
2026-02-09T19:17:19.8436259Z [31m-hlines!(ax1, [P_init], color=:gray, linestyle=:dot, label=L"P_{\mathrm{init}}")[m
2026-02-09T19:17:19.8436974Z [31m-axislegend(ax1, position=:rt)[m
2026-02-09T19:17:19.8437399Z [32m+[m[32mfig = Figure(fontsize = 24, size = (900, 400))[m
2026-02-09T19:17:19.8437784Z [32m+[m[32max1 = Axis([m
2026-02-09T19:17:19.8438239Z [32m+[m[32m    fig[1, 1], xlabel = "x", ylabel = "P",[m
2026-02-09T19:17:19.8438675Z [32m+[m[32m    title = "Pressure relaxation"[m
2026-02-09T19:17:19.8439354Z [32m+[m[32m)[m
2026-02-09T19:17:19.8439841Z [32m+[m[32mscatter!(ax1, x_ssp, P_ssp, color = :blue, markersize = 6, label = "SSP3(4,3,3)")[m
2026-02-09T19:17:19.8440577Z [32m+[m[32mscatter!(ax1, x_ars, P_ars, color = :red, markersize = 6, label = "ARS(2,2,2)")[m
2026-02-09T19:17:19.8441362Z [32m+[m[32mhlines!(ax1, [P_target], color = :black, linestyle = :dash, label = L"P_{\mathrm{target}}")[m
2026-02-09T19:17:19.8442177Z [32m+[m[32mhlines!(ax1, [P_init], color = :gray, linestyle = :dot, label = L"P_{\mathrm{init}}")[m
2026-02-09T19:17:19.8443110Z [32m+[m[32maxislegend(ax1, position = :rt)[m
2026-02-09T19:17:19.8443607Z  [m
2026-02-09T19:17:19.8444007Z  ## Also check that density is preserved[m
2026-02-09T19:17:19.8444842Z  rho_ssp = [conserved_to_primitive(law, U_ssp[i])[1] for i in eachindex(U_ssp)][m
2026-02-09T19:17:19.8445718Z [31m-ax2 = Axis(fig[1, 2], xlabel="x", ylabel=L"\rho",[m
2026-02-09T19:17:19.8446202Z [31m-           title="Density (should be constant)")[m
2026-02-09T19:17:19.8446722Z [31m-scatter!(ax2, x_ssp, rho_ssp, color=:blue, markersize=6)[m
2026-02-09T19:17:19.8447387Z [31m-hlines!(ax2, [rho_init], color=:black, linestyle=:dash)[m
2026-02-09T19:17:19.8447816Z [32m+[m[32max2 = Axis([m
2026-02-09T19:17:19.8448175Z [32m+[m[32m    fig[1, 2], xlabel = "x", ylabel = L"\rho",[m
2026-02-09T19:17:19.8448640Z [32m+[m[32m    title = "Density (should be constant)"[m
2026-02-09T19:17:19.8449117Z [32m+[m[32m)[m
2026-02-09T19:17:19.8449526Z [32m+[m[32mscatter!(ax2, x_ssp, rho_ssp, color = :blue, markersize = 6)[m
2026-02-09T19:17:19.8450131Z [32m+[m[32mhlines!(ax2, [rho_init], color = :black, linestyle = :dash)[m
2026-02-09T19:17:19.8450546Z  [m
2026-02-09T19:17:19.8450781Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8451033Z  fig[m
2026-02-09T19:17:19.8451656Z [34m[  9/151] Checking `docs/src/literate_hyperbolic/kelvin_helmholtz_instability.jl`  [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8452528Z [1mdiff --git a/kelvin_helmholtz_instability.jl b/kelvin_helmholtz_instability.jl[m
2026-02-09T19:17:19.8453077Z [1mindex 8349924..3a32dde 100644[m
2026-02-09T19:17:19.8453444Z [1m--- a/kelvin_helmholtz_instability.jl[m
2026-02-09T19:17:19.8453846Z [1m+++ b/kelvin_helmholtz_instability.jl[m
2026-02-09T19:17:19.8454253Z [36m@@ -40,11 +40,11 @@[m [mfunction kh_ic(x, y)[m
2026-02-09T19:17:19.8454599Z      sigma = 0.05[m
2026-02-09T19:17:19.8454878Z      rho = rho1 + (rho2 - rho1) * ([m
2026-02-09T19:17:19.8455244Z          0.5 * (1.0 + tanh((y - 0.25) / sigma)) -[m
2026-02-09T19:17:19.8455624Z [31m-        0.5 * (1.0 + tanh((y - 0.75) / sigma))[m
2026-02-09T19:17:19.8456046Z [32m+[m[32m            0.5 * (1.0 + tanh((y - 0.75) / sigma))[m
2026-02-09T19:17:19.8456378Z      )[m
2026-02-09T19:17:19.8456667Z      vx_smooth = -v_shear + 2 * v_shear * ([m
2026-02-09T19:17:19.8457043Z          0.5 * (1.0 + tanh((y - 0.25) / sigma)) -[m
2026-02-09T19:17:19.8457423Z [31m-        0.5 * (1.0 + tanh((y - 0.75) / sigma))[m
2026-02-09T19:17:19.8457826Z [32m+[m[32m            0.5 * (1.0 + tanh((y - 0.75) / sigma))[m
2026-02-09T19:17:19.8458153Z      )[m
2026-02-09T19:17:19.8458519Z      ## Sinusoidal perturbation in vy to seed the instability[m
2026-02-09T19:17:19.8459205Z      vy = A_pert * sin(4 * pi * x)[m
2026-02-09T19:17:19.8459624Z [36m@@ -62,7 +62,7 @@[m [mprob_low = HyperbolicProblem2D([m
2026-02-09T19:17:19.8460183Z      law, mesh_low, HLLCSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.8460763Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8461272Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8461921Z [31m-    kh_ic; final_time=t_final, cfl=0.4[m
2026-02-09T19:17:19.8462354Z [32m+[m[32m    kh_ic; final_time = t_final, cfl = 0.4[m
2026-02-09T19:17:19.8462803Z  )[m
2026-02-09T19:17:19.8463397Z  coords_low, U_low, _ = solve_hyperbolic(prob_low)[m
2026-02-09T19:17:19.8463911Z  [m
2026-02-09T19:17:19.8464257Z [36m@@ -72,7 +72,7 @@[m [mprob_high = HyperbolicProblem2D([m
2026-02-09T19:17:19.8464836Z      law, mesh_high, HLLCSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.8465430Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8465950Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8466414Z [31m-    kh_ic; final_time=t_final, cfl=0.4[m
2026-02-09T19:17:19.8466853Z [32m+[m[32m    kh_ic; final_time = t_final, cfl = 0.4[m
2026-02-09T19:17:19.8467196Z  )[m
2026-02-09T19:17:19.8467565Z  coords_high, U_high, t_end = solve_hyperbolic(prob_high)[m
2026-02-09T19:17:19.8468000Z  coords_high |> tc #hide[m
2026-02-09T19:17:19.8468361Z [36m@@ -80,21 +80,25 @@[m [mcoords_high |> tc #hide[m
2026-02-09T19:17:19.8468849Z  # ## Visualisation[m
2026-02-09T19:17:19.8469137Z  using CairoMakie[m
2026-02-09T19:17:19.8469376Z  [m
2026-02-09T19:17:19.8469659Z [31m-fig = Figure(fontsize=24, size=(1100, 500))[m
2026-02-09T19:17:19.8470121Z [32m+[m[32mfig = Figure(fontsize = 24, size = (1100, 500))[m
2026-02-09T19:17:19.8470470Z  [m
2026-02-09T19:17:19.8470766Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8471251Z [31m-           title="Density (N=$(N_low))", aspect=DataAspect())[m
2026-02-09T19:17:19.8471667Z [32m+[m[32max1 = Axis([m
2026-02-09T19:17:19.8472010Z [32m+[m[32m    fig[1, 1], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8472515Z [32m+[m[32m    title = "Density (N=$(N_low))", aspect = DataAspect()[m
2026-02-09T19:17:19.8472925Z [32m+[m[32m)[m
2026-02-09T19:17:19.8473215Z  xc_l = [coords_low[1][i] for i in 1:N_low][m
2026-02-09T19:17:19.8473613Z  yc_l = [coords_low[2][j] for j in 1:N_low][m
2026-02-09T19:17:19.8474164Z  rho_low = [conserved_to_primitive(law, U_low[i, j])[1] for i in 1:N_low, j in 1:N_low][m
2026-02-09T19:17:19.8474821Z [31m-hm1 = heatmap!(ax1, xc_l, yc_l, rho_low, colormap=:viridis)[m
2026-02-09T19:17:19.8475395Z [32m+[m[32mhm1 = heatmap!(ax1, xc_l, yc_l, rho_low, colormap = :viridis)[m
2026-02-09T19:17:19.8475812Z  [m
2026-02-09T19:17:19.8476098Z [31m-ax2 = Axis(fig[1, 2], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8476583Z [31m-           title="Density (N=$(N_high))", aspect=DataAspect())[m
2026-02-09T19:17:19.8477250Z [32m+[m[32max2 = Axis([m
2026-02-09T19:17:19.8477830Z [32m+[m[32m    fig[1, 2], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8478499Z [32m+[m[32m    title = "Density (N=$(N_high))", aspect = DataAspect()[m
2026-02-09T19:17:19.8479121Z [32m+[m[32m)[m
2026-02-09T19:17:19.8479438Z  xc_h = [coords_high[1][i] for i in 1:N_high][m
2026-02-09T19:17:19.8479853Z  yc_h = [coords_high[2][j] for j in 1:N_high][m
2026-02-09T19:17:19.8480441Z  rho_high = [conserved_to_primitive(law, U_high[i, j])[1] for i in 1:N_high, j in 1:N_high][m
2026-02-09T19:17:19.8481118Z [31m-hm2 = heatmap!(ax2, xc_h, yc_h, rho_high, colormap=:viridis)[m
2026-02-09T19:17:19.8481705Z [32m+[m[32mhm2 = heatmap!(ax2, xc_h, yc_h, rho_high, colormap = :viridis)[m
2026-02-09T19:17:19.8482179Z  Colorbar(fig[1, 3], hm2)[m
2026-02-09T19:17:19.8482577Z  [m
2026-02-09T19:17:19.8482820Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8483453Z [34m[ 10/151] Checking `docs/src/literate_hyperbolic/orszag_tang_vortex.jl` ...... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8484183Z [1mdiff --git a/orszag_tang_vortex.jl b/orszag_tang_vortex.jl[m
2026-02-09T19:17:19.8484643Z [1mindex f26ff44..b806dae 100644[m
2026-02-09T19:17:19.8484977Z [1m--- a/orszag_tang_vortex.jl[m
2026-02-09T19:17:19.8485318Z [1m+++ b/orszag_tang_vortex.jl[m
2026-02-09T19:17:19.8485626Z [36m@@ -47,7 +47,7 @@[m [mend[m
2026-02-09T19:17:19.8486329Z  # $B_x = \partial A_z/\partial y$ and $B_y = -\partial A_z/\partial x$ is:[m
2026-02-09T19:17:19.8486796Z  function Az_ot(x, y)[m
2026-02-09T19:17:19.8487266Z      return cos(2 * pi * y) / (2 * pi * sqrt(4 * pi)) +[m
2026-02-09T19:17:19.8487713Z [31m-           cos(4 * pi * x) / (4 * pi * sqrt(4 * pi))[m
2026-02-09T19:17:19.8488139Z [32m+[m[32m        cos(4 * pi * x) / (4 * pi * sqrt(4 * pi))[m
2026-02-09T19:17:19.8488482Z  end[m
2026-02-09T19:17:19.8488672Z  [m
2026-02-09T19:17:19.8489008Z  # ## Solving[m
2026-02-09T19:17:19.8489348Z [36m@@ -56,12 +56,12 @@[m [mprob = HyperbolicProblem2D([m
2026-02-09T19:17:19.8489888Z      law, mesh, HLLDSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.8490448Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8490973Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8491428Z [31m-    ot_ic; final_time=0.5, cfl=0.4[m
2026-02-09T19:17:19.8491823Z [32m+[m[32m    ot_ic; final_time = 0.5, cfl = 0.4[m
2026-02-09T19:17:19.8492145Z  )[m
2026-02-09T19:17:19.8492331Z  [m
2026-02-09T19:17:19.8492753Z  # The `vector_potential` keyword tells `solve_hyperbolic` to initialise[m
2026-02-09T19:17:19.8493439Z  # the face-centred magnetic field from $A_z$ via Stokes' theorem:[m
2026-02-09T19:17:19.8494095Z [31m-coords, U, t_final, ct = solve_hyperbolic(prob; vector_potential=Az_ot)[m
2026-02-09T19:17:19.8494808Z [32m+[m[32mcoords, U, t_final, ct = solve_hyperbolic(prob; vector_potential = Az_ot)[m
2026-02-09T19:17:19.8495311Z  coords |> tc #hide[m
2026-02-09T19:17:19.8495549Z  [m
2026-02-09T19:17:19.8495794Z  # ## Checking $\nabla\cdot\vb B$[m
2026-02-09T19:17:19.8496158Z [36m@@ -69,7 +69,7 @@[m [mcoords |> tc #hide[m
2026-02-09T19:17:19.8496732Z  # at machine precision:[m
2026-02-09T19:17:19.8497284Z  divB_max = max_divB(ct, mesh)[m
2026-02-09T19:17:19.8497595Z  [m
2026-02-09T19:17:19.8497850Z [31m-@assert divB_max < 1e-12 #hide[m
2026-02-09T19:17:19.8498231Z [32m+[m[32m@assert divB_max < 1.0e-12 #hide[m
2026-02-09T19:17:19.8498541Z  [m
2026-02-09T19:17:19.8498874Z  # ## Visualisation[m
2026-02-09T19:17:19.8499204Z  using CairoMakie[m
2026-02-09T19:17:19.8499580Z [36m@@ -80,15 +80,19 @@[m [myc = [coords[2][j] for j in 1:ny][m
2026-02-09T19:17:19.8500131Z  rho = [conserved_to_primitive(law, U[i, j])[1] for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.8500768Z  P_vals = [conserved_to_primitive(law, U[i, j])[5] for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.8501200Z  [m
2026-02-09T19:17:19.8501494Z [31m-fig = Figure(fontsize=24, size=(1100, 500))[m
2026-02-09T19:17:19.8501921Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8502498Z [31m-           title="Density at t = $(round(t_final, digits=2))", aspect=DataAspect())[m
2026-02-09T19:17:19.8503102Z [31m-hm1 = heatmap!(ax1, xc, yc, rho, colormap=:viridis)[m
2026-02-09T19:17:19.8503601Z [32m+[m[32mfig = Figure(fontsize = 24, size = (1100, 500))[m
2026-02-09T19:17:19.8503995Z [32m+[m[32max1 = Axis([m
2026-02-09T19:17:19.8504341Z [32m+[m[32m    fig[1, 1], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8504951Z [32m+[m[32m    title = "Density at t = $(round(t_final, digits = 2))", aspect = DataAspect()[m
2026-02-09T19:17:19.8505452Z [32m+[m[32m)[m
2026-02-09T19:17:19.8505823Z [32m+[m[32mhm1 = heatmap!(ax1, xc, yc, rho, colormap = :viridis)[m
2026-02-09T19:17:19.8506252Z  Colorbar(fig[1, 2], hm1)[m
2026-02-09T19:17:19.8506499Z  [m
2026-02-09T19:17:19.8506793Z [31m-ax2 = Axis(fig[1, 3], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8507238Z [31m-           title="Pressure", aspect=DataAspect())[m
2026-02-09T19:17:19.8507729Z [31m-hm2 = heatmap!(ax2, xc, yc, P_vals, colormap=:magma)[m
2026-02-09T19:17:19.8508129Z [32m+[m[32max2 = Axis([m
2026-02-09T19:17:19.8508474Z [32m+[m[32m    fig[1, 3], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8509042Z [32m+[m[32m    title = "Pressure", aspect = DataAspect()[m
2026-02-09T19:17:19.8509577Z [32m+[m[32m)[m
2026-02-09T19:17:19.8509951Z [32m+[m[32mhm2 = heatmap!(ax2, xc, yc, P_vals, colormap = :magma)[m
2026-02-09T19:17:19.8510462Z  Colorbar(fig[1, 4], hm2)[m
2026-02-09T19:17:19.8511190Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8511489Z  fig[m
2026-02-09T19:17:19.8512074Z [34m[ 11/151] Checking `docs/src/literate_hyperbolic/sedov_blast_wave.jl` ........ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8512784Z [1mdiff --git a/sedov_blast_wave.jl b/sedov_blast_wave.jl[m
2026-02-09T19:17:19.8513225Z [1mindex 2e3aa55..c1f6ad0 100644[m
2026-02-09T19:17:19.8513556Z [1m--- a/sedov_blast_wave.jl[m
2026-02-09T19:17:19.8513872Z [1m+++ b/sedov_blast_wave.jl[m
2026-02-09T19:17:19.8514178Z [36m@@ -24,7 +24,7 @@[m [mN = 50[m
2026-02-09T19:17:19.8514563Z  mesh = StructuredMesh2D(-1.0, 1.0, -1.0, 1.0, N, N)[m
2026-02-09T19:17:19.8514893Z  [m
2026-02-09T19:17:19.8515347Z  # The background pressure is very low, with a strong blast in the central cells:[m
2026-02-09T19:17:19.8516005Z [31m-P_bg = 1e-5[m
2026-02-09T19:17:19.8516270Z [32m+[m[32mP_bg = 1.0e-5[m
2026-02-09T19:17:19.8516537Z  P_blast = 1.0[m
2026-02-09T19:17:19.8516795Z  r_blast = 3.0 * mesh.dx[m
2026-02-09T19:17:19.8517045Z  [m
2026-02-09T19:17:19.8517356Z [36m@@ -39,7 +39,7 @@[m [mprob = HyperbolicProblem2D([m
2026-02-09T19:17:19.8517895Z      law, mesh, HLLCSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.8518407Z      TransmissiveBC(), TransmissiveBC(),[m
2026-02-09T19:17:19.8519003Z      TransmissiveBC(), TransmissiveBC(),[m
2026-02-09T19:17:19.8519412Z [31m-    sedov_ic; final_time=0.1, cfl=0.3[m
2026-02-09T19:17:19.8519835Z [32m+[m[32m    sedov_ic; final_time = 0.1, cfl = 0.3[m
2026-02-09T19:17:19.8520167Z  )[m
2026-02-09T19:17:19.8520468Z  coords, U, t_final = solve_hyperbolic(prob)[m
2026-02-09T19:17:19.8520828Z  coords |> tc #hide[m
2026-02-09T19:17:19.8521189Z [36m@@ -53,14 +53,16 @@[m [mxc = [coords[1][i] for i in 1:nx][m
2026-02-09T19:17:19.8521594Z  yc = [coords[2][j] for j in 1:ny][m
2026-02-09T19:17:19.8522086Z  rho = [conserved_to_primitive(law, U[i, j])[1] for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.8522514Z  [m
2026-02-09T19:17:19.8522808Z [31m-fig = Figure(fontsize=24, size=(1000, 500))[m
2026-02-09T19:17:19.8523443Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel="y", title="Density at t = $(round(t_final, digits=3))",[m
2026-02-09T19:17:19.8524024Z [31m-           aspect=DataAspect())[m
2026-02-09T19:17:19.8524454Z [31m-hm = heatmap!(ax1, xc, yc, rho, colormap=:inferno)[m
2026-02-09T19:17:19.8524940Z [32m+[m[32mfig = Figure(fontsize = 24, size = (1000, 500))[m
2026-02-09T19:17:19.8525326Z [32m+[m[32max1 = Axis([m
2026-02-09T19:17:19.8525880Z [32m+[m[32m    fig[1, 1], xlabel = "x", ylabel = "y", title = "Density at t = $(round(t_final, digits = 3))",[m
2026-02-09T19:17:19.8526466Z [32m+[m[32m    aspect = DataAspect()[m
2026-02-09T19:17:19.8526782Z [32m+[m[32m)[m
2026-02-09T19:17:19.8527151Z [32m+[m[32mhm = heatmap!(ax1, xc, yc, rho, colormap = :inferno)[m
2026-02-09T19:17:19.8527585Z  Colorbar(fig[1, 2], hm)[m
2026-02-09T19:17:19.8527831Z  [m
2026-02-09T19:17:19.8528251Z  # We also plot the radial density profile to check cylindrical symmetry:[m
2026-02-09T19:17:19.8529023Z [31m-ax2 = Axis(fig[1, 3], xlabel="r", ylabel=L"\rho", title="Radial profile")[m
2026-02-09T19:17:19.8529711Z [32m+[m[32max2 = Axis(fig[1, 3], xlabel = "r", ylabel = L"\rho", title = "Radial profile")[m
2026-02-09T19:17:19.8530212Z  r_vals = Float64[][m
2026-02-09T19:17:19.8530486Z  rho_vals = Float64[][m
2026-02-09T19:17:19.8530783Z  for i in 1:nx, j in 1:ny[m
2026-02-09T19:17:19.8531128Z [36m@@ -68,7 +70,7 @@[m [mfor i in 1:nx, j in 1:ny[m
2026-02-09T19:17:19.8531488Z      push!(r_vals, r)[m
2026-02-09T19:17:19.8531783Z      push!(rho_vals, rho[i, j])[m
2026-02-09T19:17:19.8532061Z  end[m
2026-02-09T19:17:19.8532428Z [31m-scatter!(ax2, r_vals, rho_vals, color=:blue, markersize=3)[m
2026-02-09T19:17:19.8533037Z [32m+[m[32mscatter!(ax2, r_vals, rho_vals, color = :blue, markersize = 3)[m
2026-02-09T19:17:19.8533676Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8533931Z  fig[m
2026-02-09T19:17:19.8534481Z  @test_reference joinpath(@__DIR__, "../figures", "sedov_blast_wave.png") fig #src[m
2026-02-09T19:17:19.9315630Z [34m[ 12/151] Checking `docs/src/literate_hyperbolic/sod_shock_tube.jl` .......... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.9334517Z [1mdiff --git a/sod_shock_tube.jl b/sod_shock_tube.jl[m
2026-02-09T19:17:19.9335199Z [1mindex 24d402b..275df09 100644[m
2026-02-09T19:17:19.9335578Z [1m--- a/sod_shock_tube.jl[m
2026-02-09T19:17:19.9335974Z [1m+++ b/sod_shock_tube.jl[m
2026-02-09T19:17:19.9336527Z [36m@@ -46,7 +46,7 @@[m [mic(x) = x < 0.5 ? wL : wR[m
2026-02-09T19:17:19.9337147Z  prob_hllc = HyperbolicProblem([m
2026-02-09T19:17:19.9337871Z      law, mesh, HLLCSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.9338566Z      bc_left, bc_right, ic;[m
2026-02-09T19:17:19.9339345Z [31m-    final_time=0.2, cfl=0.5[m
2026-02-09T19:17:19.9339935Z [32m+[m[32m    final_time = 0.2, cfl = 0.5[m
2026-02-09T19:17:19.9340462Z  )[m
2026-02-09T19:17:19.9340982Z  x_hllc, U_hllc, t_hllc = solve_hyperbolic(prob_hllc)[m
2026-02-09T19:17:19.9341567Z  x_hllc |> tc #hide[m
2026-02-09T19:17:19.9342051Z [36m@@ -57,7 +57,7 @@[m [mx_hllc |> tc #hide[m
2026-02-09T19:17:19.9342636Z  prob_hll = HyperbolicProblem([m
2026-02-09T19:17:19.9343341Z      law, mesh, HLLSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.9344034Z      bc_left, bc_right, ic;[m
2026-02-09T19:17:19.9344519Z [31m-    final_time=0.2, cfl=0.5[m
2026-02-09T19:17:19.9345097Z [32m+[m[32m    final_time = 0.2, cfl = 0.5[m
2026-02-09T19:17:19.9345568Z  )[m
2026-02-09T19:17:19.9346022Z  x_hll, U_hll, t_hll = solve_hyperbolic(prob_hll)[m
2026-02-09T19:17:19.9346538Z  [m
2026-02-09T19:17:19.9347125Z [36m@@ -65,7 +65,7 @@[m [mx_hll, U_hll, t_hll = solve_hyperbolic(prob_hll)[m
2026-02-09T19:17:19.9348125Z  # The exact Riemann solution for the Sod problem consists of five constant[m
2026-02-09T19:17:19.9349391Z  # states separated by a rarefaction, contact, and shock. The pre-computed[m
2026-02-09T19:17:19.9350180Z  # star-region values are:[m
2026-02-09T19:17:19.9350768Z [31m-function sod_exact(x, t; x0=0.5, gamma=1.4)[m
2026-02-09T19:17:19.9351502Z [32m+[m[32mfunction sod_exact(x, t; x0 = 0.5, gamma = 1.4)[m
2026-02-09T19:17:19.9352160Z      rhoL, vL, PL = 1.0, 0.0, 1.0[m
2026-02-09T19:17:19.9352679Z      rhoR, vR, PR = 0.125, 0.0, 0.1[m
2026-02-09T19:17:19.9353201Z      cL = sqrt(gamma * PL / rhoL)[m
2026-02-09T19:17:19.9353911Z [36m@@ -77,7 +77,7 @@[m [mfunction sod_exact(x, t; x0=0.5, gamma=1.4)[m
2026-02-09T19:17:19.9354678Z      c_star_L = sqrt(gamma * P_star / rho_star_L)[m
2026-02-09T19:17:19.9355247Z      ## Shock speed[m
2026-02-09T19:17:19.9355774Z      S_shock = v_star + 1.0 / (gamma * rho_star_R) *[m
2026-02-09T19:17:19.9356463Z [31m-              (P_star - PR) / (v_star - vR + 1e-30)[m
2026-02-09T19:17:19.9357184Z [32m+[m[32m        (P_star - PR) / (v_star - vR + 1.0e-30)[m
2026-02-09T19:17:19.9357786Z      xi = (x - x0) / t[m
2026-02-09T19:17:19.9358208Z      if xi < -cL[m
2026-02-09T19:17:19.9358641Z          return rhoL, vL, PL[m
2026-02-09T19:17:19.9359359Z [36m@@ -101,7 +101,7 @@[m [mend[m
2026-02-09T19:17:19.9360093Z  # We now compare the numerical solutions against the exact solution.[m
2026-02-09T19:17:19.9360815Z  using CairoMakie[m
2026-02-09T19:17:19.9361184Z  [m
2026-02-09T19:17:19.9361614Z [31m-x_exact = range(0.0, 1.0, length=1000)[m
2026-02-09T19:17:19.9362268Z [32m+[m[32mx_exact = range(0.0, 1.0, length = 1000)[m
2026-02-09T19:17:19.9362997Z  rho_exact = [sod_exact(xi, 0.2)[1] for xi in x_exact][m
2026-02-09T19:17:19.9363702Z  v_exact = [sod_exact(xi, 0.2)[2] for xi in x_exact][m
2026-02-09T19:17:19.9364398Z  P_exact = [sod_exact(xi, 0.2)[3] for xi in x_exact][m
2026-02-09T19:17:19.9365467Z [36m@@ -115,20 +115,20 @@[m [mrho_hll = [conserved_to_primitive(law, U_hll[i])[1] for i in eachindex(U_hll)][m
2026-02-09T19:17:19.9366971Z  v_hll = [conserved_to_primitive(law, U_hll[i])[2] for i in eachindex(U_hll)][m
2026-02-09T19:17:19.9368233Z  P_hll = [conserved_to_primitive(law, U_hll[i])[3] for i in eachindex(U_hll)][m
2026-02-09T19:17:19.9369179Z  [m
2026-02-09T19:17:19.9369649Z [31m-fig = Figure(fontsize=24, size=(1200, 400))[m
2026-02-09T19:17:19.9370454Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel=L"\rho", title="Density")[m
2026-02-09T19:17:19.9371410Z [31m-ax2 = Axis(fig[1, 2], xlabel="x", ylabel="v", title="Velocity")[m
2026-02-09T19:17:19.9372337Z [31m-ax3 = Axis(fig[1, 3], xlabel="x", ylabel="P", title="Pressure")[m
2026-02-09T19:17:19.9373341Z [31m-lines!(ax1, x_exact, rho_exact, color=:black, linewidth=2, label="Exact")[m
2026-02-09T19:17:19.9374435Z [31m-scatter!(ax1, x_hllc, rho_hllc, color=:blue, markersize=4, label="HLLC")[m
2026-02-09T19:17:19.9375131Z [31m-scatter!(ax1, x_hll, rho_hll, color=:red, markersize=4, label="HLL")[m
2026-02-09T19:17:19.9375750Z [31m-lines!(ax2, x_exact, v_exact, color=:black, linewidth=2)[m
2026-02-09T19:17:19.9376413Z [31m-scatter!(ax2, x_hllc, v_hllc, color=:blue, markersize=4)[m
2026-02-09T19:17:19.9376971Z [31m-scatter!(ax2, x_hll, v_hll, color=:red, markersize=4)[m
2026-02-09T19:17:19.9377508Z [31m-lines!(ax3, x_exact, P_exact, color=:black, linewidth=2)[m
2026-02-09T19:17:19.9378044Z [31m-scatter!(ax3, x_hllc, P_hllc, color=:blue, markersize=4)[m
2026-02-09T19:17:19.9378575Z [31m-scatter!(ax3, x_hll, P_hll, color=:red, markersize=4)[m
2026-02-09T19:17:19.9379239Z [31m-axislegend(ax1, position=:cb)[m
2026-02-09T19:17:19.9379682Z [32m+[m[32mfig = Figure(fontsize = 24, size = (1200, 400))[m
2026-02-09T19:17:19.9380245Z [32m+[m[32max1 = Axis(fig[1, 1], xlabel = "x", ylabel = L"\rho", title = "Density")[m
2026-02-09T19:17:19.9380877Z [32m+[m[32max2 = Axis(fig[1, 2], xlabel = "x", ylabel = "v", title = "Velocity")[m
2026-02-09T19:17:19.9381487Z [32m+[m[32max3 = Axis(fig[1, 3], xlabel = "x", ylabel = "P", title = "Pressure")[m
2026-02-09T19:17:19.9382175Z [32m+[m[32mlines!(ax1, x_exact, rho_exact, color = :black, linewidth = 2, label = "Exact")[m
2026-02-09T19:17:19.9382923Z [32m+[m[32mscatter!(ax1, x_hllc, rho_hllc, color = :blue, markersize = 4, label = "HLLC")[m
2026-02-09T19:17:19.9383643Z [32m+[m[32mscatter!(ax1, x_hll, rho_hll, color = :red, markersize = 4, label = "HLL")[m
2026-02-09T19:17:19.9384305Z [32m+[m[32mlines!(ax2, x_exact, v_exact, color = :black, linewidth = 2)[m
2026-02-09T19:17:19.9384937Z [32m+[m[32mscatter!(ax2, x_hllc, v_hllc, color = :blue, markersize = 4)[m
2026-02-09T19:17:19.9385528Z [32m+[m[32mscatter!(ax2, x_hll, v_hll, color = :red, markersize = 4)[m
2026-02-09T19:17:19.9386122Z [32m+[m[32mlines!(ax3, x_exact, P_exact, color = :black, linewidth = 2)[m
2026-02-09T19:17:19.9386964Z [32m+[m[32mscatter!(ax3, x_hllc, P_hllc, color = :blue, markersize = 4)[m
2026-02-09T19:17:19.9387777Z [32m+[m[32mscatter!(ax3, x_hll, P_hll, color = :red, markersize = 4)[m
2026-02-09T19:17:19.9388279Z [32m+[m[32maxislegend(ax1, position = :cb)[m
2026-02-09T19:17:19.9388879Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.9389338Z  fig[m
2026-02-09T19:17:19.9390027Z  @test_reference joinpath(@__DIR__, "../figures", "sod_shock_tube.png") fig #src[m
2026-02-09T19:17:19.9390979Z [36m@@ -143,7 +143,7 @@[m [mfunction compute_l1_error(N)[m
2026-02-09T19:17:19.9391725Z      m = StructuredMesh1D(0.0, 1.0, N)[m
2026-02-09T19:17:19.9392287Z      p = HyperbolicProblem([m
2026-02-09T19:17:19.9392989Z          law, m, HLLCSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.9393830Z [31m-        bc_left, bc_right, ic; final_time=0.2, cfl=0.5[m
2026-02-09T19:17:19.9394642Z [32m+[m[32m        bc_left, bc_right, ic; final_time = 0.2, cfl = 0.5[m
2026-02-09T19:17:19.9395261Z      )[m
2026-02-09T19:17:19.9395681Z      xx, UU, _ = solve_hyperbolic(p)[m
2026-02-09T19:17:19.9396169Z      err = 0.0[m
2026-02-09T19:17:19.9397368Z [34m[ 13/151] Checking `docs/src/literate_hyperbolic/taylor_green_vortex.jl` ..... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.9398684Z [1mdiff --git a/taylor_green_vortex.jl b/taylor_green_vortex.jl[m
2026-02-09T19:17:19.9399649Z [1mindex 3f33964..5b7191b 100644[m
2026-02-09T19:17:19.9400181Z [1m--- a/taylor_green_vortex.jl[m
2026-02-09T19:17:19.9400702Z [1m+++ b/taylor_green_vortex.jl[m
2026-02-09T19:17:19.9401238Z [36m@@ -23,7 +23,7 @@[m [mgamma = 1.4[m
2026-02-09T19:17:19.9401769Z  eos = IdealGasEOS(gamma)[m
2026-02-09T19:17:19.9402223Z  mu = 0.01[m
2026-02-09T19:17:19.9402570Z  Pr = 0.72[m
2026-02-09T19:17:19.9403107Z [31m-ns = NavierStokesEquations{2}(eos, mu=mu, Pr=Pr)[m
2026-02-09T19:17:19.9403936Z [32m+[m[32mns = NavierStokesEquations{2}(eos, mu = mu, Pr = Pr)[m
2026-02-09T19:17:19.9404562Z  [m
2026-02-09T19:17:19.9405085Z  # Physical parameters (low Mach number: $U_0 \ll c_s$):[m
2026-02-09T19:17:19.9405697Z  rho0 = 1.0[m
2026-02-09T19:17:19.9406243Z [36m@@ -49,7 +49,7 @@[m [mprob = HyperbolicProblem2D([m
2026-02-09T19:17:19.9407059Z      ns, mesh, HLLCSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.9407905Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.9408672Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.9409565Z [31m-    ic_tgv; final_time=t_final, cfl=0.3[m
2026-02-09T19:17:19.9410257Z [32m+[m[32m    ic_tgv; final_time = t_final, cfl = 0.3[m
2026-02-09T19:17:19.9410816Z  )[m
2026-02-09T19:17:19.9411292Z  coords, U, t_end = solve_hyperbolic(prob)[m
2026-02-09T19:17:19.9411847Z  coords |> tc #hide[m
2026-02-09T19:17:19.9412692Z [36m@@ -81,15 +81,19 @@[m [mvx_num = [conserved_to_primitive(ns, U[i, j])[2] for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.9413802Z  vy_num = [conserved_to_primitive(ns, U[i, j])[3] for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.9414783Z  vx_ex = [-U0 * cos(k * xc[i]) * sin(k * yc[j]) * decay for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.9415430Z  [m
2026-02-09T19:17:19.9415891Z [31m-fig = Figure(fontsize=24, size=(1200, 500))[m
2026-02-09T19:17:19.9416576Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.9417371Z [31m-           title=L"v_x \text{ (numerical)}", aspect=DataAspect())[m
2026-02-09T19:17:19.9418200Z [31m-hm1 = heatmap!(ax1, xc, yc, vx_num, colormap=:RdBu)[m
2026-02-09T19:17:19.9419150Z [32m+[m[32mfig = Figure(fontsize = 24, size = (1200, 500))[m
2026-02-09T19:17:19.9419778Z [32m+[m[32max1 = Axis([m
2026-02-09T19:17:19.9420334Z [32m+[m[32m    fig[1, 1], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.9421151Z [32m+[m[32m    title = L"v_x \text{ (numerical)}", aspect = DataAspect()[m
2026-02-09T19:17:19.9421819Z [32m+[m[32m)[m
2026-02-09T19:17:19.9422408Z [32m+[m[32mhm1 = heatmap!(ax1, xc, yc, vx_num, colormap = :RdBu)[m
2026-02-09T19:17:19.9423082Z  Colorbar(fig[1, 2], hm1)[m
2026-02-09T19:17:19.9423479Z  [m
2026-02-09T19:17:19.9423943Z [31m-ax2 = Axis(fig[1, 3], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.9424704Z [31m-           title=L"v_x \text{ (exact)}", aspect=DataAspect())[m
2026-02-09T19:17:19.9425504Z [31m-hm2 = heatmap!(ax2, xc, yc, vx_ex, colormap=:RdBu)[m
2026-02-09T19:17:19.9426113Z [32m+[m[32max2 = Axis([m
2026-02-09T19:17:19.9426676Z [32m+[m[32m    fig[1, 3], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.9427452Z [32m+[m[32m    title = L"v_x \text{ (exact)}", aspect = DataAspect()[m
2026-02-09T19:17:19.9428095Z [32m+[m[32m)[m
2026-02-09T19:17:19.9428691Z [32m+[m[32mhm2 = heatmap!(ax2, xc, yc, vx_ex, colormap = :RdBu)[m
2026-02-09T19:17:19.9429516Z  Colorbar(fig[1, 4], hm2)[m
2026-02-09T19:17:19.9429983Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.9430381Z  fig[m
2026-02-09T19:17:19.9432998Z [34m[ 14/151] Checking `docs/src/literate_hyperbolic/weno_convergence.jl` ........ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.9448026Z [1mdiff --git a/weno_convergence.jl b/weno_convergence.jl[m
2026-02-09T19:17:19.9449184Z [1mindex c2eafea..f73ee56 100644[m
2026-02-09T19:17:19.9449703Z [1m--- a/weno_convergence.jl[m
2026-02-09T19:17:19.9450174Z [1m+++ b/weno_convergence.jl[m
2026-02-09T19:17:19.9450862Z [36m@@ -41,7 +41,7 @@[m [mfunction compute_error(N, recon)[m
2026-02-09T19:17:19.9451316Z      prob = HyperbolicProblem([m
2026-02-09T19:17:19.9451688Z          law, mesh, HLLCSolver(), recon,[m
2026-02-09T19:17:19.9452219Z          PeriodicHyperbolicBC(), PeriodicHyperbolicBC(), advection_ic;[m
2026-02-09T19:17:19.9452743Z [31m-        final_time=t_final, cfl=0.4[m
2026-02-09T19:17:19.9453159Z [32m+[m[32m        final_time = t_final, cfl = 0.4[m
2026-02-09T19:17:19.9453493Z      )[m
2026-02-09T19:17:19.9453772Z      x, U, t_end = solve_hyperbolic(prob)[m
2026-02-09T19:17:19.9454094Z      err = 0.0[m
2026-02-09T19:17:19.9454659Z [36m@@ -70,26 +70,36 @@[m [merr_char_weno3 = [compute_error(N, CharacteristicWENO(WENO3())) for N in resolut[m
2026-02-09T19:17:19.9455247Z  using CairoMakie[m
2026-02-09T19:17:19.9455489Z  [m
2026-02-09T19:17:19.9455756Z  function convergence_rate(errs)[m
2026-02-09T19:17:19.9456227Z [31m-    return [log2(errs[i] / errs[i+1]) for i in 1:length(errs)-1][m
2026-02-09T19:17:19.9456841Z [32m+[m[32m    return [log2(errs[i] / errs[i + 1]) for i in 1:(length(errs) - 1)][m
2026-02-09T19:17:19.9457279Z  end[m
2026-02-09T19:17:19.9457477Z  [m
2026-02-09T19:17:19.9457769Z  rates_muscl = convergence_rate(err_muscl)[m
2026-02-09T19:17:19.9458197Z  rates_weno3 = convergence_rate(err_weno3)[m
2026-02-09T19:17:19.9458635Z  rates_char = convergence_rate(err_char_weno3)[m
2026-02-09T19:17:19.9459261Z  [m
2026-02-09T19:17:19.9459562Z [31m-fig = Figure(fontsize=24, size=(600, 500))[m
2026-02-09T19:17:19.9460068Z [31m-ax = Axis(fig[1, 1], xlabel="N", ylabel=L"L^1 \text{ error}",[m
2026-02-09T19:17:19.9460706Z [31m-          xscale=log2, yscale=log10, title="Convergence: smooth density wave")[m
2026-02-09T19:17:19.9461443Z [31m-scatterlines!(ax, resolutions, err_muscl, label="MUSCL (minmod)", marker=:circle,[m
2026-02-09T19:17:19.9462091Z [31m-              color=:blue, linewidth=2, markersize=12)[m
2026-02-09T19:17:19.9462704Z [31m-scatterlines!(ax, resolutions, err_weno3, label="WENO-3", marker=:utriangle,[m
2026-02-09T19:17:19.9463315Z [31m-              color=:red, linewidth=2, markersize=12)[m
2026-02-09T19:17:19.9463960Z [31m-scatterlines!(ax, resolutions, err_char_weno3, label="Char. WENO-3", marker=:diamond,[m
2026-02-09T19:17:19.9464598Z [31m-              color=:green, linewidth=2, markersize=12)[m
2026-02-09T19:17:19.9465095Z [32m+[m[32mfig = Figure(fontsize = 24, size = (600, 500))[m
2026-02-09T19:17:19.9465473Z [32m+[m[32max = Axis([m
2026-02-09T19:17:19.9465879Z [32m+[m[32m    fig[1, 1], xlabel = "N", ylabel = L"L^1 \text{ error}",[m
2026-02-09T19:17:19.9466521Z [32m+[m[32m    xscale = log2, yscale = log10, title = "Convergence: smooth density wave"[m
2026-02-09T19:17:19.9467011Z [32m+[m[32m)[m
2026-02-09T19:17:19.9467277Z [32m+[m[32mscatterlines!([m
2026-02-09T19:17:19.9467785Z [32m+[m[32m    ax, resolutions, err_muscl, label = "MUSCL (minmod)", marker = :circle,[m
2026-02-09T19:17:19.9468407Z [32m+[m[32m    color = :blue, linewidth = 2, markersize = 12[m
2026-02-09T19:17:19.9469012Z [32m+[m[32m)[m
2026-02-09T19:17:19.9469282Z [32m+[m[32mscatterlines!([m
2026-02-09T19:17:19.9469772Z [32m+[m[32m    ax, resolutions, err_weno3, label = "WENO-3", marker = :utriangle,[m
2026-02-09T19:17:19.9470369Z [32m+[m[32m    color = :red, linewidth = 2, markersize = 12[m
2026-02-09T19:17:19.9470752Z [32m+[m[32m)[m
2026-02-09T19:17:19.9471006Z [32m+[m[32mscatterlines!([m
2026-02-09T19:17:19.9471534Z [32m+[m[32m    ax, resolutions, err_char_weno3, label = "Char. WENO-3", marker = :diamond,[m
2026-02-09T19:17:19.9472167Z [32m+[m[32m    color = :green, linewidth = 2, markersize = 12[m
2026-02-09T19:17:19.9472563Z [32m+[m[32m)[m
2026-02-09T19:17:19.9472805Z  ## Reference slope[m
2026-02-09T19:17:19.9473300Z [31m-lines!(ax, resolutions, err_muscl[1] .* (resolutions[1] ./ resolutions) .^ 2,[m
2026-02-09T19:17:19.9474122Z [31m-       color=:gray, linestyle=:dash, linewidth=1, label=L"O(N^{-2})")[m
2026-02-09T19:17:19.9474731Z [31m-axislegend(ax, position=:lb)[m
2026-02-09T19:17:19.9475065Z [32m+[m[32mlines!([m
2026-02-09T19:17:19.9475551Z [32m+[m[32m    ax, resolutions, err_muscl[1] .* (resolutions[1] ./ resolutions) .^ 2,[m
2026-02-09T19:17:19.9476254Z [32m+[m[32m    color = :gray, linestyle = :dash, linewidth = 1, label = L"O(N^{-2})"[m
2026-02-09T19:17:19.9476712Z [32m+[m[32m)[m
2026-02-09T19:17:19.9477018Z [32m+[m[32maxislegend(ax, position = :lb)[m
2026-02-09T19:17:19.9477382Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.9477645Z  fig[m
2026-02-09T19:17:19.9478119Z  @test_reference joinpath(@__DIR__, "../figures", "weno_convergence_smooth.png") fig #src[m
2026-02-09T19:17:19.9478997Z [36m@@ -107,14 +117,14 @@[m [mmesh_sod = StructuredMesh1D(0.0, 1.0, N_sod)[m
2026-02-09T19:17:19.9479495Z  prob_muscl = HyperbolicProblem([m
2026-02-09T19:17:19.9479994Z      law, mesh_sod, HLLCSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.9480643Z      DirichletHyperbolicBC(wL), DirichletHyperbolicBC(wR), sod_ic;[m
2026-02-09T19:17:19.9481127Z [31m-    final_time=0.2, cfl=0.4[m
2026-02-09T19:17:19.9481481Z [32m+[m[32m    final_time = 0.2, cfl = 0.4[m
2026-02-09T19:17:19.9481779Z  )[m
2026-02-09T19:17:19.9482070Z  x_m, U_m, _ = solve_hyperbolic(prob_muscl)[m
2026-02-09T19:17:19.9482399Z  [m
2026-02-09T19:17:19.9482657Z  prob_weno = HyperbolicProblem([m
2026-02-09T19:17:19.9483042Z      law, mesh_sod, HLLCSolver(), WENO3(),[m
2026-02-09T19:17:19.9483557Z      DirichletHyperbolicBC(wL), DirichletHyperbolicBC(wR), sod_ic;[m
2026-02-09T19:17:19.9484038Z [31m-    final_time=0.2, cfl=0.4[m
2026-02-09T19:17:19.9484382Z [32m+[m[32m    final_time = 0.2, cfl = 0.4[m
2026-02-09T19:17:19.9484685Z  )[m
2026-02-09T19:17:19.9484966Z  x_w, U_w, _ = solve_hyperbolic(prob_weno)[m
2026-02-09T19:17:19.9485308Z  x_w |> tc #hide[m
2026-02-09T19:17:19.9485592Z [36m@@ -122,12 +132,14 @@[m [mx_w |> tc #hide[m
2026-02-09T19:17:19.9486123Z  rho_muscl = [conserved_to_primitive(law, U_m[i])[1] for i in eachindex(U_m)][m
2026-02-09T19:17:19.9486793Z  rho_weno = [conserved_to_primitive(law, U_w[i])[1] for i in eachindex(U_w)][m
2026-02-09T19:17:19.9487231Z  [m
2026-02-09T19:17:19.9487524Z [31m-fig2 = Figure(fontsize=24, size=(600, 400))[m
2026-02-09T19:17:19.9487970Z [31m-ax2 = Axis(fig2[1, 1], xlabel="x", ylabel=L"\rho",[m
2026-02-09T19:17:19.9488445Z [31m-           title="Sod shock tube: MUSCL vs WENO-3")[m
2026-02-09T19:17:19.9489233Z [31m-scatter!(ax2, x_m, rho_muscl, color=:blue, markersize=4, label="MUSCL")[m
2026-02-09T19:17:19.9489896Z [31m-scatter!(ax2, x_w, rho_weno, color=:red, markersize=4, label="WENO-3")[m
2026-02-09T19:17:19.9490404Z [31m-axislegend(ax2, position=:cb)[m
2026-02-09T19:17:19.9490838Z [32m+[m[32mfig2 = Figure(fontsize = 24, size = (600, 400))[m
2026-02-09T19:17:19.9491235Z [32m+[m[32max2 = Axis([m
2026-02-09T19:17:19.9491594Z [32m+[m[32m    fig2[1, 1], xlabel = "x", ylabel = L"\rho",[m
2026-02-09T19:17:19.9492071Z [32m+[m[32m    title = "Sod shock tube: MUSCL vs WENO-3"[m
2026-02-09T19:17:19.9492434Z [32m+[m[32m)[m
2026-02-09T19:17:19.9492905Z [32m+[m[32mscatter!(ax2, x_m, rho_muscl, color = :blue, markersize = 4, label = "MUSCL")[m
2026-02-09T19:17:19.9493624Z [32m+[m[32mscatter!(ax2, x_w, rho_weno, color = :red, markersize = 4, label = "WENO-3")[m
2026-02-09T19:17:19.9494275Z [32m+[m[32maxislegend(ax2, position = :cb)[m
2026-02-09T19:17:19.9494838Z  resize_to_layout!(fig2)[m
2026-02-09T19:17:19.9495225Z  fig2[m
2026-02-09T19:17:19.9495922Z  @test_reference joinpath(@__DIR__, "../figures", "weno_convergence_sod.png") fig2 #src[m
2026-02-09T19:17:19.9497462Z [34m[ 15/151] Checking `docs/src/literate_tutorials/diffusion_equation_in_a_wedge_with_mixed_boundary_conditions.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9520892Z [34m[ 16/151] Checking `docs/src/literate_tutorials/diffusion_equation_on_a_square_plate.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9550544Z [34m[ 17/151] Checking `docs/src/literate_tutorials/diffusion_equation_on_an_annulus.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9567627Z [34m[ 18/151] Checking `docs/src/literate_tutorials/equilibrium_temperature_distribution_with_mixed_boundary_conditions_and_using_ensembleproblems.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9589465Z [34m[ 19/151] Checking `docs/src/literate_tutorials/gray_scott_model_turing_patterns_from_a_coupled_reaction_diffusion_system.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9603289Z [34m[ 20/151] Checking `docs/src/literate_tutorials/helmholtz_equation_with_inhomogeneous_boundary_conditions.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9617143Z [34m[ 21/151] Checking `docs/src/literate_tutorials/laplaces_equation_with_internal_dirichlet_conditions.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9673189Z [34m[ 22/151] Checking `docs/src/literate_tutorials/mean_exit_time.jl` ........... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9732372Z [34m[ 23/151] Checking `docs/src/literate_tutorials/piecewise_linear_and_natural_neighbour_interpolation_for_an_advection_diffusion_equation.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9751037Z [34m[ 24/151] Checking `docs/src/literate_tutorials/porous_fisher_equation_and_travelling_waves.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9797744Z [34m[ 25/151] Checking `docs/src/literate_tutorials/porous_medium_equation.jl` ... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9825128Z [34m[ 26/151] Checking `docs/src/literate_tutorials/reaction_diffusion_brusselator_system_of_pdes.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9845929Z [34m[ 27/151] Checking `docs/src/literate_tutorials/reaction_diffusion_equation_with_a_time_dependent_dirichlet_boundary_condition_on_a_disk.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9863748Z [34m[ 28/151] Checking `docs/src/literate_tutorials/solving_mazes_with_laplaces_equation.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9934051Z [34m[ 29/151] Checking `docs/src/literate_wyos/diffusion_equations.jl` ........... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9961406Z [34m[ 30/151] Checking `docs/src/literate_wyos/laplaces_equation.jl` ............. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9988224Z [34m[ 31/151] Checking `docs/src/literate_wyos/linear_reaction_diffusion_equations.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.0021317Z [34m[ 32/151] Checking `docs/src/literate_wyos/mean_exit_time.jl` ................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.0073801Z [34m[ 33/151] Checking `docs/src/literate_wyos/poissons_equation.jl` ............. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.0182991Z [34m[ 34/151] Checking `src/FiniteVolumeMethod.jl` ............................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.0202236Z [34m[ 35/151] Checking `src/amr/amr_grid.jl` ..................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0219276Z [1mdiff --git a/amr_grid.jl b/amr_grid.jl[m
2026-02-09T19:17:20.0219903Z [1mindex 287a915..59a8fd3 100644[m
2026-02-09T19:17:20.0220399Z [1m--- a/amr_grid.jl[m
2026-02-09T19:17:20.0220814Z [1m+++ b/amr_grid.jl[m
2026-02-09T19:17:20.0221167Z [36m@@ -47,9 +47,11 @@[m [mend[m
2026-02-09T19:17:20.0221435Z  [m
2026-02-09T19:17:20.0221708Z  Create a zero-initialized AMR block.[m
2026-02-09T19:17:20.0222032Z  """[m
2026-02-09T19:17:20.0227314Z [31m-function AMRBlock(id::Int, level::Int, origin::NTuple{Dim, FT},[m
2026-02-09T19:17:20.0227848Z [32m+[m[32mfunction AMRBlock([m
2026-02-09T19:17:20.0228382Z [32m+[m[32m        id::Int, level::Int, origin::NTuple{Dim, FT},[m
2026-02-09T19:17:20.0229164Z          dims::NTuple{Dim, Int}, dx::NTuple{Dim, FT},[m
2026-02-09T19:17:20.0229623Z [31m-        ::Val{N}) where {N, FT, Dim}[m
2026-02-09T19:17:20.0229985Z [32m+[m[32m        ::Val{N}[m
2026-02-09T19:17:20.0230551Z [32m+[m[32m    ) where {N, FT, Dim}[m
2026-02-09T19:17:20.0230905Z      zero_state = zero(SVector{N, FT})[m
2026-02-09T19:17:20.0231261Z      U = fill(zero_state, dims...)[m
2026-02-09T19:17:20.0231998Z      return AMRBlock{N, FT, Dim}(id, level, origin, dims, dx, U, -1, Int[], true, Dict{Symbol, Int}())[m
2026-02-09T19:17:20.0232850Z [36m@@ -106,10 +108,12 @@[m [mCreate an AMR grid with a single root block covering the entire domain.[m
2026-02-09T19:17:20.0233504Z  - `domain_lo`: Lower corner of the domain (tuple).[m
2026-02-09T19:17:20.0233979Z  - `domain_hi`: Upper corner of the domain (tuple).[m
2026-02-09T19:17:20.0234333Z  """[m
2026-02-09T19:17:20.0234783Z [31m-function AMRGrid(law, criterion::AbstractRefinementCriterion,[m
2026-02-09T19:17:20.0235298Z [32m+[m[32mfunction AMRGrid([m
2026-02-09T19:17:20.0235773Z [32m+[m[32m        law, criterion::AbstractRefinementCriterion,[m
2026-02-09T19:17:20.0236297Z          block_size::NTuple{Dim, Int}, max_level::Int,[m
2026-02-09T19:17:20.0236815Z          domain_lo::NTuple{Dim, FT}, domain_hi::NTuple{Dim, FT},[m
2026-02-09T19:17:20.0237286Z [31m-        ::Val{N}) where {N, FT, Dim}[m
2026-02-09T19:17:20.0237666Z [32m+[m[32m        ::Val{N}[m
2026-02-09T19:17:20.0237969Z [32m+[m[32m    ) where {N, FT, Dim}[m
2026-02-09T19:17:20.0238310Z      # Compute dx for root level[m
2026-02-09T19:17:20.0239049Z      dx = ntuple(d -> (domain_hi[d] - domain_lo[d]) / block_size[d], Val(Dim))[m
2026-02-09T19:17:20.0239493Z  [m
2026-02-09T19:17:20.0319345Z [34m[ 36/151] Checking `src/amr/amr_solve.jl` .................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0335021Z [1mdiff --git a/amr_solve.jl b/amr_solve.jl[m
2026-02-09T19:17:20.0335643Z [1mindex 2605831..b1e5dc8 100644[m
2026-02-09T19:17:20.0336126Z [1m--- a/amr_solve.jl[m
2026-02-09T19:17:20.0336559Z [1m+++ b/amr_solve.jl[m
2026-02-09T19:17:20.0337110Z [36m@@ -40,10 +40,14 @@[m [mstruct AMRProblem{Grid, RS, Rec, BCs, FT}[m
2026-02-09T19:17:20.0337603Z      regrid_interval::Int[m
2026-02-09T19:17:20.0337874Z  end[m
2026-02-09T19:17:20.0338063Z  [m
2026-02-09T19:17:20.0338558Z [31m-function AMRProblem(grid, riemann_solver, reconstruction, boundary_conditions;[m
2026-02-09T19:17:20.0339529Z [31m-        initial_time = 0.0, final_time, cfl = 0.4, regrid_interval = 4)[m
2026-02-09T19:17:20.0356862Z [31m-    return AMRProblem(grid, riemann_solver, reconstruction, boundary_conditions,[m
2026-02-09T19:17:20.0357692Z [31m-        initial_time, final_time, cfl, regrid_interval)[m
2026-02-09T19:17:20.0358151Z [32m+[m[32mfunction AMRProblem([m
2026-02-09T19:17:20.0358675Z [32m+[m[32m        grid, riemann_solver, reconstruction, boundary_conditions;[m
2026-02-09T19:17:20.0359559Z [32m+[m[32m        initial_time = 0.0, final_time, cfl = 0.4, regrid_interval = 4[m
2026-02-09T19:17:20.0360020Z [32m+[m[32m    )[m
2026-02-09T19:17:20.0360306Z [32m+[m[32m    return AMRProblem([m
2026-02-09T19:17:20.0360822Z [32m+[m[32m        grid, riemann_solver, reconstruction, boundary_conditions,[m
2026-02-09T19:17:20.0361433Z [32m+[m[32m        initial_time, final_time, cfl, regrid_interval[m
2026-02-09T19:17:20.0361844Z [32m+[m[32m    )[m
2026-02-09T19:17:20.0362082Z  end[m
2026-02-09T19:17:20.0362283Z  [m
2026-02-09T19:17:20.0362472Z  """[m
2026-02-09T19:17:20.0401507Z [34m[ 37/151] Checking `src/amr/flux_correction.jl` .............................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0415950Z [1mdiff --git a/flux_correction.jl b/flux_correction.jl[m
2026-02-09T19:17:20.0416654Z [1mindex f22f891..43c9f72 100644[m
2026-02-09T19:17:20.0417167Z [1m--- a/flux_correction.jl[m
2026-02-09T19:17:20.0417630Z [1m+++ b/flux_correction.jl[m
2026-02-09T19:17:20.0417928Z [36m@@ -72,8 +72,10 @@[m [mend[m
2026-02-09T19:17:20.0418184Z  [m
2026-02-09T19:17:20.0418527Z  Add a fine flux contribution at a coarse face location.[m
2026-02-09T19:17:20.0419153Z  """[m
2026-02-09T19:17:20.0419656Z [31m-function accumulate_fine_flux!(reg::FluxRegister, face::Symbol,[m
2026-02-09T19:17:20.0420467Z [31m-        coarse_face_idx::Int, flux::SVector)[m
2026-02-09T19:17:20.0420896Z [32m+[m[32mfunction accumulate_fine_flux!([m
2026-02-09T19:17:20.0421472Z [32m+[m[32m        reg::FluxRegister, face::Symbol,[m
2026-02-09T19:17:20.0421976Z [32m+[m[32m        coarse_face_idx::Int, flux::SVector[m
2026-02-09T19:17:20.0422338Z [32m+[m[32m    )[m
2026-02-09T19:17:20.0422868Z      reg.fine_flux_sum[face][coarse_face_idx] = reg.fine_flux_sum[face][coarse_face_idx] + flux[m
2026-02-09T19:17:20.0423409Z      return nothing[m
2026-02-09T19:17:20.0423652Z  end[m
2026-02-09T19:17:20.0423877Z [36m@@ -83,8 +85,10 @@[m [mend[m
2026-02-09T19:17:20.0424141Z  [m
2026-02-09T19:17:20.0424425Z  Store the coarse flux at a face location.[m
2026-02-09T19:17:20.0424760Z  """[m
2026-02-09T19:17:20.0425174Z [31m-function store_coarse_flux!(reg::FluxRegister, face::Symbol,[m
2026-02-09T19:17:20.0425721Z [31m-        coarse_face_idx::Int, flux::SVector)[m
2026-02-09T19:17:20.0426140Z [32m+[m[32mfunction store_coarse_flux!([m
2026-02-09T19:17:20.0426579Z [32m+[m[32m        reg::FluxRegister, face::Symbol,[m
2026-02-09T19:17:20.0427071Z [32m+[m[32m        coarse_face_idx::Int, flux::SVector[m
2026-02-09T19:17:20.0427429Z [32m+[m[32m    )[m
2026-02-09T19:17:20.0427766Z      reg.coarse_flux[face][coarse_face_idx] = flux[m
2026-02-09T19:17:20.0428127Z      return nothing[m
2026-02-09T19:17:20.0428363Z  end[m
2026-02-09T19:17:20.0429031Z [36m@@ -102,7 +106,8 @@[m [mThis is added to the coarse cells adjacent to the interface.[m
2026-02-09T19:17:20.0429512Z  """[m
2026-02-09T19:17:20.0429786Z  function apply_flux_correction_2d!([m
2026-02-09T19:17:20.0430232Z          U::AbstractMatrix, reg::FluxRegister{N, FT},[m
2026-02-09T19:17:20.0430774Z [31m-        dt, dx, dy, nx::Int, ny::Int, face::Symbol) where {N, FT}[m
2026-02-09T19:17:20.0431307Z [32m+[m[32m        dt, dx, dy, nx::Int, ny::Int, face::Symbol[m
2026-02-09T19:17:20.0431712Z [32m+[m[32m    ) where {N, FT}[m
2026-02-09T19:17:20.0432029Z      n_inv = FT(1) / FT(reg.n_fine)[m
2026-02-09T19:17:20.0432308Z  [m
2026-02-09T19:17:20.0432518Z      if face == :left[m
2026-02-09T19:17:20.0432797Z [36m@@ -142,7 +147,8 @@[m [mend[m
2026-02-09T19:17:20.0433054Z  [m
2026-02-09T19:17:20.0433316Z  function apply_flux_correction_3d!([m
2026-02-09T19:17:20.0433761Z          U::AbstractArray{T, 3}, reg::FluxRegister{N, FT},[m
2026-02-09T19:17:20.0434336Z [31m-        dt, dx, dy, dz, nx::Int, ny::Int, nz::Int, face::Symbol) where {T, N, FT}[m
2026-02-09T19:17:20.0434956Z [32m+[m[32m        dt, dx, dy, dz, nx::Int, ny::Int, nz::Int, face::Symbol[m
2026-02-09T19:17:20.0435385Z [32m+[m[32m    ) where {T, N, FT}[m
2026-02-09T19:17:20.0435710Z      n_inv = FT(1) / FT(reg.n_fine)[m
2026-02-09T19:17:20.0435980Z  [m
2026-02-09T19:17:20.0436194Z      if face == :left[m
2026-02-09T19:17:20.0483870Z [34m[ 38/151] Checking `src/amr/prolongation.jl` ................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0497854Z [1mdiff --git a/prolongation.jl b/prolongation.jl[m
2026-02-09T19:17:20.0498530Z [1mindex 6e3bf71..05c43e5 100644[m
2026-02-09T19:17:20.0499242Z [1m--- a/prolongation.jl[m
2026-02-09T19:17:20.0499728Z [1m+++ b/prolongation.jl[m
2026-02-09T19:17:20.0500278Z [36m@@ -138,7 +138,8 @@[m [mUses the Balsara (2001) divergence-preserving interpolation:[m
2026-02-09T19:17:20.0500929Z  function prolongate_B_divergence_preserving_2d!([m
2026-02-09T19:17:20.0501501Z          Bx_coarse::AbstractMatrix, By_coarse::AbstractMatrix,[m
2026-02-09T19:17:20.0502042Z          Bx_fine::AbstractMatrix, By_fine::AbstractMatrix,[m
2026-02-09T19:17:20.0502510Z [31m-        nx_c::Int, ny_c::Int)[m
2026-02-09T19:17:20.0502870Z [32m+[m[32m        nx_c::Int, ny_c::Int[m
2026-02-09T19:17:20.0503185Z [32m+[m[32m    )[m
2026-02-09T19:17:20.0503567Z      # Refinement ratio is 2: each coarse cell -> 4 fine cells[m
2026-02-09T19:17:20.0504172Z      nx_f = 2 * nx_c[m
2026-02-09T19:17:20.0504426Z      ny_f = 2 * ny_c[m
2026-02-09T19:17:20.0591843Z [34m[ 39/151] Checking `src/amr/refinement.jl` ................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0606699Z [1mdiff --git a/refinement.jl b/refinement.jl[m
2026-02-09T19:17:20.0607367Z [1mindex 1597d2b..ac03ff4 100644[m
2026-02-09T19:17:20.0607869Z [1m--- a/refinement.jl[m
2026-02-09T19:17:20.0608322Z [1m+++ b/refinement.jl[m
2026-02-09T19:17:20.0609143Z [36m@@ -24,8 +24,10 @@[m [mstruct GradientRefinement{FT} <: AbstractRefinementCriterion[m
2026-02-09T19:17:20.0609738Z      coarsen_threshold::FT[m
2026-02-09T19:17:20.0610027Z  end[m
2026-02-09T19:17:20.0610226Z  [m
2026-02-09T19:17:20.0610664Z [31m-function GradientRefinement(; variable_index::Int = 1,[m
2026-02-09T19:17:20.0611248Z [31m-        refine_threshold = 0.1, coarsen_threshold = 0.01)[m
2026-02-09T19:17:20.0611721Z [32m+[m[32mfunction GradientRefinement(;[m
2026-02-09T19:17:20.0612162Z [32m+[m[32m        variable_index::Int = 1,[m
2026-02-09T19:17:20.0612649Z [32m+[m[32m        refine_threshold = 0.1, coarsen_threshold = 0.01[m
2026-02-09T19:17:20.0613065Z [32m+[m[32m    )[m
2026-02-09T19:17:20.0613585Z      return GradientRefinement(variable_index, refine_threshold, coarsen_threshold)[m
2026-02-09T19:17:20.0614095Z  end[m
2026-02-09T19:17:20.0614289Z  [m
2026-02-09T19:17:20.0660444Z [34m[ 40/151] Checking `src/amr/restriction.jl` .................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0674045Z [1mdiff --git a/restriction.jl b/restriction.jl[m
2026-02-09T19:17:20.0674674Z [1mindex 8c9a5c7..2c2df95 100644[m
2026-02-09T19:17:20.0675200Z [1m--- a/restriction.jl[m
2026-02-09T19:17:20.0675657Z [1m+++ b/restriction.jl[m
2026-02-09T19:17:20.0676115Z [36m@@ -107,7 +107,8 @@[m [mFor refinement ratio 2 in 2D:[m
2026-02-09T19:17:20.0676546Z  function restrict_B_face_2d!([m
2026-02-09T19:17:20.0677025Z          Bx_coarse::AbstractMatrix, By_coarse::AbstractMatrix,[m
2026-02-09T19:17:20.0677595Z          Bx_fine::AbstractMatrix, By_fine::AbstractMatrix,[m
2026-02-09T19:17:20.0678068Z [31m-        nx_c::Int, ny_c::Int)[m
2026-02-09T19:17:20.0678435Z [32m+[m[32m        nx_c::Int, ny_c::Int[m
2026-02-09T19:17:20.0678964Z [32m+[m[32m    )[m
2026-02-09T19:17:20.0679269Z      # Restrict Bx at x-faces[m
2026-02-09T19:17:20.0679602Z      for j in 1:ny_c, i in 1:(nx_c + 1)[m
2026-02-09T19:17:20.0679930Z          fi = 2 * i - 1[m
2026-02-09T19:17:20.0680437Z [36m@@ -132,7 +133,8 @@[m [mEach coarse face value = average of the 4 fine faces it covers.[m
2026-02-09T19:17:20.0680970Z  function restrict_B_face_3d!([m
2026-02-09T19:17:20.0681606Z          Bx_coarse::AbstractArray{T, 3}, By_coarse::AbstractArray{T, 3}, Bz_coarse::AbstractArray{T, 3},[m
2026-02-09T19:17:20.0682458Z          Bx_fine::AbstractArray{T, 3}, By_fine::AbstractArray{T, 3}, Bz_fine::AbstractArray{T, 3},[m
2026-02-09T19:17:20.0683116Z [31m-        nx_c::Int, ny_c::Int, nz_c::Int) where {T}[m
2026-02-09T19:17:20.0683579Z [32m+[m[32m        nx_c::Int, ny_c::Int, nz_c::Int[m
2026-02-09T19:17:20.0683929Z [32m+[m[32m    ) where {T}[m
2026-02-09T19:17:20.0684381Z      # Restrict Bx at x-faces: coarse face (i,j,k) = avg of 4 fine faces[m
2026-02-09T19:17:20.0684885Z      for k in 1:nz_c, j in 1:ny_c, i in 1:(nx_c + 1)[m
2026-02-09T19:17:20.0685249Z          fi = 2 * i - 1[m
2026-02-09T19:17:20.0685608Z [36m@@ -142,7 +144,7 @@[m [mfunction restrict_B_face_3d!([m
2026-02-09T19:17:20.0685984Z          fk2 = 2 * k[m
2026-02-09T19:17:20.0686262Z          Bx_coarse[i, j, k] = 0.25 * ([m
2026-02-09T19:17:20.0686661Z              Bx_fine[fi, fj1, fk1] + Bx_fine[fi, fj2, fk1] +[m
2026-02-09T19:17:20.0687130Z [31m-            Bx_fine[fi, fj1, fk2] + Bx_fine[fi, fj2, fk2][m
2026-02-09T19:17:20.0687612Z [32m+[m[32m                Bx_fine[fi, fj1, fk2] + Bx_fine[fi, fj2, fk2][m
2026-02-09T19:17:20.0687993Z          )[m
2026-02-09T19:17:20.0688203Z      end[m
2026-02-09T19:17:20.0688598Z  [m
2026-02-09T19:17:20.0689120Z [36m@@ -155,7 +157,7 @@[m [mfunction restrict_B_face_3d!([m
2026-02-09T19:17:20.0689495Z          fk2 = 2 * k[m
2026-02-09T19:17:20.0689897Z          By_coarse[i, j, k] = 0.25 * ([m
2026-02-09T19:17:20.0690306Z              By_fine[fi1, fj, fk1] + By_fine[fi2, fj, fk1] +[m
2026-02-09T19:17:20.0690762Z [31m-            By_fine[fi1, fj, fk2] + By_fine[fi2, fj, fk2][m
2026-02-09T19:17:20.0691243Z [32m+[m[32m                By_fine[fi1, fj, fk2] + By_fine[fi2, fj, fk2][m
2026-02-09T19:17:20.0691619Z          )[m
2026-02-09T19:17:20.0691823Z      end[m
2026-02-09T19:17:20.0692018Z  [m
2026-02-09T19:17:20.0692331Z [36m@@ -168,7 +170,7 @@[m [mfunction restrict_B_face_3d!([m
2026-02-09T19:17:20.0692698Z          fj2 = 2 * j[m
2026-02-09T19:17:20.0692971Z          Bz_coarse[i, j, k] = 0.25 * ([m
2026-02-09T19:17:20.0693355Z              Bz_fine[fi1, fj1, fk] + Bz_fine[fi2, fj1, fk] +[m
2026-02-09T19:17:20.0693803Z [31m-            Bz_fine[fi1, fj2, fk] + Bz_fine[fi2, fj2, fk][m
2026-02-09T19:17:20.0694283Z [32m+[m[32m                Bz_fine[fi1, fj2, fk] + Bz_fine[fi2, fj2, fk][m
2026-02-09T19:17:20.0694652Z          )[m
2026-02-09T19:17:20.0694851Z      end[m
2026-02-09T19:17:20.0695049Z  [m
2026-02-09T19:17:20.0799396Z [34m[ 41/151] Checking `src/conditions.jl` ....................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.0822052Z [34m[ 42/151] Checking `src/conditions/coupled.jl` ............................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0837014Z [1mdiff --git a/coupled.jl b/coupled.jl[m
2026-02-09T19:17:20.0837646Z [1mindex afb2dc7..f772b1b 100644[m
2026-02-09T19:17:20.0838144Z [1m--- a/coupled.jl[m
2026-02-09T19:17:20.0838550Z [1m+++ b/coupled.jl[m
2026-02-09T19:17:20.0839393Z [36m@@ -50,12 +50,12 @@[m [mThe constraint is: `Σᵢ coefficients[i] * u[field_indices[i]] = rhs_value`[m
2026-02-09T19:17:20.0840026Z  coupled_bc = CoupledBC([1, 2], [2.0, 3.0], 5.0)[m
2026-02-09T19:17:20.0840378Z  ```[m
2026-02-09T19:17:20.0840623Z  """[m
2026-02-09T19:17:20.0840882Z [31m-struct CoupledBC{T<:Real}[m
2026-02-09T19:17:20.0841258Z [32m+[m[32mstruct CoupledBC{T <: Real}[m
2026-02-09T19:17:20.0841660Z      field_indices::Vector{Int}[m
2026-02-09T19:17:20.0842001Z      coefficients::Vector{T}[m
2026-02-09T19:17:20.0842305Z      rhs_value::T[m
2026-02-09T19:17:20.0842529Z  [m
2026-02-09T19:17:20.0843191Z [31m-    function CoupledBC(field_indices::Vector{Int}, coefficients::Vector{T}, rhs_value::T) where {T<:Real}[m
2026-02-09T19:17:20.0844232Z [32m+[m[32m    function CoupledBC(field_indices::Vector{Int}, coefficients::Vector{T}, rhs_value::T) where {T <: Real}[m
2026-02-09T19:17:20.0845263Z          @assert length(field_indices) == length(coefficients) "Number of fields must match number of coefficients"[m
2026-02-09T19:17:20.0846072Z          @assert length(field_indices) > 0 "Must specify at least one field"[m
2026-02-09T19:17:20.0846669Z          return new{T}(field_indices, coefficients, rhs_value)[m
2026-02-09T19:17:20.0847240Z [36m@@ -91,13 +91,13 @@[m [mcoupled_dirichlet = CoupledDirichlet([m
2026-02-09T19:17:20.0847644Z  )[m
2026-02-09T19:17:20.0847846Z  ```[m
2026-02-09T19:17:20.0848040Z  """[m
2026-02-09T19:17:20.0848353Z [31m-struct CoupledDirichlet{F<:Function, P}[m
2026-02-09T19:17:20.0849051Z [32m+[m[32mstruct CoupledDirichlet{F <: Function, P}[m
2026-02-09T19:17:20.0849484Z      target_field::Int[m
2026-02-09T19:17:20.0849784Z      coupling_function::F[m
2026-02-09T19:17:20.0850094Z      parameters::P[m
2026-02-09T19:17:20.0850332Z  end[m
2026-02-09T19:17:20.0850528Z  [m
2026-02-09T19:17:20.0851014Z [31m-CoupledDirichlet(target_field::Int, f::Function; parameters=nothing) =[m
2026-02-09T19:17:20.0851803Z [32m+[m[32mCoupledDirichlet(target_field::Int, f::Function; parameters = nothing) =[m
2026-02-09T19:17:20.0852436Z      CoupledDirichlet(target_field, f, parameters)[m
2026-02-09T19:17:20.0852784Z  [m
2026-02-09T19:17:20.0852976Z  """[m
2026-02-09T19:17:20.0853536Z [36m@@ -121,13 +121,13 @@[m [mcoupled_neumann = CoupledNeumann([m
2026-02-09T19:17:20.0853920Z  )[m
2026-02-09T19:17:20.0854111Z  ```[m
2026-02-09T19:17:20.0854302Z  """[m
2026-02-09T19:17:20.0854703Z [31m-struct CoupledNeumann{F<:Function, P}[m
2026-02-09T19:17:20.0855187Z [32m+[m[32mstruct CoupledNeumann{F <: Function, P}[m
2026-02-09T19:17:20.0855585Z      target_field::Int[m
2026-02-09T19:17:20.0855880Z      coupling_function::F[m
2026-02-09T19:17:20.0856220Z      parameters::P[m
2026-02-09T19:17:20.0856456Z  end[m
2026-02-09T19:17:20.0856648Z  [m
2026-02-09T19:17:20.0857117Z [31m-CoupledNeumann(target_field::Int, f::Function; parameters=nothing) =[m
2026-02-09T19:17:20.0857893Z [32m+[m[32mCoupledNeumann(target_field::Int, f::Function; parameters = nothing) =[m
2026-02-09T19:17:20.0858502Z      CoupledNeumann(target_field, f, parameters)[m
2026-02-09T19:17:20.0859045Z  [m
2026-02-09T19:17:20.0859243Z  """[m
2026-02-09T19:17:20.0859578Z [36m@@ -155,13 +155,13 @@[m [mcoupled_robin = CoupledRobin([m
2026-02-09T19:17:20.0859945Z  )[m
2026-02-09T19:17:20.0860134Z  ```[m
2026-02-09T19:17:20.0860330Z  """[m
2026-02-09T19:17:20.0860613Z [31m-struct CoupledRobin{F<:Function, P}[m
2026-02-09T19:17:20.0861062Z [32m+[m[32mstruct CoupledRobin{F <: Function, P}[m
2026-02-09T19:17:20.0861450Z      target_field::Int[m
2026-02-09T19:17:20.0861773Z      coupling_function::F[m
2026-02-09T19:17:20.0862067Z      parameters::P[m
2026-02-09T19:17:20.0862306Z  end[m
2026-02-09T19:17:20.0862492Z  [m
2026-02-09T19:17:20.0862946Z [31m-CoupledRobin(target_field::Int, f::Function; parameters=nothing) =[m
2026-02-09T19:17:20.0863680Z [32m+[m[32mCoupledRobin(target_field::Int, f::Function; parameters = nothing) =[m
2026-02-09T19:17:20.0864260Z      CoupledRobin(target_field, f, parameters)[m
2026-02-09T19:17:20.0864596Z  [m
2026-02-09T19:17:20.0864781Z  """[m
2026-02-09T19:17:20.0865246Z [36m@@ -186,7 +186,7 @@[m [mEvaluate a coupled Dirichlet BC given the current field values.[m
2026-02-09T19:17:20.0865756Z  # Returns[m
2026-02-09T19:17:20.0866111Z  The Dirichlet boundary value for the target field.[m
2026-02-09T19:17:20.0866475Z  """[m
2026-02-09T19:17:20.0867039Z [31m-function evaluate_coupled_bc(bc::CoupledDirichlet, x, y, t, u_values, grad_values=nothing)[m
2026-02-09T19:17:20.0867981Z [32m+[m[32mfunction evaluate_coupled_bc(bc::CoupledDirichlet, x, y, t, u_values, grad_values = nothing)[m
2026-02-09T19:17:20.0868963Z      return bc.coupling_function(x, y, t, u_values, bc.parameters)[m
2026-02-09T19:17:20.0869623Z  end[m
2026-02-09T19:17:20.0869907Z  [m
2026-02-09T19:17:20.0870511Z [34m[ 43/151] Checking `src/conditions/nonlinear.jl` ............................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0884624Z [1mdiff --git a/nonlinear.jl b/nonlinear.jl[m
2026-02-09T19:17:20.0885236Z [1mindex fc7fbe9..4f9fdfa 100644[m
2026-02-09T19:17:20.0885579Z [1m--- a/nonlinear.jl[m
2026-02-09T19:17:20.0885863Z [1m+++ b/nonlinear.jl[m
2026-02-09T19:17:20.0886474Z [36m@@ -126,7 +126,7 @@[m [mFor a single linearization step, we return the linearized Dirichlet value.[m
2026-02-09T19:17:20.0887028Z  # Returns[m
2026-02-09T19:17:20.0887346Z  The linearized Dirichlet boundary value.[m
2026-02-09T19:17:20.0887673Z  """[m
2026-02-09T19:17:20.0888220Z [31m-function linearize_bc(::Type{NonlinearDirichlet}, f, x, y, t, u, grad_u, p; ε=1e-6)[m
2026-02-09T19:17:20.0889294Z [32m+[m[32mfunction linearize_bc(::Type{NonlinearDirichlet}, f, x, y, t, u, grad_u, p; ε = 1.0e-6)[m
2026-02-09T19:17:20.0889885Z      # Evaluate f at current state[m
2026-02-09T19:17:20.0890233Z      f_val = f(x, y, t, u, grad_u, p)[m
2026-02-09T19:17:20.0890515Z  [m
2026-02-09T19:17:20.0891082Z [36m@@ -138,7 +138,7 @@[m [mfunction linearize_bc(::Type{NonlinearDirichlet}, f, x, y, t, u, grad_u, p; ε=1[m
2026-02-09T19:17:20.0891682Z      # u_new = u - (f(u) - u) / (df/du - 1)[m
2026-02-09T19:17:20.0892026Z      denom = df_du - one(df_du)[m
2026-02-09T19:17:20.0892299Z  [m
2026-02-09T19:17:20.0892709Z [31m-    if abs(denom) < 1e-12[m
2026-02-09T19:17:20.0893038Z [32m+[m[32m    if abs(denom) < 1.0e-12[m
2026-02-09T19:17:20.0893593Z          # Near fixed point or singular - return f(u) as estimate[m
2026-02-09T19:17:20.0894021Z          return f_val[m
2026-02-09T19:17:20.0894266Z      end[m
2026-02-09T19:17:20.0894671Z [36m@@ -188,8 +188,8 @@[m [mwith additional metadata for nonlinear handling.[m
2026-02-09T19:17:20.0895367Z  - `nonlinear_types`: Tuple indicating which boundaries have nonlinear conditions[m
2026-02-09T19:17:20.0896082Z  - `gradient_cache`: Pre-allocated storage for gradient computations[m
2026-02-09T19:17:20.0896529Z  """[m
2026-02-09T19:17:20.0896854Z [31m-struct NonlinearBoundaryConditions{F,C,P,N}[m
2026-02-09T19:17:20.0897370Z [31m-    base_conditions::BoundaryConditions{F,C}[m
2026-02-09T19:17:20.0897890Z [32m+[m[32mstruct NonlinearBoundaryConditions{F, C, P, N}[m
2026-02-09T19:17:20.0898450Z [32m+[m[32m    base_conditions::BoundaryConditions{F, C}[m
2026-02-09T19:17:20.0899159Z      nonlinear_types::N[m
2026-02-09T19:17:20.0899461Z      parameters::P[m
2026-02-09T19:17:20.0899694Z  end[m
2026-02-09T19:17:20.0926293Z [34m[ 44/151] Checking `src/conditions/periodic.jl` .............................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0940934Z [1mdiff --git a/periodic.jl b/periodic.jl[m
2026-02-09T19:17:20.0941566Z [1mindex 43ce09c..82c86a7 100644[m
2026-02-09T19:17:20.0942062Z [1m--- a/periodic.jl[m
2026-02-09T19:17:20.0942478Z [1m+++ b/periodic.jl[m
2026-02-09T19:17:20.0943001Z [36m@@ -54,7 +54,7 @@[m [mperiodic_bc = PeriodicBC(1, 3; direction=:x)[m
2026-02-09T19:17:20.0943624Z  periodic_bc_shifted = PeriodicBC(1, 3; shift=1.0, direction=:x)[m
2026-02-09T19:17:20.0944036Z  ```[m
2026-02-09T19:17:20.0944239Z  """[m
2026-02-09T19:17:20.0944503Z [31m-struct PeriodicBC{T<:Real, F}[m
2026-02-09T19:17:20.0944897Z [32m+[m[32mstruct PeriodicBC{T <: Real, F}[m
2026-02-09T19:17:20.0945308Z      segment_pair::Tuple{Int, Int}[m
2026-02-09T19:17:20.0945642Z      shift::T[m
2026-02-09T19:17:20.0945898Z      direction::Symbol[m
2026-02-09T19:17:20.0946276Z [36m@@ -62,7 +62,7 @@[m [mstruct PeriodicBC{T<:Real, F}[m
2026-02-09T19:17:20.0946631Z  end[m
2026-02-09T19:17:20.0946819Z  [m
2026-02-09T19:17:20.0947060Z  # Default constructors[m
2026-02-09T19:17:20.0947740Z [31m-function PeriodicBC(seg1::Int, seg2::Int; shift::Real=0.0, direction::Symbol=:x, transform=nothing)[m
2026-02-09T19:17:20.0948972Z [32m+[m[32mfunction PeriodicBC(seg1::Int, seg2::Int; shift::Real = 0.0, direction::Symbol = :x, transform = nothing)[m
2026-02-09T19:17:20.0949627Z      T = typeof(float(shift))[m
2026-02-09T19:17:20.0949954Z      if transform === nothing[m
2026-02-09T19:17:20.0950300Z          transform = identity_transform[m
2026-02-09T19:17:20.0950886Z [36m@@ -87,7 +87,7 @@[m [mStores the mapping between nodes on paired periodic boundaries.[m
2026-02-09T19:17:20.0951485Z  - `segment_pair`: The boundary segment indices[m
2026-02-09T19:17:20.0951904Z  - `shift`: The constant shift value[m
2026-02-09T19:17:20.0952208Z  """[m
2026-02-09T19:17:20.0952498Z [31m-struct PeriodicNodeMapping{T<:Real}[m
2026-02-09T19:17:20.0952949Z [32m+[m[32mstruct PeriodicNodeMapping{T <: Real}[m
2026-02-09T19:17:20.0953378Z      node_pairs::Vector{Tuple{Int, Int}}[m
2026-02-09T19:17:20.0953752Z      segment_pair::Tuple{Int, Int}[m
2026-02-09T19:17:20.0954051Z      shift::T[m
2026-02-09T19:17:20.0954491Z [36m@@ -115,7 +115,7 @@[m [mA `PeriodicNodeMapping` containing the paired nodes.[m
2026-02-09T19:17:20.0955117Z     coordinates (after projecting out the periodic direction)[m
2026-02-09T19:17:20.0955599Z  3. Return the list of matched pairs[m
2026-02-09T19:17:20.0955901Z  """[m
2026-02-09T19:17:20.0956411Z [31m-function compute_periodic_mapping(mesh::FVMGeometry, bc::PeriodicBC; tol=1e-10)[m
2026-02-09T19:17:20.0957289Z [32m+[m[32mfunction compute_periodic_mapping(mesh::FVMGeometry, bc::PeriodicBC; tol = 1.0e-10)[m
2026-02-09T19:17:20.0958076Z      tri = mesh.triangulation[m
2026-02-09T19:17:20.0958410Z      seg1, seg2 = bc.segment_pair[m
2026-02-09T19:17:20.0958686Z  [m
2026-02-09T19:17:20.0959505Z [36m@@ -286,7 +286,7 @@[m [mContainer for multiple periodic boundary condition specifications.[m
2026-02-09T19:17:20.0960037Z  # Fields[m
2026-02-09T19:17:20.0960479Z  - `mappings`: Vector of `PeriodicNodeMapping` for each periodic BC pair[m
2026-02-09T19:17:20.0960930Z  """[m
2026-02-09T19:17:20.0961207Z [31m-struct PeriodicConditions{T<:Real}[m
2026-02-09T19:17:20.0961638Z [32m+[m[32mstruct PeriodicConditions{T <: Real}[m
2026-02-09T19:17:20.0962098Z      mappings::Vector{PeriodicNodeMapping{T}}[m
2026-02-09T19:17:20.0962453Z  end[m
2026-02-09T19:17:20.0962635Z  [m
2026-02-09T19:17:20.0962859Z [36m@@ -295,8 +295,8 @@[m [mend[m
2026-02-09T19:17:20.0963115Z  [m
2026-02-09T19:17:20.0963564Z  Construct periodic conditions from a list of periodic BC specifications.[m
2026-02-09T19:17:20.0964045Z  """[m
2026-02-09T19:17:20.0964605Z [31m-function PeriodicConditions(mesh::FVMGeometry, bcs::Vector{<:PeriodicBC}; tol=1e-10)[m
2026-02-09T19:17:20.0965387Z [31m-    mappings = [compute_periodic_mapping(mesh, bc; tol=tol) for bc in bcs][m
2026-02-09T19:17:20.0966227Z [32m+[m[32mfunction PeriodicConditions(mesh::FVMGeometry, bcs::Vector{<:PeriodicBC}; tol = 1.0e-10)[m
2026-02-09T19:17:20.0967068Z [32m+[m[32m    mappings = [compute_periodic_mapping(mesh, bc; tol = tol) for bc in bcs][m
2026-02-09T19:17:20.0967757Z      T = isempty(mappings) ? Float64 : typeof(first(mappings).shift)[m
2026-02-09T19:17:20.0968283Z      return PeriodicConditions{T}(mappings)[m
2026-02-09T19:17:20.0968618Z  end[m
2026-02-09T19:17:20.0973391Z [34m[ 45/151] Checking `src/constrained_transport/ct_data.jl` .................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1023089Z [34m[ 46/151] Checking `src/constrained_transport/ct_data_3d.jl` ................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1037533Z [34m[ 47/151] Checking `src/constrained_transport/ct_update.jl` .................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1051447Z [1mdiff --git a/ct_update.jl b/ct_update.jl[m
2026-02-09T19:17:20.1052093Z [1mindex 033ad41..55126eb 100644[m
2026-02-09T19:17:20.1052434Z [1m--- a/ct_update.jl[m
2026-02-09T19:17:20.1052735Z [1m+++ b/ct_update.jl[m
2026-02-09T19:17:20.1053496Z [36m@@ -52,8 +52,10 @@[m [mPerform a weighted CT update for SSP-RK stages:[m
2026-02-09T19:17:20.1054172Z  [m
2026-02-09T19:17:20.1054740Z  where `ΔB` is the CT update computed from `ct_stage.emf_z`.[m
2026-02-09T19:17:20.1055385Z  """[m
2026-02-09T19:17:20.1056258Z [31m-function ct_weighted_update!(ct_out::CTData2D, ct_old::CTData2D, ct_stage::CTData2D,[m
2026-02-09T19:17:20.1057387Z [31m-        α_old, α_stage, dt, dx, dy, nx::Int, ny::Int)[m
2026-02-09T19:17:20.1058096Z [32m+[m[32mfunction ct_weighted_update!([m
2026-02-09T19:17:20.1059281Z [32m+[m[32m        ct_out::CTData2D, ct_old::CTData2D, ct_stage::CTData2D,[m
2026-02-09T19:17:20.1060277Z [32m+[m[32m        α_old, α_stage, dt, dx, dy, nx::Int, ny::Int[m
2026-02-09T19:17:20.1060881Z [32m+[m[32m    )[m
2026-02-09T19:17:20.1061293Z      Bx_out = ct_out.Bx_face[m
2026-02-09T19:17:20.1061759Z      By_out = ct_out.By_face[m
2026-02-09T19:17:20.1062226Z      Bx_old = ct_old.Bx_face[m
2026-02-09T19:17:20.1088478Z [34m[ 48/151] Checking `src/constrained_transport/ct_update_3d.jl` ............... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1102249Z [1mdiff --git a/ct_update_3d.jl b/ct_update_3d.jl[m
2026-02-09T19:17:20.1102696Z [1mindex 68a7227..bac2aeb 100644[m
2026-02-09T19:17:20.1103029Z [1m--- a/ct_update_3d.jl[m
2026-02-09T19:17:20.1103333Z [1m+++ b/ct_update_3d.jl[m
2026-02-09T19:17:20.1103872Z [36m@@ -61,8 +61,10 @@[m [mPerform a weighted CT update for SSP-RK stages:[m
2026-02-09T19:17:20.1104545Z  [m
2026-02-09T19:17:20.1105119Z  where `dB` is the CT update computed from `ct_stage`'s EMFs.[m
2026-02-09T19:17:20.1105743Z  """[m
2026-02-09T19:17:20.1106880Z [31m-function ct_weighted_update_3d!(ct_out::CTData3D, ct_old::CTData3D, ct_stage::CTData3D,[m
2026-02-09T19:17:20.1108118Z [31m-        a_old, a_stage, dt, dx, dy, dz, nx::Int, ny::Int, nz::Int)[m
2026-02-09T19:17:20.1109365Z [32m+[m[32mfunction ct_weighted_update_3d!([m
2026-02-09T19:17:20.1110291Z [32m+[m[32m        ct_out::CTData3D, ct_old::CTData3D, ct_stage::CTData3D,[m
2026-02-09T19:17:20.1111300Z [32m+[m[32m        a_old, a_stage, dt, dx, dy, dz, nx::Int, ny::Int, nz::Int[m
2026-02-09T19:17:20.1111976Z [32m+[m[32m    )[m
2026-02-09T19:17:20.1112403Z      Bx_out = ct_out.Bx_face[m
2026-02-09T19:17:20.1112885Z      By_out = ct_out.By_face[m
2026-02-09T19:17:20.1113350Z      Bz_out = ct_out.Bz_face[m
2026-02-09T19:17:20.1119422Z [34m[ 49/151] Checking `src/constrained_transport/divb.jl` ....................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1130770Z [34m[ 50/151] Checking `src/constrained_transport/divb_3d.jl` .................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1144169Z [1mdiff --git a/divb_3d.jl b/divb_3d.jl[m
2026-02-09T19:17:20.1144748Z [1mindex 73e181d..ff9ce78 100644[m
2026-02-09T19:17:20.1145104Z [1m--- a/divb_3d.jl[m
2026-02-09T19:17:20.1145392Z [1m+++ b/divb_3d.jl[m
2026-02-09T19:17:20.1146419Z [36m@@ -21,8 +21,8 @@[m [mfunction compute_divB_3d(ct::CTData3D, dx, dy, dz, nx::Int, ny::Int, nz::Int)[m
2026-02-09T19:17:20.1147407Z      divB = Array{FT, 3}(undef, nx, ny, nz)[m
2026-02-09T19:17:20.1148011Z      for k in 1:nz, j in 1:ny, i in 1:nx[m
2026-02-09T19:17:20.1148687Z          divB[i, j, k] = (Bx[i + 1, j, k] - Bx[i, j, k]) / dx +[m
2026-02-09T19:17:20.1149673Z [31m-                         (By[i, j + 1, k] - By[i, j, k]) / dy +[m
2026-02-09T19:17:20.1150393Z [31m-                         (Bz[i, j, k + 1] - Bz[i, j, k]) / dz[m
2026-02-09T19:17:20.1151104Z [32m+[m[32m            (By[i, j + 1, k] - By[i, j, k]) / dy +[m
2026-02-09T19:17:20.1151829Z [32m+[m[32m            (Bz[i, j, k + 1] - Bz[i, j, k]) / dz[m
2026-02-09T19:17:20.1152407Z      end[m
2026-02-09T19:17:20.1152751Z      return divB[m
2026-02-09T19:17:20.1153117Z  end[m
2026-02-09T19:17:20.1182353Z [34m[ 51/151] Checking `src/constrained_transport/emf.jl` ........................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1196075Z [1mdiff --git a/emf.jl b/emf.jl[m
2026-02-09T19:17:20.1196628Z [1mindex 0dbd245..3bd1f57 100644[m
2026-02-09T19:17:20.1196966Z [1m--- a/emf.jl[m
2026-02-09T19:17:20.1197216Z [1m+++ b/emf.jl[m
2026-02-09T19:17:20.1197923Z [36m@@ -34,8 +34,10 @@[m [mThe EMF at y-faces is `Ez_y = +Fy[6]` (positive of the Bx induction flux).[m
2026-02-09T19:17:20.1198928Z  [m
2026-02-09T19:17:20.1199605Z  Corner values are the arithmetic average of the 4 surrounding face EMFs.[m
2026-02-09T19:17:20.1200358Z  """[m
2026-02-09T19:17:20.1201282Z [31m-function compute_emf_2d!(ct::CTData2D, Fx_faces::AbstractMatrix, Fy_faces::AbstractMatrix,[m
2026-02-09T19:17:20.1202286Z [31m-        nx::Int, ny::Int)[m
2026-02-09T19:17:20.1202857Z [32m+[m[32mfunction compute_emf_2d!([m
2026-02-09T19:17:20.1203762Z [32m+[m[32m        ct::CTData2D, Fx_faces::AbstractMatrix, Fy_faces::AbstractMatrix,[m
2026-02-09T19:17:20.1204612Z [32m+[m[32m        nx::Int, ny::Int[m
2026-02-09T19:17:20.1205087Z [32m+[m[32m    )[m
2026-02-09T19:17:20.1205502Z      emf_z = ct.emf_z[m
2026-02-09T19:17:20.1205893Z  [m
2026-02-09T19:17:20.1206463Z      # Interior corners (i=2:nx, j=2:ny) have 4 surrounding faces[m
2026-02-09T19:17:20.1222959Z [34m[ 52/151] Checking `src/constrained_transport/emf_3d.jl` ..................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1236322Z [1mdiff --git a/emf_3d.jl b/emf_3d.jl[m
2026-02-09T19:17:20.1236718Z [1mindex 4aa392d..11e5dad 100644[m
2026-02-09T19:17:20.1237041Z [1m--- a/emf_3d.jl[m
2026-02-09T19:17:20.1237293Z [1m+++ b/emf_3d.jl[m
2026-02-09T19:17:20.1237617Z [36m@@ -39,9 +39,11 @@[m [mEMF from face fluxes:[m
2026-02-09T19:17:20.1238317Z    Ey = -Fz[6] + Fx[8]   (contributions from Bx and Bz induction)[m
2026-02-09T19:17:20.1239672Z    Ez = -Fx[7] + Fy[6]   (contributions from Bx and By induction)[m
2026-02-09T19:17:20.1240292Z  """[m
2026-02-09T19:17:20.1241168Z [31m-function _compute_emf_3d_from_extended!(ct::CTData3D,[m
2026-02-09T19:17:20.1242031Z [32m+[m[32mfunction _compute_emf_3d_from_extended!([m
2026-02-09T19:17:20.1242783Z [32m+[m[32m        ct::CTData3D,[m
2026-02-09T19:17:20.1243510Z          Fx_all::AbstractArray{T, 3}, Fy_all::AbstractArray{T, 3},[m
2026-02-09T19:17:20.1244496Z [31m-        Fz_all::AbstractArray{T, 3}, nx::Int, ny::Int, nz::Int) where {T}[m
2026-02-09T19:17:20.1245556Z [32m+[m[32m        Fz_all::AbstractArray{T, 3}, nx::Int, ny::Int, nz::Int[m
2026-02-09T19:17:20.1246257Z [32m+[m[32m    ) where {T}[m
2026-02-09T19:17:20.1246667Z  [m
2026-02-09T19:17:20.1247116Z      # Ez at z-edges: size (nx+1) x (ny+1) x nz[m
2026-02-09T19:17:20.1247727Z      # Edge (i, j, k) is surrounded by:[m
2026-02-09T19:17:20.1248687Z [34m[ 53/151] Checking `src/eos/eos_interface.jl` ................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1255011Z [34m[ 54/151] Checking `src/eos/ideal_gas.jl` .................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1268193Z [1mdiff --git a/ideal_gas.jl b/ideal_gas.jl[m
2026-02-09T19:17:20.1268984Z [1mindex d5997e6..1344d60 100644[m
2026-02-09T19:17:20.1269316Z [1m--- a/ideal_gas.jl[m
2026-02-09T19:17:20.1269611Z [1m+++ b/ideal_gas.jl[m
2026-02-09T19:17:20.1270301Z [36m@@ -17,7 +17,7 @@[m [mIdealGasEOS(; gamma = 1.4) = IdealGasEOS(gamma)[m
2026-02-09T19:17:20.1270974Z  end[m
2026-02-09T19:17:20.1271291Z  [m
2026-02-09T19:17:20.1271847Z  @inline function sound_speed(eos::IdealGasEOS, ρ, P)[m
2026-02-09T19:17:20.1272689Z [31m-    return sqrt(eos.gamma * max(P, zero(P)) / max(ρ, 1e-30))[m
2026-02-09T19:17:20.1273643Z [32m+[m[32m    return sqrt(eos.gamma * max(P, zero(P)) / max(ρ, 1.0e-30))[m
2026-02-09T19:17:20.1274348Z  end[m
2026-02-09T19:17:20.1274677Z  [m
2026-02-09T19:17:20.1275250Z  @inline function internal_energy(eos::IdealGasEOS, ρ, P)[m
2026-02-09T19:17:20.1283420Z [34m[ 55/151] Checking `src/eos/stiffened_gas.jl` ................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1315603Z [34m[ 56/151] Checking `src/equations/boundary_edge_contributions.jl` ............ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1327078Z [34m[ 57/151] Checking `src/equations/control_volumes.jl` ........................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1343480Z [34m[ 58/151] Checking `src/equations/dirichlet.jl` .............................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1363575Z [34m[ 59/151] Checking `src/equations/individual_flux_contributions.jl` .......... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1373809Z [34m[ 60/151] Checking `src/equations/main_equations.jl` ......................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1383612Z [34m[ 61/151] Checking `src/equations/shape_functions.jl` ........................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1406443Z [34m[ 62/151] Checking `src/equations/source_contributions.jl` ................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1422256Z [34m[ 63/151] Checking `src/equations/triangle_contributions.jl` ................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1453945Z [34m[ 64/151] Checking `src/geometry.jl` ......................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1502487Z [34m[ 65/151] Checking `src/hyperbolic/boundary_conditions_2d.jl` ................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1625946Z [34m[ 66/151] Checking `src/hyperbolic/boundary_conditions_3d.jl` ................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1644697Z [34m[ 67/151] Checking `src/hyperbolic/boundary_conditions_hyp.jl` ............... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1725811Z [34m[ 68/151] Checking `src/hyperbolic/characteristic_projection.jl` ............. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1742916Z [1mdiff --git a/characteristic_projection.jl b/characteristic_projection.jl[m
2026-02-09T19:17:20.1743699Z [1mindex 9914313..ca20976 100644[m
2026-02-09T19:17:20.1744400Z [1m--- a/characteristic_projection.jl[m
2026-02-09T19:17:20.1745049Z [1m+++ b/characteristic_projection.jl[m
2026-02-09T19:17:20.1745851Z [36m@@ -71,8 +71,8 @@[m [mColumns are the right eigenvectors `r₁, r₂, r₃`.[m
2026-02-09T19:17:20.1746972Z  @inline function right_eigenvectors(law::EulerEquations{1}, w::SVector{3}, dir::Int)[m
2026-02-09T19:17:20.1747806Z      ρ, v, P = w[m
2026-02-09T19:17:20.1748222Z      γ = law.eos.gamma[m
2026-02-09T19:17:20.1748679Z [31m-    ρ = max(ρ, 1e-12)[m
2026-02-09T19:17:20.1749390Z [31m-    P = max(P, 1e-12)[m
2026-02-09T19:17:20.1749874Z [32m+[m[32m    ρ = max(ρ, 1.0e-12)[m
2026-02-09T19:17:20.1750411Z [32m+[m[32m    P = max(P, 1.0e-12)[m
2026-02-09T19:17:20.1750944Z      c = sound_speed(law.eos, ρ, P)[m
2026-02-09T19:17:20.1751677Z      H = (total_energy(law.eos, ρ, v, P) + P) / ρ  # specific enthalpy[m
2026-02-09T19:17:20.1752323Z  [m
2026-02-09T19:17:20.1753162Z [36m@@ -95,8 +95,8 @@[m [mLeft eigenvector matrix (rows are left eigenvectors) of the 1D Euler flux Jacobi[m
2026-02-09T19:17:20.1754457Z  @inline function left_eigenvectors(law::EulerEquations{1}, w::SVector{3}, dir::Int)[m
2026-02-09T19:17:20.1755286Z      ρ, v, P = w[m
2026-02-09T19:17:20.1755693Z      γ = law.eos.gamma[m
2026-02-09T19:17:20.1756133Z [31m-    ρ = max(ρ, 1e-12)[m
2026-02-09T19:17:20.1756599Z [31m-    P = max(P, 1e-12)[m
2026-02-09T19:17:20.1757076Z [32m+[m[32m    ρ = max(ρ, 1.0e-12)[m
2026-02-09T19:17:20.1757605Z [32m+[m[32m    P = max(P, 1.0e-12)[m
2026-02-09T19:17:20.1758137Z      c = sound_speed(law.eos, ρ, P)[m
2026-02-09T19:17:20.1758881Z      b1 = (γ - 1) / c^2[m
2026-02-09T19:17:20.1759341Z      b2 = 0.5 * b1 * v^2[m
2026-02-09T19:17:20.1759979Z [36m@@ -126,8 +126,8 @@[m [mPrimitive state: `w = [ρ, vx, vy, P]`.[m
2026-02-09T19:17:20.1761042Z  @inline function right_eigenvectors(law::EulerEquations{2}, w::SVector{4}, dir::Int)[m
2026-02-09T19:17:20.1761895Z      ρ, vx, vy, P = w[m
2026-02-09T19:17:20.1762332Z      γ = law.eos.gamma[m
2026-02-09T19:17:20.1762792Z [31m-    ρ = max(ρ, 1e-12)[m
2026-02-09T19:17:20.1763258Z [31m-    P = max(P, 1e-12)[m
2026-02-09T19:17:20.1763728Z [32m+[m[32m    ρ = max(ρ, 1.0e-12)[m
2026-02-09T19:17:20.1764254Z [32m+[m[32m    P = max(P, 1.0e-12)[m
2026-02-09T19:17:20.1764793Z      c = sound_speed(law.eos, ρ, P)[m
2026-02-09T19:17:20.1765429Z      H = (total_energy(law.eos, ρ, vx, vy, P) + P) / ρ[m
2026-02-09T19:17:20.1765964Z  [m
2026-02-09T19:17:20.1766820Z [36m@@ -159,8 +159,8 @@[m [mLeft eigenvector matrix (rows are left eigenvectors) of the 2D Euler flux Jacobi[m
2026-02-09T19:17:20.1768127Z  @inline function left_eigenvectors(law::EulerEquations{2}, w::SVector{4}, dir::Int)[m
2026-02-09T19:17:20.1769174Z      ρ, vx, vy, P = w[m
2026-02-09T19:17:20.1769617Z      γ = law.eos.gamma[m
2026-02-09T19:17:20.1770068Z [31m-    ρ = max(ρ, 1e-12)[m
2026-02-09T19:17:20.1770528Z [31m-    P = max(P, 1e-12)[m
2026-02-09T19:17:20.1770997Z [32m+[m[32m    ρ = max(ρ, 1.0e-12)[m
2026-02-09T19:17:20.1771535Z [32m+[m[32m    P = max(P, 1.0e-12)[m
2026-02-09T19:17:20.1772080Z      c = sound_speed(law.eos, ρ, P)[m
2026-02-09T19:17:20.1772583Z      b1 = (γ - 1) / c^2[m
2026-02-09T19:17:20.1773031Z      q2 = vx^2 + vy^2[m
2026-02-09T19:17:20.1793249Z [34m[ 69/151] Checking `src/hyperbolic/con2prim.jl` .............................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1807524Z [1mdiff --git a/con2prim.jl b/con2prim.jl[m
2026-02-09T19:17:20.1808135Z [1mindex 4cce644..14ca6c2 100644[m
2026-02-09T19:17:20.1808527Z [1m--- a/con2prim.jl[m
2026-02-09T19:17:20.1809037Z [1m+++ b/con2prim.jl[m
2026-02-09T19:17:20.1810054Z [36m@@ -61,12 +61,12 @@[m [mfunction srmhd_con2prim(eos, u::SVector{8}, tol::Real, maxiter::Int)[m
2026-02-09T19:17:20.1810922Z      SdotB_sq = SdotB^2[m
2026-02-09T19:17:20.1811568Z  [m
2026-02-09T19:17:20.1811972Z      # Floor conserved variables[m
2026-02-09T19:17:20.1812481Z [31m-    D = max(D, 1e-12)[m
2026-02-09T19:17:20.1812983Z [32m+[m[32m    D = max(D, 1.0e-12)[m
2026-02-09T19:17:20.1813661Z  [m
2026-02-09T19:17:20.1814244Z      # Initial guess: from τ + D = ξ + B² - P_tot, with P_tot ≈ P[m
2026-02-09T19:17:20.1815209Z      # Non-relativistic estimate: P ≈ gm1 * (τ + D - B²/2 - S²/(2(τ+D+B²)))[m
2026-02-09T19:17:20.1815926Z      E_approx = tau + D[m
2026-02-09T19:17:20.1816808Z [31m-    P_guess = max(gm1 * (E_approx - 0.5 * B_sq - 0.5 * S_sq / max(E_approx + B_sq, 1e-30)), 1e-16)[m
2026-02-09T19:17:20.1818101Z [32m+[m[32m    P_guess = max(gm1 * (E_approx - 0.5 * B_sq - 0.5 * S_sq / max(E_approx + B_sq, 1.0e-30)), 1.0e-16)[m
2026-02-09T19:17:20.1819332Z      # ξ ≈ τ + D + P_tot - B² ≈ τ + D + P + b²/2 - B² ≈ τ + D + P[m
2026-02-09T19:17:20.1819967Z      xi = E_approx + P_guess[m
2026-02-09T19:17:20.1820385Z  [m
2026-02-09T19:17:20.1821250Z [36m@@ -86,7 +86,7 @@[m [mfunction srmhd_con2prim(eos, u::SVector{8}, tol::Real, maxiter::Int)[m
2026-02-09T19:17:20.1822104Z          v_sq = v_sq_num / v_sq_den[m
2026-02-09T19:17:20.1822533Z  [m
2026-02-09T19:17:20.1822959Z          # Cap v² to prevent superluminal[m
2026-02-09T19:17:20.1823571Z [31m-        v_sq = min(v_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.1824190Z [32m+[m[32m        v_sq = min(v_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.1824783Z          v_sq = max(v_sq, zero(v_sq))[m
2026-02-09T19:17:20.1825240Z  [m
2026-02-09T19:17:20.1825591Z          # Lorentz factor[m
2026-02-09T19:17:20.1826538Z [36m@@ -95,13 +95,13 @@[m [mfunction srmhd_con2prim(eos, u::SVector{8}, tol::Real, maxiter::Int)[m
2026-02-09T19:17:20.1827312Z  [m
2026-02-09T19:17:20.1827673Z          # Recover density[m
2026-02-09T19:17:20.1828117Z          rho = D / W[m
2026-02-09T19:17:20.1828568Z [31m-        rho = max(rho, 1e-12)[m
2026-02-09T19:17:20.1829364Z [32m+[m[32m        rho = max(rho, 1.0e-12)[m
2026-02-09T19:17:20.1829871Z  [m
2026-02-09T19:17:20.1830339Z          # Pressure from ξ = ρhW² with ideal gas EOS[m
2026-02-09T19:17:20.1831015Z          # h = 1 + γ/(γ-1) * P/ρ → ξ = (ρ + γ/(γ-1)*P)*W²[m
2026-02-09T19:17:20.1831648Z          # → P = (γ-1)/γ * (ξ/W² - ρ)[m
2026-02-09T19:17:20.1832210Z          P_val = gm1 / γ * (xi / W_sq - rho)[m
2026-02-09T19:17:20.1832788Z [31m-        P_val = max(P_val, 1e-16)[m
2026-02-09T19:17:20.1833394Z [32m+[m[32m        P_val = max(P_val, 1.0e-16)[m
2026-02-09T19:17:20.1833906Z  [m
2026-02-09T19:17:20.1834275Z          # Magnetic quantities[m
2026-02-09T19:17:20.1834830Z          b_sq = B_sq / W_sq + SdotB_sq / xi^2[m
2026-02-09T19:17:20.1835886Z [36m@@ -117,26 +117,26 @@[m [mfunction srmhd_con2prim(eos, u::SVector{8}, tol::Real, maxiter::Int)[m
2026-02-09T19:17:20.1836697Z          end[m
2026-02-09T19:17:20.1837022Z  [m
2026-02-09T19:17:20.1837394Z          # Numerical derivative[m
2026-02-09T19:17:20.1837956Z [31m-        dxi = max(abs(xi) * 1e-7, 1e-20)[m
2026-02-09T19:17:20.1838631Z [32m+[m[32m        dxi = max(abs(xi) * 1.0e-7, 1.0e-20)[m
2026-02-09T19:17:20.1839383Z          xi_p = xi + dxi[m
2026-02-09T19:17:20.1839763Z  [m
2026-02-09T19:17:20.1840160Z          xi_p_plus_Bsq = xi_p + B_sq[m
2026-02-09T19:17:20.1840830Z          v_sq_p_num = S_sq * xi_p^2 + SdotB_sq * (2 * xi_p + B_sq)[m
2026-02-09T19:17:20.1841525Z          v_sq_p_den = xi_p^2 * xi_p_plus_Bsq^2[m
2026-02-09T19:17:20.1842116Z          v_sq_p = v_sq_p_num / v_sq_p_den[m
2026-02-09T19:17:20.1842692Z [31m-        v_sq_p = min(v_sq_p, 1 - 1e-10)[m
2026-02-09T19:17:20.1843335Z [32m+[m[32m        v_sq_p = min(v_sq_p, 1 - 1.0e-10)[m
2026-02-09T19:17:20.1843976Z          v_sq_p = max(v_sq_p, zero(v_sq_p))[m
2026-02-09T19:17:20.1844525Z          W_sq_p = 1 / (1 - v_sq_p)[m
2026-02-09T19:17:20.1845008Z          W_p = sqrt(W_sq_p)[m
2026-02-09T19:17:20.1845516Z [31m-        rho_p = max(D / W_p, 1e-12)[m
2026-02-09T19:17:20.1846209Z [31m-        P_val_p = max(gm1 / γ * (xi_p / W_sq_p - rho_p), 1e-16)[m
2026-02-09T19:17:20.1847200Z [32m+[m[32m        rho_p = max(D / W_p, 1.0e-12)[m
2026-02-09T19:17:20.1847993Z [32m+[m[32m        P_val_p = max(gm1 / γ * (xi_p / W_sq_p - rho_p), 1.0e-16)[m
2026-02-09T19:17:20.1849094Z          b_sq_p = B_sq / W_sq_p + SdotB_sq / xi_p^2[m
2026-02-09T19:17:20.1849746Z          P_tot_p = P_val_p + 0.5 * b_sq_p[m
2026-02-09T19:17:20.1850354Z          f_val_p = xi_p + B_sq - P_tot_p - tau - D[m
2026-02-09T19:17:20.1850870Z  [m
2026-02-09T19:17:20.1851262Z          df_dxi = (f_val_p - f_val) / dxi[m
2026-02-09T19:17:20.1851725Z  [m
2026-02-09T19:17:20.1852098Z [31m-        if abs(df_dxi) < 1e-30[m
2026-02-09T19:17:20.1852663Z [32m+[m[32m        if abs(df_dxi) < 1.0e-30[m
2026-02-09T19:17:20.1853179Z              break[m
2026-02-09T19:17:20.1853541Z          end[m
2026-02-09T19:17:20.1853864Z  [m
2026-02-09T19:17:20.1854720Z [36m@@ -152,10 +152,10 @@[m [mfunction srmhd_con2prim(eos, u::SVector{8}, tol::Real, maxiter::Int)[m
2026-02-09T19:17:20.1855712Z      vz_val = (Sz + SdotB_over_xi * Bz) / xi_plus_Bsq[m
2026-02-09T19:17:20.1856231Z  [m
2026-02-09T19:17:20.1856643Z      v_sq = vx_val^2 + vy_val^2 + vz_val^2[m
2026-02-09T19:17:20.1857217Z [31m-    v_sq = min(v_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.1857803Z [32m+[m[32m    v_sq = min(v_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.1858348Z      W = 1 / sqrt(1 - v_sq)[m
2026-02-09T19:17:20.1859013Z [31m-    rho = max(D / W, 1e-12)[m
2026-02-09T19:17:20.1859656Z [31m-    P_val = max(gm1 / γ * (xi / W^2 - rho), 1e-16)[m
2026-02-09T19:17:20.1860301Z [32m+[m[32m    rho = max(D / W, 1.0e-12)[m
2026-02-09T19:17:20.1860999Z [32m+[m[32m    P_val = max(gm1 / γ * (xi / W^2 - rho), 1.0e-16)[m
2026-02-09T19:17:20.1861545Z  [m
2026-02-09T19:17:20.1862068Z      w = SVector(rho, vx_val, vy_val, vz_val, P_val, Bx, By, Bz)[m
2026-02-09T19:17:20.1862944Z      result = Con2PrimResult(converged, iterations, residual)[m
2026-02-09T19:17:20.1864146Z [34m[ 70/151] Checking `src/hyperbolic/conservation_laws.jl` ..................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1865506Z [34m[ 71/151] Checking `src/hyperbolic/euler.jl` ................................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1887175Z [34m[ 72/151] Checking `src/hyperbolic/euler_3d.jl` .............................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1978221Z [34m[ 73/151] Checking `src/hyperbolic/grmhd.jl` ................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1995713Z [1mdiff --git a/grmhd.jl b/grmhd.jl[m
2026-02-09T19:17:20.1996162Z [1mindex 5c35619..f309797 100644[m
2026-02-09T19:17:20.1996486Z [1m--- a/grmhd.jl[m
2026-02-09T19:17:20.1996739Z [1m+++ b/grmhd.jl[m
2026-02-09T19:17:20.1997331Z [36m@@ -62,8 +62,10 @@[m [mstruct GRMHDEquations{Dim, EOS <: AbstractEOS, M <: AbstractMetric{Dim}} <: Abst[m
2026-02-09T19:17:20.1998338Z      con2prim_maxiter::Int[m
2026-02-09T19:17:20.1998980Z  end[m
2026-02-09T19:17:20.1999306Z  [m
2026-02-09T19:17:20.1999947Z [31m-function GRMHDEquations{Dim}(eos::EOS, metric::M;[m
2026-02-09T19:17:20.2001167Z [31m-        con2prim_tol = 1e-12, con2prim_maxiter = 50) where {Dim, EOS <: AbstractEOS, M <: AbstractMetric{Dim}}[m
2026-02-09T19:17:20.2002265Z [32m+[m[32mfunction GRMHDEquations{Dim}([m
2026-02-09T19:17:20.2002972Z [32m+[m[32m        eos::EOS, metric::M;[m
2026-02-09T19:17:20.2003670Z [32m+[m[32m        con2prim_tol = 1.0e-12, con2prim_maxiter = 50[m
2026-02-09T19:17:20.2004556Z [32m+[m[32m    ) where {Dim, EOS <: AbstractEOS, M <: AbstractMetric{Dim}}[m
2026-02-09T19:17:20.2005609Z      return GRMHDEquations{Dim, EOS, M}(eos, metric, con2prim_tol, con2prim_maxiter)[m
2026-02-09T19:17:20.2006443Z  end[m
2026-02-09T19:17:20.2006741Z  [m
2026-02-09T19:17:20.2007440Z [36m@@ -246,14 +248,14 @@[m [mUses the same formula as SRMHD (flat-space Lorentz factor).[m
2026-02-09T19:17:20.2008256Z      gamma_eos = law.eos.gamma[m
2026-02-09T19:17:20.2008685Z  [m
2026-02-09T19:17:20.2009230Z      v_sq = vx^2 + vy^2 + vz^2[m
2026-02-09T19:17:20.2009980Z [31m-    v_sq = min(v_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.2010566Z [32m+[m[32m    v_sq = min(v_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.2011036Z  [m
2026-02-09T19:17:20.2011546Z      W = 1 / sqrt(1 - v_sq)[m
2026-02-09T19:17:20.2012049Z      eps_val = P / ((gamma_eos - 1) * rho)[m
2026-02-09T19:17:20.2012573Z      h = 1 + eps_val + P / rho[m
2026-02-09T19:17:20.2012969Z  [m
2026-02-09T19:17:20.2013346Z      cs_sq = gamma_eos * P / (rho * h)[m
2026-02-09T19:17:20.2013899Z [31m-    cs_sq = min(cs_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.2014507Z [32m+[m[32m    cs_sq = min(cs_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.2015004Z  [m
2026-02-09T19:17:20.2015358Z      B_sq = Bx^2 + By^2 + Bz^2[m
2026-02-09T19:17:20.2015867Z      vdotB = vx * Bx + vy * By + vz * Bz[m
2026-02-09T19:17:20.2016726Z [36m@@ -261,10 +263,10 @@[m [mUses the same formula as SRMHD (flat-space Lorentz factor).[m
2026-02-09T19:17:20.2017466Z  [m
2026-02-09T19:17:20.2017802Z      rho_h = rho * h[m
2026-02-09T19:17:20.2018273Z      ca_sq = b_sq / (rho_h + b_sq)[m
2026-02-09T19:17:20.2019023Z [31m-    ca_sq = min(ca_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.2019645Z [32m+[m[32m    ca_sq = min(ca_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.2020142Z  [m
2026-02-09T19:17:20.2020551Z      c_ms_sq = cs_sq + ca_sq - cs_sq * ca_sq[m
2026-02-09T19:17:20.2021249Z [31m-    c_ms_sq = clamp(c_ms_sq, zero(c_ms_sq), 1 - 1e-10)[m
2026-02-09T19:17:20.2022045Z [32m+[m[32m    c_ms_sq = clamp(c_ms_sq, zero(c_ms_sq), 1 - 1.0e-10)[m
2026-02-09T19:17:20.2022716Z      c_ms = sqrt(c_ms_sq)[m
2026-02-09T19:17:20.2023145Z  [m
2026-02-09T19:17:20.2023492Z      vn = dir == 1 ? vx : vy[m
2026-02-09T19:17:20.2024391Z [36m@@ -293,8 +295,10 @@[m [mMaximum wave speed in coordinate frame, accounting for lapse and shift:[m
2026-02-09T19:17:20.2025192Z  [m
2026-02-09T19:17:20.2025639Z  Used for CFL condition in the GRMHD solver.[m
2026-02-09T19:17:20.2026155Z  """[m
2026-02-09T19:17:20.2027054Z [31m-@inline function grmhd_max_wave_speed_coord(law::GRMHDEquations, w::SVector{8}, dir::Int,[m
2026-02-09T19:17:20.2027973Z [31m-        alpha, beta_dir)[m
2026-02-09T19:17:20.2028611Z [32m+[m[32m@inline function grmhd_max_wave_speed_coord([m
2026-02-09T19:17:20.2029680Z [32m+[m[32m        law::GRMHDEquations, w::SVector{8}, dir::Int,[m
2026-02-09T19:17:20.2030359Z [32m+[m[32m        alpha, beta_dir[m
2026-02-09T19:17:20.2030854Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2031373Z      lam_m, lam_p = _grmhd_wave_speeds(law, w, dir)[m
2026-02-09T19:17:20.2032001Z      # Transform to coordinate frame[m
2026-02-09T19:17:20.2032587Z      lam_m_coord = alpha * lam_m - beta_dir[m
2026-02-09T19:17:20.2033611Z [36m@@ -332,9 +336,11 @@[m [mThe source terms are computed using the stress-energy tensor contracted with[m
2026-02-09T19:17:20.2034857Z  metric derivatives (Christoffel symbols). We use centered finite differences[m
2026-02-09T19:17:20.2035682Z  for the metric derivatives.[m
2026-02-09T19:17:20.2036128Z  """[m
2026-02-09T19:17:20.2036888Z [31m-@inline function grmhd_source_terms(law::GRMHDEquations{2}, w::SVector{8},[m
2026-02-09T19:17:20.2037803Z [32m+[m[32m@inline function grmhd_source_terms([m
2026-02-09T19:17:20.2038582Z [32m+[m[32m        law::GRMHDEquations{2}, w::SVector{8},[m
2026-02-09T19:17:20.2039487Z          u_densitized::SVector{8}, md::MetricData2D,[m
2026-02-09T19:17:20.2040268Z [31m-        mesh::StructuredMesh2D, ix::Int, iy::Int)[m
2026-02-09T19:17:20.2041075Z [32m+[m[32m        mesh::StructuredMesh2D, ix::Int, iy::Int[m
2026-02-09T19:17:20.2041668Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2042262Z      rho, vx, vy, vz, P, Bx, By, Bz = w[m
2026-02-09T19:17:20.2042829Z      gamma_eos = law.eos.gamma[m
2026-02-09T19:17:20.2043327Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.2043959Z [36m@@ -465,13 +471,13 @@[m [mfor the metric derivatives.[m
2026-02-09T19:17:20.2044510Z  [m
2026-02-09T19:17:20.2044950Z      # Momentum source for x-direction (j=x):[m
2026-02-09T19:17:20.2045774Z      Sx_src = -E_und * dalpha_dx +[m
2026-02-09T19:17:20.2046422Z [31m-             Sx_und * dbetax_dx + Sy_und * dbetay_dx +[m
2026-02-09T19:17:20.2047412Z [31m-             alp * 0.5 * (Txx * dgxx_dx + 2 * Txy * dgxy_dx + Tyy * dgyy_dx)[m
2026-02-09T19:17:20.2048256Z [32m+[m[32m        Sx_und * dbetax_dx + Sy_und * dbetay_dx +[m
2026-02-09T19:17:20.2049271Z [32m+[m[32m        alp * 0.5 * (Txx * dgxx_dx + 2 * Txy * dgxy_dx + Tyy * dgyy_dx)[m
2026-02-09T19:17:20.2049905Z  [m
2026-02-09T19:17:20.2050351Z      # Momentum source for y-direction (j=y):[m
2026-02-09T19:17:20.2050944Z      Sy_src = -E_und * dalpha_dy +[m
2026-02-09T19:17:20.2051576Z [31m-             Sx_und * dbetax_dy + Sy_und * dbetay_dy +[m
2026-02-09T19:17:20.2052388Z [31m-             alp * 0.5 * (Txx * dgxx_dy + 2 * Txy * dgxy_dy + Tyy * dgyy_dy)[m
2026-02-09T19:17:20.2053215Z [32m+[m[32m        Sx_und * dbetax_dy + Sy_und * dbetay_dy +[m
2026-02-09T19:17:20.2054077Z [32m+[m[32m        alp * 0.5 * (Txx * dgxx_dy + 2 * Txy * dgxy_dy + Tyy * dgyy_dy)[m
2026-02-09T19:17:20.2054724Z  [m
2026-02-09T19:17:20.2055475Z      # ---- Energy source: S_tau = sqrt(gamma) * [-S_j partial^j alpha + alpha T^kl K_kl] ----[m
2026-02-09T19:17:20.2056613Z      # Approximate: K_ij ~ (partial_i beta_j_low + partial_j beta_i_low) / (2 alpha)[m
2026-02-09T19:17:20.2057529Z [36m@@ -499,7 +505,9 @@[m [mfor the metric derivatives.[m
2026-02-09T19:17:20.2058139Z      Sz_src = zero(Sx_src)[m
2026-02-09T19:17:20.2058538Z  [m
2026-02-09T19:17:20.2059251Z      # Multiply by sqrt(gamma) for the densitized source[m
2026-02-09T19:17:20.2059926Z [31m-    return SVector(zero(Sx_src),[m
2026-02-09T19:17:20.2060473Z [32m+[m[32m    return SVector([m
2026-02-09T19:17:20.2060975Z [32m+[m[32m        zero(Sx_src),[m
2026-02-09T19:17:20.2061605Z          sg * Sx_src, sg * Sy_src, sg * Sz_src, sg * tau_src,[m
2026-02-09T19:17:20.2062317Z [31m-        zero(Sx_src), zero(Sx_src), zero(Sx_src))[m
2026-02-09T19:17:20.2063061Z [32m+[m[32m        zero(Sx_src), zero(Sx_src), zero(Sx_src)[m
2026-02-09T19:17:20.2063653Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2064012Z  end[m
2026-02-09T19:17:20.2094618Z [34m[ 74/151] Checking `src/hyperbolic/grmhd_con2prim.jl` ........................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.2109711Z [1mdiff --git a/grmhd_con2prim.jl b/grmhd_con2prim.jl[m
2026-02-09T19:17:20.2110423Z [1mindex 0c4a2f4..d061ee5 100644[m
2026-02-09T19:17:20.2110853Z [1m--- a/grmhd_con2prim.jl[m
2026-02-09T19:17:20.2111182Z [1m+++ b/grmhd_con2prim.jl[m
2026-02-09T19:17:20.2111691Z [36m@@ -53,12 +53,16 @@[m [mend[m
2026-02-09T19:17:20.2112496Z  Metric-aware con2prim using precomputed (cached) metric quantities.[m
2026-02-09T19:17:20.2113388Z  This is the fast path used in the solver loop.[m
2026-02-09T19:17:20.2113950Z  """[m
2026-02-09T19:17:20.2114808Z [31m-@inline function grmhd_con2prim_cached(law::GRMHDEquations, u_tilde::SVector{8},[m
2026-02-09T19:17:20.2115795Z [31m-        sg, gixx, gixy, giyy, gxx, gxy, gyy)[m
2026-02-09T19:17:20.2116541Z [32m+[m[32m@inline function grmhd_con2prim_cached([m
2026-02-09T19:17:20.2117395Z [32m+[m[32m        law::GRMHDEquations, u_tilde::SVector{8},[m
2026-02-09T19:17:20.2118239Z [32m+[m[32m        sg, gixx, gixy, giyy, gxx, gxy, gyy[m
2026-02-09T19:17:20.2119020Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2119635Z      gi = StaticArrays.SMatrix{2, 2}(gixx, gixy, gixy, giyy)[m
2026-02-09T19:17:20.2120407Z      gm = StaticArrays.SMatrix{2, 2}(gxx, gxy, gxy, gyy)[m
2026-02-09T19:17:20.2121289Z [31m-    return _grmhd_con2prim_with_metric(law.eos, u_tilde, sg, gi, gm,[m
2026-02-09T19:17:20.2122126Z [31m-        law.con2prim_tol, law.con2prim_maxiter)[m
2026-02-09T19:17:20.2122832Z [32m+[m[32m    return _grmhd_con2prim_with_metric([m
2026-02-09T19:17:20.2123500Z [32m+[m[32m        law.eos, u_tilde, sg, gi, gm,[m
2026-02-09T19:17:20.2124207Z [32m+[m[32m        law.con2prim_tol, law.con2prim_maxiter[m
2026-02-09T19:17:20.2125067Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2125434Z  end[m
2026-02-09T19:17:20.2125748Z  [m
2026-02-09T19:17:20.2126052Z  """[m
2026-02-09T19:17:20.2126840Z [36m@@ -76,9 +80,11 @@[m [mInternal metric-aware con2prim implementation.[m
2026-02-09T19:17:20.2127599Z  - `tol`: Convergence tolerance.[m
2026-02-09T19:17:20.2128156Z  - `maxiter`: Maximum iterations.[m
2026-02-09T19:17:20.2128594Z  """[m
2026-02-09T19:17:20.2129595Z [31m-function _grmhd_con2prim_with_metric(eos, u_tilde::SVector{8}, sg,[m
2026-02-09T19:17:20.2130435Z [32m+[m[32mfunction _grmhd_con2prim_with_metric([m
2026-02-09T19:17:20.2131134Z [32m+[m[32m        eos, u_tilde::SVector{8}, sg,[m
2026-02-09T19:17:20.2131948Z          gi::StaticArrays.SMatrix{2, 2}, gm::StaticArrays.SMatrix{2, 2},[m
2026-02-09T19:17:20.2132737Z [31m-        tol::Real, maxiter::Int)[m
2026-02-09T19:17:20.2133385Z [32m+[m[32m        tol::Real, maxiter::Int[m
2026-02-09T19:17:20.2133903Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2134340Z      gamma_eos = eos.gamma[m
2026-02-09T19:17:20.2134810Z      gm1 = gamma_eos - 1[m
2026-02-09T19:17:20.2135200Z  [m
2026-02-09T19:17:20.2136034Z [36m@@ -94,7 +100,7 @@[m [mfunction _grmhd_con2prim_with_metric(eos, u_tilde::SVector{8}, sg,[m
2026-02-09T19:17:20.2136867Z      Bz = u_tilde[8] * inv_sg[m
2026-02-09T19:17:20.2137278Z  [m
2026-02-09T19:17:20.2137650Z      # Floor conserved density[m
2026-02-09T19:17:20.2138143Z [31m-    D = max(D, 1e-12)[m
2026-02-09T19:17:20.2138635Z [32m+[m[32m    D = max(D, 1.0e-12)[m
2026-02-09T19:17:20.2139246Z  [m
2026-02-09T19:17:20.2139865Z      # Compute S^2 = gamma^ij S_i S_j (raised with inverse spatial metric)[m
2026-02-09T19:17:20.2140764Z      # In 2D: S^2 = gi[1,1]*Sx^2 + 2*gi[1,2]*Sx*Sy + gi[2,2]*Sy^2 + Sz^2[m
2026-02-09T19:17:20.2141883Z [36m@@ -116,7 +122,7 @@[m [mfunction _grmhd_con2prim_with_metric(eos, u_tilde::SVector{8}, sg,[m
2026-02-09T19:17:20.2142940Z      # Initial guess: ξ ≈ τ + D + P_guess (non-relativistic estimate)[m
2026-02-09T19:17:20.2143654Z      SdotB_sq = SdotB^2[m
2026-02-09T19:17:20.2144096Z      E_approx = tau + D[m
2026-02-09T19:17:20.2144957Z [31m-    P_guess = max(gm1 * (E_approx - 0.5 * B_sq - 0.5 * S_sq / max(E_approx + B_sq, 1e-30)), 1e-16)[m
2026-02-09T19:17:20.2146215Z [32m+[m[32m    P_guess = max(gm1 * (E_approx - 0.5 * B_sq - 0.5 * S_sq / max(E_approx + B_sq, 1.0e-30)), 1.0e-16)[m
2026-02-09T19:17:20.2147087Z      xi = E_approx + P_guess[m
2026-02-09T19:17:20.2147498Z  [m
2026-02-09T19:17:20.2147842Z      FT = typeof(xi)[m
2026-02-09T19:17:20.2148911Z [36m@@ -133,13 +139,13 @@[m [mfunction _grmhd_con2prim_with_metric(eos, u_tilde::SVector{8}, sg,[m
2026-02-09T19:17:20.2149867Z          # v^2 from momentum (metric-corrected S^2)[m
2026-02-09T19:17:20.2150553Z          # v² = [S²ξ² + (S·B)²(2ξ + B²)] / [ξ²(ξ + B²)²][m
2026-02-09T19:17:20.2151364Z          v_sq = (S_sq + SdotB_over_xi * SdotB * (2 + B_sq / xi)) / (xi_plus_Bsq^2)[m
2026-02-09T19:17:20.2152198Z [31m-        v_sq = clamp(v_sq, zero(v_sq), 1 - 1e-10)[m
2026-02-09T19:17:20.2152945Z [32m+[m[32m        v_sq = clamp(v_sq, zero(v_sq), 1 - 1.0e-10)[m
2026-02-09T19:17:20.2153513Z  [m
2026-02-09T19:17:20.2153872Z          W_sq = 1 / (1 - v_sq)[m
2026-02-09T19:17:20.2154337Z          W = sqrt(W_sq)[m
2026-02-09T19:17:20.2154722Z  [m
2026-02-09T19:17:20.2155092Z [31m-        rho = max(D / W, 1e-12)[m
2026-02-09T19:17:20.2155780Z [31m-        P_val = max(gm1 / gamma_eos * (xi / W_sq - rho), 1e-16)[m
2026-02-09T19:17:20.2156512Z [32m+[m[32m        rho = max(D / W, 1.0e-12)[m
2026-02-09T19:17:20.2157288Z [32m+[m[32m        P_val = max(gm1 / gamma_eos * (xi / W_sq - rho), 1.0e-16)[m
2026-02-09T19:17:20.2157920Z  [m
2026-02-09T19:17:20.2158363Z          # Magnetic pressure in comoving frame[m
2026-02-09T19:17:20.2159213Z          b_sq_iter = B_sq / W_sq + SdotB^2 / xi^2[m
2026-02-09T19:17:20.2160392Z [36m@@ -155,22 +161,22 @@[m [mfunction _grmhd_con2prim_with_metric(eos, u_tilde::SVector{8}, sg,[m
2026-02-09T19:17:20.2161667Z          end[m
2026-02-09T19:17:20.2162089Z  [m
2026-02-09T19:17:20.2162689Z          # Numerical derivative[m
2026-02-09T19:17:20.2163432Z [31m-        dxi = max(abs(xi) * 1e-7, 1e-20)[m
2026-02-09T19:17:20.2164358Z [32m+[m[32m        dxi = max(abs(xi) * 1.0e-7, 1.0e-20)[m
2026-02-09T19:17:20.2165156Z          xi_p = xi + dxi[m
2026-02-09T19:17:20.2165776Z  [m
2026-02-09T19:17:20.2177914Z          SdotB_over_xi_p = SdotB / xi_p[m
2026-02-09T19:17:20.2179049Z          v_sq_p = (S_sq + SdotB_over_xi_p * SdotB * (2 + B_sq / xi_p)) / ((xi_p + B_sq)^2)[m
2026-02-09T19:17:20.2179984Z [31m-        v_sq_p = clamp(v_sq_p, zero(v_sq_p), 1 - 1e-10)[m
2026-02-09T19:17:20.2180790Z [32m+[m[32m        v_sq_p = clamp(v_sq_p, zero(v_sq_p), 1 - 1.0e-10)[m
2026-02-09T19:17:20.2181474Z          W_sq_p = 1 / (1 - v_sq_p)[m
2026-02-09T19:17:20.2181974Z          W_p = sqrt(W_sq_p)[m
2026-02-09T19:17:20.2182491Z [31m-        rho_p = max(D / W_p, 1e-12)[m
2026-02-09T19:17:20.2183253Z [31m-        P_val_p = max(gm1 / gamma_eos * (xi_p / W_sq_p - rho_p), 1e-16)[m
2026-02-09T19:17:20.2184047Z [32m+[m[32m        rho_p = max(D / W_p, 1.0e-12)[m
2026-02-09T19:17:20.2184896Z [32m+[m[32m        P_val_p = max(gm1 / gamma_eos * (xi_p / W_sq_p - rho_p), 1.0e-16)[m
2026-02-09T19:17:20.2185712Z          b_sq_p = B_sq / W_sq_p + SdotB^2 / xi_p^2[m
2026-02-09T19:17:20.2186317Z          P_tot_p = P_val_p + 0.5 * b_sq_p[m
2026-02-09T19:17:20.2186920Z          f_val_p = xi_p + B_sq - P_tot_p - tau - D[m
2026-02-09T19:17:20.2187426Z  [m
2026-02-09T19:17:20.2187836Z          df_dxi = (f_val_p - f_val) / dxi[m
2026-02-09T19:17:20.2188370Z [31m-        if abs(df_dxi) < 1e-30[m
2026-02-09T19:17:20.2189153Z [32m+[m[32m        if abs(df_dxi) < 1.0e-30[m
2026-02-09T19:17:20.2189677Z              break[m
2026-02-09T19:17:20.2190050Z          end[m
2026-02-09T19:17:20.2190369Z  [m
2026-02-09T19:17:20.2191264Z [36m@@ -209,10 +215,10 @@[m [mfunction _grmhd_con2prim_with_metric(eos, u_tilde::SVector{8}, sg,[m
2026-02-09T19:17:20.2192065Z  [m
2026-02-09T19:17:20.2192505Z      # Compute proper v^2 = gamma_ij v^i v^j[m
2026-02-09T19:17:20.2193359Z      v_sq = gm[1, 1] * vx_val^2 + 2 * gm[1, 2] * vx_val * vy_val + gm[2, 2] * vy_val^2 + vz_val^2[m
2026-02-09T19:17:20.2194134Z [31m-    v_sq = min(v_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.2194721Z [32m+[m[32m    v_sq = min(v_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.2195270Z      W = 1 / sqrt(1 - v_sq)[m
2026-02-09T19:17:20.2195751Z [31m-    rho = max(D / W, 1e-12)[m
2026-02-09T19:17:20.2196409Z [31m-    P_val = max(gm1 / gamma_eos * (xi / W^2 - rho), 1e-16)[m
2026-02-09T19:17:20.2197105Z [32m+[m[32m    rho = max(D / W, 1.0e-12)[m
2026-02-09T19:17:20.2197830Z [32m+[m[32m    P_val = max(gm1 / gamma_eos * (xi / W^2 - rho), 1.0e-16)[m
2026-02-09T19:17:20.2198454Z  [m
2026-02-09T19:17:20.2199162Z      w = SVector(rho, vx_val, vy_val, vz_val, P_val, Bx, By, Bz)[m
2026-02-09T19:17:20.2200036Z      result = Con2PrimResult(converged, iterations, residual)[m
2026-02-09T19:17:20.2200734Z [36m@@ -239,8 +245,10 @@[m [mend[m
2026-02-09T19:17:20.2201159Z  [m
2026-02-09T19:17:20.2201828Z  Convert primitive to densitized conserved using precomputed metric data.[m
2026-02-09T19:17:20.2202569Z  """[m
2026-02-09T19:17:20.2203455Z [31m-@inline function grmhd_prim2con_densitized_cached(law::GRMHDEquations, w::SVector{8},[m
2026-02-09T19:17:20.2204343Z [31m-        sg, gxx, gxy, gyy)[m
2026-02-09T19:17:20.2205028Z [32m+[m[32m@inline function grmhd_prim2con_densitized_cached([m
2026-02-09T19:17:20.2205881Z [32m+[m[32m        law::GRMHDEquations, w::SVector{8},[m
2026-02-09T19:17:20.2206507Z [32m+[m[32m        sg, gxx, gxy, gyy[m
2026-02-09T19:17:20.2206996Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2207549Z      gm = StaticArrays.SMatrix{2, 2}(gxx, gxy, gxy, gyy)[m
2026-02-09T19:17:20.2208333Z      return _grmhd_prim2con_densitized(law.eos, w, sg, gm)[m
2026-02-09T19:17:20.2209072Z  end[m
2026-02-09T19:17:20.2209913Z [36m@@ -253,14 +261,16 @@[m [mInternal: compute densitized conserved from primitives with metric data.[m
2026-02-09T19:17:20.2211334Z  The Lorentz factor uses v^2 = gamma_ij v^i v^j, and the momentum S_j[m
2026-02-09T19:17:20.2212280Z  is covariant (lowered with gamma_ij).[m
2026-02-09T19:17:20.2212790Z  """[m
2026-02-09T19:17:20.2213500Z [31m-@inline function _grmhd_prim2con_densitized(eos, w::SVector{8}, sg,[m
2026-02-09T19:17:20.2214375Z [31m-        gm::StaticArrays.SMatrix{2, 2})[m
2026-02-09T19:17:20.2215092Z [32m+[m[32m@inline function _grmhd_prim2con_densitized([m
2026-02-09T19:17:20.2215830Z [32m+[m[32m        eos, w::SVector{8}, sg,[m
2026-02-09T19:17:20.2216525Z [32m+[m[32m        gm::StaticArrays.SMatrix{2, 2}[m
2026-02-09T19:17:20.2217088Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2217533Z      rho, vx, vy, vz, P, Bx, By, Bz = w[m
2026-02-09T19:17:20.2218140Z      gamma_eos = eos.gamma[m
2026-02-09T19:17:20.2218554Z  [m
2026-02-09T19:17:20.2219154Z      # v^2 = gamma_ij v^i v^j (metric-corrected)[m
2026-02-09T19:17:20.2219915Z      v_sq = gm[1, 1] * vx^2 + 2 * gm[1, 2] * vx * vy + gm[2, 2] * vy^2 + vz^2[m
2026-02-09T19:17:20.2220569Z [31m-    v_sq = min(v_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.2221155Z [32m+[m[32m    v_sq = min(v_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.2221640Z  [m
2026-02-09T19:17:20.2222004Z      W = 1 / sqrt(1 - v_sq)[m
2026-02-09T19:17:20.2222427Z      W_sq = W^2[m
2026-02-09T19:17:20.2223007Z [36m@@ -304,6 +314,8 @@[m [mis covariant (lowered with gamma_ij).[m
2026-02-09T19:17:20.2223717Z      tau = rho_h_W2 + B_sq - Ptot - D[m
2026-02-09T19:17:20.2224178Z  [m
2026-02-09T19:17:20.2224599Z      # Densitize: multiply by sqrt(gamma)[m
2026-02-09T19:17:20.2225321Z [31m-    return SVector(sg * D, sg * Sx_c, sg * Sy_c, sg * Sz_c,[m
2026-02-09T19:17:20.2226054Z [31m-        sg * tau, sg * Bx, sg * By, sg * Bz)[m
2026-02-09T19:17:20.2226618Z [32m+[m[32m    return SVector([m
2026-02-09T19:17:20.2227240Z [32m+[m[32m        sg * D, sg * Sx_c, sg * Sy_c, sg * Sz_c,[m
2026-02-09T19:17:20.2227945Z [32m+[m[32m        sg * tau, sg * Bx, sg * By, sg * Bz[m
2026-02-09T19:17:20.2228499Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2229006Z  end[m
2026-02-09T19:17:20.2274622Z [34m[ 75/151] Checking `src/hyperbolic/grmhd_solve_2d.jl` ........................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.2290766Z [1mdiff --git a/grmhd_solve_2d.jl b/grmhd_solve_2d.jl[m
2026-02-09T19:17:20.2291385Z [1mindex 31156f9..66e9795 100644[m
2026-02-09T19:17:20.2291732Z [1m--- a/grmhd_solve_2d.jl[m
2026-02-09T19:17:20.2292113Z [1m+++ b/grmhd_solve_2d.jl[m
2026-02-09T19:17:20.2292618Z [36m@@ -76,8 +76,10 @@[m [mend[m
2026-02-09T19:17:20.2293331Z  Compute the time step using metric-corrected wave speeds:[m
2026-02-09T19:17:20.2294123Z    `lambda_coord = alpha * lambda_flat - beta`[m
2026-02-09T19:17:20.2294667Z  """[m
2026-02-09T19:17:20.2295457Z [31m-function compute_dt_2d(prob::HyperbolicProblem2D{<:GRMHDEquations{2}},[m
2026-02-09T19:17:20.2296492Z [31m-        U::AbstractMatrix, t, md::MetricData2D)[m
2026-02-09T19:17:20.2297169Z [32m+[m[32mfunction compute_dt_2d([m
2026-02-09T19:17:20.2297960Z [32m+[m[32m        prob::HyperbolicProblem2D{<:GRMHDEquations{2}},[m
2026-02-09T19:17:20.2299095Z [32m+[m[32m        U::AbstractMatrix, t, md::MetricData2D[m
2026-02-09T19:17:20.2299719Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2300147Z      law = prob.law[m
2026-02-09T19:17:20.2300559Z      mesh = prob.mesh[m
2026-02-09T19:17:20.2301019Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.2301689Z [36m@@ -129,7 +131,8 @@[m [mfunction _grmhd_compute_fluxes_2d!([m
2026-02-09T19:17:20.2302466Z          Fx_all::AbstractMatrix, Fy_all::AbstractMatrix,[m
2026-02-09T19:17:20.2303174Z          dU::AbstractMatrix, U::AbstractMatrix,[m
2026-02-09T19:17:20.2303919Z          prob::HyperbolicProblem2D{<:GRMHDEquations{2}}, t,[m
2026-02-09T19:17:20.2304700Z [31m-        md::MetricData2D, face_data)[m
2026-02-09T19:17:20.2305380Z [32m+[m[32m        md::MetricData2D, face_data[m
2026-02-09T19:17:20.2306181Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2306583Z      law = prob.law[m
2026-02-09T19:17:20.2306996Z      mesh = prob.mesh[m
2026-02-09T19:17:20.2307457Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.2308122Z [36m@@ -226,9 +229,11 @@[m [mend[m
2026-02-09T19:17:20.2308560Z  [m
2026-02-09T19:17:20.2309291Z  Add geometric source terms to dU at all interior cells.[m
2026-02-09T19:17:20.2309892Z  """[m
2026-02-09T19:17:20.2310655Z [31m-function _grmhd_add_source_terms!(dU::AbstractMatrix, U::AbstractMatrix,[m
2026-02-09T19:17:20.2311538Z [32m+[m[32mfunction _grmhd_add_source_terms!([m
2026-02-09T19:17:20.2312318Z [32m+[m[32m        dU::AbstractMatrix, U::AbstractMatrix,[m
2026-02-09T19:17:20.2313052Z          law::GRMHDEquations{2}, md::MetricData2D,[m
2026-02-09T19:17:20.2313791Z [31m-        mesh::StructuredMesh2D, nx::Int, ny::Int)[m
2026-02-09T19:17:20.2314588Z [32m+[m[32m        mesh::StructuredMesh2D, nx::Int, ny::Int[m
2026-02-09T19:17:20.2315187Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2315625Z      for iy in 1:ny, ix in 1:nx[m
2026-02-09T19:17:20.2316112Z          ii, jj = ix + 2, iy + 2[m
2026-02-09T19:17:20.2316697Z          w = conserved_to_primitive(law, U[ii, jj])[m
2026-02-09T19:17:20.2317639Z [36m@@ -258,8 +263,10 @@[m [mSolve the 2D GRMHD problem using the Valencia formulation with:[m
2026-02-09T19:17:20.2318501Z  - `t_final`: Final time reached.[m
2026-02-09T19:17:20.2319487Z  - `ct`: Final `CTData2D` for inspecting div(B) and face-centered B.[m
2026-02-09T19:17:20.2320132Z  """[m
2026-02-09T19:17:20.2320926Z [31m-function solve_hyperbolic(prob::HyperbolicProblem2D{<:GRMHDEquations{2}};[m
2026-02-09T19:17:20.2321987Z [31m-        method::Symbol = :ssprk3, vector_potential = nothing)[m
2026-02-09T19:17:20.2322714Z [32m+[m[32mfunction solve_hyperbolic([m
2026-02-09T19:17:20.2323503Z [32m+[m[32m        prob::HyperbolicProblem2D{<:GRMHDEquations{2}};[m
2026-02-09T19:17:20.2324444Z [32m+[m[32m        method::Symbol = :ssprk3, vector_potential = nothing[m
2026-02-09T19:17:20.2325122Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2325530Z      mesh = prob.mesh[m
2026-02-09T19:17:20.2325995Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.2326500Z      dx, dy = mesh.dx, mesh.dy[m
2026-02-09T19:17:20.2348489Z [34m[ 76/151] Checking `src/hyperbolic/hllc_solver.jl` ........................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.2362650Z [1mdiff --git a/hllc_solver.jl b/hllc_solver.jl[m
2026-02-09T19:17:20.2363108Z [1mindex abe8f09..ce7bb20 100644[m
2026-02-09T19:17:20.2363442Z [1m--- a/hllc_solver.jl[m
2026-02-09T19:17:20.2363734Z [1m+++ b/hllc_solver.jl[m
2026-02-09T19:17:20.2364625Z [36m@@ -47,7 +47,7 @@[m [mfunction solve_riemann(::HLLCSolver, law::EulerEquations{1}, wL::SVector{3}, wR:[m
2026-02-09T19:17:20.2365510Z  [m
2026-02-09T19:17:20.2365898Z      # Contact wave speed[m
2026-02-09T19:17:20.2366568Z      S_star = (PR - PL + ρL * vL * (SL - vL) - ρR * vR * (SR - vR)) /[m
2026-02-09T19:17:20.2367359Z [31m-             (ρL * (SL - vL) - ρR * (SR - vR))[m
2026-02-09T19:17:20.2368036Z [32m+[m[32m        (ρL * (SL - vL) - ρR * (SR - vR))[m
2026-02-09T19:17:20.2368582Z  [m
2026-02-09T19:17:20.2369199Z      if SL >= zero(SL)[m
2026-02-09T19:17:20.2369652Z          # Left of all waves[m
2026-02-09T19:17:20.2370478Z [36m@@ -78,7 +78,7 @@[m [mIf P_star > P_K (shock), q > 1; if P_star ≤ P_K (rarefaction), q = 1.[m
2026-02-09T19:17:20.2371259Z      if P_star <= P_K[m
2026-02-09T19:17:20.2371714Z          return one(P_star)[m
2026-02-09T19:17:20.2372133Z      else[m
2026-02-09T19:17:20.2372559Z [31m-        P_K_safe = max(P_K, 1e-30)[m
2026-02-09T19:17:20.2373176Z [32m+[m[32m        P_K_safe = max(P_K, 1.0e-30)[m
2026-02-09T19:17:20.2373910Z          arg = one(P_star) + (γ + 1) / (2γ) * (P_star / P_K_safe - 1)[m
2026-02-09T19:17:20.2374606Z          return sqrt(max(arg, one(P_star)))[m
2026-02-09T19:17:20.2375096Z      end[m
2026-02-09T19:17:20.2376064Z [36m@@ -140,7 +140,7 @@[m [mfunction solve_riemann(::HLLCSolver, law::EulerEquations{2}, wL::SVector{4}, wR:[m
2026-02-09T19:17:20.2377149Z  [m
2026-02-09T19:17:20.2377503Z      # Contact wave speed[m
2026-02-09T19:17:20.2378301Z      S_star = (PR - PL + ρL * vnL * (SL - vnL) - ρR * vnR * (SR - vnR)) /[m
2026-02-09T19:17:20.2379261Z [31m-             (ρL * (SL - vnL) - ρR * (SR - vnR))[m
2026-02-09T19:17:20.2379938Z [32m+[m[32m        (ρL * (SL - vnL) - ρR * (SR - vnR))[m
2026-02-09T19:17:20.2380468Z  [m
2026-02-09T19:17:20.2380819Z      if SL >= zero(SL)[m
2026-02-09T19:17:20.2381321Z          return physical_flux(law, wL, dir)[m
2026-02-09T19:17:20.2432384Z [34m[ 77/151] Checking `src/hyperbolic/hlld_solver.jl` ........................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.2446784Z [1mdiff --git a/hlld_solver.jl b/hlld_solver.jl[m
2026-02-09T19:17:20.2447236Z [1mindex 699c3bd..f85a974 100644[m
2026-02-09T19:17:20.2447573Z [1m--- a/hlld_solver.jl[m
2026-02-09T19:17:20.2447873Z [1m+++ b/hlld_solver.jl[m
2026-02-09T19:17:20.2448988Z [36m@@ -85,8 +85,8 @@[m [mfunction solve_riemann(::HLLDSolver, law::IdealMHDEquations, wL::SVector{8}, wR:[m
2026-02-09T19:17:20.2450033Z      ρR_star = ρR * (SR - vnR) / (SR - SM)[m
2026-02-09T19:17:20.2450544Z  [m
2026-02-09T19:17:20.2450975Z      # Guard against negative densities[m
2026-02-09T19:17:20.2451578Z [31m-    ρL_star = max(ρL_star, 1e-20)[m
2026-02-09T19:17:20.2452222Z [31m-    ρR_star = max(ρR_star, 1e-20)[m
2026-02-09T19:17:20.2452882Z [32m+[m[32m    ρL_star = max(ρL_star, 1.0e-20)[m
2026-02-09T19:17:20.2453553Z [32m+[m[32m    ρR_star = max(ρR_star, 1.0e-20)[m
2026-02-09T19:17:20.2454067Z  [m
2026-02-09T19:17:20.2454521Z      # Star tangential velocities and B-fields[m
2026-02-09T19:17:20.2455347Z      vt1L_star, vt2L_star, Bt1L_star, Bt2L_star = _hlld_tangential_star([m
2026-02-09T19:17:20.2456687Z [36m@@ -118,7 +118,7 @@[m [mfunction solve_riemann(::HLLDSolver, law::IdealMHDEquations, wL::SVector{8}, wR:[m
2026-02-09T19:17:20.2457708Z      SL_star = SM - abs_Bn / sqrt_ρL_star[m
2026-02-09T19:17:20.2458297Z      SR_star = SM + abs_Bn / sqrt_ρR_star[m
2026-02-09T19:17:20.2459033Z  [m
2026-02-09T19:17:20.2459441Z [31m-    if SM >= zero(SM)[m
2026-02-09T19:17:20.2459989Z [32m+[m[32m    return if SM >= zero(SM)[m
2026-02-09T19:17:20.2460529Z          # Left side of contact[m
2026-02-09T19:17:20.2461086Z          fL_star = fL + SL * (uL_star - uL)[m
2026-02-09T19:17:20.2461645Z          if SL_star >= zero(SL_star)[m
2026-02-09T19:17:20.2462397Z [36m@@ -170,7 +170,7 @@[m [mFrom Miyoshi & Kusano (2005), eqs (44)-(47).[m
2026-02-09T19:17:20.2463025Z  [m
2026-02-09T19:17:20.2463415Z      # Scale for tolerance check[m
2026-02-09T19:17:20.2464130Z      scale = max(abs(ρ * (SK - vn) * (SK - SM)), Bn_sq, eps(typeof(vn)))[m
2026-02-09T19:17:20.2464866Z [31m-    if abs(denom) > 1e-8 * scale[m
2026-02-09T19:17:20.2465460Z [32m+[m[32m    if abs(denom) > 1.0e-8 * scale[m
2026-02-09T19:17:20.2466113Z          factor_v = sqrt(Bn_sq) * (SM - vn) / denom[m
2026-02-09T19:17:20.2466804Z          factor_B = (ρ * (SK - vn)^2 - Bn_sq) / denom[m
2026-02-09T19:17:20.2467314Z  [m
2026-02-09T19:17:20.2467894Z [36m@@ -225,7 +225,7 @@[m [mFrom Miyoshi & Kusano (2005), eqs (59)-(63).[m
2026-02-09T19:17:20.2468519Z      )[m
2026-02-09T19:17:20.2469099Z      denom = sqrt_ρL + sqrt_ρR[m
2026-02-09T19:17:20.2469546Z  [m
2026-02-09T19:17:20.2469903Z [31m-    if denom < 1e-30[m
2026-02-09T19:17:20.2470394Z [32m+[m[32m    if denom < 1.0e-30[m
2026-02-09T19:17:20.2471115Z          # Both densities effectively zero — return star state as-is[m
2026-02-09T19:17:20.2471889Z          ρ_ds = side == :left ? ρL_star : ρR_star[m
2026-02-09T19:17:20.2472568Z          vt1_ds = side == :left ? vt1L_star : vt1R_star[m
2026-02-09T19:17:20.2473410Z [36m@@ -238,16 +238,24 @@[m [mFrom Miyoshi & Kusano (2005), eqs (59)-(63).[m
2026-02-09T19:17:20.2474196Z      sign_Bn = Bn >= zero(Bn) ? one(Bn) : -one(Bn)[m
2026-02-09T19:17:20.2474693Z  [m
2026-02-09T19:17:20.2475422Z      # Averaged tangential velocities (eq 59-60)[m
2026-02-09T19:17:20.2476180Z [31m-    vt1_ds = (sqrt_ρL * vt1L_star + sqrt_ρR * vt1R_star +[m
2026-02-09T19:17:20.2477135Z [31m-              (Bt1R_star - Bt1L_star) * sign_Bn) / denom[m
2026-02-09T19:17:20.2477913Z [31m-    vt2_ds = (sqrt_ρL * vt2L_star + sqrt_ρR * vt2R_star +[m
2026-02-09T19:17:20.2478675Z [31m-              (Bt2R_star - Bt2L_star) * sign_Bn) / denom[m
2026-02-09T19:17:20.2479524Z [32m+[m[32m    vt1_ds = ([m
2026-02-09T19:17:20.2480145Z [32m+[m[32m        sqrt_ρL * vt1L_star + sqrt_ρR * vt1R_star +[m
2026-02-09T19:17:20.2480905Z [32m+[m[32m            (Bt1R_star - Bt1L_star) * sign_Bn[m
2026-02-09T19:17:20.2481485Z [32m+[m[32m    ) / denom[m
2026-02-09T19:17:20.2481933Z [32m+[m[32m    vt2_ds = ([m
2026-02-09T19:17:20.2482530Z [32m+[m[32m        sqrt_ρL * vt2L_star + sqrt_ρR * vt2R_star +[m
2026-02-09T19:17:20.2483274Z [32m+[m[32m            (Bt2R_star - Bt2L_star) * sign_Bn[m
2026-02-09T19:17:20.2483870Z [32m+[m[32m    ) / denom[m
2026-02-09T19:17:20.2484307Z  [m
2026-02-09T19:17:20.2484788Z      # Averaged tangential B-fields (eq 61-62)[m
2026-02-09T19:17:20.2485573Z [31m-    Bt1_ds = (sqrt_ρL * Bt1R_star + sqrt_ρR * Bt1L_star +[m
2026-02-09T19:17:20.2486464Z [31m-              sqrt_ρL * sqrt_ρR * (vt1R_star - vt1L_star) * sign_Bn) / denom[m
2026-02-09T19:17:20.2487328Z [31m-    Bt2_ds = (sqrt_ρL * Bt2R_star + sqrt_ρR * Bt2L_star +[m
2026-02-09T19:17:20.2488193Z [31m-              sqrt_ρL * sqrt_ρR * (vt2R_star - vt2L_star) * sign_Bn) / denom[m
2026-02-09T19:17:20.2489077Z [32m+[m[32m    Bt1_ds = ([m
2026-02-09T19:17:20.2489721Z [32m+[m[32m        sqrt_ρL * Bt1R_star + sqrt_ρR * Bt1L_star +[m
2026-02-09T19:17:20.2490579Z [32m+[m[32m            sqrt_ρL * sqrt_ρR * (vt1R_star - vt1L_star) * sign_Bn[m
2026-02-09T19:17:20.2491255Z [32m+[m[32m    ) / denom[m
2026-02-09T19:17:20.2491690Z [32m+[m[32m    Bt2_ds = ([m
2026-02-09T19:17:20.2492274Z [32m+[m[32m        sqrt_ρL * Bt2R_star + sqrt_ρR * Bt2L_star +[m
2026-02-09T19:17:20.2493106Z [32m+[m[32m            sqrt_ρL * sqrt_ρR * (vt2R_star - vt2L_star) * sign_Bn[m
2026-02-09T19:17:20.2493801Z [32m+[m[32m    ) / denom[m
2026-02-09T19:17:20.2494208Z  [m
2026-02-09T19:17:20.2494586Z      # Energy update (eq 63)[m
2026-02-09T19:17:20.2495055Z      if side == :left[m
2026-02-09T19:17:20.2496000Z [34m[ 78/151] Checking `src/hyperbolic/hyperbolic_problem.jl` .................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.2497407Z [34m[ 79/151] Checking `src/hyperbolic/hyperbolic_problem_2d.jl` ................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.2498954Z [34m[ 80/151] Checking `src/hyperbolic/hyperbolic_problem_3d.jl` ................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.2606877Z [34m[ 81/151] Checking `src/hyperbolic/hyperbolic_solve.jl` ...................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.2680481Z [34m[ 82/151] Checking `src/hyperbolic/hyperbolic_solve_2d.jl` ................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.2776732Z [34m[ 83/151] Checking `src/hyperbolic/hyperbolic_solve_3d.jl` ................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.2792163Z [1mdiff --git a/hyperbolic_solve_3d.jl b/hyperbolic_solve_3d.jl[m
2026-02-09T19:17:20.2792843Z [1mindex ecd59d2..cf512ce 100644[m
2026-02-09T19:17:20.2793201Z [1m--- a/hyperbolic_solve_3d.jl[m
2026-02-09T19:17:20.2793793Z [1m+++ b/hyperbolic_solve_3d.jl[m
2026-02-09T19:17:20.2794559Z [36m@@ -186,8 +186,10 @@[m [mdimension-by-dimension flux differencing:[m
2026-02-09T19:17:20.2795419Z                    -1/dy * (Fy_{i,j+1/2,k} - Fy_{i,j-1/2,k})[m
2026-02-09T19:17:20.2796126Z                    -1/dz * (Fz_{i,j,k+1/2} - Fz_{i,j,k-1/2})`[m
2026-02-09T19:17:20.2796669Z  """[m
2026-02-09T19:17:20.2797537Z [31m-function hyperbolic_rhs_3d!(dU::AbstractArray{T, 3}, U::AbstractArray{T, 3},[m
2026-02-09T19:17:20.2798567Z [31m-        prob::HyperbolicProblem3D, t) where {T}[m
2026-02-09T19:17:20.2799792Z [32m+[m[32mfunction hyperbolic_rhs_3d!([m
2026-02-09T19:17:20.2800612Z [32m+[m[32m        dU::AbstractArray{T, 3}, U::AbstractArray{T, 3},[m
2026-02-09T19:17:20.2801634Z [32m+[m[32m        prob::HyperbolicProblem3D, t[m
2026-02-09T19:17:20.2802225Z [32m+[m[32m    ) where {T}[m
2026-02-09T19:17:20.2802675Z      law = prob.law[m
2026-02-09T19:17:20.2803112Z      mesh = prob.mesh[m
2026-02-09T19:17:20.2803613Z      nx, ny, nz = mesh.nx, mesh.ny, mesh.nz[m
2026-02-09T19:17:20.2821199Z [34m[ 84/151] Checking `src/hyperbolic/imex.jl` .................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.2835084Z [1mdiff --git a/imex.jl b/imex.jl[m
2026-02-09T19:17:20.2835666Z [1mindex 523c458..eee704a 100644[m
2026-02-09T19:17:20.2836076Z [1m--- a/imex.jl[m
2026-02-09T19:17:20.2836332Z [1m+++ b/imex.jl[m
2026-02-09T19:17:20.2837086Z [36m@@ -75,13 +75,13 @@[m [mfunction imex_tableau(::IMEX_SSP3_433)[m
2026-02-09T19:17:20.2837710Z  [m
2026-02-09T19:17:20.2838107Z      α = 0.24169426078821[m
2026-02-09T19:17:20.2838550Z      β = 0.06042356519705[m
2026-02-09T19:17:20.2839194Z [31m-    η = 0.12915286960590[m
2026-02-09T19:17:20.2839706Z [32m+[m[32m    η = 0.1291528696059[m
2026-02-09T19:17:20.2840144Z  [m
2026-02-09T19:17:20.2840484Z      A_ex = ([m
2026-02-09T19:17:20.2840905Z          (0.0, 0.0, 0.0, 0.0),[m
2026-02-09T19:17:20.2841354Z          (0.5, 0.0, 0.0, 0.0),[m
2026-02-09T19:17:20.2841800Z          (0.5, 0.5, 0.0, 0.0),[m
2026-02-09T19:17:20.2842337Z [31m-        (1.0 / 6.0, 1.0 / 6.0, 1.0 / 6.0, 0.0)[m
2026-02-09T19:17:20.2842977Z [32m+[m[32m        (1.0 / 6.0, 1.0 / 6.0, 1.0 / 6.0, 0.0),[m
2026-02-09T19:17:20.2843498Z      )[m
2026-02-09T19:17:20.2843934Z      b_ex = (1.0 / 6.0, 1.0 / 6.0, 1.0 / 6.0, 0.5)[m
2026-02-09T19:17:20.2844461Z      c_ex = (0.0, 0.5, 1.0, 0.5)[m
2026-02-09T19:17:20.2845224Z [36m@@ -92,14 +92,16 @@[m [mfunction imex_tableau(::IMEX_SSP3_433)[m
2026-02-09T19:17:20.2845857Z          (α, 0.0, 0.0, 0.0),[m
2026-02-09T19:17:20.2846324Z          (-α, α, 0.0, 0.0),[m
2026-02-09T19:17:20.2846767Z          (0.0, 1.0 - α, α, 0.0),[m
2026-02-09T19:17:20.2847278Z [31m-        (β, η, 1.0 - α - β - η, α)[m
2026-02-09T19:17:20.2847858Z [32m+[m[32m        (β, η, 1.0 - α - β - η, α),[m
2026-02-09T19:17:20.2848359Z      )[m
2026-02-09T19:17:20.2848933Z      b_im = (β, η, 1.0 - α - β - η, α)[m
2026-02-09T19:17:20.2849448Z      c_im = (α, 0.0, 1.0, 1.0)[m
2026-02-09T19:17:20.2849860Z  [m
2026-02-09T19:17:20.2850342Z [31m-    return (A_ex = A_ex, b_ex = b_ex, c_ex = c_ex,[m
2026-02-09T19:17:20.2850947Z [32m+[m[32m    return ([m
2026-02-09T19:17:20.2851510Z [32m+[m[32m        A_ex = A_ex, b_ex = b_ex, c_ex = c_ex,[m
2026-02-09T19:17:20.2852140Z          A_im = A_im, b_im = b_im, c_im = c_im,[m
2026-02-09T19:17:20.2852637Z [31m-        s = 4)[m
2026-02-09T19:17:20.2853031Z [32m+[m[32m        s = 4,[m
2026-02-09T19:17:20.2853433Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2853788Z  end[m
2026-02-09T19:17:20.2854094Z  [m
2026-02-09T19:17:20.2854534Z  # ============================================================[m
2026-02-09T19:17:20.2855371Z [36m@@ -130,7 +132,7 @@[m [mfunction imex_tableau(::IMEX_ARS222)[m
2026-02-09T19:17:20.2856015Z      A_ex = ([m
2026-02-09T19:17:20.2856407Z          (0.0, 0.0, 0.0),[m
2026-02-09T19:17:20.2856832Z          (γ, 0.0, 0.0),[m
2026-02-09T19:17:20.2857272Z [31m-        (δ, 1.0 - δ, 0.0)[m
2026-02-09T19:17:20.2857767Z [32m+[m[32m        (δ, 1.0 - δ, 0.0),[m
2026-02-09T19:17:20.2858228Z      )[m
2026-02-09T19:17:20.2858594Z      b_ex = (0.0, 1.0 - γ, γ)[m
2026-02-09T19:17:20.2859272Z      c_ex = (0.0, γ, 1.0)[m
2026-02-09T19:17:20.2859985Z [36m@@ -139,14 +141,16 @@[m [mfunction imex_tableau(::IMEX_ARS222)[m
2026-02-09T19:17:20.2860608Z      A_im = ([m
2026-02-09T19:17:20.2860976Z          (0.0, 0.0, 0.0),[m
2026-02-09T19:17:20.2861406Z          (0.0, γ, 0.0),[m
2026-02-09T19:17:20.2861835Z [31m-        (0.0, 1.0 - γ, γ)[m
2026-02-09T19:17:20.2862578Z [32m+[m[32m        (0.0, 1.0 - γ, γ),[m
2026-02-09T19:17:20.2863034Z      )[m
2026-02-09T19:17:20.2863398Z      b_im = (0.0, 1.0 - γ, γ)[m
2026-02-09T19:17:20.2863862Z      c_im = (0.0, γ, 1.0)[m
2026-02-09T19:17:20.2864492Z  [m
2026-02-09T19:17:20.2864996Z [31m-    return (A_ex = A_ex, b_ex = b_ex, c_ex = c_ex,[m
2026-02-09T19:17:20.2865590Z [32m+[m[32m    return ([m
2026-02-09T19:17:20.2866167Z [32m+[m[32m        A_ex = A_ex, b_ex = b_ex, c_ex = c_ex,[m
2026-02-09T19:17:20.2866824Z          A_im = A_im, b_im = b_im, c_im = c_im,[m
2026-02-09T19:17:20.2867353Z [31m-        s = 3)[m
2026-02-09T19:17:20.2867765Z [32m+[m[32m        s = 3,[m
2026-02-09T19:17:20.2868187Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2868551Z  end[m
2026-02-09T19:17:20.2869025Z  [m
2026-02-09T19:17:20.2869463Z  # ============================================================[m
2026-02-09T19:17:20.2870266Z [36m@@ -170,19 +174,21 @@[m [mimex_nstages(::IMEX_Midpoint) = 2[m
2026-02-09T19:17:20.2870999Z  function imex_tableau(::IMEX_Midpoint)[m
2026-02-09T19:17:20.2871508Z      A_ex = ([m
2026-02-09T19:17:20.2871879Z          (0.0, 0.0),[m
2026-02-09T19:17:20.2872271Z [31m-        (1.0, 0.0)[m
2026-02-09T19:17:20.2872721Z [32m+[m[32m        (1.0, 0.0),[m
2026-02-09T19:17:20.2873149Z      )[m
2026-02-09T19:17:20.2873490Z      b_ex = (0.5, 0.5)[m
2026-02-09T19:17:20.2873900Z      c_ex = (0.0, 1.0)[m
2026-02-09T19:17:20.2874263Z  [m
2026-02-09T19:17:20.2874584Z      A_im = ([m
2026-02-09T19:17:20.2875013Z          (0.0, 0.0),[m
2026-02-09T19:17:20.2875409Z [31m-        (0.0, 1.0)[m
2026-02-09T19:17:20.2875836Z [32m+[m[32m        (0.0, 1.0),[m
2026-02-09T19:17:20.2876263Z      )[m
2026-02-09T19:17:20.2876601Z      b_im = (0.0, 1.0)[m
2026-02-09T19:17:20.2877008Z      c_im = (0.0, 1.0)[m
2026-02-09T19:17:20.2877365Z  [m
2026-02-09T19:17:20.2877844Z [31m-    return (A_ex = A_ex, b_ex = b_ex, c_ex = c_ex,[m
2026-02-09T19:17:20.2878443Z [32m+[m[32m    return ([m
2026-02-09T19:17:20.2879192Z [32m+[m[32m        A_ex = A_ex, b_ex = b_ex, c_ex = c_ex,[m
2026-02-09T19:17:20.2879862Z          A_im = A_im, b_im = b_im, c_im = c_im,[m
2026-02-09T19:17:20.2880387Z [31m-        s = 2)[m
2026-02-09T19:17:20.2880813Z [32m+[m[32m        s = 2,[m
2026-02-09T19:17:20.2881235Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2881605Z  end[m
2026-02-09T19:17:20.2943025Z [34m[ 85/151] Checking `src/hyperbolic/imex_solve.jl` ............................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.2957988Z [1mdiff --git a/imex_solve.jl b/imex_solve.jl[m
2026-02-09T19:17:20.2958623Z [1mindex 343b784..15d8bde 100644[m
2026-02-09T19:17:20.2959175Z [1m--- a/imex_solve.jl[m
2026-02-09T19:17:20.2959548Z [1m+++ b/imex_solve.jl[m
2026-02-09T19:17:20.2960189Z [36m@@ -38,10 +38,12 @@[m [mRunge-Kutta time integration.[m
2026-02-09T19:17:20.2961209Z  - `U_final::Vector{SVector{N}}`: Final conserved variable vectors at cell centers.[m
2026-02-09T19:17:20.2962128Z  - `t_final::Real`: Final time reached.[m
2026-02-09T19:17:20.2962655Z  """[m
2026-02-09T19:17:20.2963640Z [31m-function solve_hyperbolic_imex(prob::HyperbolicProblem, stiff_source::AbstractStiffSource;[m
2026-02-09T19:17:20.2964728Z [32m+[m[32mfunction solve_hyperbolic_imex([m
2026-02-09T19:17:20.2965676Z [32m+[m[32m        prob::HyperbolicProblem, stiff_source::AbstractStiffSource;[m
2026-02-09T19:17:20.2966578Z          scheme::AbstractIMEXScheme = IMEX_SSP3_433(),[m
2026-02-09T19:17:20.2967212Z [31m-        newton_tol = 1e-10,[m
2026-02-09T19:17:20.2967813Z [31m-        newton_maxiter::Int = 5)[m
2026-02-09T19:17:20.2968382Z [32m+[m[32m        newton_tol = 1.0e-10,[m
2026-02-09T19:17:20.2969327Z [32m+[m[32m        newton_maxiter::Int = 5[m
2026-02-09T19:17:20.2969864Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2970284Z      mesh = prob.mesh[m
2026-02-09T19:17:20.2970716Z      nc = ncells(mesh)[m
2026-02-09T19:17:20.2971153Z      law = prob.law[m
2026-02-09T19:17:20.2972156Z [36m@@ -116,8 +118,10 @@[m [mfunction solve_hyperbolic_imex(prob::HyperbolicProblem, stiff_source::AbstractSt[m
2026-02-09T19:17:20.2973393Z                  #   U* = U_stage + a_kk * dt * S(U*)[m
2026-02-09T19:17:20.2974260Z                  # Newton iteration: given U_guess, solve[m
2026-02-09T19:17:20.2975186Z                  #   (I - a_kk*dt*J) * (U_new - U_guess) = U_stage + a_kk*dt*S(U_guess) - U_guess[m
2026-02-09T19:17:20.2976243Z [31m-                _implicit_solve_1d!(U_stage, law, stiff_source, a_kk * dt, nc, N,[m
2026-02-09T19:17:20.2977101Z [31m-                    newton_tol, newton_maxiter)[m
2026-02-09T19:17:20.2977750Z [32m+[m[32m                _implicit_solve_1d!([m
2026-02-09T19:17:20.2978517Z [32m+[m[32m                    U_stage, law, stiff_source, a_kk * dt, nc, N,[m
2026-02-09T19:17:20.2979535Z [32m+[m[32m                    newton_tol, newton_maxiter[m
2026-02-09T19:17:20.2980139Z [32m+[m[32m                )[m
2026-02-09T19:17:20.2980548Z  [m
2026-02-09T19:17:20.2981137Z                  # After the solve, U_stage contains the updated stage value.[m
2026-02-09T19:17:20.2981882Z                  # K_im[k] = S(U_stage)[m
2026-02-09T19:17:20.2982551Z [36m@@ -219,10 +223,12 @@[m [mRunge-Kutta time integration.[m
2026-02-09T19:17:20.2983479Z  - `U_final::Matrix{SVector{N}}`: Final conserved variable matrix (nx x ny).[m
2026-02-09T19:17:20.2984284Z  - `t_final::Real`: Final time reached.[m
2026-02-09T19:17:20.2984773Z  """[m
2026-02-09T19:17:20.2985550Z [31m-function solve_hyperbolic_imex(prob::HyperbolicProblem2D, stiff_source::AbstractStiffSource;[m
2026-02-09T19:17:20.2985826Z [32m+[m[32mfunction solve_hyperbolic_imex([m
2026-02-09T19:17:20.2986382Z [32m+[m[32m        prob::HyperbolicProblem2D, stiff_source::AbstractStiffSource;[m
2026-02-09T19:17:20.2986777Z          scheme::AbstractIMEXScheme = IMEX_SSP3_433(),[m
2026-02-09T19:17:20.2986993Z [31m-        newton_tol = 1e-10,[m
2026-02-09T19:17:20.2987280Z [31m-        newton_maxiter::Int = 5)[m
2026-02-09T19:17:20.2987536Z [32m+[m[32m        newton_tol = 1.0e-10,[m
2026-02-09T19:17:20.2987841Z [32m+[m[32m        newton_maxiter::Int = 5[m
2026-02-09T19:17:20.2988016Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2988210Z      mesh = prob.mesh[m
2026-02-09T19:17:20.2988422Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.2988600Z      law = prob.law[m
2026-02-09T19:17:20.2989584Z [36m@@ -283,8 +289,10 @@[m [mfunction solve_hyperbolic_imex(prob::HyperbolicProblem2D, stiff_source::Abstract[m
2026-02-09T19:17:20.2989746Z              else[m
2026-02-09T19:17:20.2990197Z                  hyperbolic_rhs_2d!(K_ex[k], U_stage, prob, t + tab.c_ex[k] * dt)[m
2026-02-09T19:17:20.2990337Z  [m
2026-02-09T19:17:20.2990851Z [31m-                _implicit_solve_2d!(U_stage, law, stiff_source, a_kk * dt, nx, ny, N,[m
2026-02-09T19:17:20.2991139Z [31m-                    newton_tol, newton_maxiter)[m
2026-02-09T19:17:20.2991411Z [32m+[m[32m                _implicit_solve_2d!([m
2026-02-09T19:17:20.2991822Z [32m+[m[32m                    U_stage, law, stiff_source, a_kk * dt, nx, ny, N,[m
2026-02-09T19:17:20.2992142Z [32m+[m[32m                    newton_tol, newton_maxiter[m
2026-02-09T19:17:20.2992333Z [32m+[m[32m                )[m
2026-02-09T19:17:20.2992471Z  [m
2026-02-09T19:17:20.2992934Z                  _eval_stiff_source_2d!(K_im[k], U_stage, law, stiff_source, nx, ny)[m
2026-02-09T19:17:20.2993090Z              end[m
2026-02-09T19:17:20.3022279Z [34m[ 86/151] Checking `src/hyperbolic/mhd.jl` ................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3058241Z [34m[ 87/151] Checking `src/hyperbolic/mhd_3d.jl` ................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3155515Z [34m[ 88/151] Checking `src/hyperbolic/mhd_solve_2d.jl` .......................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3171383Z [1mdiff --git a/mhd_solve_2d.jl b/mhd_solve_2d.jl[m
2026-02-09T19:17:20.3171629Z [1mindex 2fe3c05..73f755b 100644[m
2026-02-09T19:17:20.3172057Z [1m--- a/mhd_solve_2d.jl[m
2026-02-09T19:17:20.3172283Z [1m+++ b/mhd_solve_2d.jl[m
2026-02-09T19:17:20.3173327Z [36m@@ -185,8 +185,10 @@[m [mCompute the corner EMF uniformly at all corners from the extended face flux arra[m
2026-02-09T19:17:20.3173626Z  Corner (i,j) for i=1:nx+1, j=1:ny+1:[m
2026-02-09T19:17:20.3174185Z    Ez = 0.25 * (-Fx_all[i,j][7] - Fx_all[i,j+1][7] + Fy_all[i,j][6] + Fy_all[i+1,j][6])[m
2026-02-09T19:17:20.3174356Z  """[m
2026-02-09T19:17:20.3175201Z [31m-function _compute_emf_from_extended!(emf_z::AbstractMatrix, Fx_all::AbstractMatrix,[m
2026-02-09T19:17:20.3175551Z [31m-        Fy_all::AbstractMatrix, nx::Int, ny::Int)[m
2026-02-09T19:17:20.3175807Z [32m+[m[32mfunction _compute_emf_from_extended!([m
2026-02-09T19:17:20.3176144Z [32m+[m[32m        emf_z::AbstractMatrix, Fx_all::AbstractMatrix,[m
2026-02-09T19:17:20.3176442Z [32m+[m[32m        Fy_all::AbstractMatrix, nx::Int, ny::Int[m
2026-02-09T19:17:20.3176567Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3176756Z      for j in 1:(ny + 1), i in 1:(nx + 1)[m
2026-02-09T19:17:20.3177049Z          # x-face EMF: Ez = -F_By (negative of By induction flux)[m
2026-02-09T19:17:20.3177370Z          Ez_x_below = -Fx_all[i, j][7]       # x-face in row below corner[m
2026-02-09T19:17:20.3177846Z [36m@@ -217,8 +219,10 @@[m [mSolve the 2D MHD problem using constrained transport for ∇·B = 0.[m
2026-02-09T19:17:20.3178026Z  - `t_final`: Final time reached.[m
2026-02-09T19:17:20.3178379Z  - `ct`: Final `CTData2D` (for inspecting ∇·B, face-centered B, etc.).[m
2026-02-09T19:17:20.3178486Z  """[m
2026-02-09T19:17:20.3179289Z [31m-function solve_hyperbolic(prob::HyperbolicProblem2D{<:IdealMHDEquations{2}};[m
2026-02-09T19:17:20.3179650Z [31m-        method::Symbol = :ssprk3, vector_potential = nothing)[m
2026-02-09T19:17:20.3179854Z [32m+[m[32mfunction solve_hyperbolic([m
2026-02-09T19:17:20.3180214Z [32m+[m[32m        prob::HyperbolicProblem2D{<:IdealMHDEquations{2}};[m
2026-02-09T19:17:20.3180557Z [32m+[m[32m        method::Symbol = :ssprk3, vector_potential = nothing[m
2026-02-09T19:17:20.3180689Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3180825Z      mesh = prob.mesh[m
2026-02-09T19:17:20.3180987Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.3181143Z      dx, dy = mesh.dx, mesh.dy[m
2026-02-09T19:17:20.3272196Z [34m[ 89/151] Checking `src/hyperbolic/mhd_solve_3d.jl` .......................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3288048Z [1mdiff --git a/mhd_solve_3d.jl b/mhd_solve_3d.jl[m
2026-02-09T19:17:20.3288350Z [1mindex 7b131c5..d41d8bf 100644[m
2026-02-09T19:17:20.3288545Z [1m--- a/mhd_solve_3d.jl[m
2026-02-09T19:17:20.3288987Z [1m+++ b/mhd_solve_3d.jl[m
2026-02-09T19:17:20.3289345Z [36m@@ -73,7 +73,8 @@[m [mfunction _mhd_compute_fluxes_3d!([m
2026-02-09T19:17:20.3289753Z          Fx_all::AbstractArray{T, 3}, Fy_all::AbstractArray{T, 3},[m
2026-02-09T19:17:20.3290002Z          Fz_all::AbstractArray{T, 3},[m
2026-02-09T19:17:20.3290259Z          dU::AbstractArray{T, 3}, U::AbstractArray{T, 3},[m
2026-02-09T19:17:20.3290534Z [31m-        prob::HyperbolicProblem3D, t) where {T}[m
2026-02-09T19:17:20.3290751Z [32m+[m[32m        prob::HyperbolicProblem3D, t[m
2026-02-09T19:17:20.3290875Z [32m+[m[32m    ) where {T}[m
2026-02-09T19:17:20.3290982Z      law = prob.law[m
2026-02-09T19:17:20.3291098Z      mesh = prob.mesh[m
2026-02-09T19:17:20.3291260Z      nx, ny, nz = mesh.nx, mesh.ny, mesh.nz[m
2026-02-09T19:17:20.3291649Z [36m@@ -166,11 +167,13 @@[m [mSolve the 3D MHD problem using constrained transport for div(B) = 0.[m
2026-02-09T19:17:20.3291798Z  - `t_final`: Final time reached.[m
2026-02-09T19:17:20.3292095Z  - `ct`: Final `CTData3D` (for inspecting div(B), face-centered B, etc.).[m
2026-02-09T19:17:20.3292176Z  """[m
2026-02-09T19:17:20.3292580Z [31m-function solve_hyperbolic(prob::HyperbolicProblem3D{<:IdealMHDEquations{3}};[m
2026-02-09T19:17:20.3292738Z [32m+[m[32mfunction solve_hyperbolic([m
2026-02-09T19:17:20.3293025Z [32m+[m[32m        prob::HyperbolicProblem3D{<:IdealMHDEquations{3}};[m
2026-02-09T19:17:20.3293356Z          method::Symbol = :ssprk3,[m
2026-02-09T19:17:20.3293512Z          vector_potential_x = nothing,[m
2026-02-09T19:17:20.3293823Z          vector_potential_y = nothing,[m
2026-02-09T19:17:20.3293992Z [31m-        vector_potential_z = nothing)[m
2026-02-09T19:17:20.3294174Z [32m+[m[32m        vector_potential_z = nothing[m
2026-02-09T19:17:20.3294268Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3294376Z      mesh = prob.mesh[m
2026-02-09T19:17:20.3294537Z      nx, ny, nz = mesh.nx, mesh.ny, mesh.nz[m
2026-02-09T19:17:20.3294688Z      dx, dy, dz = mesh.dx, mesh.dy, mesh.dz[m
2026-02-09T19:17:20.3303944Z [34m[ 90/151] Checking `src/hyperbolic/navier_stokes.jl` ......................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3321982Z [34m[ 91/151] Checking `src/hyperbolic/navier_stokes_solve.jl` ................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3335362Z [1mdiff --git a/navier_stokes_solve.jl b/navier_stokes_solve.jl[m
2026-02-09T19:17:20.3335613Z [1mindex 9e8f14a..045d0d3 100644[m
2026-02-09T19:17:20.3335833Z [1m--- a/navier_stokes_solve.jl[m
2026-02-09T19:17:20.3336052Z [1m+++ b/navier_stokes_solve.jl[m
2026-02-09T19:17:20.3336243Z [36m@@ -55,8 +55,10 @@[m [mend[m
2026-02-09T19:17:20.3336742Z  Compute the RHS including both inviscid Riemann fluxes and viscous fluxes:[m
2026-02-09T19:17:20.3337138Z    `dU[i]/dt = -1/dx * (F_{i+1/2} - F_{i-1/2}) + 1/dx * (Fv_{i+1/2} - Fv_{i-1/2})`[m
2026-02-09T19:17:20.3337223Z  """[m
2026-02-09T19:17:20.3337602Z [31m-function hyperbolic_rhs!(dU::AbstractVector, U::AbstractVector,[m
2026-02-09T19:17:20.3337905Z [31m-        prob::HyperbolicProblem{<:NavierStokesEquations{1}}, t)[m
2026-02-09T19:17:20.3338063Z [32m+[m[32mfunction hyperbolic_rhs!([m
2026-02-09T19:17:20.3338301Z [32m+[m[32m        dU::AbstractVector, U::AbstractVector,[m
2026-02-09T19:17:20.3338606Z [32m+[m[32m        prob::HyperbolicProblem{<:NavierStokesEquations{1}}, t[m
2026-02-09T19:17:20.3339049Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3339169Z      law = prob.law[m
2026-02-09T19:17:20.3339279Z      mesh = prob.mesh[m
2026-02-09T19:17:20.3339396Z      nc = ncells(mesh)[m
2026-02-09T19:17:20.3396095Z [34m[ 92/151] Checking `src/hyperbolic/navier_stokes_solve_2d.jl` ................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3409783Z [1mdiff --git a/navier_stokes_solve_2d.jl b/navier_stokes_solve_2d.jl[m
2026-02-09T19:17:20.3410023Z [1mindex 273bc8f..a93ce92 100644[m
2026-02-09T19:17:20.3410298Z [1m--- a/navier_stokes_solve_2d.jl[m
2026-02-09T19:17:20.3410508Z [1m+++ b/navier_stokes_solve_2d.jl[m
2026-02-09T19:17:20.3410944Z [36m@@ -59,8 +59,10 @@[m [mCompute the 2D RHS including inviscid and viscous fluxes:[m
2026-02-09T19:17:20.3411129Z                  +1/dx * (Fvx_{i+1/2,j} - Fvx_{i-1/2,j})[m
2026-02-09T19:17:20.3411300Z                  +1/dy * (Fvy_{i,j+1/2} - Fvy_{i,j-1/2})`[m
2026-02-09T19:17:20.3411385Z  """[m
2026-02-09T19:17:20.3411794Z [31m-function hyperbolic_rhs_2d!(dU::AbstractMatrix, U::AbstractMatrix,[m
2026-02-09T19:17:20.3412109Z [31m-        prob::HyperbolicProblem2D{<:NavierStokesEquations{2}}, t)[m
2026-02-09T19:17:20.3412284Z [32m+[m[32mfunction hyperbolic_rhs_2d!([m
2026-02-09T19:17:20.3412539Z [32m+[m[32m        dU::AbstractMatrix, U::AbstractMatrix,[m
2026-02-09T19:17:20.3412858Z [32m+[m[32m        prob::HyperbolicProblem2D{<:NavierStokesEquations{2}}, t[m
2026-02-09T19:17:20.3412956Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3413083Z      law = prob.law[m
2026-02-09T19:17:20.3413194Z      mesh = prob.mesh[m
2026-02-09T19:17:20.3413320Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.3413757Z [36m@@ -137,10 +139,14 @@[m [mfunction hyperbolic_rhs_2d!(dU::AbstractMatrix, U::AbstractMatrix,[m
2026-02-09T19:17:20.3413834Z  [m
2026-02-09T19:17:20.3414019Z              # Cross-derivatives via 4-cell average[m
2026-02-09T19:17:20.3414287Z              # ∂vx/∂y ≈ (vx[iL,j+1] + vx[iR,j+1] - vx[iL,j-1] - vx[iR,j-1]) / (4*dy)[m
2026-02-09T19:17:20.3414840Z [31m-            dvx_dy = (W[iL, jj + 1][2] + W[iR, jj + 1][2] -[m
2026-02-09T19:17:20.3415173Z [31m-                       W[iL, jj - 1][2] - W[iR, jj - 1][2]) / (4.0 * dy)[m
2026-02-09T19:17:20.3415369Z [31m-            dvy_dy = (W[iL, jj + 1][3] + W[iR, jj + 1][3] -[m
2026-02-09T19:17:20.3415566Z [31m-                       W[iL, jj - 1][3] - W[iR, jj - 1][3]) / (4.0 * dy)[m
2026-02-09T19:17:20.3415686Z [32m+[m[32m            dvx_dy = ([m
2026-02-09T19:17:20.3415873Z [32m+[m[32m                W[iL, jj + 1][2] + W[iR, jj + 1][2] -[m
2026-02-09T19:17:20.3416065Z [32m+[m[32m                    W[iL, jj - 1][2] - W[iR, jj - 1][2][m
2026-02-09T19:17:20.3416182Z [32m+[m[32m            ) / (4.0 * dy)[m
2026-02-09T19:17:20.3416295Z [32m+[m[32m            dvy_dy = ([m
2026-02-09T19:17:20.3416482Z [32m+[m[32m                W[iL, jj + 1][3] + W[iR, jj + 1][3] -[m
2026-02-09T19:17:20.3416667Z [32m+[m[32m                    W[iL, jj - 1][3] - W[iR, jj - 1][3][m
2026-02-09T19:17:20.3416792Z [32m+[m[32m            ) / (4.0 * dy)[m
2026-02-09T19:17:20.3416868Z  [m
2026-02-09T19:17:20.3417109Z              Fv = viscous_flux_x_2d(law, wL, wR, dvx_dy, dvy_dy, dx)[m
2026-02-09T19:17:20.3417183Z  [m
2026-02-09T19:17:20.3417620Z [36m@@ -166,10 +172,14 @@[m [mfunction hyperbolic_rhs_2d!(dU::AbstractMatrix, U::AbstractMatrix,[m
2026-02-09T19:17:20.3417700Z  [m
2026-02-09T19:17:20.3417884Z              # Cross-derivatives via 4-cell average[m
2026-02-09T19:17:20.3418129Z              # ∂vx/∂x ≈ (vx[i+1,jL] + vx[i+1,jR] - vx[i-1,jL] - vx[i-1,jR]) / (4*dx)[m
2026-02-09T19:17:20.3418317Z [31m-            dvx_dx = (W[ii + 1, jL][2] + W[ii + 1, jR][2] -[m
2026-02-09T19:17:20.3418524Z [31m-                       W[ii - 1, jL][2] - W[ii - 1, jR][2]) / (4.0 * dx)[m
2026-02-09T19:17:20.3418705Z [31m-            dvy_dx = (W[ii + 1, jL][3] + W[ii + 1, jR][3] -[m
2026-02-09T19:17:20.3419045Z [31m-                       W[ii - 1, jL][3] - W[ii - 1, jR][3]) / (4.0 * dx)[m
2026-02-09T19:17:20.3419181Z [32m+[m[32m            dvx_dx = ([m
2026-02-09T19:17:20.3419364Z [32m+[m[32m                W[ii + 1, jL][2] + W[ii + 1, jR][2] -[m
2026-02-09T19:17:20.3419558Z [32m+[m[32m                    W[ii - 1, jL][2] - W[ii - 1, jR][2][m
2026-02-09T19:17:20.3419679Z [32m+[m[32m            ) / (4.0 * dx)[m
2026-02-09T19:17:20.3419792Z [32m+[m[32m            dvy_dx = ([m
2026-02-09T19:17:20.3419967Z [32m+[m[32m                W[ii + 1, jL][3] + W[ii + 1, jR][3] -[m
2026-02-09T19:17:20.3420154Z [32m+[m[32m                    W[ii - 1, jL][3] - W[ii - 1, jR][3][m
2026-02-09T19:17:20.3420267Z [32m+[m[32m            ) / (4.0 * dx)[m
2026-02-09T19:17:20.3420339Z  [m
2026-02-09T19:17:20.3420560Z              Fv = viscous_flux_y_2d(law, wB, wT, dvx_dx, dvy_dx, dy)[m
2026-02-09T19:17:20.3420643Z  [m
2026-02-09T19:17:20.3437841Z [34m[ 93/151] Checking `src/hyperbolic/noslip_bc.jl` ............................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3453268Z [34m[ 94/151] Checking `src/hyperbolic/reconstruction.jl` ........................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3462664Z [34m[ 95/151] Checking `src/hyperbolic/riemann_solvers.jl` ....................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3517313Z [34m[ 96/151] Checking `src/hyperbolic/srmhd.jl` ................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3532234Z [1mdiff --git a/srmhd.jl b/srmhd.jl[m
2026-02-09T19:17:20.3532476Z [1mindex abfe885..11abe0e 100644[m
2026-02-09T19:17:20.3532641Z [1m--- a/srmhd.jl[m
2026-02-09T19:17:20.3532799Z [1m+++ b/srmhd.jl[m
2026-02-09T19:17:20.3533363Z [36m@@ -38,7 +38,7 @@[m [mstruct SRMHDEquations{Dim, EOS <: AbstractEOS} <: AbstractConservationLaw{Dim}[m
2026-02-09T19:17:20.3533526Z      con2prim_maxiter::Int[m
2026-02-09T19:17:20.3533608Z  end[m
2026-02-09T19:17:20.3533784Z  [m
2026-02-09T19:17:20.3534716Z [31m-function SRMHDEquations{Dim}(eos::EOS; con2prim_tol = 1e-12, con2prim_maxiter = 50) where {Dim, EOS <: AbstractEOS}[m
2026-02-09T19:17:20.3536116Z [32m+[m[32mfunction SRMHDEquations{Dim}(eos::EOS; con2prim_tol = 1.0e-12, con2prim_maxiter = 50) where {Dim, EOS <: AbstractEOS}[m
2026-02-09T19:17:20.3536659Z      return SRMHDEquations{Dim, EOS}(eos, con2prim_tol, con2prim_maxiter)[m
2026-02-09T19:17:20.3536818Z  end[m
2026-02-09T19:17:20.3536950Z  [m
2026-02-09T19:17:20.3537360Z [36m@@ -55,7 +55,7 @@[m [mCompute the Lorentz factor W = 1/√(1 − v²).[m
2026-02-09T19:17:20.3537536Z  """[m
2026-02-09T19:17:20.3537847Z  @inline function lorentz_factor(vx, vy, vz)[m
2026-02-09T19:17:20.3538055Z      v_sq = vx^2 + vy^2 + vz^2[m
2026-02-09T19:17:20.3538469Z [31m-    v_sq = min(v_sq, 1 - 1e-10)  # cap to prevent superluminal[m
2026-02-09T19:17:20.3539363Z [32m+[m[32m    v_sq = min(v_sq, 1 - 1.0e-10)  # cap to prevent superluminal[m
2026-02-09T19:17:20.3539613Z      return 1 / sqrt(1 - v_sq)[m
2026-02-09T19:17:20.3539780Z  end[m
2026-02-09T19:17:20.3539937Z  [m
2026-02-09T19:17:20.3540309Z [36m@@ -227,14 +227,14 @@[m [ma² = γP/(ρh), va² = b²/(ρh + b²).[m
2026-02-09T19:17:20.3540514Z      γ_eos = law.eos.gamma[m
2026-02-09T19:17:20.3540657Z  [m
2026-02-09T19:17:20.3540876Z      v_sq = vx^2 + vy^2 + vz^2[m
2026-02-09T19:17:20.3541111Z [31m-    v_sq = min(v_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.3541387Z [32m+[m[32m    v_sq = min(v_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.3541518Z  [m
2026-02-09T19:17:20.3541719Z      W = 1 / sqrt(1 - v_sq)[m
2026-02-09T19:17:20.3541931Z      ε = P / ((γ_eos - 1) * ρ)[m
2026-02-09T19:17:20.3542126Z      h = 1 + ε + P / ρ[m
2026-02-09T19:17:20.3542260Z  [m
2026-02-09T19:17:20.3542467Z      cs_sq = γ_eos * P / (ρ * h)[m
2026-02-09T19:17:20.3542708Z [31m-    cs_sq = min(cs_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.3542991Z [32m+[m[32m    cs_sq = min(cs_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.3543130Z  [m
2026-02-09T19:17:20.3543327Z      B_sq = Bx^2 + By^2 + Bz^2[m
2026-02-09T19:17:20.3543567Z      vdotB = vx * Bx + vy * By + vz * Bz[m
2026-02-09T19:17:20.3543940Z [36m@@ -242,10 +242,10 @@[m [ma² = γP/(ρh), va² = b²/(ρh + b²).[m
2026-02-09T19:17:20.3544076Z  [m
2026-02-09T19:17:20.3544250Z      rho_h = ρ * h[m
2026-02-09T19:17:20.3544478Z      ca_sq = b_sq / (rho_h + b_sq)[m
2026-02-09T19:17:20.3544714Z [31m-    ca_sq = min(ca_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.3544991Z [32m+[m[32m    ca_sq = min(ca_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.3545126Z  [m
2026-02-09T19:17:20.3545379Z      c_ms_sq = cs_sq + ca_sq - cs_sq * ca_sq[m
2026-02-09T19:17:20.3545724Z [31m-    c_ms_sq = clamp(c_ms_sq, zero(c_ms_sq), 1 - 1e-10)[m
2026-02-09T19:17:20.3546114Z [32m+[m[32m    c_ms_sq = clamp(c_ms_sq, zero(c_ms_sq), 1 - 1.0e-10)[m
2026-02-09T19:17:20.3546316Z      c_ms = sqrt(c_ms_sq)[m
2026-02-09T19:17:20.3546448Z  [m
2026-02-09T19:17:20.3546643Z      vn = dir == 1 ? vx : vy[m
2026-02-09T19:17:20.3547316Z [34m[ 97/151] Checking `src/hyperbolic/srmhd_solve.jl` ........................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3609779Z [34m[ 98/151] Checking `src/hyperbolic/srmhd_solve_2d.jl` ........................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3623787Z [1mdiff --git a/srmhd_solve_2d.jl b/srmhd_solve_2d.jl[m
2026-02-09T19:17:20.3624028Z [1mindex 35ad700..45753a6 100644[m
2026-02-09T19:17:20.3624171Z [1m--- a/srmhd_solve_2d.jl[m
2026-02-09T19:17:20.3624289Z [1m+++ b/srmhd_solve_2d.jl[m
2026-02-09T19:17:20.3624409Z [36m@@ -64,8 +64,10 @@[m [mend[m
2026-02-09T19:17:20.3624719Z  Solve the 2D SRMHD problem using constrained transport for ∇·B = 0.[m
2026-02-09T19:17:20.3624959Z  Same structure as the IdealMHDEquations{2} solver.[m
2026-02-09T19:17:20.3625049Z  """[m
2026-02-09T19:17:20.3625655Z [31m-function solve_hyperbolic(prob::HyperbolicProblem2D{<:SRMHDEquations{2}};[m
2026-02-09T19:17:20.3626155Z [31m-        method::Symbol = :ssprk3, vector_potential = nothing)[m
2026-02-09T19:17:20.3626427Z [32m+[m[32mfunction solve_hyperbolic([m
2026-02-09T19:17:20.3627164Z [32m+[m[32m        prob::HyperbolicProblem2D{<:SRMHDEquations{2}};[m
2026-02-09T19:17:20.3627664Z [32m+[m[32m        method::Symbol = :ssprk3, vector_potential = nothing[m
2026-02-09T19:17:20.3628030Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3628249Z      mesh = prob.mesh[m
2026-02-09T19:17:20.3628476Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.3628680Z      dx, dy = mesh.dx, mesh.dy[m
2026-02-09T19:17:20.3656969Z [34m[ 99/151] Checking `src/hyperbolic/stiff_sources.jl` ......................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3670883Z [1mdiff --git a/stiff_sources.jl b/stiff_sources.jl[m
2026-02-09T19:17:20.3671112Z [1mindex 80697bf..781b3bc 100644[m
2026-02-09T19:17:20.3671312Z [1m--- a/stiff_sources.jl[m
2026-02-09T19:17:20.3671503Z [1m+++ b/stiff_sources.jl[m
2026-02-09T19:17:20.3671656Z [36m@@ -95,8 +95,10 @@[m [mend[m
2026-02-09T19:17:20.3671750Z      Bx = u[6][m
2026-02-09T19:17:20.3671843Z      By = u[7][m
2026-02-09T19:17:20.3671932Z      Bz = u[8][m
2026-02-09T19:17:20.3672343Z [31m-    return SVector(zero(η), zero(η), zero(η), zero(η), zero(η),[m
2026-02-09T19:17:20.3672601Z [31m-        -η * Bx, -η * By, -η * Bz)[m
2026-02-09T19:17:20.3672857Z [32m+[m[32m    return SVector([m
2026-02-09T19:17:20.3673227Z [32m+[m[32m        zero(η), zero(η), zero(η), zero(η), zero(η),[m
2026-02-09T19:17:20.3673506Z [32m+[m[32m        -η * Bx, -η * By, -η * Bz[m
2026-02-09T19:17:20.3673683Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3673827Z  end[m
2026-02-09T19:17:20.3673963Z  [m
2026-02-09T19:17:20.3674824Z  @inline function stiff_source_jacobian(src::ResistiveSource, law::IdealMHDEquations, w::SVector{8}, u::SVector{8})[m
2026-02-09T19:17:20.3697903Z [34m[100/151] Checking `src/hyperbolic/viscous_flux.jl` .......................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3711741Z [1mdiff --git a/viscous_flux.jl b/viscous_flux.jl[m
2026-02-09T19:17:20.3711971Z [1mindex 2040673..58b3998 100644[m
2026-02-09T19:17:20.3712160Z [1m--- a/viscous_flux.jl[m
2026-02-09T19:17:20.3712371Z [1m+++ b/viscous_flux.jl[m
2026-02-09T19:17:20.3712845Z [36m@@ -49,8 +49,10 @@[m [mcross-derivatives `∂vx/∂y` and `∂vy/∂y` must be provided (4-cell average[m
2026-02-09T19:17:20.3712936Z  [m
2026-02-09T19:17:20.3713225Z  Returns `SVector(0, τ_xx, τ_xy, vx*τ_xx + vy*τ_xy - q_x)`.[m
2026-02-09T19:17:20.3713377Z  """[m
2026-02-09T19:17:20.3714190Z [31m-@inline function viscous_flux_x_2d(ns::NavierStokesEquations{2}, wL::SVector{4}, wR::SVector{4},[m
2026-02-09T19:17:20.3714428Z [31m-        dvx_dy, dvy_dy, dx)[m
2026-02-09T19:17:20.3714738Z [32m+[m[32m@inline function viscous_flux_x_2d([m
2026-02-09T19:17:20.3715316Z [32m+[m[32m        ns::NavierStokesEquations{2}, wL::SVector{4}, wR::SVector{4},[m
2026-02-09T19:17:20.3715567Z [32m+[m[32m        dvx_dy, dvy_dy, dx[m
2026-02-09T19:17:20.3715740Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3715950Z      ρL, vxL, vyL, PL = wL[m
2026-02-09T19:17:20.3716148Z      ρR, vxR, vyR, PR = wR[m
2026-02-09T19:17:20.3716330Z      μ = ns.mu[m
2026-02-09T19:17:20.3716955Z [36m@@ -90,8 +92,10 @@[m [mcross-derivatives `∂vx/∂x` and `∂vy/∂x` must be provided (4-cell average[m
2026-02-09T19:17:20.3717133Z  [m
2026-02-09T19:17:20.3717544Z  Returns `SVector(0, τ_yx, τ_yy, vx*τ_yx + vy*τ_yy - q_y)`.[m
2026-02-09T19:17:20.3717695Z  """[m
2026-02-09T19:17:20.3718488Z [31m-@inline function viscous_flux_y_2d(ns::NavierStokesEquations{2}, wB::SVector{4}, wT::SVector{4},[m
2026-02-09T19:17:20.3718913Z [31m-        dvx_dx, dvy_dx, dy)[m
2026-02-09T19:17:20.3719237Z [32m+[m[32m@inline function viscous_flux_y_2d([m
2026-02-09T19:17:20.3719792Z [32m+[m[32m        ns::NavierStokesEquations{2}, wB::SVector{4}, wT::SVector{4},[m
2026-02-09T19:17:20.3720024Z [32m+[m[32m        dvx_dx, dvy_dx, dy[m
2026-02-09T19:17:20.3720194Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3720391Z      ρB, vxB, vyB, PB = wB[m
2026-02-09T19:17:20.3720585Z      ρT, vxT, vyT, PT = wT[m
2026-02-09T19:17:20.3720745Z      μ = ns.mu[m
2026-02-09T19:17:20.3757659Z [34m[101/151] Checking `src/hyperbolic/weno.jl` .................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3772065Z [1mdiff --git a/weno.jl b/weno.jl[m
2026-02-09T19:17:20.3772491Z [1mindex 77d135f..6c7cf12 100644[m
2026-02-09T19:17:20.3772667Z [1m--- a/weno.jl[m
2026-02-09T19:17:20.3772849Z [1m+++ b/weno.jl[m
2026-02-09T19:17:20.3773113Z [36m@@ -27,7 +27,7 @@[m [mstruct WENO5{FT}[m
2026-02-09T19:17:20.3773286Z      p::Int[m
2026-02-09T19:17:20.3773420Z  end[m
2026-02-09T19:17:20.3773554Z  [m
2026-02-09T19:17:20.3773756Z [31m-WENO5() = WENO5(1e-6, 2)[m
2026-02-09T19:17:20.3773994Z [32m+[m[32mWENO5() = WENO5(1.0e-6, 2)[m
2026-02-09T19:17:20.3774140Z  [m
2026-02-09T19:17:20.3774425Z  # ============================================================[m
2026-02-09T19:17:20.3774870Z  # nghost: number of ghost cells required by each reconstruction[m
2026-02-09T19:17:20.3807224Z [34m[102/151] Checking `src/hyperbolic/weno3.jl` ................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3821724Z [1mdiff --git a/weno3.jl b/weno3.jl[m
2026-02-09T19:17:20.3821948Z [1mindex 0804699..1542020 100644[m
2026-02-09T19:17:20.3822142Z [1m--- a/weno3.jl[m
2026-02-09T19:17:20.3822313Z [1m+++ b/weno3.jl[m
2026-02-09T19:17:20.3822577Z [36m@@ -23,7 +23,7 @@[m [mstruct WENO3{FT}[m
2026-02-09T19:17:20.3822767Z      epsilon::FT[m
2026-02-09T19:17:20.3822912Z  end[m
2026-02-09T19:17:20.3823038Z  [m
2026-02-09T19:17:20.3823241Z [31m-WENO3() = WENO3(1e-6)[m
2026-02-09T19:17:20.3823471Z [32m+[m[32mWENO3() = WENO3(1.0e-6)[m
2026-02-09T19:17:20.3823548Z  [m
2026-02-09T19:17:20.3823705Z  # ============================================================[m
2026-02-09T19:17:20.3823852Z  # Scalar WENO-3 reconstruction[m
2026-02-09T19:17:20.3834686Z [34m[103/151] Checking `src/mesh/abstract_mesh.jl` ............................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3879161Z [34m[104/151] Checking `src/mesh/structured_mesh.jl` ............................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3906293Z [34m[105/151] Checking `src/mesh/structured_mesh_3d.jl` .......................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3921142Z [1mdiff --git a/structured_mesh_3d.jl b/structured_mesh_3d.jl[m
2026-02-09T19:17:20.3921431Z [1mindex c1f4eef..b15072d 100644[m
2026-02-09T19:17:20.3921678Z [1m--- a/structured_mesh_3d.jl[m
2026-02-09T19:17:20.3921913Z [1m+++ b/structured_mesh_3d.jl[m
2026-02-09T19:17:20.3922382Z [36m@@ -30,8 +30,10 @@[m [mstruct StructuredMesh3D{FT} <: AbstractMesh{3}[m
2026-02-09T19:17:20.3922580Z      dz::FT[m
2026-02-09T19:17:20.3922745Z  end[m
2026-02-09T19:17:20.3922882Z  [m
2026-02-09T19:17:20.3923472Z [31m-function StructuredMesh3D(xmin::FT, xmax::FT, ymin::FT, ymax::FT,[m
2026-02-09T19:17:20.3923957Z [31m-        zmin::FT, zmax::FT, nx::Int, ny::Int, nz::Int) where {FT}[m
2026-02-09T19:17:20.3924233Z [32m+[m[32mfunction StructuredMesh3D([m
2026-02-09T19:17:20.3924654Z [32m+[m[32m        xmin::FT, xmax::FT, ymin::FT, ymax::FT,[m
2026-02-09T19:17:20.3925113Z [32m+[m[32m        zmin::FT, zmax::FT, nx::Int, ny::Int, nz::Int[m
2026-02-09T19:17:20.3925345Z [32m+[m[32m    ) where {FT}[m
2026-02-09T19:17:20.3925576Z      dx = (xmax - xmin) / nx[m
2026-02-09T19:17:20.3925774Z      dy = (ymax - ymin) / ny[m
2026-02-09T19:17:20.3925986Z      dz = (zmax - zmin) / nz[m
2026-02-09T19:17:20.3929460Z [34m[106/151] Checking `src/metric/abstract_metric.jl` ........................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3947346Z [34m[107/151] Checking `src/metric/kerr.jl` ...................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3976154Z [34m[108/151] Checking `src/metric/metric_data.jl` ............................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3990223Z [1mdiff --git a/metric_data.jl b/metric_data.jl[m
2026-02-09T19:17:20.3990455Z [1mindex 04ec291..95d0900 100644[m
2026-02-09T19:17:20.3990679Z [1m--- a/metric_data.jl[m
2026-02-09T19:17:20.3991117Z [1m+++ b/metric_data.jl[m
2026-02-09T19:17:20.3991949Z [36m@@ -148,6 +148,8 @@[m [mfunction precompute_metric_at_faces(metric::AbstractMetric{2}, mesh::StructuredM[m
2026-02-09T19:17:20.3992444Z          sqrtg_yf[i, j] = sqrt_gamma(metric, xf, yf)[m
2026-02-09T19:17:20.3992610Z      end[m
2026-02-09T19:17:20.3992742Z  [m
2026-02-09T19:17:20.3993227Z [31m-    return (alpha_xf, alpha_yf, betax_xf, betay_xf, betax_yf, betay_yf,[m
2026-02-09T19:17:20.3993471Z [31m-            sqrtg_xf, sqrtg_yf)[m
2026-02-09T19:17:20.3993671Z [32m+[m[32m    return ([m
2026-02-09T19:17:20.3994139Z [32m+[m[32m        alpha_xf, alpha_yf, betax_xf, betay_xf, betax_yf, betay_yf,[m
2026-02-09T19:17:20.3994397Z [32m+[m[32m        sqrtg_xf, sqrtg_yf,[m
2026-02-09T19:17:20.3994577Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3994723Z  end[m
2026-02-09T19:17:20.4002705Z [34m[109/151] Checking `src/metric/minkowski.jl` ................................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.4018138Z [34m[110/151] Checking `src/metric/schwarzschild.jl` ............................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.4065204Z [34m[111/151] Checking `src/physics/turbulence/k_epsilon.jl` ..................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.4080187Z [1mdiff --git a/k_epsilon.jl b/k_epsilon.jl[m
2026-02-09T19:17:20.4080454Z [1mindex 21e5aa2..cf30d24 100644[m
2026-02-09T19:17:20.4080678Z [1m--- a/k_epsilon.jl[m
2026-02-09T19:17:20.4080887Z [1m+++ b/k_epsilon.jl[m
2026-02-09T19:17:20.4081257Z [36m@@ -70,7 +70,7 @@[m [mmodel = StandardKEpsilon(;[m
2026-02-09T19:17:20.4081418Z  )[m
2026-02-09T19:17:20.4081575Z  ```[m
2026-02-09T19:17:20.4081731Z  """[m
2026-02-09T19:17:20.4082005Z [31m-struct StandardKEpsilon{T<:Real}[m
2026-02-09T19:17:20.4082338Z [32m+[m[32mstruct StandardKEpsilon{T <: Real}[m
2026-02-09T19:17:20.4082544Z      C_mu::T[m
2026-02-09T19:17:20.4082750Z      sigma_k::T[m
2026-02-09T19:17:20.4083002Z      sigma_epsilon::T[m
2026-02-09T19:17:20.4083466Z [36m@@ -117,18 +117,18 @@[m [mFor dimensional problems with density:[m
2026-02-09T19:17:20.4083638Z  # Returns[m
2026-02-09T19:17:20.4083945Z  Turbulent viscosity (same shape as inputs).[m
2026-02-09T19:17:20.4084107Z  """[m
2026-02-09T19:17:20.4084986Z [31m-function compute_turbulent_viscosity(model::StandardKEpsilon, k::Real, epsilon::Real; rho::Real=1.0)[m
2026-02-09T19:17:20.4085883Z [32m+[m[32mfunction compute_turbulent_viscosity(model::StandardKEpsilon, k::Real, epsilon::Real; rho::Real = 1.0)[m
2026-02-09T19:17:20.4086161Z      # Safeguard against division by zero[m
2026-02-09T19:17:20.4086426Z [31m-    eps_safe = max(epsilon, 1e-10)[m
2026-02-09T19:17:20.4086724Z [32m+[m[32m    eps_safe = max(epsilon, 1.0e-10)[m
2026-02-09T19:17:20.4086926Z      k_safe = max(k, 0.0)[m
2026-02-09T19:17:20.4087247Z      return rho * model.C_mu * k_safe^2 / eps_safe[m
2026-02-09T19:17:20.4087402Z  end[m
2026-02-09T19:17:20.4087762Z  [m
2026-02-09T19:17:20.4088970Z [31m-function compute_turbulent_viscosity(model::StandardKEpsilon, k::AbstractVector, epsilon::AbstractVector; rho=1.0)[m
2026-02-09T19:17:20.4091061Z [32m+[m[32mfunction compute_turbulent_viscosity(model::StandardKEpsilon, k::AbstractVector, epsilon::AbstractVector; rho = 1.0)[m
2026-02-09T19:17:20.4092308Z      nu_t = similar(k)[m
2026-02-09T19:17:20.4092950Z      rho_vec = rho isa Real ? fill(rho, length(k)) : rho[m
2026-02-09T19:17:20.4093695Z      @inbounds for i in eachindex(k)[m
2026-02-09T19:17:20.4094322Z [31m-        eps_safe = max(epsilon[i], 1e-10)[m
2026-02-09T19:17:20.4095115Z [32m+[m[32m        eps_safe = max(epsilon[i], 1.0e-10)[m
2026-02-09T19:17:20.4095763Z          k_safe = max(k[i], 0.0)[m
2026-02-09T19:17:20.4096503Z          nu_t[i] = rho_vec[i] * model.C_mu * k_safe^2 / eps_safe[m
2026-02-09T19:17:20.4097095Z      end[m
2026-02-09T19:17:20.4097776Z [36m@@ -238,7 +238,7 @@[m [mfunction epsilon_source_function(x, y, t, u_tuple, p)[m
2026-02-09T19:17:20.4098701Z      Pk = haskey(p, :Pk) && !isnothing(p.Pk) ? p.Pk : 0.0[m
2026-02-09T19:17:20.4099817Z  [m
2026-02-09T19:17:20.4100209Z      # Safeguards[m
2026-02-09T19:17:20.4100684Z [31m-    k_safe = max(k, 1e-10)[m
2026-02-09T19:17:20.4101516Z [32m+[m[32m    k_safe = max(k, 1.0e-10)[m
2026-02-09T19:17:20.4102180Z      eps_by_k = epsilon / k_safe[m
2026-02-09T19:17:20.4102652Z  [m
2026-02-09T19:17:20.4103024Z      # Source terms[m
2026-02-09T19:17:20.4103729Z [36m@@ -266,7 +266,7 @@[m [mCreate a diffusion function for the k equation.[m
2026-02-09T19:17:20.4104744Z  A diffusion function `(x, y, t, u, p) -> Γk` suitable for `FVMProblem`.[m
2026-02-09T19:17:20.4105446Z  """[m
2026-02-09T19:17:20.4106348Z  function make_k_diffusion_function(model::StandardKEpsilon, nu::Real, nu_t_field::AbstractVector)[m
2026-02-09T19:17:20.4107378Z [31m-    return function(x, y, t, u, p)[m
2026-02-09T19:17:20.4108064Z [32m+[m[32m    return function (x, y, t, u, p)[m
2026-02-09T19:17:20.4108959Z          # Get node index from parameters[m
2026-02-09T19:17:20.4109676Z          i = haskey(p, :node_index) ? p.node_index : 1[m
2026-02-09T19:17:20.4110452Z          nu_t = i <= length(nu_t_field) ? nu_t_field[i] : 0.0[m
2026-02-09T19:17:20.4111376Z [36m@@ -292,7 +292,7 @@[m [mCreate a diffusion function for the ε equation.[m
2026-02-09T19:17:20.4112414Z  A diffusion function `(x, y, t, u, p) -> Γε` suitable for `FVMProblem`.[m
2026-02-09T19:17:20.4113146Z  """[m
2026-02-09T19:17:20.4114119Z  function make_epsilon_diffusion_function(model::StandardKEpsilon, nu::Real, nu_t_field::AbstractVector)[m
2026-02-09T19:17:20.4115203Z [31m-    return function(x, y, t, u, p)[m
2026-02-09T19:17:20.4115853Z [32m+[m[32m    return function (x, y, t, u, p)[m
2026-02-09T19:17:20.4116570Z          i = haskey(p, :node_index) ? p.node_index : 1[m
2026-02-09T19:17:20.4117327Z          nu_t = i <= length(nu_t_field) ? nu_t_field[i] : 0.0[m
2026-02-09T19:17:20.4118143Z          return nu + nu_t / model.sigma_epsilon[m
2026-02-09T19:17:20.4119237Z [36m@@ -321,11 +321,13 @@[m [mwhere $u^+ = u/u_\tau$ and $y^+ = y u_\tau / \nu$.[m
2026-02-09T19:17:20.4119958Z  # Returns[m
2026-02-09T19:17:20.4120377Z  Friction velocity `u_τ`.[m
2026-02-09T19:17:20.4120842Z  """[m
2026-02-09T19:17:20.4121614Z [31m-function compute_friction_velocity(u_tan::Real, y::Real, nu::Real;[m
2026-02-09T19:17:20.4122731Z [31m-        kappa::Real = 0.41, E::Real = 9.8, max_iter::Int = 10, tol::Real = 1e-5)[m
2026-02-09T19:17:20.4123621Z [32m+[m[32mfunction compute_friction_velocity([m
2026-02-09T19:17:20.4124456Z [32m+[m[32m        u_tan::Real, y::Real, nu::Real;[m
2026-02-09T19:17:20.4125590Z [32m+[m[32m        kappa::Real = 0.41, E::Real = 9.8, max_iter::Int = 10, tol::Real = 1.0e-5[m
2026-02-09T19:17:20.4126378Z [32m+[m[32m    )[m
2026-02-09T19:17:20.4126772Z  [m
2026-02-09T19:17:20.4127237Z      # Initial guess from viscous sublayer[m
2026-02-09T19:17:20.4127963Z [31m-    u_tau = sqrt(abs(nu * u_tan / max(y, 1e-10)))[m
2026-02-09T19:17:20.4129019Z [32m+[m[32m    u_tau = sqrt(abs(nu * u_tan / max(y, 1.0e-10)))[m
2026-02-09T19:17:20.4129631Z  [m
2026-02-09T19:17:20.4129998Z      for _ in 1:max_iter[m
2026-02-09T19:17:20.4130490Z          y_plus = y * u_tau / nu[m
2026-02-09T19:17:20.4131555Z [36m@@ -339,7 +341,7 @@[m [mfunction compute_friction_velocity(u_tan::Real, y::Real, nu::Real;[m
2026-02-09T19:17:20.4132586Z              df = -u_tan / u_tau^2 - (1.0 / kappa) / u_tau[m
2026-02-09T19:17:20.4133133Z  [m
2026-02-09T19:17:20.4133503Z              delta = f / df[m
2026-02-09T19:17:20.4134068Z [31m-            u_tau = max(u_tau - delta, 1e-10)[m
2026-02-09T19:17:20.4134798Z [32m+[m[32m            u_tau = max(u_tau - delta, 1.0e-10)[m
2026-02-09T19:17:20.4135359Z  [m
2026-02-09T19:17:20.4135726Z              if abs(delta) < tol[m
2026-02-09T19:17:20.4136191Z                  break[m
2026-02-09T19:17:20.4136979Z [36m@@ -389,7 +391,7 @@[m [mCompute equilibrium ε value at the wall for wall functions.[m
2026-02-09T19:17:20.4138026Z  Wall value of ε.[m
2026-02-09T19:17:20.4138420Z  """[m
2026-02-09T19:17:20.4139406Z  function epsilon_wall_value(u_tau::Real, y::Real; kappa::Real = 0.41, C_mu::Real = 0.09)[m
2026-02-09T19:17:20.4141727Z [31m-    return C_mu^0.75 * k_wall_value(u_tau; C_mu=C_mu)^1.5 / (kappa * max(y, 1e-10))[m
2026-02-09T19:17:20.4143567Z [32m+[m[32m    return C_mu^0.75 * k_wall_value(u_tau; C_mu = C_mu)^1.5 / (kappa * max(y, 1.0e-10))[m
2026-02-09T19:17:20.4144938Z  end[m
2026-02-09T19:17:20.4145278Z  [m
2026-02-09T19:17:20.4145922Z  @doc raw"""[m
2026-02-09T19:17:20.4146923Z [36m@@ -402,7 +404,7 @@[m [mParameters for turbulent wall boundary conditions.[m
2026-02-09T19:17:20.4147967Z  - `C_mu::T`: Model constant[m
2026-02-09T19:17:20.4148561Z  - `kappa::T`: von Kármán constant[m
2026-02-09T19:17:20.4149299Z  """[m
2026-02-09T19:17:20.4149749Z [31m-struct TurbulentWallBC{T<:Real}[m
2026-02-09T19:17:20.4150434Z [32m+[m[32mstruct TurbulentWallBC{T <: Real}[m
2026-02-09T19:17:20.4151060Z      roughness::T[m
2026-02-09T19:17:20.4151525Z      C_mu::T[m
2026-02-09T19:17:20.4151917Z      kappa::T[m
2026-02-09T19:17:20.4152831Z [36m@@ -425,7 +427,7 @@[m [mOnly the coefficients are provided here; implementation is deferred.[m
2026-02-09T19:17:20.4154046Z  - `sigma_k1::T`, `sigma_k2::T`: Blending coefficients for k diffusion[m
2026-02-09T19:17:20.4155162Z  - `sigma_omega1::T`, `sigma_omega2::T`: Blending coefficients for ω diffusion[m
2026-02-09T19:17:20.4155897Z  """[m
2026-02-09T19:17:20.4156323Z [31m-struct KappaOmegaSST{T<:Real}[m
2026-02-09T19:17:20.4156955Z [32m+[m[32mstruct KappaOmegaSST{T <: Real}[m
2026-02-09T19:17:20.4157513Z      a1::T[m
2026-02-09T19:17:20.4157912Z      beta_star::T[m
2026-02-09T19:17:20.4158342Z      sigma_k1::T[m
2026-02-09T19:17:20.4181303Z [34m[112/151] Checking `src/problem.jl` .......................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.4234007Z [34m[113/151] Checking `src/schemes/gradients.jl` ................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.4268954Z [34m[114/151] Checking `src/schemes/limiters.jl` ................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.4285491Z [1mdiff --git a/limiters.jl b/limiters.jl[m
2026-02-09T19:17:20.4286127Z [1mindex 8fe6977..b409188 100644[m
2026-02-09T19:17:20.4286578Z [1m--- a/limiters.jl[m
2026-02-09T19:17:20.4286883Z [1m+++ b/limiters.jl[m
2026-02-09T19:17:20.4287252Z [36m@@ -87,7 +87,7 @@[m [mat the cost of accuracy.[m
2026-02-09T19:17:20.4287622Z  # Returns[m
2026-02-09T19:17:20.4287889Z  The minmod of `a` and `b`.[m
2026-02-09T19:17:20.4288159Z  """[m
2026-02-09T19:17:20.4288568Z [31m-@inline function minmod(a::T, b::T) where {T<:Real}[m
2026-02-09T19:17:20.4289386Z [32m+[m[32m@inline function minmod(a::T, b::T) where {T <: Real}[m
2026-02-09T19:17:20.4289838Z      if a > zero(T) && b > zero(T)[m
2026-02-09T19:17:20.4290154Z          return min(a, b)[m
2026-02-09T19:17:20.4290470Z      elseif a < zero(T) && b < zero(T)[m
2026-02-09T19:17:20.4291184Z [36m@@ -116,7 +116,7 @@[m [mdiscontinuities but may be slightly oscillatory near extrema.[m
2026-02-09T19:17:20.4291700Z  # Returns[m
2026-02-09T19:17:20.4291981Z  The superbee limiter value.[m
2026-02-09T19:17:20.4292268Z  """[m
2026-02-09T19:17:20.4292650Z [31m-@inline function superbee(a::T, b::T) where {T<:Real}[m
2026-02-09T19:17:20.4293219Z [32m+[m[32m@inline function superbee(a::T, b::T) where {T <: Real}[m
2026-02-09T19:17:20.4293715Z      return max(minmod(2a, b), minmod(a, 2b))[m
2026-02-09T19:17:20.4294042Z  end[m
2026-02-09T19:17:20.4294234Z  [m
2026-02-09T19:17:20.4294567Z [36m@@ -142,7 +142,7 @@[m [musing a harmonic mean formulation.[m
2026-02-09T19:17:20.4294954Z  # Returns[m
2026-02-09T19:17:20.4295221Z  The van Leer limiter value.[m
2026-02-09T19:17:20.4295491Z  """[m
2026-02-09T19:17:20.4295853Z [31m-@inline function van_leer(a::T, b::T) where {T<:Real}[m
2026-02-09T19:17:20.4296415Z [32m+[m[32m@inline function van_leer(a::T, b::T) where {T <: Real}[m
2026-02-09T19:17:20.4297039Z      ab = a * b[m
2026-02-09T19:17:20.4297280Z      if ab > zero(T)[m
2026-02-09T19:17:20.4297561Z          return 2ab / (a + b)[m
2026-02-09T19:17:20.4298106Z [36m@@ -171,7 +171,7 @@[m [ma smoothing factor for very small values.[m
2026-02-09T19:17:20.4298524Z  # Returns[m
2026-02-09T19:17:20.4299038Z  The Venkatakrishnan limiter value in [0, 1].[m
2026-02-09T19:17:20.4299437Z  """[m
2026-02-09T19:17:20.4299898Z [31m-@inline function venkatakrishnan(r::T, ε::T=T(1e-6)) where {T<:Real}[m
2026-02-09T19:17:20.4300616Z [32m+[m[32m@inline function venkatakrishnan(r::T, ε::T = T(1.0e-6)) where {T <: Real}[m
2026-02-09T19:17:20.4301108Z      if r < ε[m
2026-02-09T19:17:20.4301351Z          return zero(T)[m
2026-02-09T19:17:20.4301637Z      end[m
2026-02-09T19:17:20.4302038Z [36m@@ -204,7 +204,7 @@[m [mgradient reconstruction on unstructured meshes.[m
2026-02-09T19:17:20.4302477Z  # Returns[m
2026-02-09T19:17:20.4302744Z  The limiting factor in [0, 1].[m
2026-02-09T19:17:20.4303047Z  """[m
2026-02-09T19:17:20.4303590Z [31m-@inline function barth_jespersen(φ_center::T, φ_min::T, φ_max::T, φ_face::T) where {T<:Real}[m
2026-02-09T19:17:20.4304506Z [32m+[m[32m@inline function barth_jespersen(φ_center::T, φ_min::T, φ_max::T, φ_face::T) where {T <: Real}[m
2026-02-09T19:17:20.4305087Z      Δ = φ_face - φ_center[m
2026-02-09T19:17:20.4305370Z      if abs(Δ) < eps(T)[m
2026-02-09T19:17:20.4305646Z          return one(T)[m
2026-02-09T19:17:20.4306038Z [36m@@ -234,7 +234,7 @@[m [mwhile maintaining TVD properties.[m
2026-02-09T19:17:20.4306427Z  # Returns[m
2026-02-09T19:17:20.4306679Z  The Koren limiter value.[m
2026-02-09T19:17:20.4306950Z  """[m
2026-02-09T19:17:20.4307322Z [31m-@inline function koren(r::T, β::T=T(1//3)) where {T<:Real}[m
2026-02-09T19:17:20.4307918Z [32m+[m[32m@inline function koren(r::T, β::T = T(1 // 3)) where {T <: Real}[m
2026-02-09T19:17:20.4308474Z      return max(zero(T), min(2r, min((one(T) + 2r) / 3, T(2))))[m
2026-02-09T19:17:20.4308983Z  end[m
2026-02-09T19:17:20.4309173Z  [m
2026-02-09T19:17:20.4309522Z [36m@@ -256,7 +256,7 @@[m [moptimized for second-order accuracy.[m
2026-02-09T19:17:20.4309919Z  # Returns[m
2026-02-09T19:17:20.4310182Z  The OSPRE limiter value.[m
2026-02-09T19:17:20.4310454Z  """[m
2026-02-09T19:17:20.4310871Z [31m-@inline function ospre(r::T) where {T<:Real}[m
2026-02-09T19:17:20.4311375Z [32m+[m[32m@inline function ospre(r::T) where {T <: Real}[m
2026-02-09T19:17:20.4311759Z      r² = r * r[m
2026-02-09T19:17:20.4312011Z      denom = r² + r + one(T)[m
2026-02-09T19:17:20.4312302Z      if denom < eps(T)[m
2026-02-09T19:17:20.4312579Z [36m@@ -270,42 +270,42 @@[m [mend[m
2026-02-09T19:17:20.4312844Z  [m
2026-02-09T19:17:20.4313086Z  Apply the minmod limiter.[m
2026-02-09T19:17:20.4313359Z  """[m
2026-02-09T19:17:20.4313839Z [31m-@inline apply_limiter(::MinmodLimiter, a::T, b::T) where {T<:Real} = minmod(a, b)[m
2026-02-09T19:17:20.4314664Z [32m+[m[32m@inline apply_limiter(::MinmodLimiter, a::T, b::T) where {T <: Real} = minmod(a, b)[m
2026-02-09T19:17:20.4315185Z  [m
2026-02-09T19:17:20.4315388Z  """[m
2026-02-09T19:17:20.4315768Z      apply_limiter(::SuperbeeLimiter, a::T, b::T) where {T<:Real}[m
2026-02-09T19:17:20.4316158Z  [m
2026-02-09T19:17:20.4316409Z  Apply the superbee limiter.[m
2026-02-09T19:17:20.4316688Z  """[m
2026-02-09T19:17:20.4317196Z [31m-@inline apply_limiter(::SuperbeeLimiter, a::T, b::T) where {T<:Real} = superbee(a, b)[m
2026-02-09T19:17:20.4318037Z [32m+[m[32m@inline apply_limiter(::SuperbeeLimiter, a::T, b::T) where {T <: Real} = superbee(a, b)[m
2026-02-09T19:17:20.4318570Z  [m
2026-02-09T19:17:20.4318994Z  """[m
2026-02-09T19:17:20.4319576Z      apply_limiter(::VanLeerLimiter, a::T, b::T) where {T<:Real}[m
2026-02-09T19:17:20.4320051Z  [m
2026-02-09T19:17:20.4320389Z  Apply the van Leer limiter.[m
2026-02-09T19:17:20.4320710Z  """[m
2026-02-09T19:17:20.4330718Z [31m-@inline apply_limiter(::VanLeerLimiter, a::T, b::T) where {T<:Real} = van_leer(a, b)[m
2026-02-09T19:17:20.4331815Z [32m+[m[32m@inline apply_limiter(::VanLeerLimiter, a::T, b::T) where {T <: Real} = van_leer(a, b)[m
2026-02-09T19:17:20.4332352Z  [m
2026-02-09T19:17:20.4332718Z  """[m
2026-02-09T19:17:20.4333128Z      apply_limiter(::VenkatakrishnanLimiter, r::T) where {T<:Real}[m
2026-02-09T19:17:20.4333543Z  [m
2026-02-09T19:17:20.4333827Z  Apply the Venkatakrishnan limiter.[m
2026-02-09T19:17:20.4334138Z  """[m
2026-02-09T19:17:20.4334700Z [31m-@inline apply_limiter(::VenkatakrishnanLimiter, r::T) where {T<:Real} = venkatakrishnan(r)[m
2026-02-09T19:17:20.4335635Z [32m+[m[32m@inline apply_limiter(::VenkatakrishnanLimiter, r::T) where {T <: Real} = venkatakrishnan(r)[m
2026-02-09T19:17:20.4336212Z  [m
2026-02-09T19:17:20.4336407Z  """[m
2026-02-09T19:17:20.4336742Z      apply_limiter(::KorenLimiter, r::T) where {T<:Real}[m
2026-02-09T19:17:20.4337111Z  [m
2026-02-09T19:17:20.4337352Z  Apply the Koren limiter.[m
2026-02-09T19:17:20.4337636Z  """[m
2026-02-09T19:17:20.4338077Z [31m-@inline apply_limiter(::KorenLimiter, r::T) where {T<:Real} = koren(r)[m
2026-02-09T19:17:20.4339024Z [32m+[m[32m@inline apply_limiter(::KorenLimiter, r::T) where {T <: Real} = koren(r)[m
2026-02-09T19:17:20.4339536Z  [m
2026-02-09T19:17:20.4339734Z  """[m
2026-02-09T19:17:20.4340075Z      apply_limiter(::OspreLimiter, r::T) where {T<:Real}[m
2026-02-09T19:17:20.4340431Z  [m
2026-02-09T19:17:20.4340673Z  Apply the OSPRE limiter.[m
2026-02-09T19:17:20.4340941Z  """[m
2026-02-09T19:17:20.4341472Z [31m-@inline apply_limiter(::OspreLimiter, r::T) where {T<:Real} = ospre(r)[m
2026-02-09T19:17:20.4342197Z [32m+[m[32m@inline apply_limiter(::OspreLimiter, r::T) where {T <: Real} = ospre(r)[m
2026-02-09T19:17:20.4342663Z  [m
2026-02-09T19:17:20.4342865Z  @doc raw"""[m
2026-02-09T19:17:20.4343292Z      compute_slope_ratio(φ_L::T, φ_C::T, φ_R::T) where {T<:Real} -> T[m
2026-02-09T19:17:20.4343877Z [36m@@ -324,11 +324,11 @@[m [mr = \frac{\phi_C - \phi_L}{\phi_R - \phi_C}[m
2026-02-09T19:17:20.4344297Z  # Returns[m
2026-02-09T19:17:20.4344723Z  The slope ratio, or a large value if the denominator is near zero.[m
2026-02-09T19:17:20.4345154Z  """[m
2026-02-09T19:17:20.4345629Z [31m-@inline function compute_slope_ratio(φ_L::T, φ_C::T, φ_R::T) where {T<:Real}[m
2026-02-09T19:17:20.4346394Z [32m+[m[32m@inline function compute_slope_ratio(φ_L::T, φ_C::T, φ_R::T) where {T <: Real}[m
2026-02-09T19:17:20.4346916Z      Δ_down = φ_R - φ_C[m
2026-02-09T19:17:20.4347181Z      Δ_up = φ_C - φ_L[m
2026-02-09T19:17:20.4347464Z      if abs(Δ_down) < eps(T)[m
2026-02-09T19:17:20.4347800Z [31m-        return sign(Δ_up) * T(1e10)[m
2026-02-09T19:17:20.4348183Z [32m+[m[32m        return sign(Δ_up) * T(1.0e10)[m
2026-02-09T19:17:20.4348513Z      end[m
2026-02-09T19:17:20.4348871Z      return Δ_up / Δ_down[m
2026-02-09T19:17:20.4349136Z  end[m
2026-02-09T19:17:20.4349622Z [36m@@ -345,7 +345,7 @@[m [mSelect an appropriate limiter based on problem characteristics.[m
2026-02-09T19:17:20.4350154Z  # Returns[m
2026-02-09T19:17:20.4350437Z  An appropriate limiter instance.[m
2026-02-09T19:17:20.4350749Z  """[m
2026-02-09T19:17:20.4351248Z [31m-function select_limiter(problem_type::Symbol, mesh_type::Symbol=:structured)[m
2026-02-09T19:17:20.4352083Z [32m+[m[32mfunction select_limiter(problem_type::Symbol, mesh_type::Symbol = :structured)[m
2026-02-09T19:17:20.4352672Z      if mesh_type == :unstructured[m
2026-02-09T19:17:20.4353052Z          return VenkatakrishnanLimiter()[m
2026-02-09T19:17:20.4353376Z      end[m
2026-02-09T19:17:20.5142173Z [34m[115/151] Checking `src/schemes/muscl.jl` .................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.5160572Z [1mdiff --git a/muscl.jl b/muscl.jl[m
2026-02-09T19:17:20.5161176Z [1mindex 1755054..3d8a393 100644[m
2026-02-09T19:17:20.5161541Z [1m--- a/muscl.jl[m
2026-02-09T19:17:20.5161820Z [1m+++ b/muscl.jl[m
2026-02-09T19:17:20.5162428Z [36m@@ -19,7 +19,7 @@[m [mMUSCL reconstruction scheme configuration.[m
2026-02-09T19:17:20.5163562Z  - `limiter::L`: The flux limiter to use[m
2026-02-09T19:17:20.5164305Z  - `gradient_method::G`: The gradient reconstruction method[m
2026-02-09T19:17:20.5165124Z  """[m
2026-02-09T19:17:20.5165826Z [31m-struct MUSCLScheme{L<:AbstractLimiter, G<:AbstractGradientMethod}[m
2026-02-09T19:17:20.5166953Z [32m+[m[32mstruct MUSCLScheme{L <: AbstractLimiter, G <: AbstractGradientMethod}[m
2026-02-09T19:17:20.5167774Z      limiter::L[m
2026-02-09T19:17:20.5168195Z      gradient_method::G[m
2026-02-09T19:17:20.5168611Z  end[m
2026-02-09T19:17:20.5169207Z [36m@@ -30,8 +30,8 @@[m [mend[m
2026-02-09T19:17:20.5169933Z  Create a MUSCL scheme with specified limiter and gradient method.[m
2026-02-09T19:17:20.5170595Z  """[m
2026-02-09T19:17:20.5170978Z  function MUSCLScheme(;[m
2026-02-09T19:17:20.5171724Z [31m-        limiter::AbstractLimiter=VanLeerLimiter(),[m
2026-02-09T19:17:20.5172685Z [31m-        gradient_method::AbstractGradientMethod=GreenGaussGradient()[m
2026-02-09T19:17:20.5173703Z [32m+[m[32m        limiter::AbstractLimiter = VanLeerLimiter(),[m
2026-02-09T19:17:20.5174727Z [32m+[m[32m        gradient_method::AbstractGradientMethod = GreenGaussGradient()[m
2026-02-09T19:17:20.5175459Z      )[m
2026-02-09T19:17:20.5175926Z      return MUSCLScheme(limiter, gradient_method)[m
2026-02-09T19:17:20.5176460Z  end[m
2026-02-09T19:17:20.5177179Z [36m@@ -235,13 +235,13 @@[m [mA flux function wrapper that applies MUSCL reconstruction.[m
2026-02-09T19:17:20.5178246Z  This can be used to create a flux function compatible with FVMProblem[m
2026-02-09T19:17:20.5179247Z  that uses MUSCL reconstruction internally.[m
2026-02-09T19:17:20.5179774Z  """[m
2026-02-09T19:17:20.5180287Z [31m-struct MUSCLFluxFunction{S<:MUSCLScheme, D, V}[m
2026-02-09T19:17:20.5181091Z [32m+[m[32mstruct MUSCLFluxFunction{S <: MUSCLScheme, D, V}[m
2026-02-09T19:17:20.5181737Z      scheme::S[m
2026-02-09T19:17:20.5182225Z      diffusion::D  # D(x, y, t, u, p) -> scalar[m
2026-02-09T19:17:20.5183091Z      velocity::V   # v(x, y, t, u, p) -> (vx, vy), or nothing for pure diffusion[m
2026-02-09T19:17:20.5183758Z  end[m
2026-02-09T19:17:20.5184064Z  [m
2026-02-09T19:17:20.5184886Z [31m-function MUSCLFluxFunction(scheme::MUSCLScheme; diffusion, velocity=nothing)[m
2026-02-09T19:17:20.5186240Z [32m+[m[32mfunction MUSCLFluxFunction(scheme::MUSCLScheme; diffusion, velocity = nothing)[m
2026-02-09T19:17:20.5187326Z      return MUSCLFluxFunction(scheme, diffusion, velocity)[m
2026-02-09T19:17:20.5187931Z  end[m
2026-02-09T19:17:20.5188230Z  [m
2026-02-09T19:17:20.5189112Z [36m@@ -321,41 +321,41 @@[m [mAn FVMProblem configured with MUSCL reconstruction.[m
2026-02-09T19:17:20.5189937Z  function create_muscl_problem([m
2026-02-09T19:17:20.5190473Z          mesh::FVMGeometry,[m
2026-02-09T19:17:20.5190988Z          BCs::BoundaryConditions,[m
2026-02-09T19:17:20.5191733Z [31m-        ICs::InternalConditions=InternalConditions();[m
2026-02-09T19:17:20.5192652Z [32m+[m[32m        ICs::InternalConditions = InternalConditions();[m
2026-02-09T19:17:20.5193364Z          diffusion_function,[m
2026-02-09T19:17:20.5193927Z [31m-        diffusion_parameters=nothing,[m
2026-02-09T19:17:20.5194534Z [31m-        velocity_function=nothing,[m
2026-02-09T19:17:20.5195142Z [31m-        velocity_parameters=nothing,[m
2026-02-09T19:17:20.5195868Z [31m-        source_function=(x, y, t, u, p) -> zero(typeof(x)),[m
2026-02-09T19:17:20.5196584Z [31m-        source_parameters=nothing,[m
2026-02-09T19:17:20.5197237Z [32m+[m[32m        diffusion_parameters = nothing,[m
2026-02-09T19:17:20.5197925Z [32m+[m[32m        velocity_function = nothing,[m
2026-02-09T19:17:20.5198603Z [32m+[m[32m        velocity_parameters = nothing,[m
2026-02-09T19:17:20.5199579Z [32m+[m[32m        source_function = (x, y, t, u, p) -> zero(typeof(x)),[m
2026-02-09T19:17:20.5200368Z [32m+[m[32m        source_parameters = nothing,[m
2026-02-09T19:17:20.5200967Z          initial_condition,[m
2026-02-09T19:17:20.5201724Z [31m-        initial_time=0.0,[m
2026-02-09T19:17:20.5202277Z [32m+[m[32m        initial_time = 0.0,[m
2026-02-09T19:17:20.5202796Z          final_time,[m
2026-02-09T19:17:20.5203618Z [31m-        limiter::AbstractLimiter=VanLeerLimiter(),[m
2026-02-09T19:17:20.5204629Z [31m-        gradient_method::AbstractGradientMethod=GreenGaussGradient(),[m
2026-02-09T19:17:20.5205633Z [32m+[m[32m        limiter::AbstractLimiter = VanLeerLimiter(),[m
2026-02-09T19:17:20.5206693Z [32m+[m[32m        gradient_method::AbstractGradientMethod = GreenGaussGradient(),[m
2026-02-09T19:17:20.5207475Z          kwargs...[m
2026-02-09T19:17:20.5207848Z      )[m
2026-02-09T19:17:20.5208545Z [31m-    scheme = MUSCLScheme(limiter=limiter, gradient_method=gradient_method)[m
2026-02-09T19:17:20.5209896Z [32m+[m[32m    scheme = MUSCLScheme(limiter = limiter, gradient_method = gradient_method)[m
2026-02-09T19:17:20.5210677Z  [m
2026-02-09T19:17:20.5211205Z      # Wrap functions to include parameters[m
2026-02-09T19:17:20.5212108Z      D_wrapped = (x, y, t, u, p) -> diffusion_function(x, y, t, u, diffusion_parameters)[m
2026-02-09T19:17:20.5213044Z      v_wrapped = isnothing(velocity_function) ? nothing :[m
2026-02-09T19:17:20.5213965Z [31m-                (x, y, t, u, p) -> velocity_function(x, y, t, u, velocity_parameters)[m
2026-02-09T19:17:20.5214994Z [32m+[m[32m        (x, y, t, u, p) -> velocity_function(x, y, t, u, velocity_parameters)[m
2026-02-09T19:17:20.5215686Z  [m
2026-02-09T19:17:20.5216417Z [31m-    flux_fn = MUSCLFluxFunction(scheme; diffusion=D_wrapped, velocity=v_wrapped)[m
2026-02-09T19:17:20.5217694Z [32m+[m[32m    flux_fn = MUSCLFluxFunction(scheme; diffusion = D_wrapped, velocity = v_wrapped)[m
2026-02-09T19:17:20.5218534Z  [m
2026-02-09T19:17:20.5219333Z      # The flux function signature for FVMProblem is q(x, y, t, α, β, γ, p)[m
2026-02-09T19:17:20.5220231Z      flux = (x, y, t, α, β, γ, p) -> flux_fn(x, y, t, α, β, γ, p)[m
2026-02-09T19:17:20.5220804Z  [m
2026-02-09T19:17:20.5221174Z      return FVMProblem([m
2026-02-09T19:17:20.5221625Z          mesh, BCs, ICs;[m
2026-02-09T19:17:20.5222085Z [31m-        flux_function=flux,[m
2026-02-09T19:17:20.5222646Z [31m-        flux_parameters=nothing,[m
2026-02-09T19:17:20.5223259Z [31m-        source_function=source_function,[m
2026-02-09T19:17:20.5223941Z [31m-        source_parameters=source_parameters,[m
2026-02-09T19:17:20.5224624Z [31m-        initial_condition=initial_condition,[m
2026-02-09T19:17:20.5225261Z [31m-        initial_time=initial_time,[m
2026-02-09T19:17:20.5225822Z [31m-        final_time=final_time,[m
2026-02-09T19:17:20.5226397Z [32m+[m[32m        flux_function = flux,[m
2026-02-09T19:17:20.5227026Z [32m+[m[32m        flux_parameters = nothing,[m
2026-02-09T19:17:20.5227725Z [32m+[m[32m        source_function = source_function,[m
2026-02-09T19:17:20.5228480Z [32m+[m[32m        source_parameters = source_parameters,[m
2026-02-09T19:17:20.5229461Z [32m+[m[32m        initial_condition = initial_condition,[m
2026-02-09T19:17:20.5230174Z [32m+[m[32m        initial_time = initial_time,[m
2026-02-09T19:17:20.5230812Z [32m+[m[32m        final_time = final_time,[m
2026-02-09T19:17:20.5231343Z          kwargs...[m
2026-02-09T19:17:20.5231714Z      )[m
2026-02-09T19:17:20.5232035Z  end[m
2026-02-09T19:17:20.5238651Z [34m[116/151] Checking `src/solve.jl` ............................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5298561Z [34m[117/151] Checking `src/specific_problems/abstract_templates.jl` ............. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5354432Z [34m[118/151] Checking `src/specific_problems/advection_diffusion_equation.jl` ... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.5371486Z [1mdiff --git a/advection_diffusion_equation.jl b/advection_diffusion_equation.jl[m
2026-02-09T19:17:20.5372231Z [1mindex d1dc182..0f225af 100644[m
2026-02-09T19:17:20.5372710Z [1m--- a/advection_diffusion_equation.jl[m
2026-02-09T19:17:20.5373626Z [1m+++ b/advection_diffusion_equation.jl[m
2026-02-09T19:17:20.5374190Z [36m@@ -134,15 +134,15 @@[m [mend[m
2026-02-09T19:17:20.5374941Z  function AdvectionDiffusionEquation([m
2026-02-09T19:17:20.5375562Z          mesh::FVMGeometry,[m
2026-02-09T19:17:20.5376083Z          BCs::BoundaryConditions,[m
2026-02-09T19:17:20.5376858Z [31m-        ICs::InternalConditions=InternalConditions();[m
2026-02-09T19:17:20.5377774Z [32m+[m[32m        ICs::InternalConditions = InternalConditions();[m
2026-02-09T19:17:20.5378466Z          diffusion_function,[m
2026-02-09T19:17:20.5379257Z [31m-        diffusion_parameters=nothing,[m
2026-02-09T19:17:20.5379917Z [32m+[m[32m        diffusion_parameters = nothing,[m
2026-02-09T19:17:20.5380515Z          velocity_function,[m
2026-02-09T19:17:20.5381040Z [31m-        velocity_parameters=nothing,[m
2026-02-09T19:17:20.5381773Z [31m-        source_function=(x, y, t, u, p) -> zero(typeof(x)),[m
2026-02-09T19:17:20.5382491Z [31m-        source_parameters=nothing,[m
2026-02-09T19:17:20.5383123Z [32m+[m[32m        velocity_parameters = nothing,[m
2026-02-09T19:17:20.5383923Z [32m+[m[32m        source_function = (x, y, t, u, p) -> zero(typeof(x)),[m
2026-02-09T19:17:20.5384689Z [32m+[m[32m        source_parameters = nothing,[m
2026-02-09T19:17:20.5385278Z          initial_condition,[m
2026-02-09T19:17:20.5385750Z [31m-        initial_time=0.0,[m
2026-02-09T19:17:20.5386266Z [32m+[m[32m        initial_time = 0.0,[m
2026-02-09T19:17:20.5386750Z          final_time,[m
2026-02-09T19:17:20.5387140Z          kwargs...[m
2026-02-09T19:17:20.5387490Z      )[m
2026-02-09T19:17:20.5439494Z [34m[119/151] Checking `src/specific_problems/anisotropic_diffusion.jl` .......... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.5455661Z [1mdiff --git a/anisotropic_diffusion.jl b/anisotropic_diffusion.jl[m
2026-02-09T19:17:20.5456427Z [1mindex 153830e..a64004f 100644[m
2026-02-09T19:17:20.5456962Z [1m--- a/anisotropic_diffusion.jl[m
2026-02-09T19:17:20.5457498Z [1m+++ b/anisotropic_diffusion.jl[m
2026-02-09T19:17:20.5458095Z [36m@@ -201,10 +201,10 @@[m [mfunction anisotropic_neumann_boundary_edge_contributions!([m
2026-02-09T19:17:20.5458704Z          D_eff_j = sqrt(Dxx_j * Dyy_j - Dxy_j^2)[m
2026-02-09T19:17:20.5459418Z  [m
2026-02-09T19:17:20.5459762Z          # Fallback to average of diagonal if det is small[m
2026-02-09T19:17:20.5460168Z [31m-        if D_eff_i < 1e-10[m
2026-02-09T19:17:20.5460503Z [32m+[m[32m        if D_eff_i < 1.0e-10[m
2026-02-09T19:17:20.5460847Z              D_eff_i = (Dxx_i + Dyy_i) / 2[m
2026-02-09T19:17:20.5461154Z          end[m
2026-02-09T19:17:20.5461410Z [31m-        if D_eff_j < 1e-10[m
2026-02-09T19:17:20.5461734Z [32m+[m[32m        if D_eff_j < 1.0e-10[m
2026-02-09T19:17:20.5462079Z              D_eff_j = (Dxx_j + Dyy_j) / 2[m
2026-02-09T19:17:20.5462368Z          end[m
2026-02-09T19:17:20.5462576Z  [m
2026-02-09T19:17:20.5471660Z [34m[120/151] Checking `src/specific_problems/diffusion_equation.jl` ............. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5479727Z [34m[121/151] Checking `src/specific_problems/laplaces_equation.jl` .............. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5492912Z [34m[122/151] Checking `src/specific_problems/linear_reaction_diffusion_equations.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5502350Z [34m[123/151] Checking `src/specific_problems/mean_exit_time.jl` ................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5510825Z [34m[124/151] Checking `src/specific_problems/poissons_equation.jl` .............. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5525854Z [34m[125/151] Checking `src/utils.jl` ............................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5531904Z [34m[126/151] Checking `test/README.jl` .......................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5605124Z [34m[127/151] Checking `test/advanced_bcs.jl` .................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.5620448Z [1mdiff --git a/advanced_bcs.jl b/advanced_bcs.jl[m
2026-02-09T19:17:20.5621131Z [1mindex a1832b9..68cfd8d 100644[m
2026-02-09T19:17:20.5621670Z [1m--- a/advanced_bcs.jl[m
2026-02-09T19:17:20.5621980Z [1m+++ b/advanced_bcs.jl[m
2026-02-09T19:17:20.5622295Z [36m@@ -25,7 +25,7 @@[m [musing Test[m
2026-02-09T19:17:20.5622681Z              # Test near fixed point (golden ratio)[m
2026-02-09T19:17:20.5623063Z              φ = (1 + sqrt(5)) / 2[m
2026-02-09T19:17:20.5623631Z              result_near = linearize_bc(NonlinearDirichlet, f, 0.0, 0.0, 0.0, φ, (0.0, 0.0), nothing)[m
2026-02-09T19:17:20.5624281Z [31m-            @test isapprox(result_near, φ, atol=1e-4)[m
2026-02-09T19:17:20.5624786Z [32m+[m[32m            @test isapprox(result_near, φ, atol = 1.0e-4)[m
2026-02-09T19:17:20.5625169Z          end[m
2026-02-09T19:17:20.5625387Z  [m
2026-02-09T19:17:20.5625874Z          @testset "linearize_bc for NonlinearNeumann" begin[m
2026-02-09T19:17:20.5626325Z [36m@@ -48,7 +48,7 @@[m [musing Test[m
2026-02-09T19:17:20.5626605Z  [m
2026-02-09T19:17:20.5626922Z          @testset "compute_boundary_gradient" begin[m
2026-02-09T19:17:20.5627325Z              # Create a simple mesh[m
2026-02-09T19:17:20.5627828Z [31m-            tri = triangulate_rectangle(0, 1, 0, 1, 3, 3, single_boundary=true)[m
2026-02-09T19:17:20.5628507Z [32m+[m[32m            tri = triangulate_rectangle(0, 1, 0, 1, 3, 3, single_boundary = true)[m
2026-02-09T19:17:20.5629282Z              mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.5629594Z  [m
2026-02-09T19:17:20.5629842Z              # Linear solution u = x + y[m
2026-02-09T19:17:20.5630185Z [36m@@ -68,8 +68,8 @@[m [musing Test[m
2026-02-09T19:17:20.5630598Z              grad = compute_boundary_gradient(mesh, u, i, j)[m
2026-02-09T19:17:20.5630965Z  [m
2026-02-09T19:17:20.5631247Z              # Gradient of (x + y) should be (1, 1)[m
2026-02-09T19:17:20.5631672Z [31m-            @test isapprox(grad[1], 1.0, atol=0.1)[m
2026-02-09T19:17:20.5632118Z [31m-            @test isapprox(grad[2], 1.0, atol=0.1)[m
2026-02-09T19:17:20.5632580Z [32m+[m[32m            @test isapprox(grad[1], 1.0, atol = 0.1)[m
2026-02-09T19:17:20.5633066Z [32m+[m[32m            @test isapprox(grad[2], 1.0, atol = 0.1)[m
2026-02-09T19:17:20.5633421Z          end[m
2026-02-09T19:17:20.5633636Z      end[m
2026-02-09T19:17:20.5633827Z  [m
2026-02-09T19:17:20.5634072Z [36m@@ -80,17 +80,17 @@[m [musing Test[m
2026-02-09T19:17:20.5634418Z              @test bc1.shift ≈ 0.0[m
2026-02-09T19:17:20.5634749Z              @test bc1.direction == :x[m
2026-02-09T19:17:20.5635041Z  [m
2026-02-09T19:17:20.5635365Z [31m-            bc2 = PeriodicBC(1, 3; shift=1.0, direction=:y)[m
2026-02-09T19:17:20.5635899Z [32m+[m[32m            bc2 = PeriodicBC(1, 3; shift = 1.0, direction = :y)[m
2026-02-09T19:17:20.5636332Z              @test bc2.shift ≈ 1.0[m
2026-02-09T19:17:20.5636673Z              @test bc2.direction == :y[m
2026-02-09T19:17:20.5636961Z  [m
2026-02-09T19:17:20.5637249Z [31m-            bc3 = PeriodicBC((2, 4); shift=0.5)[m
2026-02-09T19:17:20.5637694Z [32m+[m[32m            bc3 = PeriodicBC((2, 4); shift = 0.5)[m
2026-02-09T19:17:20.5638105Z              @test bc3.segment_pair == (2, 4)[m
2026-02-09T19:17:20.5638416Z          end[m
2026-02-09T19:17:20.5638612Z  [m
2026-02-09T19:17:20.5639132Z          @testset "get_segment_nodes" begin[m
2026-02-09T19:17:20.5639579Z              # Create mesh with distinct boundary segments[m
2026-02-09T19:17:20.5640161Z [31m-            tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=false)[m
2026-02-09T19:17:20.5640851Z [32m+[m[32m            tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = false)[m
2026-02-09T19:17:20.5641382Z              mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.5641668Z  [m
2026-02-09T19:17:20.5641932Z              # Get nodes on segment 1 (bottom)[m
2026-02-09T19:17:20.5642305Z [36m@@ -101,17 +101,17 @@[m [musing Test[m
2026-02-09T19:17:20.5642803Z              for n in nodes1[m
2026-02-09T19:17:20.5643117Z                  p = get_point(mesh, n)[m
2026-02-09T19:17:20.5643536Z                  _, y = getxy(p)[m
2026-02-09T19:17:20.5643907Z [31m-                @test isapprox(y, 0.0, atol=1e-10)[m
2026-02-09T19:17:20.5644354Z [32m+[m[32m                @test isapprox(y, 0.0, atol = 1.0e-10)[m
2026-02-09T19:17:20.5644718Z              end[m
2026-02-09T19:17:20.5644940Z          end[m
2026-02-09T19:17:20.5645136Z  [m
2026-02-09T19:17:20.5645439Z          @testset "compute_periodic_mapping" begin[m
2026-02-09T19:17:20.5645894Z              # Create mesh with left-right periodicity[m
2026-02-09T19:17:20.5646463Z [31m-            tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=false)[m
2026-02-09T19:17:20.5647143Z [32m+[m[32m            tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = false)[m
2026-02-09T19:17:20.5647664Z              mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.5647947Z  [m
2026-02-09T19:17:20.5648271Z              # Segment 4 is left (x=0), segment 2 is right (x=1)[m
2026-02-09T19:17:20.5648951Z [31m-            bc = PeriodicBC(4, 2; direction=:x)[m
2026-02-09T19:17:20.5649462Z [32m+[m[32m            bc = PeriodicBC(4, 2; direction = :x)[m
2026-02-09T19:17:20.5649944Z              mapping = compute_periodic_mapping(mesh, bc)[m
2026-02-09T19:17:20.5650295Z  [m
2026-02-09T19:17:20.5650558Z              # Should have matched pairs[m
2026-02-09T19:17:20.5650911Z [36m@@ -123,7 +123,7 @@[m [musing Test[m
2026-02-09T19:17:20.5651262Z                  p2 = get_point(mesh, n2)[m
2026-02-09T19:17:20.5651591Z                  _, y1 = getxy(p1)[m
2026-02-09T19:17:20.5651902Z                  _, y2 = getxy(p2)[m
2026-02-09T19:17:20.5652271Z [31m-                @test isapprox(y1, y2, atol=1e-8)[m
2026-02-09T19:17:20.5652718Z [32m+[m[32m                @test isapprox(y1, y2, atol = 1.0e-8)[m
2026-02-09T19:17:20.5653087Z              end[m
2026-02-09T19:17:20.5653305Z          end[m
2026-02-09T19:17:20.5653512Z  [m
2026-02-09T19:17:20.5653751Z [36m@@ -135,8 +135,8 @@[m [musing Test[m
2026-02-09T19:17:20.5654154Z              apply_periodic_constraints!(u, mapping)[m
2026-02-09T19:17:20.5654497Z  [m
2026-02-09T19:17:20.5654795Z              # After constraint: u[1] ≈ u[3] and u[2] ≈ u[4][m
2026-02-09T19:17:20.5655238Z [31m-            @test isapprox(u[1], u[3], atol=1e-10)[m
2026-02-09T19:17:20.5655664Z [31m-            @test isapprox(u[2], u[4], atol=1e-10)[m
2026-02-09T19:17:20.5656119Z [32m+[m[32m            @test isapprox(u[1], u[3], atol = 1.0e-10)[m
2026-02-09T19:17:20.5656607Z [32m+[m[32m            @test isapprox(u[2], u[4], atol = 1.0e-10)[m
2026-02-09T19:17:20.5656960Z          end[m
2026-02-09T19:17:20.5657162Z  [m
2026-02-09T19:17:20.5657511Z          @testset "apply_periodic_constraints! with shift" begin[m
2026-02-09T19:17:20.5657961Z [36m@@ -146,14 +146,14 @@[m [musing Test[m
2026-02-09T19:17:20.5658360Z              apply_periodic_constraints!(u, mapping)[m
2026-02-09T19:17:20.5658701Z  [m
2026-02-09T19:17:20.5659134Z              # After constraint: u[1] - u[2] = shift = 2.0[m
2026-02-09T19:17:20.5659592Z [31m-            @test isapprox(u[1] - u[2], 2.0, atol=1e-10)[m
2026-02-09T19:17:20.5660084Z [32m+[m[32m            @test isapprox(u[1] - u[2], 2.0, atol = 1.0e-10)[m
2026-02-09T19:17:20.5660454Z          end[m
2026-02-09T19:17:20.5660654Z  [m
2026-02-09T19:17:20.5660930Z          @testset "PeriodicConditions" begin[m
2026-02-09T19:17:20.5661486Z [31m-            tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=false)[m
2026-02-09T19:17:20.5662177Z [32m+[m[32m            tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = false)[m
2026-02-09T19:17:20.5662704Z              mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.5662987Z  [m
2026-02-09T19:17:20.5663277Z [31m-            bcs = [PeriodicBC(4, 2; direction=:x)][m
2026-02-09T19:17:20.5663892Z [32m+[m[32m            bcs = [PeriodicBC(4, 2; direction = :x)][m
2026-02-09T19:17:20.5664341Z              pc = PeriodicConditions(mesh, bcs)[m
2026-02-09T19:17:20.5664664Z  [m
2026-02-09T19:17:20.5665045Z              @test has_periodic_conditions(pc)[m
2026-02-09T19:17:20.5665195Z [36m@@ -186,7 +186,7 @@[m [musing Test[m
2026-02-09T19:17:20.5665270Z  [m
2026-02-09T19:17:20.5665421Z          @testset "CoupledNeumann" begin[m
2026-02-09T19:17:20.5665626Z              # flux depends on gradient of another field[m
2026-02-09T19:17:20.5665999Z [31m-            cn = CoupledNeumann(1, (x, y, t, u, grad, p) -> -p.D * grad[2][1]; parameters=(D=0.5,))[m
2026-02-09T19:17:20.5666383Z [32m+[m[32m            cn = CoupledNeumann(1, (x, y, t, u, grad, p) -> -p.D * grad[2][1]; parameters = (D = 0.5,))[m
2026-02-09T19:17:20.5666538Z              @test get_target_field(cn) == 1[m
2026-02-09T19:17:20.5666615Z  [m
2026-02-09T19:17:20.5666728Z              u_vals = (1.0, 2.0)[m
2026-02-09T19:17:20.5765241Z [34m[128/151] Checking `test/amr.jl` ............................................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5808636Z [34m[129/151] Checking `test/conditions.jl` ...................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5839580Z [34m[130/151] Checking `test/equations.jl` ....................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5841040Z [34m[131/151] Checking `test/explicit_imports.jl` ................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5864304Z [34m[132/151] Checking `test/geometry.jl` ........................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5900174Z [34m[133/151] Checking `test/grmhd.jl` ........................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.5915793Z [1mdiff --git a/grmhd.jl b/grmhd.jl[m
2026-02-09T19:17:20.5916028Z [1mindex 22c56e7..9d48ee1 100644[m
2026-02-09T19:17:20.5916193Z [1m--- a/grmhd.jl[m
2026-02-09T19:17:20.5916375Z [1m+++ b/grmhd.jl[m
2026-02-09T19:17:20.5916638Z [36m@@ -52,7 +52,7 @@[m [musing LinearAlgebra[m
2026-02-09T19:17:20.5916791Z          m_kerr0 = KerrMetric(M, 0.0)[m
2026-02-09T19:17:20.5916955Z          m_sch = SchwarzschildMetric(M)[m
2026-02-09T19:17:20.5917223Z          for (x, y) in [(5.0, 0.0), (3.0, 4.0), (0.0, 6.0)][m
2026-02-09T19:17:20.5917686Z [31m-            @test lapse(m_kerr0, x, y) ≈ lapse(m_sch, x, y) atol = 1e-10[m
2026-02-09T19:17:20.5918185Z [32m+[m[32m            @test lapse(m_kerr0, x, y) ≈ lapse(m_sch, x, y) atol = 1.0e-10[m
2026-02-09T19:17:20.5918363Z          end[m
2026-02-09T19:17:20.5918511Z      end[m
2026-02-09T19:17:20.5918641Z  [m
2026-02-09T19:17:20.5919065Z [36m@@ -101,10 +101,10 @@[m [mend[m
2026-02-09T19:17:20.5919402Z              u_gr = primitive_to_conserved(law_gr, w)[m
2026-02-09T19:17:20.5919711Z              u_sr = primitive_to_conserved(law_sr, w)[m
2026-02-09T19:17:20.5920130Z              # In Minkowski with √γ=1, GRMHD conserved = SRMHD conserved[m
2026-02-09T19:17:20.5920434Z [31m-            @test u_gr ≈ u_sr atol = 1e-12[m
2026-02-09T19:17:20.5920743Z [32m+[m[32m            @test u_gr ≈ u_sr atol = 1.0e-12[m
2026-02-09T19:17:20.5920880Z  [m
2026-02-09T19:17:20.5921219Z              w_gr = conserved_to_primitive(law_gr, u_gr)[m
2026-02-09T19:17:20.5921495Z [31m-            @test w_gr ≈ w atol = 1e-9[m
2026-02-09T19:17:20.5921795Z [32m+[m[32m            @test w_gr ≈ w atol = 1.0e-9[m
2026-02-09T19:17:20.5921958Z          end[m
2026-02-09T19:17:20.5922126Z      end[m
2026-02-09T19:17:20.5922263Z  [m
2026-02-09T19:17:20.5922472Z [36m@@ -115,7 +115,7 @@[m [mend[m
2026-02-09T19:17:20.5922825Z          mesh_src = StructuredMesh2D(0.0, 1.0, 0.0, 1.0, 4, 4)[m
2026-02-09T19:17:20.5923283Z          md_src = FiniteVolumeMethod.precompute_metric(metric, mesh_src)[m
2026-02-09T19:17:20.5923873Z          src = FiniteVolumeMethod.grmhd_source_terms(law_gr, w, u, md_src, mesh_src, 2, 2)[m
2026-02-09T19:17:20.5924126Z [31m-        @test all(abs.(src) .< 1e-14)[m
2026-02-09T19:17:20.5924682Z [32m+[m[32m        @test all(abs.(src) .< 1.0e-14)[m
2026-02-09T19:17:20.5924830Z      end[m
2026-02-09T19:17:20.5924977Z  end[m
2026-02-09T19:17:20.5925294Z  [m
2026-02-09T19:17:20.5925509Z [36m@@ -131,7 +131,7 @@[m [mend[m
2026-02-09T19:17:20.5925817Z          w = SVector(1.0, 0.3, 0.2, 0.0, 2.0, 0.5, 0.8, 0.3)[m
2026-02-09T19:17:20.5926083Z          u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.5926356Z          w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.5926586Z [31m-        @test w2 ≈ w atol = 1e-9[m
2026-02-09T19:17:20.5926858Z [32m+[m[32m        @test w2 ≈ w atol = 1.0e-9[m
2026-02-09T19:17:20.5927006Z      end[m
2026-02-09T19:17:20.5927129Z  [m
2026-02-09T19:17:20.5927455Z      @testset "Schwarzschild con2prim roundtrip" begin[m
2026-02-09T19:17:20.5927654Z [36m@@ -141,7 +141,7 @@[m [mend[m
2026-02-09T19:17:20.5927941Z          w = SVector(1.0, 0.1, 0.0, 0.0, 1.0, 0.5, 0.0, 0.0)[m
2026-02-09T19:17:20.5928207Z          u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.5928467Z          w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.5928916Z [31m-        @test w2[1] ≈ w[1] rtol = 1e-6[m
2026-02-09T19:17:20.5929186Z [31m-        @test w2[5] ≈ w[5] rtol = 1e-6[m
2026-02-09T19:17:20.5929477Z [32m+[m[32m        @test w2[1] ≈ w[1] rtol = 1.0e-6[m
2026-02-09T19:17:20.5929764Z [32m+[m[32m        @test w2[5] ≈ w[5] rtol = 1.0e-6[m
2026-02-09T19:17:20.5929917Z      end[m
2026-02-09T19:17:20.5930059Z  end[m
2026-02-09T19:17:20.5955673Z [34m[134/151] Checking `test/grmhd_2d.jl` ........................................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.5969731Z [1mdiff --git a/grmhd_2d.jl b/grmhd_2d.jl[m
2026-02-09T19:17:20.5969966Z [1mindex da9fe50..8fe4089 100644[m
2026-02-09T19:17:20.5970146Z [1m--- a/grmhd_2d.jl[m
2026-02-09T19:17:20.5970310Z [1m+++ b/grmhd_2d.jl[m
2026-02-09T19:17:20.5970574Z [36m@@ -36,7 +36,7 @@[m [musing StaticArrays[m
2026-02-09T19:17:20.5970887Z      D_total_0 = sum(U0[ix, iy][1] for ix in 1:nx, iy in 1:ny) * dV[m
2026-02-09T19:17:20.5970971Z  [m
2026-02-09T19:17:20.5971326Z      # In Minkowski spacetime, geometric sources vanish → perfect conservation[m
2026-02-09T19:17:20.5971509Z [31m-    @test D_total ≈ D_total_0 rtol = 1e-10[m
2026-02-09T19:17:20.5971716Z [32m+[m[32m    @test D_total ≈ D_total_0 rtol = 1.0e-10[m
2026-02-09T19:17:20.5971797Z  end[m
2026-02-09T19:17:20.5971869Z  [m
2026-02-09T19:17:20.5972060Z  @testset "CT DivB Preservation (GRMHD)" begin[m
2026-02-09T19:17:20.5972178Z [36m@@ -59,7 +59,7 @@[m [mend[m
2026-02-09T19:17:20.5972447Z      coords, U, t, ct = solve_hyperbolic(prob; vector_potential = Az)[m
2026-02-09T19:17:20.5972519Z  [m
2026-02-09T19:17:20.5972725Z      divB_max = max_divB(ct, mesh.dx, mesh.dy, nx, ny)[m
2026-02-09T19:17:20.5972849Z [31m-    @test divB_max < 1e-13[m
2026-02-09T19:17:20.5972992Z [32m+[m[32m    @test divB_max < 1.0e-13[m
2026-02-09T19:17:20.5973078Z  end[m
2026-02-09T19:17:20.5973157Z  [m
2026-02-09T19:17:20.5973359Z  @testset "GRMHD matches SRMHD in Minkowski" begin[m
2026-02-09T19:17:20.5973465Z [36m@@ -93,7 +93,7 @@[m [mend[m
2026-02-09T19:17:20.5973543Z  [m
2026-02-09T19:17:20.5973721Z      # Density profiles should match closely[m
2026-02-09T19:17:20.5973843Z      for iy in 1:ny, ix in 1:nx[m
2026-02-09T19:17:20.5974057Z [31m-        @test W_gr[ix, iy][1] ≈ W_sr[ix, iy][1] rtol = 1e-10[m
2026-02-09T19:17:20.5974296Z [32m+[m[32m        @test W_gr[ix, iy][1] ≈ W_sr[ix, iy][1] rtol = 1.0e-10[m
2026-02-09T19:17:20.5974378Z      end[m
2026-02-09T19:17:20.5974456Z  end[m
2026-02-09T19:17:20.5974538Z  [m
2026-02-09T19:17:20.6083888Z [34m[135/151] Checking `test/hyperbolic.jl` ...................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.6099931Z [1mdiff --git a/hyperbolic.jl b/hyperbolic.jl[m
2026-02-09T19:17:20.6100193Z [1mindex e7cd740..4c124eb 100644[m
2026-02-09T19:17:20.6100385Z [1m--- a/hyperbolic.jl[m
2026-02-09T19:17:20.6100798Z [1m+++ b/hyperbolic.jl[m
2026-02-09T19:17:20.6101000Z [36m@@ -125,7 +125,7 @@[m [mend[m
2026-02-09T19:17:20.6101235Z      w = SVector(1.0, 0.5, 1.0)  # ρ, v, P[m
2026-02-09T19:17:20.6101666Z      u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.6101871Z      w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.6102004Z [31m-    @test w2 ≈ w atol = 1e-14[m
2026-02-09T19:17:20.6102157Z [32m+[m[32m    @test w2 ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.6102237Z  [m
2026-02-09T19:17:20.6102369Z      # Test flux computation[m
2026-02-09T19:17:20.6102520Z      f = physical_flux(law, w, 1)[m
2026-02-09T19:17:20.6102644Z [36m@@ -170,10 +170,10 @@[m [mend[m
2026-02-09T19:17:20.6102805Z          f_exact = physical_flux(law, w, 1)[m
2026-02-09T19:17:20.6102879Z  [m
2026-02-09T19:17:20.6103142Z          f_lf = solve_riemann(LaxFriedrichsSolver(), law, w, w, 1)[m
2026-02-09T19:17:20.6103306Z [31m-        @test f_lf ≈ f_exact atol = 1e-14[m
2026-02-09T19:17:20.6103505Z [32m+[m[32m        @test f_lf ≈ f_exact atol = 1.0e-14[m
2026-02-09T19:17:20.6103579Z  [m
2026-02-09T19:17:20.6103784Z          f_hll = solve_riemann(HLLSolver(), law, w, w, 1)[m
2026-02-09T19:17:20.6103952Z [31m-        @test f_hll ≈ f_exact atol = 1e-14[m
2026-02-09T19:17:20.6104136Z [32m+[m[32m        @test f_hll ≈ f_exact atol = 1.0e-14[m
2026-02-09T19:17:20.6104228Z      end[m
2026-02-09T19:17:20.6104307Z  end[m
2026-02-09T19:17:20.6104380Z  [m
2026-02-09T19:17:20.6104493Z [36m@@ -199,7 +199,7 @@[m [mend[m
2026-02-09T19:17:20.6104655Z          x, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6104784Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.6104857Z  [m
2026-02-09T19:17:20.6104999Z [31m-        @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.6105156Z [32m+[m[32m        @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.6105228Z  [m
2026-02-09T19:17:20.6105442Z          # Compare against exact solution at sample points[m
2026-02-09T19:17:20.6105685Z          # Use L1 error norm — should decrease with resolution[m
2026-02-09T19:17:20.6105793Z [36m@@ -277,9 +277,9 @@[m [mend[m
2026-02-09T19:17:20.6105988Z      # The solution should be symmetric about x=0.5[m
2026-02-09T19:17:20.6106107Z      N = length(W)[m
2026-02-09T19:17:20.6106232Z      for i in 1:div(N, 4)[m
2026-02-09T19:17:20.6106410Z [31m-        @test W[i][1] ≈ W[N + 1 - i][1] atol = 1e-10[m
2026-02-09T19:17:20.6106607Z [31m-        @test W[i][2] ≈ -W[N + 1 - i][2] atol = 1e-10[m
2026-02-09T19:17:20.6106784Z [31m-        @test W[i][3] ≈ W[N + 1 - i][3] atol = 1e-10[m
2026-02-09T19:17:20.6106991Z [32m+[m[32m        @test W[i][1] ≈ W[N + 1 - i][1] atol = 1.0e-10[m
2026-02-09T19:17:20.6107191Z [32m+[m[32m        @test W[i][2] ≈ -W[N + 1 - i][2] atol = 1.0e-10[m
2026-02-09T19:17:20.6107388Z [32m+[m[32m        @test W[i][3] ≈ W[N + 1 - i][3] atol = 1.0e-10[m
2026-02-09T19:17:20.6107470Z      end[m
2026-02-09T19:17:20.6107548Z  end[m
2026-02-09T19:17:20.6107628Z  [m
2026-02-09T19:17:20.6107744Z [36m@@ -315,9 +315,9 @@[m [mend[m
2026-02-09T19:17:20.6107947Z      energy_final = sum(U_final[i][3] for i in 1:100) * dx[m
2026-02-09T19:17:20.6108018Z  [m
2026-02-09T19:17:20.6108343Z      # Conservation should hold to near machine precision for periodic BCs[m
2026-02-09T19:17:20.6108514Z [31m-    @test mass_final ≈ mass0 rtol = 1e-12[m
2026-02-09T19:17:20.6108925Z [31m-    @test momentum_final ≈ momentum0 rtol = 1e-12[m
2026-02-09T19:17:20.6109146Z [31m-    @test energy_final ≈ energy0 rtol = 1e-12[m
2026-02-09T19:17:20.6109342Z [32m+[m[32m    @test mass_final ≈ mass0 rtol = 1.0e-12[m
2026-02-09T19:17:20.6109571Z [32m+[m[32m    @test momentum_final ≈ momentum0 rtol = 1.0e-12[m
2026-02-09T19:17:20.6109782Z [32m+[m[32m    @test energy_final ≈ energy0 rtol = 1.0e-12[m
2026-02-09T19:17:20.6109859Z  end[m
2026-02-09T19:17:20.6109933Z  [m
2026-02-09T19:17:20.6110072Z  @testset "CFL Stability" begin[m
2026-02-09T19:17:20.6110185Z [36m@@ -341,7 +341,7 @@[m [mend[m
2026-02-09T19:17:20.6110598Z      # dt should be positive and bounded by CFL * dx / max_wave_speed[m
2026-02-09T19:17:20.6110698Z      @test dt > 0[m
2026-02-09T19:17:20.6111072Z      c_max = sound_speed(eos, 1.0, 1.0)  # max sound speed in left state[m
2026-02-09T19:17:20.6111243Z [31m-    @test dt <= 0.5 * mesh.dx / c_max + 1e-14[m
2026-02-09T19:17:20.6111433Z [32m+[m[32m    @test dt <= 0.5 * mesh.dx / c_max + 1.0e-14[m
2026-02-09T19:17:20.6111506Z  [m
2026-02-09T19:17:20.6111675Z      # dt should not exceed final_time - t[m
2026-02-09T19:17:20.6111816Z      prob2 = HyperbolicProblem([m
2026-02-09T19:17:20.6111929Z [36m@@ -391,12 +391,12 @@[m [mend[m
2026-02-09T19:17:20.6112020Z              end[m
2026-02-09T19:17:20.6112092Z  [m
2026-02-09T19:17:20.6112226Z              # Should reach final time[m
2026-02-09T19:17:20.6112369Z [31m-            @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.6112541Z [32m+[m[32m            @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.6112621Z  [m
2026-02-09T19:17:20.6112779Z              # L1 error should be reasonable[m
2026-02-09T19:17:20.6112886Z              dx = 1.0 / 100[m
2026-02-09T19:17:20.6113161Z              ρ_err = sum(abs(W[i][1] - sod_exact(x[i], 0.2)[1]) * dx for i in 1:100)[m
2026-02-09T19:17:20.6113455Z [31m-            @test ρ_err < 0.10  # All limiters should give reasonable results[m
2026-02-09T19:17:20.6113770Z [32m+[m[32m            @test ρ_err < 0.1  # All limiters should give reasonable results[m
2026-02-09T19:17:20.6113855Z          end[m
2026-02-09T19:17:20.6113939Z      end[m
2026-02-09T19:17:20.6114015Z  end[m
2026-02-09T19:17:20.6114133Z [36m@@ -420,7 +420,7 @@[m [mend[m
2026-02-09T19:17:20.6114261Z      W = to_primitive(law, U)[m
2026-02-09T19:17:20.6114334Z  [m
2026-02-09T19:17:20.6114636Z      # Should complete and give valid results (more diffusive than MUSCL)[m
2026-02-09T19:17:20.6114762Z [31m-    @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.6114908Z [32m+[m[32m    @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.6115018Z      for i in 1:100[m
2026-02-09T19:17:20.6115132Z          @test W[i][1] > 0[m
2026-02-09T19:17:20.6115236Z          @test W[i][3] > 0[m
2026-02-09T19:17:20.6115351Z [36m@@ -483,7 +483,7 @@[m [mend[m
2026-02-09T19:17:20.6115525Z      w = SVector(1.0, 0.5, 0.3, 1.0)  # ρ, vx, vy, P[m
2026-02-09T19:17:20.6115679Z      u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.6115835Z      w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.6115962Z [31m-    @test w2 ≈ w atol = 1e-14[m
2026-02-09T19:17:20.6116114Z [32m+[m[32m    @test w2 ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.6116188Z  [m
2026-02-09T19:17:20.6116276Z      # X-flux[m
2026-02-09T19:17:20.6116415Z      fx = physical_flux(law, w, 1)[m
2026-02-09T19:17:20.6235406Z [34m[136/151] Checking `test/hyperbolic_2d.jl` ................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.6252553Z [1mdiff --git a/hyperbolic_2d.jl b/hyperbolic_2d.jl[m
2026-02-09T19:17:20.6252841Z [1mindex 68d6aa2..e6475ea 100644[m
2026-02-09T19:17:20.6253042Z [1m--- a/hyperbolic_2d.jl[m
2026-02-09T19:17:20.6253240Z [1m+++ b/hyperbolic_2d.jl[m
2026-02-09T19:17:20.6253441Z [36m@@ -56,7 +56,7 @@[m [mend[m
2026-02-09T19:17:20.6253660Z              w = SVector(1.0, 0.5, 1.0)[m
2026-02-09T19:17:20.6253925Z              f_exact = physical_flux(law, w, 1)[m
2026-02-09T19:17:20.6254270Z              f_hllc = solve_riemann(HLLCSolver(), law, w, w, 1)[m
2026-02-09T19:17:20.6254579Z [31m-            @test f_hllc ≈ f_exact atol = 1e-13[m
2026-02-09T19:17:20.6254828Z [32m+[m[32m            @test f_hllc ≈ f_exact atol = 1.0e-13[m
2026-02-09T19:17:20.6254917Z          end[m
2026-02-09T19:17:20.6254991Z  [m
2026-02-09T19:17:20.6255142Z          @testset "Sod shock tube" begin[m
2026-02-09T19:17:20.6255257Z [36m@@ -73,7 +73,7 @@[m [mend[m
2026-02-09T19:17:20.6255417Z              x, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6255554Z              W = to_primitive(law, U)[m
2026-02-09T19:17:20.6255940Z  [m
2026-02-09T19:17:20.6256188Z [31m-            @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.6256461Z [32m+[m[32m            @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.6256769Z  [m
2026-02-09T19:17:20.6256964Z              dx = 1.0 / 200[m
2026-02-09T19:17:20.6257253Z              ρ_err = sum(abs(W[i][1] - sod_exact(x[i], 0.2)[1]) * dx for i in 1:200)[m
2026-02-09T19:17:20.6257375Z [36m@@ -134,7 +134,7 @@[m [mend[m
2026-02-09T19:17:20.6257507Z              for dir in (1, 2)[m
2026-02-09T19:17:20.6257690Z                  f_exact = physical_flux(law, w, dir)[m
2026-02-09T19:17:20.6257926Z                  f_hllc = solve_riemann(HLLCSolver(), law, w, w, dir)[m
2026-02-09T19:17:20.6258113Z [31m-                @test f_hllc ≈ f_exact atol = 1e-13[m
2026-02-09T19:17:20.6258322Z [32m+[m[32m                @test f_hllc ≈ f_exact atol = 1.0e-13[m
2026-02-09T19:17:20.6258410Z              end[m
2026-02-09T19:17:20.6258493Z          end[m
2026-02-09T19:17:20.6258582Z  [m
2026-02-09T19:17:20.6258694Z [36m@@ -150,9 +150,9 @@[m [mend[m
2026-02-09T19:17:20.6259185Z              f2d = solve_riemann(HLLCSolver(), law, wL_2d, wR_2d, 1)[m
2026-02-09T19:17:20.6259266Z  [m
2026-02-09T19:17:20.6259405Z              # Mass flux should match[m
2026-02-09T19:17:20.6259569Z [31m-            @test f2d[1] ≈ f1d[1] atol = 1e-12[m
2026-02-09T19:17:20.6259752Z [32m+[m[32m            @test f2d[1] ≈ f1d[1] atol = 1.0e-12[m
2026-02-09T19:17:20.6259913Z              # x-momentum flux should match[m
2026-02-09T19:17:20.6260066Z [31m-            @test f2d[2] ≈ f1d[2] atol = 1e-12[m
2026-02-09T19:17:20.6260244Z [32m+[m[32m            @test f2d[2] ≈ f1d[2] atol = 1.0e-12[m
2026-02-09T19:17:20.6260335Z          end[m
2026-02-09T19:17:20.6260414Z      end[m
2026-02-09T19:17:20.6260492Z  end[m
2026-02-09T19:17:20.6260605Z [36m@@ -183,14 +183,14 @@[m [mend[m
2026-02-09T19:17:20.6260781Z          coords, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6260920Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.6260993Z  [m
2026-02-09T19:17:20.6261132Z [31m-        @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.6261292Z [32m+[m[32m        @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.6261365Z  [m
2026-02-09T19:17:20.6261571Z          # Check that solution is uniform in y-direction[m
2026-02-09T19:17:20.6261684Z          for ix in 1:N[m
2026-02-09T19:17:20.6261793Z              for iy in 2:4[m
2026-02-09T19:17:20.6261994Z [31m-                @test W[ix, iy][1] ≈ W[ix, 1][1] atol = 1e-12[m
2026-02-09T19:17:20.6262195Z [31m-                @test W[ix, iy][2] ≈ W[ix, 1][2] atol = 1e-12[m
2026-02-09T19:17:20.6262384Z [31m-                @test W[ix, iy][4] ≈ W[ix, 1][4] atol = 1e-12[m
2026-02-09T19:17:20.6262602Z [32m+[m[32m                @test W[ix, iy][1] ≈ W[ix, 1][1] atol = 1.0e-12[m
2026-02-09T19:17:20.6262819Z [32m+[m[32m                @test W[ix, iy][2] ≈ W[ix, 1][2] atol = 1.0e-12[m
2026-02-09T19:17:20.6263032Z [32m+[m[32m                @test W[ix, iy][4] ≈ W[ix, 1][4] atol = 1.0e-12[m
2026-02-09T19:17:20.6263117Z              end[m
2026-02-09T19:17:20.6263200Z          end[m
2026-02-09T19:17:20.6263279Z  [m
2026-02-09T19:17:20.6263398Z [36m@@ -219,12 +219,12 @@[m [mend[m
2026-02-09T19:17:20.6263569Z          coords, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6263703Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.6263776Z  [m
2026-02-09T19:17:20.6263905Z [31m-        @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.6264064Z [32m+[m[32m        @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.6264143Z  [m
2026-02-09T19:17:20.6264264Z          # Check uniform in x[m
2026-02-09T19:17:20.6264369Z          for iy in 1:N[m
2026-02-09T19:17:20.6264484Z              for ix in 2:4[m
2026-02-09T19:17:20.6264676Z [31m-                @test W[ix, iy][1] ≈ W[1, iy][1] atol = 1e-12[m
2026-02-09T19:17:20.6264884Z [32m+[m[32m                @test W[ix, iy][1] ≈ W[1, iy][1] atol = 1.0e-12[m
2026-02-09T19:17:20.6265120Z              end[m
2026-02-09T19:17:20.6265209Z          end[m
2026-02-09T19:17:20.6265285Z  [m
2026-02-09T19:17:20.6265396Z [36m@@ -268,10 +268,10 @@[m [mend[m
2026-02-09T19:17:20.6265763Z          mom_yf = sum(U_final[ix, iy][3] for ix in 1:50, iy in 1:50) * dx * dy[m
2026-02-09T19:17:20.6266031Z          energy_f = sum(U_final[ix, iy][4] for ix in 1:50, iy in 1:50) * dx * dy[m
2026-02-09T19:17:20.6266105Z  [m
2026-02-09T19:17:20.6266264Z [31m-        @test mass_f ≈ mass0 rtol = 1e-12[m
2026-02-09T19:17:20.6266426Z [31m-        @test mom_xf ≈ mom_x0 rtol = 1e-12[m
2026-02-09T19:17:20.6266577Z [31m-        @test mom_yf ≈ mom_y0 rtol = 1e-12[m
2026-02-09T19:17:20.6266751Z [31m-        @test energy_f ≈ energy0 rtol = 1e-12[m
2026-02-09T19:17:20.6266938Z [32m+[m[32m        @test mass_f ≈ mass0 rtol = 1.0e-12[m
2026-02-09T19:17:20.6267121Z [32m+[m[32m        @test mom_xf ≈ mom_x0 rtol = 1.0e-12[m
2026-02-09T19:17:20.6267296Z [32m+[m[32m        @test mom_yf ≈ mom_y0 rtol = 1.0e-12[m
2026-02-09T19:17:20.6267506Z [32m+[m[32m        @test energy_f ≈ energy0 rtol = 1.0e-12[m
2026-02-09T19:17:20.6267588Z      end[m
2026-02-09T19:17:20.6267663Z  [m
2026-02-09T19:17:20.6267860Z      @testset "2D Sedov blast (qualitative)" begin[m
2026-02-09T19:17:20.6267978Z [36m@@ -281,7 +281,7 @@[m [mend[m
2026-02-09T19:17:20.6268179Z          mesh = StructuredMesh2D(-1.0, 1.0, -1.0, 1.0, N, N)[m
2026-02-09T19:17:20.6268252Z  [m
2026-02-09T19:17:20.6268536Z          # Background state + small region of high pressure at center[m
2026-02-09T19:17:20.6268647Z [31m-        P_bg = 1e-5[m
2026-02-09T19:17:20.6269089Z [32m+[m[32m        P_bg = 1.0e-5[m
2026-02-09T19:17:20.6269223Z          P_blast = 1.0[m
2026-02-09T19:17:20.6269391Z          r_blast = 3.0 * mesh.dx  # few cells[m
2026-02-09T19:17:20.6269465Z  [m
2026-02-09T19:17:20.6269582Z [36m@@ -348,10 +348,10 @@[m [mend[m
2026-02-09T19:17:20.6269662Z  [m
2026-02-09T19:17:20.6269987Z          # Uniform state with zero velocity + reflective walls should stay uniform[m
2026-02-09T19:17:20.6270119Z          for iy in 1:N, ix in 1:N[m
2026-02-09T19:17:20.6270298Z [31m-            @test W[ix, iy][1] ≈ 1.0 atol = 1e-10[m
2026-02-09T19:17:20.6270469Z [31m-            @test W[ix, iy][2] ≈ 0.0 atol = 1e-10[m
2026-02-09T19:17:20.6270624Z [31m-            @test W[ix, iy][3] ≈ 0.0 atol = 1e-10[m
2026-02-09T19:17:20.6270781Z [31m-            @test W[ix, iy][4] ≈ 1.0 atol = 1e-10[m
2026-02-09T19:17:20.6270985Z [32m+[m[32m            @test W[ix, iy][1] ≈ 1.0 atol = 1.0e-10[m
2026-02-09T19:17:20.6271168Z [32m+[m[32m            @test W[ix, iy][2] ≈ 0.0 atol = 1.0e-10[m
2026-02-09T19:17:20.6271349Z [32m+[m[32m            @test W[ix, iy][3] ≈ 0.0 atol = 1.0e-10[m
2026-02-09T19:17:20.6271536Z [32m+[m[32m            @test W[ix, iy][4] ≈ 1.0 atol = 1.0e-10[m
2026-02-09T19:17:20.6271621Z          end[m
2026-02-09T19:17:20.6271702Z      end[m
2026-02-09T19:17:20.6271775Z  [m
2026-02-09T19:17:20.6271901Z [36m@@ -377,7 +377,7 @@[m [mend[m
2026-02-09T19:17:20.6272113Z          # CFL: dt ≤ cfl / (c/dx + c/dy) where c = sound speed[m
2026-02-09T19:17:20.6272252Z          c = sound_speed(eos, 1.0, 1.0)[m
2026-02-09T19:17:20.6272437Z          dt_max = 0.5 / (c / mesh.dx + c / mesh.dy)[m
2026-02-09T19:17:20.6272573Z [31m-        @test dt <= dt_max + 1e-14[m
2026-02-09T19:17:20.6272731Z [32m+[m[32m        @test dt <= dt_max + 1.0e-14[m
2026-02-09T19:17:20.6272813Z      end[m
2026-02-09T19:17:20.6272891Z  [m
2026-02-09T19:17:20.6273120Z      @testset "2D All solvers produce valid results" begin[m
2026-02-09T19:17:20.6273231Z [36m@@ -398,7 +398,7 @@[m [mend[m
2026-02-09T19:17:20.6273423Z                  coords, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6273564Z                  W = to_primitive(law, U)[m
2026-02-09T19:17:20.6273635Z  [m
2026-02-09T19:17:20.6273786Z [31m-                @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.6273958Z [32m+[m[32m                @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.6274240Z                  for iy in 1:4, ix in 1:50[m
2026-02-09T19:17:20.6274403Z                      @test W[ix, iy][1] > 0  # ρ > 0[m
2026-02-09T19:17:20.6274658Z                      @test W[ix, iy][4] > 0  # P > 0[m
2026-02-09T19:17:20.6363867Z [34m[137/151] Checking `test/hyperbolic_3d.jl` ................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.6379532Z [1mdiff --git a/hyperbolic_3d.jl b/hyperbolic_3d.jl[m
2026-02-09T19:17:20.6379763Z [1mindex ec036ea..baf30db 100644[m
2026-02-09T19:17:20.6379960Z [1m--- a/hyperbolic_3d.jl[m
2026-02-09T19:17:20.6380147Z [1m+++ b/hyperbolic_3d.jl[m
2026-02-09T19:17:20.6380434Z [36m@@ -20,13 +20,13 @@[m [musing LinearAlgebra[m
2026-02-09T19:17:20.6380789Z          w = SVector(1.0, 0.5, -0.3, 0.2, 1.0)  # ρ, vx, vy, vz, P[m
2026-02-09T19:17:20.6381047Z          u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.6381303Z          w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.6381586Z [31m-        @test w2 ≈ w atol = 1e-14[m
2026-02-09T19:17:20.6381774Z [32m+[m[32m        @test w2 ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.6381856Z  [m
2026-02-09T19:17:20.6381981Z          # Another state[m
2026-02-09T19:17:20.6382135Z          w3 = SVector(0.125, -1.0, 0.7, 0.4, 0.1)[m
2026-02-09T19:17:20.6382312Z          u3 = primitive_to_conserved(law, w3)[m
2026-02-09T19:17:20.6382478Z          w4 = conserved_to_primitive(law, u3)[m
2026-02-09T19:17:20.6382617Z [31m-        @test w4 ≈ w3 atol = 1e-14[m
2026-02-09T19:17:20.6382777Z [32m+[m[32m        @test w4 ≈ w3 atol = 1.0e-14[m
2026-02-09T19:17:20.6382868Z      end[m
2026-02-09T19:17:20.6382943Z  [m
2026-02-09T19:17:20.6383149Z      @testset "physical_flux dir=$dir" for dir in 1:3[m
2026-02-09T19:17:20.6383270Z [36m@@ -152,7 +152,7 @@[m [mend[m
2026-02-09T19:17:20.6383444Z          coords, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6383574Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.6383655Z  [m
2026-02-09T19:17:20.6383797Z [31m-        @test t ≈ 0.05 atol = 1e-10[m
2026-02-09T19:17:20.6383956Z [32m+[m[32m        @test t ≈ 0.05 atol = 1.0e-10[m
2026-02-09T19:17:20.6384029Z  [m
2026-02-09T19:17:20.6384271Z          # Density should vary along x: left side > right side[m
2026-02-09T19:17:20.6384387Z          jmid, kmid = 2, 2[m
2026-02-09T19:17:20.6384499Z [36m@@ -166,7 +166,7 @@[m [mend[m
2026-02-09T19:17:20.6384675Z          # Solution should be uniform in y and z[m
2026-02-09T19:17:20.6384790Z          for ix in 1:nx[m
2026-02-09T19:17:20.6384926Z              for iy in 2:ny, iz in 1:nz[m
2026-02-09T19:17:20.6385144Z [31m-                @test W[ix, iy, iz][1] ≈ W[ix, 1, 1][1] atol = 1e-10[m
2026-02-09T19:17:20.6385389Z [32m+[m[32m                @test W[ix, iy, iz][1] ≈ W[ix, 1, 1][1] atol = 1.0e-10[m
2026-02-09T19:17:20.6385476Z              end[m
2026-02-09T19:17:20.6385558Z          end[m
2026-02-09T19:17:20.6385637Z  [m
2026-02-09T19:17:20.6385747Z [36m@@ -196,7 +196,7 @@[m [mend[m
2026-02-09T19:17:20.6385923Z          coords, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6386052Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.6386134Z  [m
2026-02-09T19:17:20.6386276Z [31m-        @test t ≈ 0.05 atol = 1e-10[m
2026-02-09T19:17:20.6386435Z [32m+[m[32m        @test t ≈ 0.05 atol = 1.0e-10[m
2026-02-09T19:17:20.6386514Z  [m
2026-02-09T19:17:20.6386628Z          imid, kmid = 2, 2[m
2026-02-09T19:17:20.6386813Z          # Bottom state has higher density than top[m
2026-02-09T19:17:20.6386923Z [36m@@ -210,7 +210,7 @@[m [mend[m
2026-02-09T19:17:20.6387052Z          # Uniform in x and z[m
2026-02-09T19:17:20.6387160Z          for iy in 1:ny[m
2026-02-09T19:17:20.6387292Z              for ix in 2:nx, iz in 1:nz[m
2026-02-09T19:17:20.6387508Z [31m-                @test W[ix, iy, iz][1] ≈ W[1, iy, 1][1] atol = 1e-10[m
2026-02-09T19:17:20.6387738Z [32m+[m[32m                @test W[ix, iy, iz][1] ≈ W[1, iy, 1][1] atol = 1.0e-10[m
2026-02-09T19:17:20.6388032Z              end[m
2026-02-09T19:17:20.6388124Z          end[m
2026-02-09T19:17:20.6388204Z  [m
2026-02-09T19:17:20.6388313Z [36m@@ -240,7 +240,7 @@[m [mend[m
2026-02-09T19:17:20.6388591Z          coords, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6388938Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.6389034Z  [m
2026-02-09T19:17:20.6389174Z [31m-        @test t ≈ 0.05 atol = 1e-10[m
2026-02-09T19:17:20.6389334Z [32m+[m[32m        @test t ≈ 0.05 atol = 1.0e-10[m
2026-02-09T19:17:20.6389414Z  [m
2026-02-09T19:17:20.6389525Z          imid, jmid = 2, 2[m
2026-02-09T19:17:20.6389754Z          # Front (low z) has higher density than back (high z)[m
2026-02-09T19:17:20.6389871Z [36m@@ -254,7 +254,7 @@[m [mend[m
2026-02-09T19:17:20.6389989Z          # Uniform in x and y[m
2026-02-09T19:17:20.6390095Z          for iz in 1:nz[m
2026-02-09T19:17:20.6390229Z              for ix in 2:nx, iy in 1:ny[m
2026-02-09T19:17:20.6390452Z [31m-                @test W[ix, iy, iz][1] ≈ W[1, 1, iz][1] atol = 1e-10[m
2026-02-09T19:17:20.6390690Z [32m+[m[32m                @test W[ix, iy, iz][1] ≈ W[1, 1, iz][1] atol = 1.0e-10[m
2026-02-09T19:17:20.6390786Z              end[m
2026-02-09T19:17:20.6390878Z          end[m
2026-02-09T19:17:20.6390949Z  [m
2026-02-09T19:17:20.6391061Z [36m@@ -314,11 +314,11 @@[m [mend[m
2026-02-09T19:17:20.6391357Z      mom_zf = sum(U_final[ix, iy, iz][4] for ix in 1:N, iy in 1:N, iz in 1:N) * vol[m
2026-02-09T19:17:20.6391649Z      energy_f = sum(U_final[ix, iy, iz][5] for ix in 1:N, iy in 1:N, iz in 1:N) * vol[m
2026-02-09T19:17:20.6391722Z  [m
2026-02-09T19:17:20.6391882Z [31m-    @test mass_f ≈ mass0 rtol = 1e-10[m
2026-02-09T19:17:20.6392045Z [31m-    @test mom_xf ≈ mom_x0 rtol = 1e-10[m
2026-02-09T19:17:20.6392191Z [31m-    @test mom_yf ≈ mom_y0 rtol = 1e-10[m
2026-02-09T19:17:20.6392335Z [31m-    @test mom_zf ≈ mom_z0 rtol = 1e-10[m
2026-02-09T19:17:20.6392505Z [31m-    @test energy_f ≈ energy0 rtol = 1e-10[m
2026-02-09T19:17:20.6392692Z [32m+[m[32m    @test mass_f ≈ mass0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6392871Z [32m+[m[32m    @test mom_xf ≈ mom_x0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6393048Z [32m+[m[32m    @test mom_yf ≈ mom_y0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6393223Z [32m+[m[32m    @test mom_zf ≈ mom_z0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6393416Z [32m+[m[32m    @test energy_f ≈ energy0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6393494Z  end[m
2026-02-09T19:17:20.6393574Z  [m
2026-02-09T19:17:20.6393723Z  # ============================================================[m
2026-02-09T19:17:20.6393835Z [36m@@ -334,7 +334,7 @@[m [mend[m
2026-02-09T19:17:20.6393997Z      dx, dy, dz = mesh.dx, mesh.dy, mesh.dz[m
2026-02-09T19:17:20.6394104Z      vol = dx * dy * dz[m
2026-02-09T19:17:20.6394177Z  [m
2026-02-09T19:17:20.6394279Z [31m-    P_bg = 1e-5[m
2026-02-09T19:17:20.6394399Z [32m+[m[32m    P_bg = 1.0e-5[m
2026-02-09T19:17:20.6394498Z      P_blast = 1.0[m
2026-02-09T19:17:20.6394637Z      r_blast = 3.0 * dx  # a few cells[m
2026-02-09T19:17:20.6394715Z  [m
2026-02-09T19:17:20.6394821Z [36m@@ -392,6 +392,6 @@[m [mend[m
2026-02-09T19:17:20.6395132Z          energy0 = sum(U0[ix + 2, iy + 2, iz + 2][5] for ix in 1:N, iy in 1:N, iz in 1:N) * vol[m
2026-02-09T19:17:20.6395397Z          energy_f = sum(U[ix, iy, iz][5] for ix in 1:N, iy in 1:N, iz in 1:N) * vol[m
2026-02-09T19:17:20.6395477Z  [m
2026-02-09T19:17:20.6395646Z [31m-        @test energy_f ≈ energy0 rtol = 1e-8[m
2026-02-09T19:17:20.6395845Z [32m+[m[32m        @test energy_f ≈ energy0 rtol = 1.0e-8[m
2026-02-09T19:17:20.6395933Z      end[m
2026-02-09T19:17:20.6396009Z  end[m
2026-02-09T19:17:20.6474487Z [34m[138/151] Checking `test/imex.jl` ............................................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.6489688Z [1mdiff --git a/imex.jl b/imex.jl[m
2026-02-09T19:17:20.6490211Z [1mindex 4fd210d..0d6f69b 100644[m
2026-02-09T19:17:20.6490395Z [1m--- a/imex.jl[m
2026-02-09T19:17:20.6490801Z [1m+++ b/imex.jl[m
2026-02-09T19:17:20.6491359Z [36m@@ -57,21 +57,21 @@[m [musing FiniteVolumeMethod, Test, StaticArrays, LinearAlgebra[m
2026-02-09T19:17:20.6491746Z              @test has_implicit_stage[m
2026-02-09T19:17:20.6491883Z  [m
2026-02-09T19:17:20.6492113Z              # b_ex sums to 1 (consistency)[m
2026-02-09T19:17:20.6492314Z [31m-            @test sum(tab.b_ex) ≈ 1.0 atol = 1e-14[m
2026-02-09T19:17:20.6492532Z [32m+[m[32m            @test sum(tab.b_ex) ≈ 1.0 atol = 1.0e-14[m
2026-02-09T19:17:20.6492612Z  [m
2026-02-09T19:17:20.6492765Z              # b_im sums to 1 (consistency)[m
2026-02-09T19:17:20.6492946Z [31m-            @test sum(tab.b_im) ≈ 1.0 atol = 1e-14[m
2026-02-09T19:17:20.6493153Z [32m+[m[32m            @test sum(tab.b_im) ≈ 1.0 atol = 1.0e-14[m
2026-02-09T19:17:20.6493233Z  [m
2026-02-09T19:17:20.6493429Z              # c_ex = A_ex * ones (row sums match abscissae)[m
2026-02-09T19:17:20.6493540Z              for k in 1:s[m
2026-02-09T19:17:20.6493741Z                  row_sum = sum(tab.A_ex[k][j] for j in 1:s)[m
2026-02-09T19:17:20.6493939Z [31m-                @test row_sum ≈ tab.c_ex[k] atol = 1e-14[m
2026-02-09T19:17:20.6494171Z [32m+[m[32m                @test row_sum ≈ tab.c_ex[k] atol = 1.0e-14[m
2026-02-09T19:17:20.6494266Z              end[m
2026-02-09T19:17:20.6494340Z  [m
2026-02-09T19:17:20.6494651Z              # c_im = A_im * ones (row sums match abscissae)[m
2026-02-09T19:17:20.6494803Z              for k in 1:s[m
2026-02-09T19:17:20.6495003Z                  row_sum = sum(tab.A_im[k][j] for j in 1:s)[m
2026-02-09T19:17:20.6495202Z [31m-                @test row_sum ≈ tab.c_im[k] atol = 1e-14[m
2026-02-09T19:17:20.6495419Z [32m+[m[32m                @test row_sum ≈ tab.c_im[k] atol = 1.0e-14[m
2026-02-09T19:17:20.6495511Z              end[m
2026-02-09T19:17:20.6495597Z          end[m
2026-02-09T19:17:20.6495677Z      end[m
2026-02-09T19:17:20.6495794Z [36m@@ -142,13 +142,15 @@[m [mend[m
2026-02-09T19:17:20.6495955Z      W_ref = to_primitive(law, U_ref)[m
2026-02-09T19:17:20.6496029Z  [m
2026-02-09T19:17:20.6496290Z      # IMEX solve with NullSource (should behave like explicit)[m
2026-02-09T19:17:20.6496599Z [31m-    x_imex, U_imex, t_imex = solve_hyperbolic_imex(prob, NullSource();[m
2026-02-09T19:17:20.6496750Z [31m-        scheme = IMEX_Midpoint())[m
2026-02-09T19:17:20.6496977Z [32m+[m[32m    x_imex, U_imex, t_imex = solve_hyperbolic_imex([m
2026-02-09T19:17:20.6497121Z [32m+[m[32m        prob, NullSource();[m
2026-02-09T19:17:20.6497289Z [32m+[m[32m        scheme = IMEX_Midpoint()[m
2026-02-09T19:17:20.6497383Z [32m+[m[32m    )[m
2026-02-09T19:17:20.6497531Z      W_imex = to_primitive(law, U_imex)[m
2026-02-09T19:17:20.6497634Z  [m
2026-02-09T19:17:20.6497781Z      # Both should reach the final time[m
2026-02-09T19:17:20.6497959Z [31m-    @test t_ref ≈ t_final atol = 1e-10[m
2026-02-09T19:17:20.6498118Z [31m-    @test t_imex ≈ t_final atol = 1e-10[m
2026-02-09T19:17:20.6498311Z [32m+[m[32m    @test t_ref ≈ t_final atol = 1.0e-10[m
2026-02-09T19:17:20.6498493Z [32m+[m[32m    @test t_imex ≈ t_final atol = 1.0e-10[m
2026-02-09T19:17:20.6498572Z  [m
2026-02-09T19:17:20.6499049Z      # The solutions should be close (not identical due to different time[m
2026-02-09T19:17:20.6499288Z      # stepping structure, but the physics should match)[m
2026-02-09T19:17:20.6499410Z [36m@@ -215,8 +217,10 @@[m [mend[m
2026-02-09T19:17:20.6499540Z          final_time = 0.05, cfl = 0.4[m
2026-02-09T19:17:20.6499620Z      )[m
2026-02-09T19:17:20.6499692Z  [m
2026-02-09T19:17:20.6499960Z [31m-    x, U_final, t_final = solve_hyperbolic_imex(prob, source;[m
2026-02-09T19:17:20.6500235Z [31m-        scheme = IMEX_ARS222(), newton_tol = 1e-12, newton_maxiter = 10)[m
2026-02-09T19:17:20.6500454Z [32m+[m[32m    x, U_final, t_final = solve_hyperbolic_imex([m
2026-02-09T19:17:20.6500584Z [32m+[m[32m        prob, source;[m
2026-02-09T19:17:20.6500879Z [32m+[m[32m        scheme = IMEX_ARS222(), newton_tol = 1.0e-12, newton_maxiter = 10[m
2026-02-09T19:17:20.6501130Z [32m+[m[32m    )[m
2026-02-09T19:17:20.6501294Z      W_final = to_primitive(law, U_final)[m
2026-02-09T19:17:20.6501494Z  [m
2026-02-09T19:17:20.6501783Z      # After evolution, pressure should have relaxed toward P_target[m
2026-02-09T19:17:20.6501897Z [36m@@ -278,17 +282,19 @@[m [mend[m
2026-02-09T19:17:20.6502104Z      energy0 = sum(U0[i][3] for i in 3:(N_cells + 2)) * dx[m
2026-02-09T19:17:20.6502177Z  [m
2026-02-09T19:17:20.6502448Z      # Solve with IMEX + NullSource (purely explicit, conservative)[m
2026-02-09T19:17:20.6502727Z [31m-    x, U_final, t_final = solve_hyperbolic_imex(prob, NullSource();[m
2026-02-09T19:17:20.6502865Z [31m-        scheme = IMEX_SSP3_433())[m
2026-02-09T19:17:20.6503082Z [32m+[m[32m    x, U_final, t_final = solve_hyperbolic_imex([m
2026-02-09T19:17:20.6503230Z [32m+[m[32m        prob, NullSource();[m
2026-02-09T19:17:20.6503389Z [32m+[m[32m        scheme = IMEX_SSP3_433()[m
2026-02-09T19:17:20.6503487Z [32m+[m[32m    )[m
2026-02-09T19:17:20.6503560Z  [m
2026-02-09T19:17:20.6503782Z      mass_final = sum(U_final[i][1] for i in 1:N_cells) * dx[m
2026-02-09T19:17:20.6504024Z      momentum_final = sum(U_final[i][2] for i in 1:N_cells) * dx[m
2026-02-09T19:17:20.6504246Z      energy_final = sum(U_final[i][3] for i in 1:N_cells) * dx[m
2026-02-09T19:17:20.6504324Z  [m
2026-02-09T19:17:20.6504626Z      # Conservation should hold (NullSource adds no energy/mass/momentum)[m
2026-02-09T19:17:20.6504797Z [31m-    @test mass_final ≈ mass0 rtol = 1e-10[m
2026-02-09T19:17:20.6504999Z [31m-    @test momentum_final ≈ momentum0 rtol = 1e-10[m
2026-02-09T19:17:20.6505186Z [31m-    @test energy_final ≈ energy0 rtol = 1e-10[m
2026-02-09T19:17:20.6505380Z [32m+[m[32m    @test mass_final ≈ mass0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6505607Z [32m+[m[32m    @test momentum_final ≈ momentum0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6505820Z [32m+[m[32m    @test energy_final ≈ energy0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6505909Z  end[m
2026-02-09T19:17:20.6505980Z  [m
2026-02-09T19:17:20.6506125Z  # ============================================================[m
2026-02-09T19:17:20.6506252Z [36m@@ -313,11 +319,13 @@[m [mend[m
2026-02-09T19:17:20.6506390Z          ic; final_time = 0.01, cfl = 0.3[m
2026-02-09T19:17:20.6506470Z      )[m
2026-02-09T19:17:20.6506549Z  [m
2026-02-09T19:17:20.6506849Z [31m-    coords, U_final, t_final = solve_hyperbolic_imex(prob, NullSource();[m
2026-02-09T19:17:20.6506995Z [31m-        scheme = IMEX_Midpoint())[m
2026-02-09T19:17:20.6507236Z [32m+[m[32m    coords, U_final, t_final = solve_hyperbolic_imex([m
2026-02-09T19:17:20.6507377Z [32m+[m[32m        prob, NullSource();[m
2026-02-09T19:17:20.6507531Z [32m+[m[32m        scheme = IMEX_Midpoint()[m
2026-02-09T19:17:20.6507625Z [32m+[m[32m    )[m
2026-02-09T19:17:20.6507704Z  [m
2026-02-09T19:17:20.6507833Z      # Should reach final time[m
2026-02-09T19:17:20.6507987Z [31m-    @test t_final ≈ 0.01 atol = 1e-10[m
2026-02-09T19:17:20.6508162Z [32m+[m[32m    @test t_final ≈ 0.01 atol = 1.0e-10[m
2026-02-09T19:17:20.6508235Z  [m
2026-02-09T19:17:20.6508417Z      # Solution should have correct dimensions[m
2026-02-09T19:17:20.6508548Z      @test size(U_final) == (nx, ny)[m
2026-02-09T19:17:20.6508663Z [36m@@ -363,15 +371,15 @@[m [mend[m
2026-02-09T19:17:20.6508878Z      )[m
2026-02-09T19:17:20.6508954Z  [m
2026-02-09T19:17:20.6509079Z      for (name, scheme) in [[m
2026-02-09T19:17:20.6509223Z [31m-        ("SSP3_433", IMEX_SSP3_433()),[m
2026-02-09T19:17:20.6509356Z [31m-        ("ARS222", IMEX_ARS222()),[m
2026-02-09T19:17:20.6509513Z [31m-        ("Midpoint", IMEX_Midpoint()),[m
2026-02-09T19:17:20.6509607Z [31m-    ][m
2026-02-09T19:17:20.6509776Z [32m+[m[32m            ("SSP3_433", IMEX_SSP3_433()),[m
2026-02-09T19:17:20.6509939Z [32m+[m[32m            ("ARS222", IMEX_ARS222()),[m
2026-02-09T19:17:20.6510125Z [32m+[m[32m            ("Midpoint", IMEX_Midpoint()),[m
2026-02-09T19:17:20.6510351Z [32m+[m[32m        ][m
2026-02-09T19:17:20.6510476Z          @testset "$name" begin[m
2026-02-09T19:17:20.6510864Z              x, U, t = solve_hyperbolic_imex(prob, NullSource(); scheme = scheme)[m
2026-02-09T19:17:20.6511012Z              W = to_primitive(law, U)[m
2026-02-09T19:17:20.6511084Z  [m
2026-02-09T19:17:20.6511226Z [31m-            @test t ≈ 0.05 atol = 1e-10[m
2026-02-09T19:17:20.6511402Z [32m+[m[32m            @test t ≈ 0.05 atol = 1.0e-10[m
2026-02-09T19:17:20.6511475Z  [m
2026-02-09T19:17:20.6511600Z              # Physical results[m
2026-02-09T19:17:20.6511714Z              for i in 1:N_cells[m
2026-02-09T19:17:20.6699758Z [34m[139/151] Checking `test/mhd.jl` ............................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.6719017Z [1mdiff --git a/mhd.jl b/mhd.jl[m
2026-02-09T19:17:20.6719611Z [1mindex b2758cf..779aafc 100644[m
2026-02-09T19:17:20.6720085Z [1m--- a/mhd.jl[m
2026-02-09T19:17:20.6720443Z [1m+++ b/mhd.jl[m
2026-02-09T19:17:20.6720705Z [36m@@ -40,7 +40,7 @@[m [mend[m
2026-02-09T19:17:20.6721096Z          for w in states[m
2026-02-09T19:17:20.6721678Z              u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.6722359Z              w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.6723006Z [31m-            @test w2 ≈ w atol = 1e-14[m
2026-02-09T19:17:20.6723650Z [32m+[m[32m            @test w2 ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.6724182Z          end[m
2026-02-09T19:17:20.6724533Z      end[m
2026-02-09T19:17:20.6724850Z  [m
2026-02-09T19:17:20.6725255Z [36m@@ -170,10 +170,10 @@[m [mend[m
2026-02-09T19:17:20.6725925Z          w_hydro = SVector(1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0)[m
2026-02-09T19:17:20.6726688Z          cf = fast_magnetosonic_speed(law, w_hydro, 1)[m
2026-02-09T19:17:20.6727423Z          cs_hydro = sqrt(eos.gamma * 1.0 / 1.0)  # √(γP/ρ)[m
2026-02-09T19:17:20.6728095Z [31m-        @test cf ≈ cs_hydro atol = 1e-14[m
2026-02-09T19:17:20.6729017Z [32m+[m[32m        @test cf ≈ cs_hydro atol = 1.0e-14[m
2026-02-09T19:17:20.6729562Z  [m
2026-02-09T19:17:20.6730068Z          cs = slow_magnetosonic_speed(law, w_hydro, 1)[m
2026-02-09T19:17:20.6730727Z [31m-        @test cs ≈ 0.0 atol = 1e-14[m
2026-02-09T19:17:20.6731345Z [32m+[m[32m        @test cs ≈ 0.0 atol = 1.0e-14[m
2026-02-09T19:17:20.6731862Z      end[m
2026-02-09T19:17:20.6732185Z  [m
2026-02-09T19:17:20.6732639Z      @testset "Perpendicular B only (Bn=0)" begin[m
2026-02-09T19:17:20.6733250Z [36m@@ -184,8 +184,8 @@[m [mend[m
2026-02-09T19:17:20.6733678Z  [m
2026-02-09T19:17:20.6734066Z          a_sq = eos.gamma * 1.0 / 1.0[m
2026-02-09T19:17:20.6734601Z          b_sq = 1.0 / 1.0  # By² / ρ[m
2026-02-09T19:17:20.6735215Z [31m-        @test cf ≈ sqrt(a_sq + b_sq) atol = 1e-14[m
2026-02-09T19:17:20.6735847Z [31m-        @test cs ≈ 0.0 atol = 1e-14[m
2026-02-09T19:17:20.6736520Z [32m+[m[32m        @test cf ≈ sqrt(a_sq + b_sq) atol = 1.0e-14[m
2026-02-09T19:17:20.6737256Z [32m+[m[32m        @test cs ≈ 0.0 atol = 1.0e-14[m
2026-02-09T19:17:20.6737762Z      end[m
2026-02-09T19:17:20.6738082Z  [m
2026-02-09T19:17:20.6738578Z      @testset "wave_speeds and max_wave_speed" begin[m
2026-02-09T19:17:20.6739357Z [36m@@ -236,7 +236,7 @@[m [mend[m
2026-02-09T19:17:20.6739839Z          for w in states[m
2026-02-09T19:17:20.6740376Z              F_exact = physical_flux(law, w, 1)[m
2026-02-09T19:17:20.6741050Z              F_hlld = solve_riemann(hlld, law, w, w, 1)[m
2026-02-09T19:17:20.6741740Z [31m-            @test F_hlld ≈ F_exact atol = 1e-12[m
2026-02-09T19:17:20.6742453Z [32m+[m[32m            @test F_hlld ≈ F_exact atol = 1.0e-12[m
2026-02-09T19:17:20.6743021Z          end[m
2026-02-09T19:17:20.6743376Z      end[m
2026-02-09T19:17:20.6743686Z  [m
2026-02-09T19:17:20.6744056Z [36m@@ -269,7 +269,7 @@[m [mend[m
2026-02-09T19:17:20.6744565Z          @test all(isfinite.(F_lf))[m
2026-02-09T19:17:20.6745283Z  [m
2026-02-09T19:17:20.6745810Z          # Mass flux should have the same sign for all three[m
2026-02-09T19:17:20.6746474Z [31m-        if abs(F_hlld[1]) > 1e-10[m
2026-02-09T19:17:20.6747268Z [32m+[m[32m        if abs(F_hlld[1]) > 1.0e-10[m
2026-02-09T19:17:20.6747942Z              @test sign(F_hlld[1]) == sign(F_hll[1])[m
2026-02-09T19:17:20.6748469Z          end[m
2026-02-09T19:17:20.6748979Z      end[m
2026-02-09T19:17:20.6749378Z [36m@@ -283,7 +283,7 @@[m [mend[m
2026-02-09T19:17:20.6749801Z  [m
2026-02-09T19:17:20.6750228Z          # Just check it's finite and reasonable[m
2026-02-09T19:17:20.6750812Z          @test all(isfinite.(F_hlld))[m
2026-02-09T19:17:20.6751464Z [31m-        @test F_hlld[6] ≈ 0.0 atol = 1e-14  # No Bx flux[m
2026-02-09T19:17:20.6752241Z [32m+[m[32m        @test F_hlld[6] ≈ 0.0 atol = 1.0e-14  # No Bx flux[m
2026-02-09T19:17:20.6752833Z      end[m
2026-02-09T19:17:20.6753132Z  [m
2026-02-09T19:17:20.6753618Z      @testset "Degenerate: Bn=0 (no Alfvén waves)" begin[m
2026-02-09T19:17:20.6754244Z [36m@@ -323,7 +323,7 @@[m [mend[m
2026-02-09T19:17:20.6754787Z          x, U, t_final = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6755377Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.6755807Z  [m
2026-02-09T19:17:20.6756224Z [31m-        @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.6756865Z [32m+[m[32m        @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.6757474Z          @test length(x) == 800[m
2026-02-09T19:17:20.6757988Z          @test length(W) == 800[m
2026-02-09T19:17:20.6758411Z  [m
2026-02-09T19:17:20.6758949Z [36m@@ -339,7 +339,7 @@[m [mend[m
2026-02-09T19:17:20.6759386Z  [m
2026-02-09T19:17:20.6760039Z          # Bx should remain constant throughout (trivially satisfied in 1D)[m
2026-02-09T19:17:20.6760821Z          Bx_sol = [w[6] for w in W][m
2026-02-09T19:17:20.6761461Z [31m-        @test all(b -> abs(b - Bx) < 1e-10, Bx_sol)[m
2026-02-09T19:17:20.6762211Z [32m+[m[32m        @test all(b -> abs(b - Bx) < 1.0e-10, Bx_sol)[m
2026-02-09T19:17:20.6762877Z  [m
2026-02-09T19:17:20.6763483Z          # Check that the solution has structure (not all the same value)[m
2026-02-09T19:17:20.6764264Z          @test maximum(ρ) > minimum(ρ) + 0.01[m
2026-02-09T19:17:20.6764824Z [36m@@ -368,7 +368,7 @@[m [mend[m
2026-02-09T19:17:20.6765313Z          ρ = [w[1] for w in W][m
2026-02-09T19:17:20.6765794Z          P = [w[5] for w in W][m
2026-02-09T19:17:20.6766201Z  [m
2026-02-09T19:17:20.6766629Z [31m-        @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.6767283Z [32m+[m[32m        @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.6767875Z          @test all(ρ .> 0)[m
2026-02-09T19:17:20.6768337Z          @test all(P .> 0)[m
2026-02-09T19:17:20.6769024Z          @test all(isfinite.(ρ))[m
2026-02-09T19:17:20.6769553Z [36m@@ -423,7 +423,7 @@[m [mend[m
2026-02-09T19:17:20.6770035Z          ρ = [w[1] for w in W][m
2026-02-09T19:17:20.6770511Z          P = [w[5] for w in W][m
2026-02-09T19:17:20.6771164Z  [m
2026-02-09T19:17:20.6771600Z [31m-        @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.6772260Z [32m+[m[32m        @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.6773019Z          @test all(ρ .> 0)[m
2026-02-09T19:17:20.6773494Z          @test all(P .> 0)[m
2026-02-09T19:17:20.6773910Z      end[m
2026-02-09T19:17:20.6774307Z [36m@@ -479,10 +479,10 @@[m [mend[m
2026-02-09T19:17:20.6774861Z          energy_0 = sum(u[5] for u in U0) * dx[m
2026-02-09T19:17:20.6775514Z          energy_f = sum(u[5] for u in U_final) * dx[m
2026-02-09T19:17:20.6776022Z  [m
2026-02-09T19:17:20.6776456Z [31m-        @test mass_f ≈ mass_0 atol = 1e-10[m
2026-02-09T19:17:20.6777088Z [31m-        @test mom_x_f ≈ mom_x_0 atol = 1e-10[m
2026-02-09T19:17:20.6777727Z [31m-        @test mom_y_f ≈ mom_y_0 atol = 1e-10[m
2026-02-09T19:17:20.6778379Z [31m-        @test energy_f ≈ energy_0 atol = 1e-10[m
2026-02-09T19:17:20.6779260Z [32m+[m[32m        @test mass_f ≈ mass_0 atol = 1.0e-10[m
2026-02-09T19:17:20.6779998Z [32m+[m[32m        @test mom_x_f ≈ mom_x_0 atol = 1.0e-10[m
2026-02-09T19:17:20.6780710Z [32m+[m[32m        @test mom_y_f ≈ mom_y_0 atol = 1.0e-10[m
2026-02-09T19:17:20.6781459Z [32m+[m[32m        @test energy_f ≈ energy_0 atol = 1.0e-10[m
2026-02-09T19:17:20.6782033Z      end[m
2026-02-09T19:17:20.6782360Z  end[m
2026-02-09T19:17:20.6782657Z  [m
2026-02-09T19:17:20.6783026Z [36m@@ -522,7 +522,7 @@[m [mend[m
2026-02-09T19:17:20.6783518Z              ρ = [w[1] for w in W][m
2026-02-09T19:17:20.6784021Z              P = [w[5] for w in W][m
2026-02-09T19:17:20.6784451Z  [m
2026-02-09T19:17:20.6784886Z [31m-            @test t_final ≈ 0.05 atol = 1e-10[m
2026-02-09T19:17:20.6785564Z [32m+[m[32m            @test t_final ≈ 0.05 atol = 1.0e-10[m
2026-02-09T19:17:20.6786159Z              @test all(ρ .> 0)[m
2026-02-09T19:17:20.6786638Z              @test all(P .> 0)[m
2026-02-09T19:17:20.6787131Z              @test all(isfinite.(ρ))[m
2026-02-09T19:17:20.6787668Z [36m@@ -678,7 +678,7 @@[m [mend[m
2026-02-09T19:17:20.6788139Z      ρ = [w[1] for w in W][m
2026-02-09T19:17:20.6788601Z      P = [w[5] for w in W][m
2026-02-09T19:17:20.6789161Z  [m
2026-02-09T19:17:20.6789593Z [31m-    @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.6790221Z [32m+[m[32m    @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.6790916Z      @test all(ρ .> 0)    # Density should stay positive[m
2026-02-09T19:17:20.6791683Z      @test all(P .> 0)    # Pressure should stay positive[m
2026-02-09T19:17:20.6792307Z      @test all(isfinite.(ρ))[m
2026-02-09T19:17:20.6792796Z [36m@@ -758,7 +758,7 @@[m [mend[m
2026-02-09T19:17:20.6793270Z      ρ = [w[1] for w in W][m
2026-02-09T19:17:20.6793730Z      P = [w[5] for w in W][m
2026-02-09T19:17:20.6794124Z  [m
2026-02-09T19:17:20.6794545Z [31m-    @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.6795180Z [32m+[m[32m    @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.6795747Z      @test all(ρ .> 0)[m
2026-02-09T19:17:20.6796182Z      @test all(P .> 0)[m
2026-02-09T19:17:20.6796562Z  end[m
2026-02-09T19:17:20.6936076Z [34m[140/151] Checking `test/mhd_2d.jl` .......................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.6952619Z [1mdiff --git a/mhd_2d.jl b/mhd_2d.jl[m
2026-02-09T19:17:20.6953271Z [1mindex b84b863..f33ed16 100644[m
2026-02-09T19:17:20.6953739Z [1m--- a/mhd_2d.jl[m
2026-02-09T19:17:20.6954106Z [1m+++ b/mhd_2d.jl[m
2026-02-09T19:17:20.6954439Z [36m@@ -25,9 +25,9 @@[m [musing StaticArrays[m
2026-02-09T19:17:20.6954755Z  [m
2026-02-09T19:17:20.6955288Z          u_ref = primitive_to_conserved(law, w_const)[m
2026-02-09T19:17:20.6955934Z          for iy in 1:20, ix in 1:20[m
2026-02-09T19:17:20.6956605Z [31m-            @test U_final[ix, iy] ≈ u_ref atol = 1e-12[m
2026-02-09T19:17:20.6957412Z [32m+[m[32m            @test U_final[ix, iy] ≈ u_ref atol = 1.0e-12[m
2026-02-09T19:17:20.6958028Z          end[m
2026-02-09T19:17:20.6959061Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1e-13[m
2026-02-09T19:17:20.6959963Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1.0e-13[m
2026-02-09T19:17:20.6960862Z      end[m
2026-02-09T19:17:20.6973143Z  [m
2026-02-09T19:17:20.6973618Z      @testset "Return value structure" begin[m
2026-02-09T19:17:20.6974287Z [36m@@ -45,7 +45,7 @@[m [musing StaticArrays[m
2026-02-09T19:17:20.6974875Z          coords, U, t, ct = result[m
2026-02-09T19:17:20.6975403Z          @test size(U) == (10, 10)[m
2026-02-09T19:17:20.6976004Z          @test size(coords) == (10, 10)[m
2026-02-09T19:17:20.6976589Z [31m-        @test t ≈ 0.01 atol = 1e-10[m
2026-02-09T19:17:20.6977204Z [32m+[m[32m        @test t ≈ 0.01 atol = 1.0e-10[m
2026-02-09T19:17:20.6977777Z          @test ct isa CTData2D[m
2026-02-09T19:17:20.6978227Z      end[m
2026-02-09T19:17:20.6978545Z  end[m
2026-02-09T19:17:20.6979140Z [36m@@ -68,7 +68,7 @@[m [mend[m
2026-02-09T19:17:20.6979586Z          )[m
2026-02-09T19:17:20.6979913Z  [m
2026-02-09T19:17:20.6980336Z          _, _, _, ct = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6981057Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 30, 30) < 1e-12[m
2026-02-09T19:17:20.6981885Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 30, 30) < 1.0e-12[m
2026-02-09T19:17:20.6982494Z      end[m
2026-02-09T19:17:20.6982795Z  [m
2026-02-09T19:17:20.6983314Z      @testset "Non-uniform field: ∇·B = 0 maintained" begin[m
2026-02-09T19:17:20.6983941Z [36m@@ -95,7 +95,7 @@[m [mend[m
2026-02-09T19:17:20.6984343Z  [m
2026-02-09T19:17:20.6984752Z          _, _, _, ct = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6985407Z          divB_max = max_divB(ct, mesh.dx, mesh.dy, 30, 30)[m
2026-02-09T19:17:20.6986035Z [31m-        @test divB_max < 1e-12[m
2026-02-09T19:17:20.6986582Z [32m+[m[32m        @test divB_max < 1.0e-12[m
2026-02-09T19:17:20.6987069Z      end[m
2026-02-09T19:17:20.6987393Z  [m
2026-02-09T19:17:20.6987833Z      @testset "Euler method: ∇·B = 0" begin[m
2026-02-09T19:17:20.6988397Z [36m@@ -109,7 +109,7 @@[m [mend[m
2026-02-09T19:17:20.6989024Z          )[m
2026-02-09T19:17:20.6989350Z  [m
2026-02-09T19:17:20.6989860Z          _, _, _, ct = solve_hyperbolic(prob; method = :euler)[m
2026-02-09T19:17:20.6990657Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1e-12[m
2026-02-09T19:17:20.6991507Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1.0e-12[m
2026-02-09T19:17:20.6992140Z      end[m
2026-02-09T19:17:20.6992465Z  end[m
2026-02-09T19:17:20.6992763Z  [m
2026-02-09T19:17:20.6993127Z [36m@@ -148,11 +148,11 @@[m [mend[m
2026-02-09T19:17:20.6993615Z          ρ = [w[1] for w in W][m
2026-02-09T19:17:20.6994099Z          P = [w[5] for w in W][m
2026-02-09T19:17:20.6994502Z  [m
2026-02-09T19:17:20.6994924Z [31m-        @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.6995574Z [32m+[m[32m        @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.6996172Z          @test all(ρ .> 0)[m
2026-02-09T19:17:20.6996621Z          @test all(P .> 0)[m
2026-02-09T19:17:20.6997108Z          @test all(isfinite.(ρ))[m
2026-02-09T19:17:20.6997793Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 50, 50) < 1e-12[m
2026-02-09T19:17:20.6998632Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 50, 50) < 1.0e-12[m
2026-02-09T19:17:20.6999413Z  [m
2026-02-09T19:17:20.6999991Z          # Orszag-Tang should develop structure (not remain uniform)[m
2026-02-09T19:17:20.7000747Z          @test maximum(ρ) > minimum(ρ) + 0.1[m
2026-02-09T19:17:20.7001288Z [36m@@ -172,10 +172,10 @@[m [mend[m
2026-02-09T19:17:20.7001777Z          ρ = [w[1] for w in W][m
2026-02-09T19:17:20.7002239Z          P = [w[5] for w in W][m
2026-02-09T19:17:20.7002648Z  [m
2026-02-09T19:17:20.7003069Z [31m-        @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.7003727Z [32m+[m[32m        @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.7004307Z          @test all(ρ .> 0)[m
2026-02-09T19:17:20.7005015Z          @test all(P .> 0)[m
2026-02-09T19:17:20.7005647Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 40, 40) < 1e-12[m
2026-02-09T19:17:20.7006654Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 40, 40) < 1.0e-12[m
2026-02-09T19:17:20.7007325Z      end[m
2026-02-09T19:17:20.7007638Z  [m
2026-02-09T19:17:20.7008082Z      @testset "HLLD vs HLL comparison" begin[m
2026-02-09T19:17:20.7008652Z [36m@@ -206,7 +206,7 @@[m [mend[m
2026-02-09T19:17:20.7009532Z          # HLLD should give a different (generally sharper) solution[m
2026-02-09T19:17:20.7010272Z          ρ_hlld = [w[1] for w in W_hlld][m
2026-02-09T19:17:20.7010838Z          ρ_hll = [w[1] for w in W_hll][m
2026-02-09T19:17:20.7011481Z [31m-        @test maximum(abs.(ρ_hlld .- ρ_hll)) > 1e-6[m
2026-02-09T19:17:20.7012238Z [32m+[m[32m        @test maximum(abs.(ρ_hlld .- ρ_hll)) > 1.0e-6[m
2026-02-09T19:17:20.7012843Z      end[m
2026-02-09T19:17:20.7013162Z  end[m
2026-02-09T19:17:20.7013487Z  [m
2026-02-09T19:17:20.7013844Z [36m@@ -224,7 +224,7 @@[m [mend[m
2026-02-09T19:17:20.7014307Z      ρ_bg = 1.0[m
2026-02-09T19:17:20.7014693Z      P_bg = 1.0[m
2026-02-09T19:17:20.7015104Z      R0 = 0.3  # loop radius[m
2026-02-09T19:17:20.7015732Z [31m-    A0 = 1e-3  # amplitude (weak field → linear regime)[m
2026-02-09T19:17:20.7016551Z [32m+[m[32m    A0 = 1.0e-3  # amplitude (weak field → linear regime)[m
2026-02-09T19:17:20.7017156Z  [m
2026-02-09T19:17:20.7017524Z      function loop_ic(x, y)[m
2026-02-09T19:17:20.7018010Z          # Center at (0.5, 0.5)[m
2026-02-09T19:17:20.7018506Z [36m@@ -258,8 +258,8 @@[m [mend[m
2026-02-09T19:17:20.7019150Z          )[m
2026-02-09T19:17:20.7019469Z  [m
2026-02-09T19:17:20.7020096Z          _, _, t_final, ct = solve_hyperbolic(prob; vector_potential = Az_loop)[m
2026-02-09T19:17:20.7020902Z [31m-        @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.7021613Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 50, 50) < 1e-12[m
2026-02-09T19:17:20.7022375Z [32m+[m[32m        @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.7023152Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 50, 50) < 1.0e-12[m
2026-02-09T19:17:20.7023798Z      end[m
2026-02-09T19:17:20.7024106Z  [m
2026-02-09T19:17:20.7024637Z      @testset "Density and pressure remain positive" begin[m
2026-02-09T19:17:20.7025280Z [36m@@ -352,10 +352,10 @@[m [mend[m
2026-02-09T19:17:20.7025835Z          energy_0 = sum(u[5] for u in U0) * dA[m
2026-02-09T19:17:20.7026480Z          energy_f = sum(u[5] for u in U_final) * dA[m
2026-02-09T19:17:20.7026985Z  [m
2026-02-09T19:17:20.7027420Z [31m-        @test mass_f ≈ mass_0 atol = 1e-10[m
2026-02-09T19:17:20.7028045Z [31m-        @test momx_f ≈ momx_0 atol = 1e-10[m
2026-02-09T19:17:20.7028667Z [31m-        @test momy_f ≈ momy_0 atol = 1e-10[m
2026-02-09T19:17:20.7029754Z [31m-        @test energy_f ≈ energy_0 atol = 1e-8  # Energy may have slightly larger error[m
2026-02-09T19:17:20.7030726Z [32m+[m[32m        @test mass_f ≈ mass_0 atol = 1.0e-10[m
2026-02-09T19:17:20.7031436Z [32m+[m[32m        @test momx_f ≈ momx_0 atol = 1.0e-10[m
2026-02-09T19:17:20.7032144Z [32m+[m[32m        @test momy_f ≈ momy_0 atol = 1.0e-10[m
2026-02-09T19:17:20.7033139Z [32m+[m[32m        @test energy_f ≈ energy_0 atol = 1.0e-8  # Energy may have slightly larger error[m
2026-02-09T19:17:20.7033938Z      end[m
2026-02-09T19:17:20.7034267Z  end[m
2026-02-09T19:17:20.7034567Z  [m
2026-02-09T19:17:20.7034935Z [36m@@ -380,7 +380,7 @@[m [mend[m
2026-02-09T19:17:20.7035438Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.7035969Z          @test all(w -> w[1] > 0, W)[m
2026-02-09T19:17:20.7036487Z          @test all(w -> w[5] > 0, W)[m
2026-02-09T19:17:20.7037152Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1e-12[m
2026-02-09T19:17:20.7037996Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1.0e-12[m
2026-02-09T19:17:20.7038621Z      end[m
2026-02-09T19:17:20.7039360Z  [m
2026-02-09T19:17:20.7039758Z      @testset "ReflectiveBC" begin[m
2026-02-09T19:17:20.7040304Z [36m@@ -401,7 +401,7 @@[m [mend[m
2026-02-09T19:17:20.7041045Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.7041602Z          @test all(w -> w[1] > 0, W)[m
2026-02-09T19:17:20.7042120Z          @test all(w -> w[5] > 0, W)[m
2026-02-09T19:17:20.7042787Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1e-12[m
2026-02-09T19:17:20.7043631Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1.0e-12[m
2026-02-09T19:17:20.7044268Z      end[m
2026-02-09T19:17:20.7044574Z  [m
2026-02-09T19:17:20.7044965Z      @testset "PeriodicBC" begin[m
2026-02-09T19:17:20.7045471Z [36m@@ -422,7 +422,7 @@[m [mend[m
2026-02-09T19:17:20.7045977Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.7046496Z          @test all(w -> w[1] > 0, W)[m
2026-02-09T19:17:20.7047005Z          @test all(w -> w[5] > 0, W)[m
2026-02-09T19:17:20.7047679Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1e-12[m
2026-02-09T19:17:20.7048525Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1.0e-12[m
2026-02-09T19:17:20.7049315Z      end[m
2026-02-09T19:17:20.7049637Z  end[m
2026-02-09T19:17:20.7049935Z  [m
2026-02-09T19:17:20.7050286Z [36m@@ -461,7 +461,7 @@[m [mend[m
2026-02-09T19:17:20.7050801Z              W = to_primitive(law, U)[m
2026-02-09T19:17:20.7051345Z              @test all(w -> w[1] > 0, W)[m
2026-02-09T19:17:20.7051877Z              @test all(w -> w[5] > 0, W)[m
2026-02-09T19:17:20.7052563Z [31m-            @test max_divB(ct, mesh.dx, mesh.dy, 30, 30) < 1e-12[m
2026-02-09T19:17:20.7053421Z [32m+[m[32m            @test max_divB(ct, mesh.dx, mesh.dy, 30, 30) < 1.0e-12[m
2026-02-09T19:17:20.7054071Z          end[m
2026-02-09T19:17:20.7054405Z      end[m
2026-02-09T19:17:20.7054724Z  end[m
2026-02-09T19:17:20.7055089Z [36m@@ -495,7 +495,7 @@[m [mend[m
2026-02-09T19:17:20.7055610Z              @test all(w -> w[1] > 0, W)[m
2026-02-09T19:17:20.7056156Z              @test all(w -> w[5] > 0, W)[m
2026-02-09T19:17:20.7056733Z              @test all(w -> all(isfinite, w), W)[m
2026-02-09T19:17:20.7057465Z [31m-            @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1e-12[m
2026-02-09T19:17:20.7058323Z [32m+[m[32m            @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1.0e-12[m
2026-02-09T19:17:20.7059172Z          end[m
2026-02-09T19:17:20.7059505Z      end[m
2026-02-09T19:17:20.7059830Z  end[m
2026-02-09T19:17:20.7060196Z [36m@@ -529,7 +529,7 @@[m [mend[m
2026-02-09T19:17:20.7060741Z          # Solution should be uniform in y[m
2026-02-09T19:17:20.7061267Z          for ix in 1:200[m
2026-02-09T19:17:20.7061721Z              for iy in 2:4[m
2026-02-09T19:17:20.7062333Z [31m-                @test W[ix, iy][1] ≈ W[ix, 1][1] atol = 1e-10[m
2026-02-09T19:17:20.7063122Z [32m+[m[32m                @test W[ix, iy][1] ≈ W[ix, 1][1] atol = 1.0e-10[m
2026-02-09T19:17:20.7063738Z              end[m
2026-02-09T19:17:20.7064094Z          end[m
2026-02-09T19:17:20.7064418Z  [m
2026-02-09T19:17:20.7064777Z [36m@@ -570,7 +570,7 @@[m [mend[m
2026-02-09T19:17:20.7065303Z              W = to_primitive(law, U)[m
2026-02-09T19:17:20.7065842Z              @test all(w -> w[1] > 0, W)[m
2026-02-09T19:17:20.7066382Z              @test all(w -> w[5] > 0, W)[m
2026-02-09T19:17:20.7067068Z [31m-            @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1e-12[m
2026-02-09T19:17:20.7067929Z [32m+[m[32m            @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1.0e-12[m
2026-02-09T19:17:20.7068574Z          end[m
2026-02-09T19:17:20.7069077Z      end[m
2026-02-09T19:17:20.7069397Z  end[m
2026-02-09T19:17:20.7069759Z [36m@@ -621,10 +621,10 @@[m [mend[m
2026-02-09T19:17:20.7070255Z          ρ = [w[1] for w in W][m
2026-02-09T19:17:20.7070728Z          P = [w[5] for w in W][m
2026-02-09T19:17:20.7071140Z  [m
2026-02-09T19:17:20.7071537Z [31m-        @test t ≈ 0.02 atol = 1e-10[m
2026-02-09T19:17:20.7072370Z [32m+[m[32m        @test t ≈ 0.02 atol = 1.0e-10[m
2026-02-09T19:17:20.7072931Z          @test all(ρ .> 0)[m
2026-02-09T19:17:20.7073381Z          @test all(P .> 0)[m
2026-02-09T19:17:20.7074172Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 40, 40) < 1e-12[m
2026-02-09T19:17:20.7075024Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 40, 40) < 1.0e-12[m
2026-02-09T19:17:20.7075653Z      end[m
2026-02-09T19:17:20.7076043Z  end[m
2026-02-09T19:17:20.7076345Z  [m
2026-02-09T19:17:20.7076705Z [36m@@ -659,8 +659,8 @@[m [mend[m
2026-02-09T19:17:20.7077245Z          # Uniform Bx, zero By → ∇·B = 0[m
2026-02-09T19:17:20.7077757Z          ct.Bx_face .= 1.0[m
2026-02-09T19:17:20.7078213Z          ct.By_face .= 0.0[m
2026-02-09T19:17:20.7079046Z [31m-        @test max_divB(ct, 0.1, 0.1, 10, 10) ≈ 0.0 atol = 1e-15[m
2026-02-09T19:17:20.7079855Z [31m-        @test l2_divB(ct, 0.1, 0.1, 10, 10) ≈ 0.0 atol = 1e-15[m
2026-02-09T19:17:20.7080698Z [32m+[m[32m        @test max_divB(ct, 0.1, 0.1, 10, 10) ≈ 0.0 atol = 1.0e-15[m
2026-02-09T19:17:20.7081583Z [32m+[m[32m        @test l2_divB(ct, 0.1, 0.1, 10, 10) ≈ 0.0 atol = 1.0e-15[m
2026-02-09T19:17:20.7082193Z  [m
2026-02-09T19:17:20.7082580Z          # Non-zero divergence[m
2026-02-09T19:17:20.7083084Z          ct.Bx_face[5, 5] = 2.0[m
2026-02-09T19:17:20.7157609Z [34m[141/151] Checking `test/mhd_3d.jl` .......................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.7174314Z [1mdiff --git a/mhd_3d.jl b/mhd_3d.jl[m
2026-02-09T19:17:20.7174932Z [1mindex a452e04..f163322 100644[m
2026-02-09T19:17:20.7175268Z [1m--- a/mhd_3d.jl[m
2026-02-09T19:17:20.7175538Z [1m+++ b/mhd_3d.jl[m
2026-02-09T19:17:20.7175801Z [36m@@ -82,8 +82,8 @@[m [mend[m
2026-02-09T19:17:20.7176167Z              # Alfven speed for this direction[m
2026-02-09T19:17:20.7176732Z              Bn = dir == 1 ? w[6] : (dir == 2 ? w[7] : w[8])[m
2026-02-09T19:17:20.7177374Z              ca = abs(Bn) / sqrt(w[1])[m
2026-02-09T19:17:20.7177986Z [31m-            @test cf >= ca - 1e-14[m
2026-02-09T19:17:20.7178567Z [31m-            @test ca >= cs - 1e-14[m
2026-02-09T19:17:20.7179412Z [32m+[m[32m            @test cf >= ca - 1.0e-14[m
2026-02-09T19:17:20.7180056Z [32m+[m[32m            @test ca >= cs - 1.0e-14[m
2026-02-09T19:17:20.7180588Z          end[m
2026-02-09T19:17:20.7180958Z      end[m
2026-02-09T19:17:20.7181296Z  [m
2026-02-09T19:17:20.7181680Z [36m@@ -103,10 +103,10 @@[m [mend[m
2026-02-09T19:17:20.7182254Z          cs_hydro = sqrt(gamma * 1.0 / 1.0)[m
2026-02-09T19:17:20.7182813Z          for dir in 1:3[m
2026-02-09T19:17:20.7183426Z              cf = fast_magnetosonic_speed(law, w_hydro, dir)[m
2026-02-09T19:17:20.7184214Z [31m-            @test cf ≈ cs_hydro atol = 1e-14[m
2026-02-09T19:17:20.7184953Z [32m+[m[32m            @test cf ≈ cs_hydro atol = 1.0e-14[m
2026-02-09T19:17:20.7185517Z  [m
2026-02-09T19:17:20.7186031Z              cs = slow_magnetosonic_speed(law, w_hydro, dir)[m
2026-02-09T19:17:20.7186752Z [31m-            @test cs ≈ 0.0 atol = 1e-14[m
2026-02-09T19:17:20.7187426Z [32m+[m[32m            @test cs ≈ 0.0 atol = 1.0e-14[m
2026-02-09T19:17:20.7187988Z          end[m
2026-02-09T19:17:20.7188356Z      end[m
2026-02-09T19:17:20.7188700Z  end[m
2026-02-09T19:17:20.7189285Z [36m@@ -136,7 +136,7 @@[m [mend[m
2026-02-09T19:17:20.7189983Z      coords, U_final, t_final, ct = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.7190676Z      W = to_primitive(law, U_final)[m
2026-02-09T19:17:20.7191134Z  [m
2026-02-09T19:17:20.7191549Z [31m-    @test t_final ≈ 0.05 atol = 1e-10[m
2026-02-09T19:17:20.7192183Z [32m+[m[32m    @test t_final ≈ 0.05 atol = 1.0e-10[m
2026-02-09T19:17:20.7192868Z      @test size(U_final) == (nx, ny, nz)[m
2026-02-09T19:17:20.7193327Z  [m
2026-02-09T19:17:20.7193759Z      # Extract density along x at iy=1, iz=1[m
2026-02-09T19:17:20.7194319Z [36m@@ -153,7 +153,7 @@[m [mend[m
2026-02-09T19:17:20.7194745Z  [m
2026-02-09T19:17:20.7195517Z      # Solution should be approximately uniform in y and z[m
2026-02-09T19:17:20.7196229Z      for ix in 1:nx, iy in 1:ny, iz in 1:nz[m
2026-02-09T19:17:20.7197093Z [31m-        @test W[ix, iy, iz][1] ≈ W[ix, 1, 1][1] atol = 1e-8[m
2026-02-09T19:17:20.7197931Z [32m+[m[32m        @test W[ix, iy, iz][1] ≈ W[ix, 1, 1][1] atol = 1.0e-8[m
2026-02-09T19:17:20.7198541Z      end[m
2026-02-09T19:17:20.7199043Z  [m
2026-02-09T19:17:20.7199500Z      # Bx should remain approximately constant[m
2026-02-09T19:17:20.7200085Z [36m@@ -188,7 +188,7 @@[m [mend[m
2026-02-09T19:17:20.7200741Z      coords, U_final, t_final, ct = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.7201403Z      W = to_primitive(law, U_final)[m
2026-02-09T19:17:20.7201859Z  [m
2026-02-09T19:17:20.7202271Z [31m-    @test t_final ≈ 0.05 atol = 1e-10[m
2026-02-09T19:17:20.7202906Z [32m+[m[32m    @test t_final ≈ 0.05 atol = 1.0e-10[m
2026-02-09T19:17:20.7203408Z  [m
2026-02-09T19:17:20.7203867Z      # Extract density along z at ix=1, iy=1[m
2026-02-09T19:17:20.7204503Z      rho_z = [W[1, 1, iz][1] for iz in 1:nz][m
2026-02-09T19:17:20.7205048Z [36m@@ -203,7 +203,7 @@[m [mend[m
2026-02-09T19:17:20.7205457Z  [m
2026-02-09T19:17:20.7205970Z      # Solution should be approximately uniform in x and y[m
2026-02-09T19:17:20.7206651Z      for ix in 1:nx, iy in 1:ny, iz in 1:nz[m
2026-02-09T19:17:20.7207304Z [31m-        @test W[ix, iy, iz][1] ≈ W[1, 1, iz][1] atol = 1e-8[m
2026-02-09T19:17:20.7208079Z [32m+[m[32m        @test W[ix, iy, iz][1] ≈ W[1, 1, iz][1] atol = 1.0e-8[m
2026-02-09T19:17:20.7208667Z      end[m
2026-02-09T19:17:20.7209148Z  end[m
2026-02-09T19:17:20.7209437Z  [m
2026-02-09T19:17:20.7209784Z [36m@@ -227,7 +227,7 @@[m [mend[m
2026-02-09T19:17:20.7210526Z          initialize_ct_3d_from_potential!(ct, Ax_func, Ay_func, Az_func, mesh)[m
2026-02-09T19:17:20.7211210Z  [m
2026-02-09T19:17:20.7211761Z          divB = max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz)[m
2026-02-09T19:17:20.7212433Z [31m-        @test divB < 1e-14[m
2026-02-09T19:17:20.7212962Z [32m+[m[32m        @test divB < 1.0e-14[m
2026-02-09T19:17:20.7213456Z      end[m
2026-02-09T19:17:20.7213773Z  [m
2026-02-09T19:17:20.7214267Z      @testset "DivB preserved after evolution" begin[m
2026-02-09T19:17:20.7214889Z [36m@@ -267,8 +267,8 @@[m [mend[m
2026-02-09T19:17:20.7215327Z          )[m
2026-02-09T19:17:20.7215652Z  [m
2026-02-09T19:17:20.7216215Z          divB = max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz)[m
2026-02-09T19:17:20.7216899Z [31m-        @test divB < 1e-14[m
2026-02-09T19:17:20.7217461Z [31m-        @test t_final ≈ 0.02 atol = 1e-10[m
2026-02-09T19:17:20.7218056Z [32m+[m[32m        @test divB < 1.0e-14[m
2026-02-09T19:17:20.7218698Z [32m+[m[32m        @test t_final ≈ 0.02 atol = 1.0e-10[m
2026-02-09T19:17:20.7219411Z      end[m
2026-02-09T19:17:20.7219731Z  [m
2026-02-09T19:17:20.7220153Z      @testset "Uniform field: divB = 0" begin[m
2026-02-09T19:17:20.7220721Z [36m@@ -286,7 +286,7 @@[m [mend[m
2026-02-09T19:17:20.7221167Z  [m
2026-02-09T19:17:20.7221695Z          coords, U_final, t_final, ct = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.7222561Z          divB = max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz)[m
2026-02-09T19:17:20.7223242Z [31m-        @test divB < 1e-12[m
2026-02-09T19:17:20.7223772Z [32m+[m[32m        @test divB < 1.0e-12[m
2026-02-09T19:17:20.7224245Z      end[m
2026-02-09T19:17:20.7224560Z  [m
2026-02-09T19:17:20.7224980Z      @testset "Euler method: divB = 0" begin[m
2026-02-09T19:17:20.7225541Z [36m@@ -304,7 +304,7 @@[m [mend[m
2026-02-09T19:17:20.7225960Z  [m
2026-02-09T19:17:20.7226463Z          _, _, _, ct = solve_hyperbolic(prob; method = :euler)[m
2026-02-09T19:17:20.7227299Z          divB = max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz)[m
2026-02-09T19:17:20.7227981Z [31m-        @test divB < 1e-12[m
2026-02-09T19:17:20.7228512Z [32m+[m[32m        @test divB < 1.0e-12[m
2026-02-09T19:17:20.7229147Z      end[m
2026-02-09T19:17:20.7229702Z  end[m
2026-02-09T19:17:20.7230017Z  [m
2026-02-09T19:17:20.7230384Z [36m@@ -323,7 +323,7 @@[m [mend[m
2026-02-09T19:17:20.7230861Z      rho_bg = 1.0[m
2026-02-09T19:17:20.7231408Z      P_bg = 1.0[m
2026-02-09T19:17:20.7231803Z      R0 = 0.3[m
2026-02-09T19:17:20.7232179Z [31m-    A0 = 1e-3[m
2026-02-09T19:17:20.7232604Z [32m+[m[32m    A0 = 1.0e-3[m
2026-02-09T19:17:20.7233007Z  [m
2026-02-09T19:17:20.7233406Z      function loop_ic_3d(x, y, z)[m
2026-02-09T19:17:20.7234119Z          # B will be overwritten by CT, just set hydrodynamic part[m
2026-02-09T19:17:20.7234806Z [36m@@ -360,8 +360,8 @@[m [mend[m
2026-02-09T19:17:20.7235247Z          )[m
2026-02-09T19:17:20.7235559Z  [m
2026-02-09T19:17:20.7236124Z          divB = max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz)[m
2026-02-09T19:17:20.7236813Z [31m-        @test divB < 1e-14[m
2026-02-09T19:17:20.7237382Z [31m-        @test t_final ≈ 0.02 atol = 1e-10[m
2026-02-09T19:17:20.7237978Z [32m+[m[32m        @test divB < 1.0e-14[m
2026-02-09T19:17:20.7238631Z [32m+[m[32m        @test t_final ≈ 0.02 atol = 1.0e-10[m
2026-02-09T19:17:20.7239335Z      end[m
2026-02-09T19:17:20.7239660Z  [m
2026-02-09T19:17:20.7240333Z      @testset "Density and pressure remain positive and nearly uniform" begin[m
2026-02-09T19:17:20.7241120Z [36m@@ -437,7 +437,7 @@[m [mend[m
2026-02-09T19:17:20.7241563Z      )[m
2026-02-09T19:17:20.7242052Z      _, U_final, t_final, ct = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.7242592Z  [m
2026-02-09T19:17:20.7243004Z [31m-    @test t_final ≈ 0.02 atol = 1e-10[m
2026-02-09T19:17:20.7243641Z [32m+[m[32m    @test t_final ≈ 0.02 atol = 1.0e-10[m
2026-02-09T19:17:20.7244151Z  [m
2026-02-09T19:17:20.7244537Z      # Compute conserved totals[m
2026-02-09T19:17:20.7245072Z      mass_0 = sum(u[1] for u in U0) * dV[m
2026-02-09T19:17:20.7245607Z [36m@@ -451,15 +451,15 @@[m [mend[m
2026-02-09T19:17:20.7246147Z      energy_0 = sum(u[5] for u in U0) * dV[m
2026-02-09T19:17:20.7246780Z      energy_f = sum(u[5] for u in U_final) * dV[m
2026-02-09T19:17:20.7247290Z  [m
2026-02-09T19:17:20.7247706Z [31m-    @test mass_f ≈ mass_0 atol = 1e-10[m
2026-02-09T19:17:20.7248322Z [31m-    @test momx_f ≈ momx_0 atol = 1e-10[m
2026-02-09T19:17:20.7249077Z [31m-    @test momy_f ≈ momy_0 atol = 1e-10[m
2026-02-09T19:17:20.7249690Z [31m-    @test momz_f ≈ momz_0 atol = 1e-10[m
2026-02-09T19:17:20.7250308Z [31m-    @test energy_f ≈ energy_0 atol = 1e-8[m
2026-02-09T19:17:20.7250986Z [32m+[m[32m    @test mass_f ≈ mass_0 atol = 1.0e-10[m
2026-02-09T19:17:20.7251661Z [32m+[m[32m    @test momx_f ≈ momx_0 atol = 1.0e-10[m
2026-02-09T19:17:20.7252338Z [32m+[m[32m    @test momy_f ≈ momy_0 atol = 1.0e-10[m
2026-02-09T19:17:20.7253008Z [32m+[m[32m    @test momz_f ≈ momz_0 atol = 1.0e-10[m
2026-02-09T19:17:20.7253698Z [32m+[m[32m    @test energy_f ≈ energy_0 atol = 1.0e-8[m
2026-02-09T19:17:20.7254237Z  [m
2026-02-09T19:17:20.7254634Z      # divB should also be preserved[m
2026-02-09T19:17:20.7255052Z      divB = max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz)[m
2026-02-09T19:17:20.7255253Z [31m-    @test divB < 1e-12[m
2026-02-09T19:17:20.7255492Z [32m+[m[32m    @test divB < 1.0e-12[m
2026-02-09T19:17:20.7255637Z  end[m
2026-02-09T19:17:20.7255778Z  [m
2026-02-09T19:17:20.7256050Z  # ============================================================[m
2026-02-09T19:17:20.7256255Z [36m@@ -503,7 +503,7 @@[m [mend[m
2026-02-09T19:17:20.7256457Z          ct.Bx_face .= 1.0[m
2026-02-09T19:17:20.7256647Z          ct.By_face .= 0.0[m
2026-02-09T19:17:20.7256834Z          ct.Bz_face .= 0.0[m
2026-02-09T19:17:20.7257259Z [31m-        @test max_divB_3d(ct, dx, dy, dz, nx, ny, nz) ≈ 0.0 atol = 1e-15[m
2026-02-09T19:17:20.7257745Z [32m+[m[32m        @test max_divB_3d(ct, dx, dy, dz, nx, ny, nz) ≈ 0.0 atol = 1.0e-15[m
2026-02-09T19:17:20.7257881Z  [m
2026-02-09T19:17:20.7258126Z          # Introduce non-zero divergence[m
2026-02-09T19:17:20.7258554Z          ct.Bx_face[5, 5, 5] = 2.0[m
2026-02-09T19:17:20.7258945Z [36m@@ -547,7 +547,7 @@[m [mend[m
2026-02-09T19:17:20.7259183Z              @test all(w -> w[1] > 0, W)[m
2026-02-09T19:17:20.7259584Z              @test all(w -> w[5] > 0, W)[m
2026-02-09T19:17:20.7259869Z              @test all(w -> all(isfinite, w), W)[m
2026-02-09T19:17:20.7260350Z [31m-            @test max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz) < 1e-12[m
2026-02-09T19:17:20.7260878Z [32m+[m[32m            @test max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz) < 1.0e-12[m
2026-02-09T19:17:20.7261042Z          end[m
2026-02-09T19:17:20.7261189Z      end[m
2026-02-09T19:17:20.7261328Z  end[m
2026-02-09T19:17:20.7261534Z [36m@@ -576,7 +576,7 @@[m [mend[m
2026-02-09T19:17:20.7261838Z      u_ref = primitive_to_conserved(law, w_const)[m
2026-02-09T19:17:20.7261974Z  [m
2026-02-09T19:17:20.7262229Z      for iz in 1:nz, iy in 1:ny, ix in 1:nx[m
2026-02-09T19:17:20.7262576Z [31m-        @test U_final[ix, iy, iz] ≈ u_ref atol = 1e-12[m
2026-02-09T19:17:20.7262956Z [32m+[m[32m        @test U_final[ix, iy, iz] ≈ u_ref atol = 1.0e-12[m
2026-02-09T19:17:20.7263103Z      end[m
2026-02-09T19:17:20.7263566Z [31m-    @test max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz) < 1e-13[m
2026-02-09T19:17:20.7264061Z [32m+[m[32m    @test max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz) < 1.0e-13[m
2026-02-09T19:17:20.7264205Z  end[m
2026-02-09T19:17:20.7382390Z [34m[142/151] Checking `test/navier_stokes.jl` ................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.7398560Z [1mdiff --git a/navier_stokes.jl b/navier_stokes.jl[m
2026-02-09T19:17:20.7398976Z [1mindex 70d87d6..323b08f 100644[m
2026-02-09T19:17:20.7399177Z [1m--- a/navier_stokes.jl[m
2026-02-09T19:17:20.7399361Z [1m+++ b/navier_stokes.jl[m
2026-02-09T19:17:20.7399552Z [36m@@ -64,11 +64,11 @@[m [mend[m
2026-02-09T19:17:20.7399885Z          for (ρ, P) in [(1000.0, 1.0e9), (800.0, 5.0e8), (1200.0, 2.0e9)][m
2026-02-09T19:17:20.7400066Z              ε = internal_energy(eos, ρ, P)[m
2026-02-09T19:17:20.7400213Z              P_back = pressure(eos, ρ, ε)[m
2026-02-09T19:17:20.7400396Z [31m-            @test P_back ≈ P rtol = 1e-12[m
2026-02-09T19:17:20.7400584Z [32m+[m[32m            @test P_back ≈ P rtol = 1.0e-12[m
2026-02-09T19:17:20.7400661Z  [m
2026-02-09T19:17:20.7400918Z              c = sound_speed(eos, ρ, P)[m
2026-02-09T19:17:20.7401123Z              @test c > 0[m
2026-02-09T19:17:20.7401545Z [31m-            @test c^2 ≈ eos.gamma * (P + eos.P_inf) / ρ rtol = 1e-12[m
2026-02-09T19:17:20.7402015Z [32m+[m[32m            @test c^2 ≈ eos.gamma * (P + eos.P_inf) / ρ rtol = 1.0e-12[m
2026-02-09T19:17:20.7402193Z          end[m
2026-02-09T19:17:20.7402345Z      end[m
2026-02-09T19:17:20.7402481Z  [m
2026-02-09T19:17:20.7402691Z [36m@@ -79,11 +79,11 @@[m [mend[m
2026-02-09T19:17:20.7402837Z  [m
2026-02-09T19:17:20.7403007Z          ρ = 1.0[m
2026-02-09T19:17:20.7403173Z          P = 1.0[m
2026-02-09T19:17:20.7403780Z [31m-        @test pressure(eos_stiff, ρ, internal_energy(eos_ideal, ρ, P)) ≈ P rtol = 1e-12[m
2026-02-09T19:17:20.7404360Z [31m-        @test sound_speed(eos_stiff, ρ, P) ≈ sound_speed(eos_ideal, ρ, P) rtol = 1e-12[m
2026-02-09T19:17:20.7404999Z [31m-        @test internal_energy(eos_stiff, ρ, P) ≈ internal_energy(eos_ideal, ρ, P) rtol = 1e-12[m
2026-02-09T19:17:20.7405746Z [31m-        @test total_energy(eos_stiff, ρ, 0.5, P) ≈ total_energy(eos_ideal, ρ, 0.5, P) rtol = 1e-12[m
2026-02-09T19:17:20.7406443Z [31m-        @test total_energy(eos_stiff, ρ, 0.5, 0.3, P) ≈ total_energy(eos_ideal, ρ, 0.5, 0.3, P) rtol = 1e-12[m
2026-02-09T19:17:20.7407066Z [32m+[m[32m        @test pressure(eos_stiff, ρ, internal_energy(eos_ideal, ρ, P)) ≈ P rtol = 1.0e-12[m
2026-02-09T19:17:20.7407670Z [32m+[m[32m        @test sound_speed(eos_stiff, ρ, P) ≈ sound_speed(eos_ideal, ρ, P) rtol = 1.0e-12[m
2026-02-09T19:17:20.7408323Z [32m+[m[32m        @test internal_energy(eos_stiff, ρ, P) ≈ internal_energy(eos_ideal, ρ, P) rtol = 1.0e-12[m
2026-02-09T19:17:20.7409434Z [32m+[m[32m        @test total_energy(eos_stiff, ρ, 0.5, P) ≈ total_energy(eos_ideal, ρ, 0.5, P) rtol = 1.0e-12[m
2026-02-09T19:17:20.7410352Z [32m+[m[32m        @test total_energy(eos_stiff, ρ, 0.5, 0.3, P) ≈ total_energy(eos_ideal, ρ, 0.5, 0.3, P) rtol = 1.0e-12[m
2026-02-09T19:17:20.7410519Z      end[m
2026-02-09T19:17:20.7410656Z  [m
2026-02-09T19:17:20.7410925Z      @testset "Total energy formulas" begin[m
2026-02-09T19:17:20.7411146Z [36m@@ -95,12 +95,12 @@[m [mend[m
2026-02-09T19:17:20.7411310Z          v = 10.0[m
2026-02-09T19:17:20.7411562Z          E_1d = total_energy(eos, ρ, v, P)[m
2026-02-09T19:17:20.7411807Z          ε = internal_energy(eos, ρ, P)[m
2026-02-09T19:17:20.7412112Z [31m-        @test E_1d ≈ ρ * ε + 0.5 * ρ * v^2 rtol = 1e-12[m
2026-02-09T19:17:20.7412448Z [32m+[m[32m        @test E_1d ≈ ρ * ε + 0.5 * ρ * v^2 rtol = 1.0e-12[m
2026-02-09T19:17:20.7412573Z  [m
2026-02-09T19:17:20.7412752Z          # 2D[m
2026-02-09T19:17:20.7412931Z          vx, vy = 10.0, 5.0[m
2026-02-09T19:17:20.7413191Z          E_2d = total_energy(eos, ρ, vx, vy, P)[m
2026-02-09T19:17:20.7413550Z [31m-        @test E_2d ≈ ρ * ε + 0.5 * ρ * (vx^2 + vy^2) rtol = 1e-12[m
2026-02-09T19:17:20.7413948Z [32m+[m[32m        @test E_2d ≈ ρ * ε + 0.5 * ρ * (vx^2 + vy^2) rtol = 1.0e-12[m
2026-02-09T19:17:20.7414099Z      end[m
2026-02-09T19:17:20.7414247Z  [m
2026-02-09T19:17:20.7414689Z      @testset "Euler solver with StiffenedGasEOS (shock tube)" begin[m
2026-02-09T19:17:20.7414896Z [36m@@ -179,7 +179,7 @@[m [mend[m
2026-02-09T19:17:20.7415145Z          eos = IdealGasEOS(gamma = 1.4)[m
2026-02-09T19:17:20.7415527Z          ns = NavierStokesEquations{1}(eos, mu = 0.01, Pr = 0.72)[m
2026-02-09T19:17:20.7415773Z          κ = thermal_conductivity(ns)[m
2026-02-09T19:17:20.7416103Z [31m-        @test κ ≈ 0.01 * 1.4 / (0.72 * 0.4) rtol = 1e-12[m
2026-02-09T19:17:20.7416458Z [32m+[m[32m        @test κ ≈ 0.01 * 1.4 / (0.72 * 0.4) rtol = 1.0e-12[m
2026-02-09T19:17:20.7416625Z      end[m
2026-02-09T19:17:20.7416757Z  [m
2026-02-09T19:17:20.7417001Z      @testset "HLLC forwarding" begin[m
2026-02-09T19:17:20.7417212Z [36m@@ -216,7 +216,7 @@[m [mend[m
2026-02-09T19:17:20.7417473Z          # Uniform state → zero viscous flux[m
2026-02-09T19:17:20.7417728Z          w_uniform = SVector(1.0, 1.0, 1.0)[m
2026-02-09T19:17:20.7418075Z          Fv = viscous_flux_1d(ns, w_uniform, w_uniform, 0.1)[m
2026-02-09T19:17:20.7418400Z [31m-        @test Fv ≈ SVector(0.0, 0.0, 0.0) atol = 1e-15[m
2026-02-09T19:17:20.7418994Z [32m+[m[32m        @test Fv ≈ SVector(0.0, 0.0, 0.0) atol = 1.0e-15[m
2026-02-09T19:17:20.7419155Z  [m
2026-02-09T19:17:20.7419387Z          # Linear velocity gradient[m
2026-02-09T19:17:20.7419599Z          wL = SVector(1.0, 0.0, 1.0)[m
2026-02-09T19:17:20.7419806Z [36m@@ -226,7 +226,7 @@[m [mend[m
2026-02-09T19:17:20.7420108Z          # τ_xx = (4/3) * μ * dv/dx = (4/3) * 0.01 * (1-0)/0.1[m
2026-02-09T19:17:20.7420389Z          τ_xx_expected = (4.0 / 3.0) * 0.01 * 10.0[m
2026-02-09T19:17:20.7420592Z          @test Fv[1] == 0.0[m
2026-02-09T19:17:20.7420913Z [31m-        @test Fv[2] ≈ τ_xx_expected rtol = 1e-12[m
2026-02-09T19:17:20.7421263Z [32m+[m[32m        @test Fv[2] ≈ τ_xx_expected rtol = 1.0e-12[m
2026-02-09T19:17:20.7421411Z      end[m
2026-02-09T19:17:20.7421554Z  [m
2026-02-09T19:17:20.7421857Z      @testset "2D viscous flux x-direction" begin[m
2026-02-09T19:17:20.7422057Z [36m@@ -236,7 +236,7 @@[m [mend[m
2026-02-09T19:17:20.7422261Z          # Uniform state[m
2026-02-09T19:17:20.7422534Z          w_uniform = SVector(1.0, 1.0, 0.5, 1.0)[m
2026-02-09T19:17:20.7422940Z          Fv = viscous_flux_x_2d(ns, w_uniform, w_uniform, 0.0, 0.0, 0.1)[m
2026-02-09T19:17:20.7423292Z [31m-        @test Fv ≈ SVector(0.0, 0.0, 0.0, 0.0) atol = 1e-15[m
2026-02-09T19:17:20.7423705Z [32m+[m[32m        @test Fv ≈ SVector(0.0, 0.0, 0.0, 0.0) atol = 1.0e-15[m
2026-02-09T19:17:20.7424086Z      end[m
2026-02-09T19:17:20.7424219Z  [m
2026-02-09T19:17:20.7424536Z      @testset "2D viscous flux y-direction" begin[m
2026-02-09T19:17:20.7424744Z [36m@@ -246,7 +246,7 @@[m [mend[m
2026-02-09T19:17:20.7425106Z          # Uniform state[m
2026-02-09T19:17:20.7425385Z          w_uniform = SVector(1.0, 1.0, 0.5, 1.0)[m
2026-02-09T19:17:20.7425803Z          Fv = viscous_flux_y_2d(ns, w_uniform, w_uniform, 0.0, 0.0, 0.1)[m
2026-02-09T19:17:20.7426153Z [31m-        @test Fv ≈ SVector(0.0, 0.0, 0.0, 0.0) atol = 1e-15[m
2026-02-09T19:17:20.7426537Z [32m+[m[32m        @test Fv ≈ SVector(0.0, 0.0, 0.0, 0.0) atol = 1.0e-15[m
2026-02-09T19:17:20.7426696Z      end[m
2026-02-09T19:17:20.7426838Z  end[m
2026-02-09T19:17:20.7426969Z  [m
2026-02-09T19:17:20.7427178Z [36m@@ -282,7 +282,7 @@[m [mend[m
2026-02-09T19:17:20.7427311Z  [m
2026-02-09T19:17:20.7427501Z          @test t_e ≈ t_ns[m
2026-02-09T19:17:20.7427719Z          for i in eachindex(U_e)[m
2026-02-09T19:17:20.7428024Z [31m-            @test U_e[i] ≈ U_ns[i] rtol = 1e-12[m
2026-02-09T19:17:20.7428351Z [32m+[m[32m            @test U_e[i] ≈ U_ns[i] rtol = 1.0e-12[m
2026-02-09T19:17:20.7428506Z          end[m
2026-02-09T19:17:20.7428677Z      end[m
2026-02-09T19:17:20.7429016Z  end[m
2026-02-09T19:17:20.7429223Z [36m@@ -544,8 +544,8 @@[m [mend[m
2026-02-09T19:17:20.7429467Z          mass_f = sum(u[1] for u in U) * dx[m
2026-02-09T19:17:20.7429714Z          mom_f = sum(u[2] for u in U) * dx[m
2026-02-09T19:17:20.7429848Z  [m
2026-02-09T19:17:20.7430120Z [31m-        @test mass_f ≈ mass_0 rtol = 1e-10[m
2026-02-09T19:17:20.7430564Z [31m-        @test abs(mom_f - mom_0) < 1e-12  # momentum near zero, use atol[m
2026-02-09T19:17:20.7430878Z [32m+[m[32m        @test mass_f ≈ mass_0 rtol = 1.0e-10[m
2026-02-09T19:17:20.7431359Z [32m+[m[32m        @test abs(mom_f - mom_0) < 1.0e-12  # momentum near zero, use atol[m
2026-02-09T19:17:20.7431509Z      end[m
2026-02-09T19:17:20.7431651Z  [m
2026-02-09T19:17:20.7431925Z      @testset "2D mass conservation" begin[m
2026-02-09T19:17:20.7432125Z [36m@@ -590,7 +590,7 @@[m [mend[m
2026-02-09T19:17:20.7432307Z          # Final mass[m
2026-02-09T19:17:20.7432698Z          mass_f = sum(U[ix, iy][1] for iy in 1:N, ix in 1:N) * dx * dy[m
2026-02-09T19:17:20.7432831Z  [m
2026-02-09T19:17:20.7433094Z [31m-        @test mass_f ≈ mass_0 rtol = 1e-10[m
2026-02-09T19:17:20.7433410Z [32m+[m[32m        @test mass_f ≈ mass_0 rtol = 1.0e-10[m
2026-02-09T19:17:20.7433556Z      end[m
2026-02-09T19:17:20.7433699Z  end[m
2026-02-09T19:17:20.7433840Z  [m
2026-02-09T19:17:20.7472887Z [34m[143/151] Checking `test/physics.jl` ......................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.7487233Z [1mdiff --git a/physics.jl b/physics.jl[m
2026-02-09T19:17:20.7487499Z [1mindex b4a0010..817cb7d 100644[m
2026-02-09T19:17:20.7487679Z [1m--- a/physics.jl[m
2026-02-09T19:17:20.7487852Z [1m+++ b/physics.jl[m
2026-02-09T19:17:20.7488069Z [36m@@ -7,7 +7,7 @@[m [musing Test[m
2026-02-09T19:17:20.7488352Z      @testset "Anisotropic Diffusion" begin[m
2026-02-09T19:17:20.7488929Z          @testset "AnisotropicDiffusionEquation construction" begin[m
2026-02-09T19:17:20.7489140Z              # Create mesh[m
2026-02-09T19:17:20.7489628Z [31m-            tri = triangulate_rectangle(0, 1, 0, 1, 10, 10, single_boundary=true)[m
2026-02-09T19:17:20.7490130Z [32m+[m[32m            tri = triangulate_rectangle(0, 1, 0, 1, 10, 10, single_boundary = true)[m
2026-02-09T19:17:20.7490276Z              mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.7490351Z  [m
2026-02-09T19:17:20.7490518Z              # Dirichlet boundary conditions[m
2026-02-09T19:17:20.7490654Z [36m@@ -18,7 +18,7 @@[m [musing Test[m
2026-02-09T19:17:20.7490886Z              diffusion_tensor = (x, y, p) -> (1.0, 0.0, 1.0)  # D = I[m
2026-02-09T19:17:20.7490961Z  [m
2026-02-09T19:17:20.7491087Z              # Initial condition[m
2026-02-09T19:17:20.7491466Z [31m-            u0 = [exp(-((x-0.5)^2 + (y-0.5)^2)/0.01) for (x, y) in DelaunayTriangulation.each_point(tri)][m
2026-02-09T19:17:20.7492150Z [32m+[m[32m            u0 = [exp(-((x - 0.5)^2 + (y - 0.5)^2) / 0.01) for (x, y) in DelaunayTriangulation.each_point(tri)][m
2026-02-09T19:17:20.7492227Z  [m
2026-02-09T19:17:20.7492429Z              prob = AnisotropicDiffusionEquation([m
2026-02-09T19:17:20.7492537Z                  mesh, BCs;[m
2026-02-09T19:17:20.7492670Z [36m@@ -37,22 +37,22 @@[m [musing Test[m
2026-02-09T19:17:20.7492860Z              D_func = make_rotation_tensor(0.0, 2.0, 0.5)[m
2026-02-09T19:17:20.7493038Z              Dxx, Dxy, Dyy = D_func(0.0, 0.0, nothing)[m
2026-02-09T19:17:20.7493156Z              @test Dxx ≈ 2.0[m
2026-02-09T19:17:20.7493306Z [31m-            @test Dxy ≈ 0.0 atol=1e-10[m
2026-02-09T19:17:20.7493489Z [32m+[m[32m            @test Dxy ≈ 0.0 atol = 1.0e-10[m
2026-02-09T19:17:20.7493601Z              @test Dyy ≈ 0.5[m
2026-02-09T19:17:20.7493674Z  [m
2026-02-09T19:17:20.7493904Z              # 90 degree rotation - should swap coefficients[m
2026-02-09T19:17:20.7494120Z [31m-            D_func_90 = make_rotation_tensor(π/2, 2.0, 0.5)[m
2026-02-09T19:17:20.7494358Z [32m+[m[32m            D_func_90 = make_rotation_tensor(π / 2, 2.0, 0.5)[m
2026-02-09T19:17:20.7494536Z              Dxx, Dxy, Dyy = D_func_90(0.0, 0.0, nothing)[m
2026-02-09T19:17:20.7494684Z [31m-            @test Dxx ≈ 0.5 atol=1e-10[m
2026-02-09T19:17:20.7494823Z [31m-            @test Dxy ≈ 0.0 atol=1e-10[m
2026-02-09T19:17:20.7494957Z [31m-            @test Dyy ≈ 2.0 atol=1e-10[m
2026-02-09T19:17:20.7495133Z [32m+[m[32m            @test Dxx ≈ 0.5 atol = 1.0e-10[m
2026-02-09T19:17:20.7495293Z [32m+[m[32m            @test Dxy ≈ 0.0 atol = 1.0e-10[m
2026-02-09T19:17:20.7495453Z [32m+[m[32m            @test Dyy ≈ 2.0 atol = 1.0e-10[m
2026-02-09T19:17:20.7495526Z  [m
2026-02-09T19:17:20.7495738Z              # 45 degree rotation - should give mixed terms[m
2026-02-09T19:17:20.7495943Z [31m-            D_func_45 = make_rotation_tensor(π/4, 2.0, 0.5)[m
2026-02-09T19:17:20.7496179Z [32m+[m[32m            D_func_45 = make_rotation_tensor(π / 4, 2.0, 0.5)[m
2026-02-09T19:17:20.7496365Z              Dxx, Dxy, Dyy = D_func_45(0.0, 0.0, nothing)[m
2026-02-09T19:17:20.7496525Z              # Average of 2 and 0.5 for diagonal[m
2026-02-09T19:17:20.7496669Z [31m-            @test Dxx ≈ 1.25 atol=1e-10[m
2026-02-09T19:17:20.7496810Z [31m-            @test Dyy ≈ 1.25 atol=1e-10[m
2026-02-09T19:17:20.7496978Z [32m+[m[32m            @test Dxx ≈ 1.25 atol = 1.0e-10[m
2026-02-09T19:17:20.7497140Z [32m+[m[32m            @test Dyy ≈ 1.25 atol = 1.0e-10[m
2026-02-09T19:17:20.7497302Z              # Off-diagonal should be non-zero[m
2026-02-09T19:17:20.7497427Z              @test abs(Dxy) > 0.5[m
2026-02-09T19:17:20.7497511Z          end[m
2026-02-09T19:17:20.7497638Z [36m@@ -83,7 +83,7 @@[m [musing Test[m
2026-02-09T19:17:20.7497780Z              @test model.kappa ≈ 0.41[m
2026-02-09T19:17:20.7497863Z  [m
2026-02-09T19:17:20.7497973Z              # Custom model[m
2026-02-09T19:17:20.7498247Z [31m-            model_custom = StandardKEpsilon(C_mu=0.1, C1_epsilon=1.5)[m
2026-02-09T19:17:20.7498564Z [32m+[m[32m            model_custom = StandardKEpsilon(C_mu = 0.1, C1_epsilon = 1.5)[m
2026-02-09T19:17:20.7498917Z              @test model_custom.C_mu ≈ 0.1[m
2026-02-09T19:17:20.7499109Z              @test model_custom.C1_epsilon ≈ 1.5[m
2026-02-09T19:17:20.7499201Z          end[m
2026-02-09T19:17:20.7499333Z [36m@@ -99,7 +99,7 @@[m [musing Test[m
2026-02-09T19:17:20.7499405Z  [m
2026-02-09T19:17:20.7499516Z              # With density[m
2026-02-09T19:17:20.7499623Z              rho = 1000.0[m
2026-02-09T19:17:20.7499919Z [31m-            mu_t = compute_turbulent_viscosity(model, k, epsilon; rho=rho)[m
2026-02-09T19:17:20.7500230Z [32m+[m[32m            mu_t = compute_turbulent_viscosity(model, k, epsilon; rho = rho)[m
2026-02-09T19:17:20.7500386Z              @test mu_t ≈ rho * 0.09 * 1.0^2 / 0.1[m
2026-02-09T19:17:20.7500596Z  [m
2026-02-09T19:17:20.7500711Z              # Vector inputs[m
2026-02-09T19:17:20.7500856Z [36m@@ -148,12 +148,12 @@[m [musing Test[m
2026-02-09T19:17:20.7501037Z  [m
2026-02-09T19:17:20.7501235Z          @testset "compute_friction_velocity" begin[m
2026-02-09T19:17:20.7501413Z              # Viscous sublayer (low u_tan, small y)[m
2026-02-09T19:17:20.7501647Z [31m-            u_tau = compute_friction_velocity(0.1, 0.001, 1e-6)[m
2026-02-09T19:17:20.7501895Z [32m+[m[32m            u_tau = compute_friction_velocity(0.1, 0.001, 1.0e-6)[m
2026-02-09T19:17:20.7502025Z              @test isfinite(u_tau)[m
2026-02-09T19:17:20.7502141Z              @test u_tau > 0[m
2026-02-09T19:17:20.7502217Z  [m
2026-02-09T19:17:20.7502390Z              # Log layer (higher Reynolds number)[m
2026-02-09T19:17:20.7502629Z [31m-            u_tau_log = compute_friction_velocity(10.0, 0.01, 1e-6)[m
2026-02-09T19:17:20.7502896Z [32m+[m[32m            u_tau_log = compute_friction_velocity(10.0, 0.01, 1.0e-6)[m
2026-02-09T19:17:20.7503039Z              @test isfinite(u_tau_log)[m
2026-02-09T19:17:20.7503160Z              @test u_tau_log > 0[m
2026-02-09T19:17:20.7503403Z              @test u_tau_log < 10.0  # Must be less than bulk velocity[m
2026-02-09T19:17:20.7503534Z [36m@@ -171,7 +171,7 @@[m [musing Test[m
2026-02-09T19:17:20.7503644Z              @test eps_w > 0[m
2026-02-09T19:17:20.7503721Z  [m
2026-02-09T19:17:20.7503909Z              # Epsilon should increase as y decreases[m
2026-02-09T19:17:20.7504123Z [31m-            eps_w_closer = epsilon_wall_value(u_tau, y/2)[m
2026-02-09T19:17:20.7504359Z [32m+[m[32m            eps_w_closer = epsilon_wall_value(u_tau, y / 2)[m
2026-02-09T19:17:20.7504503Z              @test eps_w_closer > eps_w[m
2026-02-09T19:17:20.7504588Z          end[m
2026-02-09T19:17:20.7504660Z  [m
2026-02-09T19:17:20.7504793Z [36m@@ -181,7 +181,7 @@[m [musing Test[m
2026-02-09T19:17:20.7504913Z              @test bc.C_mu ≈ 0.09[m
2026-02-09T19:17:20.7505044Z              @test bc.kappa ≈ 0.41[m
2026-02-09T19:17:20.7505117Z  [m
2026-02-09T19:17:20.7505336Z [31m-            bc_rough = TurbulentWallBC(roughness=0.001)[m
2026-02-09T19:17:20.7505576Z [32m+[m[32m            bc_rough = TurbulentWallBC(roughness = 0.001)[m
2026-02-09T19:17:20.7505735Z              @test bc_rough.roughness ≈ 0.001[m
2026-02-09T19:17:20.7505825Z          end[m
2026-02-09T19:17:20.7505896Z  [m
2026-02-09T19:17:20.7598890Z [34m[144/151] Checking `test/problem.jl` ......................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.7623592Z [34m[145/151] Checking `test/robin.jl` ........................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.7637851Z [1mdiff --git a/robin.jl b/robin.jl[m
2026-02-09T19:17:20.7638082Z [1mindex d902655..ee4a36e 100644[m
2026-02-09T19:17:20.7638275Z [1m--- a/robin.jl[m
2026-02-09T19:17:20.7638393Z [1m+++ b/robin.jl[m
2026-02-09T19:17:20.7638543Z [36m@@ -13,21 +13,21 @@[m [musing Test[m
2026-02-09T19:17:20.7638646Z      end[m
2026-02-09T19:17:20.7638939Z  [m
2026-02-09T19:17:20.7639199Z      @testset "BoundaryConditions with Robin" begin[m
2026-02-09T19:17:20.7639519Z [31m-        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=true)[m
2026-02-09T19:17:20.7639852Z [32m+[m[32m        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = true)[m
2026-02-09T19:17:20.7639989Z          mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.7640063Z  [m
2026-02-09T19:17:20.7640262Z          # Robin BC function returns (a, b, c) tuple[m
2026-02-09T19:17:20.7640447Z          robin_fn = (x, y, t, u, p) -> (p.a, p.b, p.c)[m
2026-02-09T19:17:20.7640600Z [31m-        params = (a=1.0, b=2.0, c=3.0)[m
2026-02-09T19:17:20.7640800Z [32m+[m[32m        params = (a = 1.0, b = 2.0, c = 3.0)[m
2026-02-09T19:17:20.7640878Z  [m
2026-02-09T19:17:20.7641194Z [31m-        BCs = BoundaryConditions(mesh, robin_fn, Robin; parameters=params)[m
2026-02-09T19:17:20.7641737Z [32m+[m[32m        BCs = BoundaryConditions(mesh, robin_fn, Robin; parameters = params)[m
2026-02-09T19:17:20.7641818Z  [m
2026-02-09T19:17:20.7642114Z          @test BCs.condition_types == (Robin,)[m
2026-02-09T19:17:20.7642275Z          @test length(BCs.functions) == 1[m
2026-02-09T19:17:20.7642364Z      end[m
2026-02-09T19:17:20.7642439Z  [m
2026-02-09T19:17:20.7642684Z      @testset "Conditions with Robin edges" begin[m
2026-02-09T19:17:20.7643069Z [31m-        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=true)[m
2026-02-09T19:17:20.7643401Z [32m+[m[32m        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = true)[m
2026-02-09T19:17:20.7643533Z          mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.7643606Z  [m
2026-02-09T19:17:20.7643781Z          robin_fn = (x, y, t, u, p) -> (1.0, 2.0, 3.0)[m
2026-02-09T19:17:20.7643911Z [36m@@ -47,7 +47,7 @@[m [musing Test[m
2026-02-09T19:17:20.7643983Z  [m
2026-02-09T19:17:20.7644227Z      @testset "Mixed boundary conditions with Robin" begin[m
2026-02-09T19:17:20.7644436Z          # Create a mesh with multiple boundary segments[m
2026-02-09T19:17:20.7644730Z [31m-        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=false)[m
2026-02-09T19:17:20.7645052Z [32m+[m[32m        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = false)[m
2026-02-09T19:17:20.7645185Z          mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.7645269Z  [m
2026-02-09T19:17:20.7645462Z          # Different BC types on different segments[m
2026-02-09T19:17:20.7645597Z [36m@@ -59,9 +59,11 @@[m [musing Test[m
2026-02-09T19:17:20.7645743Z          neumann_fn = (x, y, t, u, p) -> 0.0[m
2026-02-09T19:17:20.7645944Z          robin_fn = (x, y, t, u, p) -> (1.0, 1.0, 0.0)  # (a, b, c)[m
2026-02-09T19:17:20.7646017Z  [m
2026-02-09T19:17:20.7646184Z [31m-        BCs = BoundaryConditions(mesh,[m
2026-02-09T19:17:20.7646349Z [32m+[m[32m        BCs = BoundaryConditions([m
2026-02-09T19:17:20.7646461Z [32m+[m[32m            mesh,[m
2026-02-09T19:17:20.7646693Z              (dirichlet_fn, neumann_fn, robin_fn, dirichlet_fn),[m
2026-02-09T19:17:20.7646896Z [31m-            (Dirichlet, Neumann, Robin, Dirichlet))[m
2026-02-09T19:17:20.7647106Z [32m+[m[32m            (Dirichlet, Neumann, Robin, Dirichlet)[m
2026-02-09T19:17:20.7647216Z [32m+[m[32m        )[m
2026-02-09T19:17:20.7647291Z  [m
2026-02-09T19:17:20.7647453Z          conditions = Conditions(mesh, BCs)[m
2026-02-09T19:17:20.7647524Z  [m
2026-02-09T19:17:20.7647656Z [36m@@ -75,7 +77,7 @@[m [musing Test[m
2026-02-09T19:17:20.7647739Z      end[m
2026-02-09T19:17:20.7647811Z  [m
2026-02-09T19:17:20.7647972Z      @testset "Robin BC evaluation" begin[m
2026-02-09T19:17:20.7648258Z [31m-        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=true)[m
2026-02-09T19:17:20.7648565Z [32m+[m[32m        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = true)[m
2026-02-09T19:17:20.7648695Z          mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.7649008Z  [m
2026-02-09T19:17:20.7649272Z          # Robin BC that returns position-dependent coefficients[m
2026-02-09T19:17:20.7680069Z [34m[146/151] Checking `test/runtests.jl` ........................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.7710155Z [34m[147/151] Checking `test/schemes.jl` ......................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.7725848Z [1mdiff --git a/schemes.jl b/schemes.jl[m
2026-02-09T19:17:20.7726083Z [1mindex e641ad7..b5db3d1 100644[m
2026-02-09T19:17:20.7726265Z [1m--- a/schemes.jl[m
2026-02-09T19:17:20.7726429Z [1m+++ b/schemes.jl[m
2026-02-09T19:17:20.7726624Z [36m@@ -105,12 +105,12 @@[m [mend[m
2026-02-09T19:17:20.7726712Z  [m
2026-02-09T19:17:20.7726898Z  @testset "Gradient Reconstruction" begin[m
2026-02-09T19:17:20.7727034Z      # Create a simple test mesh[m
2026-02-09T19:17:20.7727488Z [31m-    tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=true)[m
2026-02-09T19:17:20.7728294Z [32m+[m[32m    tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = true)[m
2026-02-09T19:17:20.7728522Z      mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.7729026Z  [m
2026-02-09T19:17:20.7729326Z      # Linear function: u(x, y) = 2x + 3y[m
2026-02-09T19:17:20.7729556Z      # Gradient should be (2, 3)[m
2026-02-09T19:17:20.7730004Z [31m-    u = [2*x + 3*y for (x, y) in DelaunayTriangulation.each_point(tri)][m
2026-02-09T19:17:20.7730511Z [32m+[m[32m    u = [2 * x + 3 * y for (x, y) in DelaunayTriangulation.each_point(tri)][m
2026-02-09T19:17:20.7730651Z  [m
2026-02-09T19:17:20.7730907Z      @testset "GreenGaussGradient" begin[m
2026-02-09T19:17:20.7731158Z          method = GreenGaussGradient()[m
2026-02-09T19:17:20.7731397Z [36m@@ -145,7 +145,7 @@[m [mend[m
2026-02-09T19:17:20.7731709Z          @test scheme.limiter isa VanLeerLimiter[m
2026-02-09T19:17:20.7732103Z          @test scheme.gradient_method isa GreenGaussGradient[m
2026-02-09T19:17:20.7732261Z  [m
2026-02-09T19:17:20.7732935Z [31m-        scheme2 = MUSCLScheme(limiter=MinmodLimiter(), gradient_method=LeastSquaresGradient())[m
2026-02-09T19:17:20.7733672Z [32m+[m[32m        scheme2 = MUSCLScheme(limiter = MinmodLimiter(), gradient_method = LeastSquaresGradient())[m
2026-02-09T19:17:20.7733967Z          @test scheme2.limiter isa MinmodLimiter[m
2026-02-09T19:17:20.7734362Z          @test scheme2.gradient_method isa LeastSquaresGradient[m
2026-02-09T19:17:20.7734516Z      end[m
2026-02-09T19:17:20.7856676Z [34m[148/151] Checking `test/srmhd.jl` ........................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.7872272Z [1mdiff --git a/srmhd.jl b/srmhd.jl[m
2026-02-09T19:17:20.7872503Z [1mindex 88b47a4..de5dbd7 100644[m
2026-02-09T19:17:20.7872680Z [1m--- a/srmhd.jl[m
2026-02-09T19:17:20.7872907Z [1m+++ b/srmhd.jl[m
2026-02-09T19:17:20.7873199Z [36m@@ -12,7 +12,7 @@[m [musing StaticArrays[m
2026-02-09T19:17:20.7873404Z          law = SRMHDEquations{1}(eos)[m
2026-02-09T19:17:20.7873566Z          @test nvariables(law) == 8[m
2026-02-09T19:17:20.7873687Z          @test law.eos === eos[m
2026-02-09T19:17:20.7873982Z [31m-        @test law.con2prim_tol == 1e-12[m
2026-02-09T19:17:20.7874304Z [32m+[m[32m        @test law.con2prim_tol == 1.0e-12[m
2026-02-09T19:17:20.7874556Z          @test law.con2prim_maxiter == 50[m
2026-02-09T19:17:20.7874715Z      end[m
2026-02-09T19:17:20.7874853Z  [m
2026-02-09T19:17:20.7875144Z [36m@@ -22,8 +22,8 @@[m [musing StaticArrays[m
2026-02-09T19:17:20.7875302Z      end[m
2026-02-09T19:17:20.7875452Z  [m
2026-02-09T19:17:20.7875746Z      @testset "Custom con2prim params" begin[m
2026-02-09T19:17:20.7876304Z [31m-        law = SRMHDEquations{1}(eos; con2prim_tol = 1e-10, con2prim_maxiter = 100)[m
2026-02-09T19:17:20.7876596Z [31m-        @test law.con2prim_tol == 1e-10[m
2026-02-09T19:17:20.7877193Z [32m+[m[32m        law = SRMHDEquations{1}(eos; con2prim_tol = 1.0e-10, con2prim_maxiter = 100)[m
2026-02-09T19:17:20.7877529Z [32m+[m[32m        @test law.con2prim_tol == 1.0e-10[m
2026-02-09T19:17:20.7877801Z          @test law.con2prim_maxiter == 100[m
2026-02-09T19:17:20.7877954Z      end[m
2026-02-09T19:17:20.7878105Z  end[m
2026-02-09T19:17:20.7878305Z [36m@@ -44,7 +44,7 @@[m [mend[m
2026-02-09T19:17:20.7878507Z          for w in states[m
2026-02-09T19:17:20.7878983Z              u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.7879293Z              w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.7879571Z [31m-            @test w2 ≈ w atol = 1e-10[m
2026-02-09T19:17:20.7879863Z [32m+[m[32m            @test w2 ≈ w atol = 1.0e-10[m
2026-02-09T19:17:20.7880019Z          end[m
2026-02-09T19:17:20.7880173Z      end[m
2026-02-09T19:17:20.7880314Z  [m
2026-02-09T19:17:20.7880516Z [36m@@ -58,7 +58,7 @@[m [mend[m
2026-02-09T19:17:20.7880704Z          for w in states[m
2026-02-09T19:17:20.7880983Z              u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.7881492Z              w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.7881740Z [31m-            @test w2 ≈ w atol = 1e-9[m
2026-02-09T19:17:20.7882212Z [32m+[m[32m            @test w2 ≈ w atol = 1.0e-9[m
2026-02-09T19:17:20.7882391Z          end[m
2026-02-09T19:17:20.7882544Z      end[m
2026-02-09T19:17:20.7882672Z  [m
2026-02-09T19:17:20.7882874Z [36m@@ -71,7 +71,7 @@[m [mend[m
2026-02-09T19:17:20.7883060Z          for w in states[m
2026-02-09T19:17:20.7883329Z              u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.7883598Z              w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.7883846Z [31m-            @test w2 ≈ w atol = 1e-8[m
2026-02-09T19:17:20.7884125Z [32m+[m[32m            @test w2 ≈ w atol = 1.0e-8[m
2026-02-09T19:17:20.7884276Z          end[m
2026-02-09T19:17:20.7884431Z      end[m
2026-02-09T19:17:20.7884570Z  [m
2026-02-09T19:17:20.7884773Z [36m@@ -81,16 +81,16 @@[m [mend[m
2026-02-09T19:17:20.7885097Z          w = SVector(1.0, v, 0.0, 0.0, 10.0, 0.5, 0.0, 0.0)[m
2026-02-09T19:17:20.7885366Z          u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.7885630Z          w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.7885958Z [31m-        @test w2[1] ≈ w[1] rtol = 1e-6   # density[m
2026-02-09T19:17:20.7886262Z [31m-        @test w2[2] ≈ w[2] rtol = 1e-6   # velocity[m
2026-02-09T19:17:20.7886548Z [31m-        @test w2[5] ≈ w[5] rtol = 1e-6   # pressure[m
2026-02-09T19:17:20.7886875Z [32m+[m[32m        @test w2[1] ≈ w[1] rtol = 1.0e-6   # density[m
2026-02-09T19:17:20.7887205Z [32m+[m[32m        @test w2[2] ≈ w[2] rtol = 1.0e-6   # velocity[m
2026-02-09T19:17:20.7887524Z [32m+[m[32m        @test w2[5] ≈ w[5] rtol = 1.0e-6   # pressure[m
2026-02-09T19:17:20.7887667Z      end[m
2026-02-09T19:17:20.7887792Z  [m
2026-02-09T19:17:20.7888041Z      @testset "B=0 (SR hydro limit)" begin[m
2026-02-09T19:17:20.7888341Z          w = SVector(1.0, 0.5, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0)[m
2026-02-09T19:17:20.7888626Z          u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.7889100Z          w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.7889360Z [31m-        @test w2 ≈ w atol = 1e-10[m
2026-02-09T19:17:20.7889628Z [32m+[m[32m        @test w2 ≈ w atol = 1.0e-10[m
2026-02-09T19:17:20.7889777Z      end[m
2026-02-09T19:17:20.7889915Z  [m
2026-02-09T19:17:20.7890171Z      @testset "Random valid states" begin[m
2026-02-09T19:17:20.7890378Z [36m@@ -109,11 +109,11 @@[m [mend[m
2026-02-09T19:17:20.7890680Z              w = SVector(ρ, vx, vy, vz, P, Bx, By, Bz)[m
2026-02-09T19:17:20.7890944Z              u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.7891213Z              w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.7891480Z [31m-            @test w2[1] ≈ w[1] rtol = 1e-8[m
2026-02-09T19:17:20.7891739Z [31m-            @test w2[2] ≈ w[2] atol = 1e-8[m
2026-02-09T19:17:20.7891995Z [31m-            @test w2[3] ≈ w[3] atol = 1e-8[m
2026-02-09T19:17:20.7892257Z [31m-            @test w2[4] ≈ w[4] atol = 1e-8[m
2026-02-09T19:17:20.7892511Z [31m-            @test w2[5] ≈ w[5] rtol = 1e-8[m
2026-02-09T19:17:20.7892825Z [32m+[m[32m            @test w2[1] ≈ w[1] rtol = 1.0e-8[m
2026-02-09T19:17:20.7893120Z [32m+[m[32m            @test w2[2] ≈ w[2] atol = 1.0e-8[m
2026-02-09T19:17:20.7893416Z [32m+[m[32m            @test w2[3] ≈ w[3] atol = 1.0e-8[m
2026-02-09T19:17:20.7893700Z [32m+[m[32m            @test w2[4] ≈ w[4] atol = 1.0e-8[m
2026-02-09T19:17:20.7893989Z [32m+[m[32m            @test w2[5] ≈ w[5] rtol = 1.0e-8[m
2026-02-09T19:17:20.7894144Z          end[m
2026-02-09T19:17:20.7894296Z      end[m
2026-02-09T19:17:20.7894437Z  end[m
2026-02-09T19:17:20.7894638Z [36m@@ -127,10 +127,10 @@[m [mend[m
2026-02-09T19:17:20.7894934Z      w = SVector(1.0, 0.5, 0.3, 0.0, 2.0, 0.5, 0.8, 0.3)[m
2026-02-09T19:17:20.7895465Z      u = FiniteVolumeMethod.primitive_to_conserved(SRMHDEquations{1}(eos), w)[m
2026-02-09T19:17:20.7895815Z  [m
2026-02-09T19:17:20.7896316Z [31m-    w_rec, result = FiniteVolumeMethod.srmhd_con2prim(eos, u, 1e-12, 50)[m
2026-02-09T19:17:20.7897018Z [32m+[m[32m    w_rec, result = FiniteVolumeMethod.srmhd_con2prim(eos, u, 1.0e-12, 50)[m
2026-02-09T19:17:20.7897265Z      @test result.converged == true[m
2026-02-09T19:17:20.7897504Z      @test result.iterations < 50[m
2026-02-09T19:17:20.7897763Z [31m-    @test result.residual < 1e-10[m
2026-02-09T19:17:20.7898047Z [32m+[m[32m    @test result.residual < 1.0e-10[m
2026-02-09T19:17:20.7898188Z  end[m
2026-02-09T19:17:20.7898326Z  [m
2026-02-09T19:17:20.7898595Z  # ============================================================[m
2026-02-09T19:17:20.7898985Z [36m@@ -153,12 +153,12 @@[m [mend[m
2026-02-09T19:17:20.7899198Z          Sx = ρ * h * W^2 * vx[m
2026-02-09T19:17:20.7899416Z          tau = ρ * h * W^2 - P - D[m
2026-02-09T19:17:20.7899552Z  [m
2026-02-09T19:17:20.7899873Z [31m-        @test f[1] ≈ D * vx atol = 1e-14           # D*vx[m
2026-02-09T19:17:20.7900306Z [31m-        @test f[5] ≈ Sx - D * vx atol = 1e-12       # τ flux = Sx - D*vx[m
2026-02-09T19:17:20.7900688Z [32m+[m[32m        @test f[1] ≈ D * vx atol = 1.0e-14           # D*vx[m
2026-02-09T19:17:20.7901153Z [32m+[m[32m        @test f[5] ≈ Sx - D * vx atol = 1.0e-12       # τ flux = Sx - D*vx[m
2026-02-09T19:17:20.7901312Z      end[m
2026-02-09T19:17:20.7901454Z  [m
2026-02-09T19:17:20.7901819Z      @testset "v≪1 approaches Newtonian MHD flux" begin[m
2026-02-09T19:17:20.7902021Z [31m-        v_small = 1e-4[m
2026-02-09T19:17:20.7902251Z [32m+[m[32m        v_small = 1.0e-4[m
2026-02-09T19:17:20.7902589Z          w = SVector(1.0, v_small, 0.0, 0.0, 1.0, 0.5, 1.0, 0.0)[m
2026-02-09T19:17:20.7902834Z          f_sr = physical_flux(law, w, 1)[m
2026-02-09T19:17:20.7902975Z  [m
2026-02-09T19:17:20.7903176Z [36m@@ -168,23 +168,23 @@[m [mend[m
2026-02-09T19:17:20.7903309Z  [m
2026-02-09T19:17:20.7903757Z          # At low v, SRMHD flux ≈ Newtonian MHD flux (to leading order in v)[m
2026-02-09T19:17:20.7903996Z          # D flux ≈ ρv (since W ≈ 1)[m
2026-02-09T19:17:20.7904277Z [31m-        @test f_sr[1] ≈ f_mhd[1] rtol = 1e-3[m
2026-02-09T19:17:20.7904612Z [32m+[m[32m        @test f_sr[1] ≈ f_mhd[1] rtol = 1.0e-3[m
2026-02-09T19:17:20.7904820Z          # Bx flux = 0 in both[m
2026-02-09T19:17:20.7905074Z [31m-        @test f_sr[6] ≈ 0.0 atol = 1e-14[m
2026-02-09T19:17:20.7905369Z [32m+[m[32m        @test f_sr[6] ≈ 0.0 atol = 1.0e-14[m
2026-02-09T19:17:20.7905637Z          # Induction fluxes should be similar[m
2026-02-09T19:17:20.7905908Z [31m-        @test f_sr[7] ≈ f_mhd[7] rtol = 1e-3[m
2026-02-09T19:17:20.7906170Z [31m-        @test f_sr[8] ≈ f_mhd[8] atol = 1e-3[m
2026-02-09T19:17:20.7906482Z [32m+[m[32m        @test f_sr[7] ≈ f_mhd[7] rtol = 1.0e-3[m
2026-02-09T19:17:20.7906796Z [32m+[m[32m        @test f_sr[8] ≈ f_mhd[8] atol = 1.0e-3[m
2026-02-09T19:17:20.7906945Z      end[m
2026-02-09T19:17:20.7907074Z  [m
2026-02-09T19:17:20.7907432Z      @testset "Flux consistency (F·n = 0 for Bn)" begin[m
2026-02-09T19:17:20.7907922Z          # The normal B flux should be zero (Bx flux for dir=1, By flux for dir=2)[m
2026-02-09T19:17:20.7908231Z          w = SVector(1.0, 0.5, 0.3, 0.0, 2.0, 0.5, 0.8, 0.3)[m
2026-02-09T19:17:20.7908467Z          f1 = physical_flux(law, w, 1)[m
2026-02-09T19:17:20.7909040Z [31m-        @test f1[6] ≈ 0.0 atol = 1e-14  # Bx flux = 0 for x-direction[m
2026-02-09T19:17:20.7909506Z [32m+[m[32m        @test f1[6] ≈ 0.0 atol = 1.0e-14  # Bx flux = 0 for x-direction[m
2026-02-09T19:17:20.7909636Z  [m
2026-02-09T19:17:20.7909887Z          law2d = SRMHDEquations{2}(eos)[m
2026-02-09T19:17:20.7910126Z          f2 = physical_flux(law2d, w, 2)[m
2026-02-09T19:17:20.7910526Z [31m-        @test f2[7] ≈ 0.0 atol = 1e-14  # By flux = 0 for y-direction[m
2026-02-09T19:17:20.7910981Z [32m+[m[32m        @test f2[7] ≈ 0.0 atol = 1.0e-14  # By flux = 0 for y-direction[m
2026-02-09T19:17:20.7911129Z      end[m
2026-02-09T19:17:20.7911485Z  end[m
2026-02-09T19:17:20.7911617Z  [m
2026-02-09T19:17:20.7911833Z [36m@@ -199,13 +199,13 @@[m [mend[m
2026-02-09T19:17:20.7912388Z          # Use a genuinely non-relativistic state (P << ρ, B² << ρ)[m
2026-02-09T19:17:20.7912861Z          # so the classical fast magnetosonic speed is a good approximation[m
2026-02-09T19:17:20.7913032Z          ρ = 1.0[m
2026-02-09T19:17:20.7913213Z [31m-        P = 1e-4[m
2026-02-09T19:17:20.7913409Z [32m+[m[32m        P = 1.0e-4[m
2026-02-09T19:17:20.7913577Z          Bx = 0.01[m
2026-02-09T19:17:20.7913875Z          w = SVector(ρ, 0.0, 0.0, 0.0, P, Bx, 0.0, 0.0)[m
2026-02-09T19:17:20.7914115Z          λm, λp = wave_speeds(law, w, 1)[m
2026-02-09T19:17:20.7914298Z          @test λp > 0[m
2026-02-09T19:17:20.7914480Z          @test λm < 0[m
2026-02-09T19:17:20.7914846Z [31m-        @test λp ≈ -λm atol = 1e-14  # symmetric when v=0[m
2026-02-09T19:17:20.7915241Z [32m+[m[32m        @test λp ≈ -λm atol = 1.0e-14  # symmetric when v=0[m
2026-02-09T19:17:20.7915396Z  [m
2026-02-09T19:17:20.7915908Z          # In the non-relativistic limit (h ≈ 1), should match classical fast speed[m
2026-02-09T19:17:20.7916085Z          γ = eos.gamma[m
2026-02-09T19:17:20.7916303Z [36m@@ -222,8 +222,8 @@[m [mend[m
2026-02-09T19:17:20.7916509Z          ε = 1.0 / ((γ - 1) * 1.0)[m
2026-02-09T19:17:20.7916687Z          h = 1 + ε + 1.0[m
2026-02-09T19:17:20.7916899Z          cs = sqrt(γ * 1.0 / (1.0 * h))[m
2026-02-09T19:17:20.7917144Z [31m-        @test λp ≈ cs atol = 1e-12[m
2026-02-09T19:17:20.7917385Z [31m-        @test λm ≈ -cs atol = 1e-12[m
2026-02-09T19:17:20.7917659Z [32m+[m[32m        @test λp ≈ cs atol = 1.0e-12[m
2026-02-09T19:17:20.7917946Z [32m+[m[32m        @test λm ≈ -cs atol = 1.0e-12[m
2026-02-09T19:17:20.7918100Z      end[m
2026-02-09T19:17:20.7918230Z  [m
2026-02-09T19:17:20.7918604Z      @testset "Wave speeds bounded by speed of light" begin[m
2026-02-09T19:17:20.7918979Z [36m@@ -363,9 +363,9 @@[m [mend[m
2026-02-09T19:17:20.7919270Z      Sx_total_0 = sum(u[2] for u in U0) * dx[m
2026-02-09T19:17:20.7919531Z      tau_total_0 = sum(u[5] for u in U0) * dx[m
2026-02-09T19:17:20.7919662Z  [m
2026-02-09T19:17:20.7919960Z [31m-    @test D_total ≈ D_total_0 rtol = 1e-10[m
2026-02-09T19:17:20.7920245Z [31m-    @test Sx_total ≈ Sx_total_0 atol = 1e-12[m
2026-02-09T19:17:20.7920543Z [31m-    @test tau_total ≈ tau_total_0 rtol = 1e-10[m
2026-02-09T19:17:20.7920882Z [32m+[m[32m    @test D_total ≈ D_total_0 rtol = 1.0e-10[m
2026-02-09T19:17:20.7921215Z [32m+[m[32m    @test Sx_total ≈ Sx_total_0 atol = 1.0e-12[m
2026-02-09T19:17:20.7921560Z [32m+[m[32m    @test tau_total ≈ tau_total_0 rtol = 1.0e-10[m
2026-02-09T19:17:20.7921716Z  end[m
2026-02-09T19:17:20.7921845Z  [m
2026-02-09T19:17:20.7922110Z  # ============================================================[m
2026-02-09T19:17:20.7922311Z [36m@@ -382,8 +382,10 @@[m [mend[m
2026-02-09T19:17:20.7922530Z      A = 0.01  # small amplitude[m
2026-02-09T19:17:20.7922728Z      γ_eos = eos.gamma[m
2026-02-09T19:17:20.7922865Z  [m
2026-02-09T19:17:20.7923234Z [31m-    ic(x) = SVector(ρ0, 0.0, A * sin(2π * x), A * cos(2π * x),[m
2026-02-09T19:17:20.7923554Z [31m-        P0, Bx0, A * sin(2π * x), A * cos(2π * x))[m
2026-02-09T19:17:20.7923770Z [32m+[m[32m    ic(x) = SVector([m
2026-02-09T19:17:20.7924096Z [32m+[m[32m        ρ0, 0.0, A * sin(2π * x), A * cos(2π * x),[m
2026-02-09T19:17:20.7924428Z [32m+[m[32m        P0, Bx0, A * sin(2π * x), A * cos(2π * x)[m
2026-02-09T19:17:20.7924596Z [32m+[m[32m    )[m
2026-02-09T19:17:20.7924730Z  [m
2026-02-09T19:17:20.7924929Z      for N in [100, 200][m
2026-02-09T19:17:20.7925194Z          mesh = StructuredMesh1D(0.0, 1.0, N)[m
2026-02-09T19:17:20.7925391Z [36m@@ -423,7 +425,7 @@[m [mend[m
2026-02-09T19:17:20.7925629Z      x, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.7925855Z      W = to_primitive(law, U)[m
2026-02-09T19:17:20.7925989Z  [m
2026-02-09T19:17:20.7926418Z [31m-    @test t ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.7926678Z [32m+[m[32m    @test t ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.7926930Z      @test all(isfinite.(w[1]) for w in W)[m
2026-02-09T19:17:20.7927315Z      @test all(w[1] > 0 for w in W)[m
2026-02-09T19:17:20.7927467Z  end[m
2026-02-09T19:17:20.7927682Z [36m@@ -440,8 +442,10 @@[m [mend[m
2026-02-09T19:17:20.7928007Z      wR = SVector(0.125, 0.0, 0.0, 0.0, 0.1, 0.5, -1.0, 0.0)[m
2026-02-09T19:17:20.7928207Z      ic(x) = x < 0.5 ? wL : wR[m
2026-02-09T19:17:20.7928349Z  [m
2026-02-09T19:17:20.7929027Z [31m-    limiters = [MinmodLimiter(), SuperbeeLimiter(), VanLeerLimiter(),[m
2026-02-09T19:17:20.7929314Z [31m-        KorenLimiter(), OspreLimiter()][m
2026-02-09T19:17:20.7929527Z [32m+[m[32m    limiters = [[m
2026-02-09T19:17:20.7929963Z [32m+[m[32m        MinmodLimiter(), SuperbeeLimiter(), VanLeerLimiter(),[m
2026-02-09T19:17:20.7930268Z [32m+[m[32m        KorenLimiter(), OspreLimiter(),[m
2026-02-09T19:17:20.7930463Z [32m+[m[32m    ][m
2026-02-09T19:17:20.7930600Z  [m
2026-02-09T19:17:20.7930795Z      for lim in limiters[m
2026-02-09T19:17:20.7931027Z          prob = HyperbolicProblem([m
2026-02-09T19:17:20.7943879Z [34m[149/151] Checking `test/srmhd_2d.jl` ........................................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.7957939Z [1mdiff --git a/srmhd_2d.jl b/srmhd_2d.jl[m
2026-02-09T19:17:20.7958181Z [1mindex cb0ef84..72d70db 100644[m
2026-02-09T19:17:20.7958362Z [1m--- a/srmhd_2d.jl[m
2026-02-09T19:17:20.7958528Z [1m+++ b/srmhd_2d.jl[m
2026-02-09T19:17:20.7958961Z [36m@@ -28,7 +28,7 @@[m [musing StaticArrays[m
2026-02-09T19:17:20.7959184Z      # Solution should be uniform in y[m
2026-02-09T19:17:20.7959290Z      for iy in 2:ny[m
2026-02-09T19:17:20.7959398Z          for ix in 1:nx[m
2026-02-09T19:17:20.7959666Z [31m-            @test W[ix, iy][1] ≈ W[ix, 1][1] atol = 1e-10[m
2026-02-09T19:17:20.7960067Z [32m+[m[32m            @test W[ix, iy][1] ≈ W[ix, 1][1] atol = 1.0e-10[m
2026-02-09T19:17:20.7960265Z          end[m
2026-02-09T19:17:20.7960423Z      end[m
2026-02-09T19:17:20.7960573Z  [m
2026-02-09T19:17:20.7960778Z [36m@@ -60,7 +60,7 @@[m [mend[m
2026-02-09T19:17:20.7961051Z      # Solution should be uniform in x[m
2026-02-09T19:17:20.7961236Z      for ix in 2:nx[m
2026-02-09T19:17:20.7961434Z          for iy in 1:ny[m
2026-02-09T19:17:20.7961782Z [31m-            @test W[ix, iy][1] ≈ W[1, iy][1] atol = 1e-10[m
2026-02-09T19:17:20.7962151Z [32m+[m[32m            @test W[ix, iy][1] ≈ W[1, iy][1] atol = 1.0e-10[m
2026-02-09T19:17:20.7962320Z          end[m
2026-02-09T19:17:20.7962472Z      end[m
2026-02-09T19:17:20.7962605Z  [m
2026-02-09T19:17:20.7962803Z [36m@@ -92,7 +92,7 @@[m [mend[m
2026-02-09T19:17:20.7963240Z      coords, U, t, ct = solve_hyperbolic(prob; vector_potential = Az)[m
2026-02-09T19:17:20.7963390Z  [m
2026-02-09T19:17:20.7963736Z      divB_max = max_divB(ct, mesh.dx, mesh.dy, nx, ny)[m
2026-02-09T19:17:20.7963973Z [31m-    @test divB_max < 1e-13[m
2026-02-09T19:17:20.7964234Z [32m+[m[32m    @test divB_max < 1.0e-13[m
2026-02-09T19:17:20.7964387Z  end[m
2026-02-09T19:17:20.7964525Z  [m
2026-02-09T19:17:20.7964820Z  # ============================================================[m
2026-02-09T19:17:20.7965028Z [36m@@ -129,7 +129,7 @@[m [mend[m
2026-02-09T19:17:20.7965769Z      U0 = [FiniteVolumeMethod.primitive_to_conserved(law, ic(coords[ix, iy]...)) for ix in 1:nx, iy in 1:ny][m
2026-02-09T19:17:20.7966236Z      D_total_0 = sum(U0[ix, iy][1] for ix in 1:nx, iy in 1:ny) * dV[m
2026-02-09T19:17:20.7966378Z  [m
2026-02-09T19:17:20.7966672Z [31m-    @test D_total ≈ D_total_0 rtol = 1e-10[m
2026-02-09T19:17:20.7967010Z [32m+[m[32m    @test D_total ≈ D_total_0 rtol = 1.0e-10[m
2026-02-09T19:17:20.7967153Z  end[m
2026-02-09T19:17:20.7967292Z  [m
2026-02-09T19:17:20.7967566Z  # ============================================================[m
2026-02-09T19:17:20.8284995Z [34m[150/151] Checking `test/test_functions.jl` .................................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.8512617Z [34m[151/151] Checking `test/weno.jl` ............................................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.8529417Z [1mdiff --git a/weno.jl b/weno.jl[m
2026-02-09T19:17:20.8529648Z [1mindex f7a8685..7f65fc2 100644[m
2026-02-09T19:17:20.8529824Z [1m--- a/weno.jl[m
2026-02-09T19:17:20.8529965Z [1m+++ b/weno.jl[m
2026-02-09T19:17:20.8530084Z [36m@@ -51,9 +51,9 @@[m [mend[m
2026-02-09T19:17:20.8530342Z      @test nghost(CellCenteredMUSCL(MinmodLimiter())) == 2[m
2026-02-09T19:17:20.8530605Z      @test nghost(CellCenteredMUSCL(SuperbeeLimiter())) == 2[m
2026-02-09T19:17:20.8530743Z      @test nghost(WENO3()) == 2[m
2026-02-09T19:17:20.8530900Z [31m-    @test nghost(WENO3(1e-10)) == 2[m
2026-02-09T19:17:20.8531077Z [32m+[m[32m    @test nghost(WENO3(1.0e-10)) == 2[m
2026-02-09T19:17:20.8531205Z      @test nghost(WENO5()) == 3[m
2026-02-09T19:17:20.8531364Z [31m-    @test nghost(WENO5(1e-10, 2)) == 3[m
2026-02-09T19:17:20.8531550Z [32m+[m[32m    @test nghost(WENO5(1.0e-10, 2)) == 3[m
2026-02-09T19:17:20.8531752Z      @test nghost(CharacteristicWENO(WENO3())) == 2[m
2026-02-09T19:17:20.8531967Z      @test nghost(CharacteristicWENO(WENO5())) == 3[m
2026-02-09T19:17:20.8532048Z  end[m
2026-02-09T19:17:20.8532162Z [36m@@ -66,20 +66,20 @@[m [mend[m
2026-02-09T19:17:20.8532272Z      recon = WENO3()[m
2026-02-09T19:17:20.8532353Z  [m
2026-02-09T19:17:20.8532561Z      @testset "Default epsilon" begin[m
2026-02-09T19:17:20.8532714Z [31m-        @test recon.epsilon == 1e-6[m
2026-02-09T19:17:20.8532898Z [32m+[m[32m        @test recon.epsilon == 1.0e-6[m
2026-02-09T19:17:20.8532981Z      end[m
2026-02-09T19:17:20.8533055Z  [m
2026-02-09T19:17:20.8533209Z      @testset "Custom epsilon" begin[m
2026-02-09T19:17:20.8533326Z [31m-        r = WENO3(1e-12)[m
2026-02-09T19:17:20.8533460Z [31m-        @test r.epsilon == 1e-12[m
2026-02-09T19:17:20.8533592Z [32m+[m[32m        r = WENO3(1.0e-12)[m
2026-02-09T19:17:20.8533762Z [32m+[m[32m        @test r.epsilon == 1.0e-12[m
2026-02-09T19:17:20.8533844Z      end[m
2026-02-09T19:17:20.8533917Z  [m
2026-02-09T19:17:20.8534132Z      @testset "Uniform data returns cell value" begin[m
2026-02-09T19:17:20.8534459Z          # For uniform data, reconstruction should return the cell value exactly[m
2026-02-09T19:17:20.8534557Z          val = 3.5[m
2026-02-09T19:17:20.8534842Z          wL_face, wR_face = reconstruct_interface(recon, val, val, val, val)[m
2026-02-09T19:17:20.8535018Z [31m-        @test wL_face ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8535176Z [31m-        @test wR_face ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8535360Z [32m+[m[32m        @test wL_face ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8535541Z [32m+[m[32m        @test wR_face ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8535623Z      end[m
2026-02-09T19:17:20.8535697Z  [m
2026-02-09T19:17:20.8535906Z      @testset "Linear data (exact for 3rd order)" begin[m
2026-02-09T19:17:20.8536030Z [36m@@ -95,8 +95,8 @@[m [mend[m
2026-02-09T19:17:20.8536543Z          wL_face, wR_face = reconstruct_interface(recon, wLL, wL, wR, wRR)[m
2026-02-09T19:17:20.8536705Z  [m
2026-02-09T19:17:20.8537048Z          # Both left and right reconstructions should give 4.0 for linear data[m
2026-02-09T19:17:20.8537208Z [31m-        @test wL_face ≈ 4.0 atol = 1e-10[m
2026-02-09T19:17:20.8537354Z [31m-        @test wR_face ≈ 4.0 atol = 1e-10[m
2026-02-09T19:17:20.8537534Z [32m+[m[32m        @test wL_face ≈ 4.0 atol = 1.0e-10[m
2026-02-09T19:17:20.8537704Z [32m+[m[32m        @test wR_face ≈ 4.0 atol = 1.0e-10[m
2026-02-09T19:17:20.8537785Z      end[m
2026-02-09T19:17:20.8537857Z  [m
2026-02-09T19:17:20.8538032Z      @testset "Smooth quadratic data" begin[m
2026-02-09T19:17:20.8538146Z [36m@@ -149,30 +149,30 @@[m [mend[m
2026-02-09T19:17:20.8538417Z          wL_face, wR_face = reconstruct_interface(recon, wLL, wL, wR, wRR)[m
2026-02-09T19:17:20.8538665Z  [m
2026-02-09T19:17:20.8539088Z          # By symmetry, both face values should be equal[m
2026-02-09T19:17:20.8539267Z [31m-        @test wL_face ≈ wR_face atol = 1e-14[m
2026-02-09T19:17:20.8539599Z [32m+[m[32m        @test wL_face ≈ wR_face atol = 1.0e-14[m
2026-02-09T19:17:20.8539695Z      end[m
2026-02-09T19:17:20.8539769Z  [m
2026-02-09T19:17:20.8539956Z      @testset "Internal _weno3 functions" begin[m
2026-02-09T19:17:20.8540068Z [31m-        eps = 1e-6[m
2026-02-09T19:17:20.8540182Z [32m+[m[32m        eps = 1.0e-6[m
2026-02-09T19:17:20.8540254Z  [m
2026-02-09T19:17:20.8540453Z          # Test left reconstruction with uniform data[m
2026-02-09T19:17:20.8540554Z          val = 5.0[m
2026-02-09T19:17:20.8540879Z          result = FiniteVolumeMethod._weno3_reconstruct_left(val, val, val, eps)[m
2026-02-09T19:17:20.8541036Z [31m-        @test result ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8541221Z [32m+[m[32m        @test result ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8541305Z  [m
2026-02-09T19:17:20.8541506Z          # Test right reconstruction with uniform data[m
2026-02-09T19:17:20.8541852Z          result_r = FiniteVolumeMethod._weno3_reconstruct_right(val, val, val, eps)[m
2026-02-09T19:17:20.8542016Z [31m-        @test result_r ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8542199Z [32m+[m[32m        @test result_r ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8542272Z  [m
2026-02-09T19:17:20.8542538Z          # Test left reconstruction with linear data: v0=0, v1=1, v2=2[m
2026-02-09T19:17:20.8542682Z          # Face at x=1.5 should give 1.5[m
2026-02-09T19:17:20.8542993Z          left_val = FiniteVolumeMethod._weno3_reconstruct_left(0.0, 1.0, 2.0, eps)[m
2026-02-09T19:17:20.8543151Z [31m-        @test left_val ≈ 1.5 atol = 1e-10[m
2026-02-09T19:17:20.8543326Z [32m+[m[32m        @test left_val ≈ 1.5 atol = 1.0e-10[m
2026-02-09T19:17:20.8543400Z  [m
2026-02-09T19:17:20.8543665Z          # Test right reconstruction with linear data: v0=0, v1=1, v2=2[m
2026-02-09T19:17:20.8543812Z          # Face at x=0.5 should give 0.5[m
2026-02-09T19:17:20.8544133Z          right_val = FiniteVolumeMethod._weno3_reconstruct_right(0.0, 1.0, 2.0, eps)[m
2026-02-09T19:17:20.8544295Z [31m-        @test right_val ≈ 0.5 atol = 1e-10[m
2026-02-09T19:17:20.8544484Z [32m+[m[32m        @test right_val ≈ 0.5 atol = 1.0e-10[m
2026-02-09T19:17:20.8544567Z      end[m
2026-02-09T19:17:20.8544647Z  end[m
2026-02-09T19:17:20.8544725Z  [m
2026-02-09T19:17:20.8544841Z [36m@@ -184,21 +184,21 @@[m [mend[m
2026-02-09T19:17:20.8544947Z      recon = WENO5()[m
2026-02-09T19:17:20.8545020Z  [m
2026-02-09T19:17:20.8545183Z      @testset "Default parameters" begin[m
2026-02-09T19:17:20.8545330Z [31m-        @test recon.epsilon == 1e-6[m
2026-02-09T19:17:20.8545500Z [32m+[m[32m        @test recon.epsilon == 1.0e-6[m
2026-02-09T19:17:20.8545626Z          @test recon.p == 2[m
2026-02-09T19:17:20.8545706Z      end[m
2026-02-09T19:17:20.8545779Z  [m
2026-02-09T19:17:20.8545934Z      @testset "Custom parameters" begin[m
2026-02-09T19:17:20.8546064Z [31m-        r = WENO5(1e-12, 1)[m
2026-02-09T19:17:20.8546200Z [31m-        @test r.epsilon == 1e-12[m
2026-02-09T19:17:20.8546348Z [32m+[m[32m        r = WENO5(1.0e-12, 1)[m
2026-02-09T19:17:20.8546512Z [32m+[m[32m        @test r.epsilon == 1.0e-12[m
2026-02-09T19:17:20.8546620Z          @test r.p == 1[m
2026-02-09T19:17:20.8546701Z      end[m
2026-02-09T19:17:20.8546773Z  [m
2026-02-09T19:17:20.8546919Z      @testset "Uniform data" begin[m
2026-02-09T19:17:20.8547014Z          val = 2.7[m
2026-02-09T19:17:20.8547411Z          left_face, right_face = reconstruct_interface_weno5(recon, val, val, val, val, val, val)[m
2026-02-09T19:17:20.8547578Z [31m-        @test left_face ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8547744Z [31m-        @test right_face ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8547928Z [32m+[m[32m        @test left_face ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8548121Z [32m+[m[32m        @test right_face ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8548330Z      end[m
2026-02-09T19:17:20.8548404Z  [m
2026-02-09T19:17:20.8548558Z      @testset "Linear data (exact)" begin[m
2026-02-09T19:17:20.8548897Z [36m@@ -212,8 +212,8 @@[m [mend[m
2026-02-09T19:17:20.8549061Z  [m
2026-02-09T19:17:20.8549378Z          # Interface between v3 and v4, at x = 0.5; exact = 2.5[m
2026-02-09T19:17:20.8549751Z          left_face, right_face = reconstruct_interface_weno5(recon, v1, v2, v3, v4, v5, v6)[m
2026-02-09T19:17:20.8549910Z [31m-        @test left_face ≈ 2.5 atol = 1e-10[m
2026-02-09T19:17:20.8550072Z [31m-        @test right_face ≈ 2.5 atol = 1e-10[m
2026-02-09T19:17:20.8550253Z [32m+[m[32m        @test left_face ≈ 2.5 atol = 1.0e-10[m
2026-02-09T19:17:20.8550445Z [32m+[m[32m        @test right_face ≈ 2.5 atol = 1.0e-10[m
2026-02-09T19:17:20.8550527Z      end[m
2026-02-09T19:17:20.8550600Z  [m
2026-02-09T19:17:20.8550752Z      @testset "Quadratic data" begin[m
2026-02-09T19:17:20.8550863Z [36m@@ -277,27 +277,27 @@[m [mend[m
2026-02-09T19:17:20.8550954Z      end[m
2026-02-09T19:17:20.8551027Z  [m
2026-02-09T19:17:20.8551217Z      @testset "Internal _weno5 functions" begin[m
2026-02-09T19:17:20.8551339Z [31m-        eps_val = 1e-6[m
2026-02-09T19:17:20.8551467Z [32m+[m[32m        eps_val = 1.0e-6[m
2026-02-09T19:17:20.8551571Z          p_val = 2[m
2026-02-09T19:17:20.8551645Z  [m
2026-02-09T19:17:20.8551752Z          # Uniform data[m
2026-02-09T19:17:20.8551846Z          val = 4.2[m
2026-02-09T19:17:20.8552288Z          result = FiniteVolumeMethod._weno5_reconstruct_left(val, val, val, val, val, eps_val, p_val)[m
2026-02-09T19:17:20.8552445Z [31m-        @test result ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8552623Z [32m+[m[32m        @test result ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8552707Z  [m
2026-02-09T19:17:20.8553142Z          result_r = FiniteVolumeMethod._weno5_reconstruct_right(val, val, val, val, val, eps_val, p_val)[m
2026-02-09T19:17:20.8553298Z [31m-        @test result_r ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8553494Z [32m+[m[32m        @test result_r ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8553567Z  [m
2026-02-09T19:17:20.8553711Z          # Linear data: v = [1, 2, 3, 4, 5][m
2026-02-09T19:17:20.8554109Z          left_val = FiniteVolumeMethod._weno5_reconstruct_left(1.0, 2.0, 3.0, 4.0, 5.0, eps_val, p_val)[m
2026-02-09T19:17:20.8554265Z [31m-        @test left_val ≈ 3.5 atol = 1e-10[m
2026-02-09T19:17:20.8554439Z [32m+[m[32m        @test left_val ≈ 3.5 atol = 1.0e-10[m
2026-02-09T19:17:20.8554511Z  [m
2026-02-09T19:17:20.8554940Z          right_val = FiniteVolumeMethod._weno5_reconstruct_right(1.0, 2.0, 3.0, 4.0, 5.0, eps_val, p_val)[m
2026-02-09T19:17:20.8555096Z [31m-        @test right_val ≈ 2.5 atol = 1e-10[m
2026-02-09T19:17:20.8555274Z [32m+[m[32m        @test right_val ≈ 2.5 atol = 1.0e-10[m
2026-02-09T19:17:20.8555353Z  [m
2026-02-09T19:17:20.8555477Z          # Right = mirror of left[m
2026-02-09T19:17:20.8555891Z          left_mirror = FiniteVolumeMethod._weno5_reconstruct_left(5.0, 4.0, 3.0, 2.0, 1.0, eps_val, p_val)[m
2026-02-09T19:17:20.8556093Z [31m-        @test right_val ≈ left_mirror atol = 1e-14[m
2026-02-09T19:17:20.8556331Z [32m+[m[32m        @test right_val ≈ left_mirror atol = 1.0e-14[m
2026-02-09T19:17:20.8556413Z      end[m
2026-02-09T19:17:20.8556491Z  end[m
2026-02-09T19:17:20.8556569Z  [m
2026-02-09T19:17:20.8556678Z [36m@@ -312,8 +312,8 @@[m [mend[m
2026-02-09T19:17:20.8556807Z          # Uniform SVector data[m
2026-02-09T19:17:20.8556927Z          w = SVector(1.0, 2.0, 3.0)[m
2026-02-09T19:17:20.8557180Z          wL_face, wR_face = reconstruct_interface(recon, w, w, w, w)[m
2026-02-09T19:17:20.8557329Z [31m-        @test wL_face ≈ w atol = 1e-14[m
2026-02-09T19:17:20.8557472Z [31m-        @test wR_face ≈ w atol = 1e-14[m
2026-02-09T19:17:20.8557649Z [32m+[m[32m        @test wL_face ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.8557818Z [32m+[m[32m        @test wR_face ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.8558036Z  [m
2026-02-09T19:17:20.8558163Z          # Linear SVector data[m
2026-02-09T19:17:20.8558296Z          wLL = SVector(0.0, 0.0, 0.0)[m
2026-02-09T19:17:20.8558563Z [36m@@ -325,8 +325,8 @@[m [mend[m
2026-02-09T19:17:20.8558646Z  [m
2026-02-09T19:17:20.8559095Z          # For linear data, face value = 1.5 * (1,2,3)[m
2026-02-09T19:17:20.8559287Z          expected = SVector(1.5, 3.0, 4.5)[m
2026-02-09T19:17:20.8559471Z [31m-        @test wL_face ≈ expected atol = 1e-10[m
2026-02-09T19:17:20.8559648Z [31m-        @test wR_face ≈ expected atol = 1e-10[m
2026-02-09T19:17:20.8559851Z [32m+[m[32m        @test wL_face ≈ expected atol = 1.0e-10[m
2026-02-09T19:17:20.8560045Z [32m+[m[32m        @test wR_face ≈ expected atol = 1.0e-10[m
2026-02-09T19:17:20.8560127Z      end[m
2026-02-09T19:17:20.8560207Z  [m
2026-02-09T19:17:20.8560460Z      @testset "WENO3 SVector component-wise consistency" begin[m
2026-02-09T19:17:20.8560572Z [36m@@ -342,8 +342,8 @@[m [mend[m
2026-02-09T19:17:20.8560833Z          # Each component should match the scalar reconstruction[m
2026-02-09T19:17:20.8560939Z          for k in 1:3[m
2026-02-09T19:17:20.8561229Z              sL, sR = reconstruct_interface(recon, wLL[k], wL[k], wR[k], wRR[k])[m
2026-02-09T19:17:20.8561395Z [31m-            @test wL_face[k] ≈ sL atol = 1e-14[m
2026-02-09T19:17:20.8561562Z [31m-            @test wR_face[k] ≈ sR atol = 1e-14[m
2026-02-09T19:17:20.8561751Z [32m+[m[32m            @test wL_face[k] ≈ sL atol = 1.0e-14[m
2026-02-09T19:17:20.8561933Z [32m+[m[32m            @test wR_face[k] ≈ sR atol = 1.0e-14[m
2026-02-09T19:17:20.8562026Z          end[m
2026-02-09T19:17:20.8562105Z      end[m
2026-02-09T19:17:20.8562178Z  [m
2026-02-09T19:17:20.8562286Z [36m@@ -353,8 +353,8 @@[m [mend[m
2026-02-09T19:17:20.8562419Z          # Uniform SVector data[m
2026-02-09T19:17:20.8562541Z          w = SVector(1.0, 2.0, 3.0)[m
2026-02-09T19:17:20.8562867Z          left_face, right_face = reconstruct_interface_weno5(recon, w, w, w, w, w, w)[m
2026-02-09T19:17:20.8563038Z [31m-        @test left_face ≈ w atol = 1e-14[m
2026-02-09T19:17:20.8563195Z [31m-        @test right_face ≈ w atol = 1e-14[m
2026-02-09T19:17:20.8563380Z [32m+[m[32m        @test left_face ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.8563566Z [32m+[m[32m        @test right_face ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.8563640Z  [m
2026-02-09T19:17:20.8563765Z          # Linear SVector data[m
2026-02-09T19:17:20.8563887Z          v1 = SVector(0.0, 0.0, 0.0)[m
2026-02-09T19:17:20.8564001Z [36m@@ -368,8 +368,8 @@[m [mend[m
2026-02-09T19:17:20.8564074Z  [m
2026-02-09T19:17:20.8564324Z          # Face between v3 and v4 at midpoint: expected = 2.5 * (1,2,3)[m
2026-02-09T19:17:20.8564474Z          expected = SVector(2.5, 5.0, 7.5)[m
2026-02-09T19:17:20.8564658Z [31m-        @test left_face ≈ expected atol = 1e-10[m
2026-02-09T19:17:20.8564843Z [31m-        @test right_face ≈ expected atol = 1e-10[m
2026-02-09T19:17:20.8565069Z [32m+[m[32m        @test left_face ≈ expected atol = 1.0e-10[m
2026-02-09T19:17:20.8565279Z [32m+[m[32m        @test right_face ≈ expected atol = 1.0e-10[m
2026-02-09T19:17:20.8565359Z      end[m
2026-02-09T19:17:20.8565437Z  [m
2026-02-09T19:17:20.8565707Z      @testset "WENO5 SVector component-wise consistency" begin[m
2026-02-09T19:17:20.8565815Z [36m@@ -387,8 +387,8 @@[m [mend[m
2026-02-09T19:17:20.8566055Z          # Each component should match the scalar reconstruction[m
2026-02-09T19:17:20.8566167Z          for k in 1:3[m
2026-02-09T19:17:20.8566515Z              sL, sR = reconstruct_interface_weno5(recon, v1[k], v2[k], v3[k], v4[k], v5[k], v6[k])[m
2026-02-09T19:17:20.8566686Z [31m-            @test left_face[k] ≈ sL atol = 1e-14[m
2026-02-09T19:17:20.8566864Z [31m-            @test right_face[k] ≈ sR atol = 1e-14[m
2026-02-09T19:17:20.8567061Z [32m+[m[32m            @test left_face[k] ≈ sL atol = 1.0e-14[m
2026-02-09T19:17:20.8567261Z [32m+[m[32m            @test right_face[k] ≈ sR atol = 1.0e-14[m
2026-02-09T19:17:20.8567487Z          end[m
2026-02-09T19:17:20.8567576Z      end[m
2026-02-09T19:17:20.8567654Z  end[m
2026-02-09T19:17:20.8567871Z [36m@@ -416,11 +416,11 @@[m [mend[m
2026-02-09T19:17:20.8568043Z              R = right_eigenvectors(law, w, 1)[m
2026-02-09T19:17:20.8568118Z  [m
2026-02-09T19:17:20.8568237Z              product = L * R[m
2026-02-09T19:17:20.8568407Z [31m-            @test product ≈ I(3) atol = 1e-12[m
2026-02-09T19:17:20.8568618Z [32m+[m[32m            @test product ≈ I(3) atol = 1.0e-12[m
2026-02-09T19:17:20.8568696Z  [m
2026-02-09T19:17:20.8568947Z              # Also check R * L = I[m
2026-02-09T19:17:20.8569075Z              product2 = R * L[m
2026-02-09T19:17:20.8569252Z [31m-            @test product2 ≈ I(3) atol = 1e-12[m
2026-02-09T19:17:20.8569451Z [32m+[m[32m            @test product2 ≈ I(3) atol = 1.0e-12[m
2026-02-09T19:17:20.8569537Z          end[m
2026-02-09T19:17:20.8569626Z      end[m
2026-02-09T19:17:20.8569707Z  [m
2026-02-09T19:17:20.8569860Z [36m@@ -439,7 +439,7 @@[m [mend[m
2026-02-09T19:17:20.8570074Z                  R = right_eigenvectors(law, w, dir)[m
2026-02-09T19:17:20.8579136Z  [m
2026-02-09T19:17:20.8579345Z                  product = L * R[m
2026-02-09T19:17:20.8579557Z [31m-                @test product ≈ I(4) atol = 1e-12[m
2026-02-09T19:17:20.8579775Z [32m+[m[32m                @test product ≈ I(4) atol = 1.0e-12[m
2026-02-09T19:17:20.8579873Z              end[m
2026-02-09T19:17:20.8579961Z          end[m
2026-02-09T19:17:20.8580044Z      end[m
2026-02-09T19:17:20.8580167Z [36m@@ -471,8 +471,8 @@[m [mend[m
2026-02-09T19:17:20.8580432Z          wL_char, wR_char = reconstruct_interface(cw, wLL, wL, wR, wRR)[m
2026-02-09T19:17:20.8580720Z          wL_plain, wR_plain = reconstruct_interface(plain, wLL, wL, wR, wRR)[m
2026-02-09T19:17:20.8580796Z  [m
2026-02-09T19:17:20.8580984Z [31m-        @test wL_char ≈ wL_plain atol = 1e-14[m
2026-02-09T19:17:20.8581153Z [31m-        @test wR_char ≈ wR_plain atol = 1e-14[m
2026-02-09T19:17:20.8581368Z [32m+[m[32m        @test wL_char ≈ wL_plain atol = 1.0e-14[m
2026-02-09T19:17:20.8581580Z [32m+[m[32m        @test wR_char ≈ wR_plain atol = 1.0e-14[m
2026-02-09T19:17:20.8581664Z      end[m
2026-02-09T19:17:20.8581741Z  [m
2026-02-09T19:17:20.8582089Z      @testset "Characteristic WENO3 1D dispatch" begin[m
2026-02-09T19:17:20.8582297Z [36m@@ -622,7 +622,7 @@[m [mend[m
2026-02-09T19:17:20.8582501Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.8582626Z  [m
2026-02-09T19:17:20.8582834Z          # Should reach final time[m
2026-02-09T19:17:20.8583050Z [31m-        @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.8583330Z [32m+[m[32m        @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.8583497Z  [m
2026-02-09T19:17:20.8583697Z          # No NaN or Inf[m
2026-02-09T19:17:20.8583889Z          for i in 1:N[m
2026-02-09T19:17:20.8584102Z [36m@@ -644,7 +644,7 @@[m [mend[m
2026-02-09T19:17:20.8584374Z          # L1 error should be reasonable[m
2026-02-09T19:17:20.8584565Z          dx = 1.0 / N[m
2026-02-09T19:17:20.8585048Z          rho_err = sum(abs(W[i][1] - sod_exact_weno(x[i], 0.2)[1]) * dx for i in 1:N)[m
2026-02-09T19:17:20.8585273Z [31m-        @test rho_err < 0.10[m
2026-02-09T19:17:20.8585417Z [32m+[m[32m        @test rho_err < 0.1[m
2026-02-09T19:17:20.8585503Z      end[m
2026-02-09T19:17:20.8585579Z  [m
2026-02-09T19:17:20.8585716Z      @testset "WENO3 + HLL" begin[m
2026-02-09T19:17:20.8585825Z [36m@@ -661,7 +661,7 @@[m [mend[m
2026-02-09T19:17:20.8585974Z          x, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.8586109Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.8586219Z  [m
2026-02-09T19:17:20.8586356Z [31m-        @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.8586513Z [32m+[m[32m        @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.8586627Z          for i in 1:N[m
2026-02-09T19:17:20.8586763Z              @test all(isfinite, W[i])[m
2026-02-09T19:17:20.8587063Z              @test W[i][1] > 0[m
2026-02-09T19:17:20.8587183Z [36m@@ -683,7 +683,7 @@[m [mend[m
2026-02-09T19:17:20.8587334Z          x, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.8587573Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.8587650Z  [m
2026-02-09T19:17:20.8587790Z [31m-        @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.8587946Z [32m+[m[32m        @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.8588107Z          for i in 1:N[m
2026-02-09T19:17:20.8588337Z              @test all(isfinite, W[i])[m
2026-02-09T19:17:20.8588527Z              @test W[i][1] > 0[m
2026-02-09T19:17:20.8588872Z [36m@@ -717,9 +717,9 @@[m [mend[m
2026-02-09T19:17:20.8589175Z          momentum_final = sum(U_final[i][2] for i in 1:N) * dx[m
2026-02-09T19:17:20.8589391Z          energy_final = sum(U_final[i][3] for i in 1:N) * dx[m
2026-02-09T19:17:20.8589466Z  [m
2026-02-09T19:17:20.8589645Z [31m-        @test mass_final ≈ mass0 rtol = 1e-12[m
2026-02-09T19:17:20.8589878Z [31m-        @test momentum_final ≈ momentum0 rtol = 1e-12[m
2026-02-09T19:17:20.8590067Z [31m-        @test energy_final ≈ energy0 rtol = 1e-12[m
2026-02-09T19:17:20.8590274Z [32m+[m[32m        @test mass_final ≈ mass0 rtol = 1.0e-12[m
2026-02-09T19:17:20.8590515Z [32m+[m[32m        @test momentum_final ≈ momentum0 rtol = 1.0e-12[m
2026-02-09T19:17:20.8590738Z [32m+[m[32m        @test energy_final ≈ energy0 rtol = 1.0e-12[m
2026-02-09T19:17:20.8590824Z      end[m
2026-02-09T19:17:20.8590900Z  [m
2026-02-09T19:17:20.8591099Z      @testset "CharacteristicWENO3 on Sod" begin[m
2026-02-09T19:17:20.8591212Z [36m@@ -736,7 +736,7 @@[m [mend[m
2026-02-09T19:17:20.8591363Z          x, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.8591497Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.8591571Z  [m
2026-02-09T19:17:20.8591703Z [31m-        @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.8591863Z [32m+[m[32m        @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.8591983Z          for i in 1:N[m
2026-02-09T19:17:20.8592120Z              @test all(isfinite, W[i])[m
2026-02-09T19:17:20.8592230Z              @test W[i][1] > 0[m
2026-02-09T19:17:20.8592352Z [36m@@ -746,6 +746,6 @@[m [mend[m
2026-02-09T19:17:20.8592502Z          # L1 error should be reasonable[m
2026-02-09T19:17:20.8592598Z          dx = 1.0 / N[m
2026-02-09T19:17:20.8592880Z          rho_err = sum(abs(W[i][1] - sod_exact_weno(x[i], 0.2)[1]) * dx for i in 1:N)[m
2026-02-09T19:17:20.8593011Z [31m-        @test rho_err < 0.10[m
2026-02-09T19:17:20.8593146Z [32m+[m[32m        @test rho_err < 0.1[m
2026-02-09T19:17:20.8593229Z      end[m
2026-02-09T19:17:20.8593316Z  end[m
2026-02-09T19:17:20.8749995Z ##[error]Process completed with exit code 1.
2026-02-09T19:17:20.8858607Z Post job cleanup.
2026-02-09T19:17:20.9798435Z [command]/usr/bin/git version
2026-02-09T19:17:20.9839709Z git version 2.52.0
2026-02-09T19:17:20.9883661Z Temporarily overriding HOME='/home/runner/work/_temp/ca3cb58d-c447-4493-98bf-218186c144c7' before making global git config changes
2026-02-09T19:17:20.9884986Z Adding repository directory to the temporary git global config as a safe directory
2026-02-09T19:17:20.9890508Z [command]/usr/bin/git config --global --add safe.directory /home/runner/work/FiniteVolumeMethod.jl/FiniteVolumeMethod.jl
2026-02-09T19:17:20.9925395Z [command]/usr/bin/git config --local --name-only --get-regexp core\.sshCommand
2026-02-09T19:17:20.9957727Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :"
2026-02-09T19:17:21.0184049Z [command]/usr/bin/git config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2026-02-09T19:17:21.0204334Z http.https://github.com/.extraheader
2026-02-09T19:17:21.0217234Z [command]/usr/bin/git config --local --unset-all http.https://github.com/.extraheader
2026-02-09T19:17:21.0249124Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :"
2026-02-09T19:17:21.0467987Z [command]/usr/bin/git config --local --name-only --get-regexp ^includeIf\.gitdir:
2026-02-09T19:17:21.0498287Z [command]/usr/bin/git submodule foreach --recursive git config --local --show-origin --name-only --get-regexp remote.origin.url
2026-02-09T19:17:21.0816846Z Cleaning up orphan processes
