2026-02-09T19:16:26.1256431Z ##[group]Run fredrikekre/runic-action@v1
2026-02-09T19:16:26.1256785Z with:
2026-02-09T19:16:26.1256966Z   version: 1
2026-02-09T19:16:26.1257149Z   format_files: false
2026-02-09T19:16:26.1257343Z ##[endgroup]
2026-02-09T19:16:26.1335387Z ##[group]Run ${GITHUB_ACTION_PATH}/src/dependency-check.sh
2026-02-09T19:16:26.1335846Z [36;1m${GITHUB_ACTION_PATH}/src/dependency-check.sh[0m
2026-02-09T19:16:26.1372474Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2026-02-09T19:16:26.1372840Z ##[endgroup]
2026-02-09T19:16:37.8537531Z ##[group]Run julia --color=yes --project=@runic "${GITHUB_ACTION_PATH}/src/install.jl"
2026-02-09T19:16:37.8538149Z [36;1mjulia --color=yes --project=@runic "${GITHUB_ACTION_PATH}/src/install.jl"[0m
2026-02-09T19:16:37.8569354Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2026-02-09T19:16:37.8569682Z env:
2026-02-09T19:16:37.8569852Z   INPUT_RUNIC_VERSION: 1
2026-02-09T19:16:37.8570059Z ##[endgroup]
2026-02-09T19:16:43.9397849Z [32m[1m  Installing[22m[39m known registries into `~/.julia`
2026-02-09T19:16:45.6475682Z [32m[1m       Added[22m[39m `General` registry to ~/.julia/registries
2026-02-09T19:16:45.9107927Z [32m[1m    Updating[22m[39m registry at `~/.julia/registries/General.toml`
2026-02-09T19:16:45.9583420Z [32m[1m   Resolving[22m[39m package versions...
2026-02-09T19:16:46.6443984Z [32m[1m   Installed[22m[39m Preferences ─ v1.5.1
2026-02-09T19:16:46.6587051Z [32m[1m   Installed[22m[39m JuliaSyntax ─ v0.4.10
2026-02-09T19:16:46.6588107Z [32m[1m   Installed[22m[39m Runic ─────── v1.5.1
2026-02-09T19:16:46.7316044Z [32m[1m    Updating[22m[39m `~/.julia/environments/runic/Project.toml`
2026-02-09T19:16:46.7316977Z   [90m[62bfec6d] [39m[92m+ Runic v1.5.1[39m
2026-02-09T19:16:46.7320294Z [32m[1m    Updating[22m[39m `~/.julia/environments/runic/Manifest.toml`
2026-02-09T19:16:46.7324687Z [33m⌅[39m [90m[70703baa] [39m[92m+ JuliaSyntax v0.4.10[39m
2026-02-09T19:16:46.7325633Z   [90m[21216c6a] [39m[92m+ Preferences v1.5.1[39m
2026-02-09T19:16:46.7326440Z   [90m[62bfec6d] [39m[92m+ Runic v1.5.1[39m
2026-02-09T19:16:46.7327427Z   [90m[ade2ca70] [39m[92m+ Dates v1.11.0[39m
2026-02-09T19:16:46.7329725Z   [90m[de0858da] [39m[92m+ Printf v1.11.0[39m
2026-02-09T19:16:46.7331951Z   [90m[fa267f1f] [39m[92m+ TOML v1.0.3[39m
2026-02-09T19:16:46.7332543Z   [90m[4ec0a83e] [39m[92m+ Unicode v1.11.0[39m
2026-02-09T19:16:46.7334075Z [36m[1m        Info[22m[39m Packages marked with [33m⌅[39m have new versions available but compatibility constraints restrict them from upgrading. To see why use `status --outdated -m`
2026-02-09T19:16:46.8985399Z [32m[1mPrecompiling[22m[39m packages...
2026-02-09T19:16:48.0210996Z    1086.2 ms[32m  ✓ [39m[90mPreferences[39m
2026-02-09T19:17:03.0837070Z   16185.0 ms[32m  ✓ [39m[90mJuliaSyntax[39m
2026-02-09T19:17:19.1406367Z   16056.8 ms[32m  ✓ [39mRunic
2026-02-09T19:17:19.1407232Z   3 dependencies successfully precompiled in 32 seconds. 4 already precompiled.
2026-02-09T19:17:19.2898974Z ##[group]Run julia --color=yes --project=@runic "${GITHUB_ACTION_PATH}/src/check.jl"
2026-02-09T19:17:19.2899551Z [36;1mjulia --color=yes --project=@runic "${GITHUB_ACTION_PATH}/src/check.jl"[0m
2026-02-09T19:17:19.2930240Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2026-02-09T19:17:19.2930563Z env:
2026-02-09T19:17:19.2930742Z   INPUT_RUNIC_FORMAT_FILES: false
2026-02-09T19:17:19.2930968Z ##[endgroup]
2026-02-09T19:17:19.7885572Z [34m[  1/151] Checking `docs/liveserver.jl` ...................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.7939062Z [34m[  2/151] Checking `docs/make.jl` ............................................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8155175Z [1mdiff --git a/make.jl b/make.jl[m
2026-02-09T19:17:19.8179631Z [1mindex 432d8ce..796d000 100644[m
2026-02-09T19:17:19.8180208Z [1m--- a/make.jl[m
2026-02-09T19:17:19.8180563Z [1m+++ b/make.jl[m
2026-02-09T19:17:19.8181094Z [36m@@ -201,6 +201,7 @@[m [mfunction _collect_pages!(set, pages)[m
2026-02-09T19:17:19.8182202Z              _collect_pages!(set, page[2])[m
2026-02-09T19:17:19.8182726Z          end[m
2026-02-09T19:17:19.8183058Z      end[m
2026-02-09T19:17:19.8183373Z [32m+[m[32m    return[m
2026-02-09T19:17:19.8183749Z  end[m
2026-02-09T19:17:19.8184094Z  _collect_pages!(set, _PAGES)[m
2026-02-09T19:17:19.8184543Z  missing_set = String[][m
2026-02-09T19:17:19.8199830Z [34m[  3/151] Checking `docs/src/literate_hyperbolic/amr_sedov_blast.jl` ......... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8216631Z [1mdiff --git a/amr_sedov_blast.jl b/amr_sedov_blast.jl[m
2026-02-09T19:17:19.8217326Z [1mindex 8b44d9a..a975834 100644[m
2026-02-09T19:17:19.8217809Z [1m--- a/amr_sedov_blast.jl[m
2026-02-09T19:17:19.8218277Z [1m+++ b/amr_sedov_blast.jl[m
2026-02-09T19:17:19.8218970Z [36m@@ -32,9 +32,9 @@[m [mdomain_hi = (1.0, 1.0)[m
2026-02-09T19:17:19.8219752Z  # The `GradientRefinement` criterion refines blocks where the density[m
2026-02-09T19:17:19.8220478Z  # gradient exceeds a threshold:[m
2026-02-09T19:17:19.8220963Z  criterion = GradientRefinement([m
2026-02-09T19:17:19.8221643Z [31m-    variable_index=1,              ## monitor density (index 1)[m
2026-02-09T19:17:19.8222281Z [31m-    refine_threshold=0.1,[m
2026-02-09T19:17:19.8222803Z [31m-    coarsen_threshold=0.01[m
2026-02-09T19:17:19.8223474Z [32m+[m[32m    variable_index = 1,              ## monitor density (index 1)[m
2026-02-09T19:17:19.8224180Z [32m+[m[32m    refine_threshold = 0.1,[m
2026-02-09T19:17:19.8224720Z [32m+[m[32m    coarsen_threshold = 0.01[m
2026-02-09T19:17:19.8225169Z  )[m
2026-02-09T19:17:19.8225460Z  [m
2026-02-09T19:17:19.8226097Z  grid = AMRGrid(law, criterion, block_size, max_level, domain_lo, domain_hi, Val(4))[m
2026-02-09T19:17:19.8227259Z [36m@@ -44,7 +44,7 @@[m [mgrid = AMRGrid(law, criterion, block_size, max_level, domain_lo, domain_hi, Val([m
2026-02-09T19:17:19.8228341Z  # uniform density with a high-pressure region near the origin.[m
2026-02-09T19:17:19.8229301Z  root_block = grid.blocks[1][m
2026-02-09T19:17:19.8229783Z  dx_root = root_block.dx[1][m
2026-02-09T19:17:19.8230236Z [31m-P_bg = 1e-5[m
2026-02-09T19:17:19.8230648Z [32m+[m[32mP_bg = 1.0e-5[m
2026-02-09T19:17:19.8231045Z  P_blast = 1.0[m
2026-02-09T19:17:19.8231415Z  r_blast = 3.0 * dx_root[m
2026-02-09T19:17:19.8231775Z  [m
2026-02-09T19:17:19.8232239Z [36m@@ -73,7 +73,7 @@[m [mmax_lev = max_active_level(grid)[m
2026-02-09T19:17:19.8233078Z  bcs = (TransmissiveBC(), TransmissiveBC(), TransmissiveBC(), TransmissiveBC())[m
2026-02-09T19:17:19.8233805Z  prob = AMRProblem([m
2026-02-09T19:17:19.8234295Z      grid, HLLCSolver(), NoReconstruction(), bcs;[m
2026-02-09T19:17:19.8234950Z [31m-    final_time=0.05, cfl=0.3, regrid_interval=4[m
2026-02-09T19:17:19.8235685Z [32m+[m[32m    final_time = 0.05, cfl = 0.3, regrid_interval = 4[m
2026-02-09T19:17:19.8236261Z  )[m
2026-02-09T19:17:19.8236658Z  final_grid, t_final = solve_amr(prob)[m
2026-02-09T19:17:19.8237181Z  final_grid |> tc #hide[m
2026-02-09T19:17:19.8237788Z [36m@@ -104,17 +104,21 @@[m [mfor block in active_blocks(final_grid)[m
2026-02-09T19:17:19.8238366Z      end[m
2026-02-09T19:17:19.8238665Z  end[m
2026-02-09T19:17:19.8239302Z  [m
2026-02-09T19:17:19.8239721Z [31m-fig = Figure(fontsize=24, size=(1100, 500))[m
2026-02-09T19:17:19.8240347Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8241043Z [31m-           title="Density (AMR, t=$(round(t_final, digits=3)))",[m
2026-02-09T19:17:19.8241682Z [31m-           aspect=DataAspect())[m
2026-02-09T19:17:19.8242404Z [31m-sc1 = scatter!(ax1, xs, ys, color=rhos, markersize=4, colormap=:inferno)[m
2026-02-09T19:17:19.8243155Z [31m-Colorbar(fig[1, 2], sc1, label=L"\rho")[m
2026-02-09T19:17:19.8243925Z [31m-[m
2026-02-09T19:17:19.8244380Z [31m-ax2 = Axis(fig[1, 3], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8245015Z [31m-           title="AMR levels", aspect=DataAspect())[m
2026-02-09T19:17:19.8246056Z [31m-sc2 = scatter!(ax2, xs, ys, color=levels, markersize=4, colormap=:Set1_3)[m
2026-02-09T19:17:19.8246812Z [31m-Colorbar(fig[1, 4], sc2, label="Level")[m
2026-02-09T19:17:19.8247494Z [32m+[m[32mfig = Figure(fontsize = 24, size = (1100, 500))[m
2026-02-09T19:17:19.8248181Z [32m+[m[32max1 = Axis([m
2026-02-09T19:17:19.8248569Z [32m+[m[32m    fig[1, 1], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8249282Z [32m+[m[32m    title = "Density (AMR, t=$(round(t_final, digits = 3)))",[m
2026-02-09T19:17:19.8249671Z [32m+[m[32m    aspect = DataAspect()[m
2026-02-09T19:17:19.8249925Z [32m+[m[32m)[m
2026-02-09T19:17:19.8250308Z [32m+[m[32msc1 = scatter!(ax1, xs, ys, color = rhos, markersize = 4, colormap = :inferno)[m
2026-02-09T19:17:19.8250790Z [32m+[m[32mColorbar(fig[1, 2], sc1, label = L"\rho")[m
2026-02-09T19:17:19.8251083Z [32m+[m
2026-02-09T19:17:19.8251271Z [32m+[m[32max2 = Axis([m
2026-02-09T19:17:19.8251558Z [32m+[m[32m    fig[1, 3], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8251929Z [32m+[m[32m    title = "AMR levels", aspect = DataAspect()[m
2026-02-09T19:17:19.8252232Z [32m+[m[32m)[m
2026-02-09T19:17:19.8252619Z [32m+[m[32msc2 = scatter!(ax2, xs, ys, color = levels, markersize = 4, colormap = :Set1_3)[m
2026-02-09T19:17:19.8253083Z [32m+[m[32mColorbar(fig[1, 4], sc2, label = "Level")[m
2026-02-09T19:17:19.8253776Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8254168Z  fig[m
2026-02-09T19:17:19.8254817Z  @test_reference joinpath(@__DIR__, "../figures", "amr_sedov_blast.png") fig #src[m
2026-02-09T19:17:19.8319982Z [34m[  4/151] Checking `docs/src/literate_hyperbolic/balsara_srmhd_shock_tube.jl`  [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8321367Z [1mdiff --git a/balsara_srmhd_shock_tube.jl b/balsara_srmhd_shock_tube.jl[m
2026-02-09T19:17:19.8322511Z [1mindex 0008e39..429ce3e 100644[m
2026-02-09T19:17:19.8323598Z [1m--- a/balsara_srmhd_shock_tube.jl[m
2026-02-09T19:17:19.8324082Z [1m+++ b/balsara_srmhd_shock_tube.jl[m
2026-02-09T19:17:19.8324517Z [36m@@ -35,7 +35,7 @@[m [mic(x) = x < 0.5 ? wL : wR[m
2026-02-09T19:17:19.8324902Z  prob = HyperbolicProblem([m
2026-02-09T19:17:19.8325377Z      law, mesh, HLLSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.8325897Z      TransmissiveBC(), TransmissiveBC(), ic;[m
2026-02-09T19:17:19.8326303Z [31m-    final_time=0.4, cfl=0.4[m
2026-02-09T19:17:19.8326658Z [32m+[m[32m    final_time = 0.4, cfl = 0.4[m
2026-02-09T19:17:19.8326971Z  )[m
2026-02-09T19:17:19.8327250Z  x, U, t_final = solve_hyperbolic(prob)[m
2026-02-09T19:17:19.8327582Z  x |> tc #hide[m
2026-02-09T19:17:19.8328070Z [36m@@ -52,15 +52,15 @@[m [mBy = [conserved_to_primitive(law, U[i])[7] for i in eachindex(U)][m
2026-02-09T19:17:19.8328594Z  # ## Visualisation[m
2026-02-09T19:17:19.8329202Z  using CairoMakie[m
2026-02-09T19:17:19.8329583Z  [m
2026-02-09T19:17:19.8330041Z [31m-fig = Figure(fontsize=20, size=(1200, 400))[m
2026-02-09T19:17:19.8330815Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel=L"\rho", title="Density")[m
2026-02-09T19:17:19.8331615Z [31m-lines!(ax1, x, rho, color=:blue, linewidth=1.5)[m
2026-02-09T19:17:19.8332371Z [32m+[m[32mfig = Figure(fontsize = 20, size = (1200, 400))[m
2026-02-09T19:17:19.8333214Z [32m+[m[32max1 = Axis(fig[1, 1], xlabel = "x", ylabel = L"\rho", title = "Density")[m
2026-02-09T19:17:19.8333829Z [32m+[m[32mlines!(ax1, x, rho, color = :blue, linewidth = 1.5)[m
2026-02-09T19:17:19.8334204Z  [m
2026-02-09T19:17:19.8334587Z [31m-ax2 = Axis(fig[1, 2], xlabel="x", ylabel=L"v_x", title="Velocity")[m
2026-02-09T19:17:19.8335113Z [31m-lines!(ax2, x, vx, color=:blue, linewidth=1.5)[m
2026-02-09T19:17:19.8335679Z [32m+[m[32max2 = Axis(fig[1, 2], xlabel = "x", ylabel = L"v_x", title = "Velocity")[m
2026-02-09T19:17:19.8336474Z [32m+[m[32mlines!(ax2, x, vx, color = :blue, linewidth = 1.5)[m
2026-02-09T19:17:19.8336880Z  [m
2026-02-09T19:17:19.8337314Z [31m-ax3 = Axis(fig[1, 3], xlabel="x", ylabel=L"B_y", title="Magnetic Field (y)")[m
2026-02-09T19:17:19.8338032Z [31m-lines!(ax3, x, By, color=:blue, linewidth=1.5)[m
2026-02-09T19:17:19.8338628Z [32m+[m[32max3 = Axis(fig[1, 3], xlabel = "x", ylabel = L"B_y", title = "Magnetic Field (y)")[m
2026-02-09T19:17:19.8339545Z [32m+[m[32mlines!(ax3, x, By, color = :blue, linewidth = 1.5)[m
2026-02-09T19:17:19.8339942Z  [m
2026-02-09T19:17:19.8340176Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8340438Z  fig[m
2026-02-09T19:17:19.8341007Z [34m[  5/151] Checking `docs/src/literate_hyperbolic/brio_wu_shock_tube.jl` ...... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8341748Z [1mdiff --git a/brio_wu_shock_tube.jl b/brio_wu_shock_tube.jl[m
2026-02-09T19:17:19.8342206Z [1mindex 8a4b163..c9475fa 100644[m
2026-02-09T19:17:19.8342545Z [1m--- a/brio_wu_shock_tube.jl[m
2026-02-09T19:17:19.8342888Z [1m+++ b/brio_wu_shock_tube.jl[m
2026-02-09T19:17:19.8343273Z [36m@@ -39,7 +39,7 @@[m [mbw_ic(x) = x < 0.5 ? wL : wR[m
2026-02-09T19:17:19.8343667Z  prob = HyperbolicProblem([m
2026-02-09T19:17:19.8344168Z      law, mesh, HLLDSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.8344690Z      TransmissiveBC(), TransmissiveBC(), bw_ic;[m
2026-02-09T19:17:19.8345087Z [31m-    final_time=0.1, cfl=0.8[m
2026-02-09T19:17:19.8345437Z [32m+[m[32m    final_time = 0.1, cfl = 0.8[m
2026-02-09T19:17:19.8345747Z  )[m
2026-02-09T19:17:19.8346023Z  x, U, t_final = solve_hyperbolic(prob)[m
2026-02-09T19:17:19.8346365Z  x |> tc #hide[m
2026-02-09T19:17:19.8346846Z [36m@@ -55,14 +55,14 @@[m [mvy = [conserved_to_primitive(law, U[i])[3] for i in eachindex(U)][m
2026-02-09T19:17:19.8347502Z  P = [conserved_to_primitive(law, U[i])[5] for i in eachindex(U)][m
2026-02-09T19:17:19.8348086Z  By = [conserved_to_primitive(law, U[i])[7] for i in eachindex(U)][m
2026-02-09T19:17:19.8348493Z  [m
2026-02-09T19:17:19.8349031Z [31m-fig = Figure(fontsize=20, size=(1200, 800))[m
2026-02-09T19:17:19.8349518Z [32m+[m[32mfig = Figure(fontsize = 20, size = (1200, 800))[m
2026-02-09T19:17:19.8349973Z  titles = [L"\rho", L"v_x", L"v_y", "P", L"B_y"][m
2026-02-09T19:17:19.8350338Z  data = [rho, vx, vy, P, By][m
2026-02-09T19:17:19.8350743Z  for (idx, (title, d)) in enumerate(zip(titles, data))[m
2026-02-09T19:17:19.8351144Z      row = (idx - 1) ÷ 3 + 1[m
2026-02-09T19:17:19.8351423Z      col = (idx - 1) % 3 + 1[m
2026-02-09T19:17:19.8351861Z [31m-    ax = Axis(fig[row, col], xlabel="x", ylabel=title, title=title)[m
2026-02-09T19:17:19.8352390Z [31m-    lines!(ax, x, d, color=:blue, linewidth=1.5)[m
2026-02-09T19:17:19.8352963Z [32m+[m[32m    ax = Axis(fig[row, col], xlabel = "x", ylabel = title, title = title)[m
2026-02-09T19:17:19.8353898Z [32m+[m[32m    lines!(ax, x, d, color = :blue, linewidth = 1.5)[m
2026-02-09T19:17:19.8354496Z  end[m
2026-02-09T19:17:19.8354852Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8355242Z  fig[m
2026-02-09T19:17:19.8355590Z [36m@@ -73,5 +73,5 @@[m [mfig[m
2026-02-09T19:17:19.8356324Z  # contact discontinuity, slow shock, and fast rarefaction on the right.[m
2026-02-09T19:17:19.8357175Z  # Note that $B_x$ remains constant at $0.75$ throughout (not shown).[m
2026-02-09T19:17:19.8357698Z  Bx_vals = [U[i][6] for i in eachindex(U)] #hide[m
2026-02-09T19:17:19.8358166Z [31m-@assert all(b -> abs(b - 0.75) < 1e-10, Bx_vals) #hide[m
2026-02-09T19:17:19.8358683Z [32m+[m[32m@assert all(b -> abs(b - 0.75) < 1.0e-10, Bx_vals) #hide[m
2026-02-09T19:17:19.8359364Z  @assert all(rho .> 0) #hide[m
2026-02-09T19:17:19.8359975Z [34m[  6/151] Checking `docs/src/literate_hyperbolic/couette_flow.jl` ............ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8360647Z [1mdiff --git a/couette_flow.jl b/couette_flow.jl[m
2026-02-09T19:17:19.8361063Z [1mindex 8addedf..21155f2 100644[m
2026-02-09T19:17:19.8361570Z [1m--- a/couette_flow.jl[m
2026-02-09T19:17:19.8361868Z [1m+++ b/couette_flow.jl[m
2026-02-09T19:17:19.8362175Z [36m@@ -23,7 +23,7 @@[m [mgamma = 1.4[m
2026-02-09T19:17:19.8362507Z  eos = IdealGasEOS(gamma)[m
2026-02-09T19:17:19.8362900Z  mu = 0.01[m
2026-02-09T19:17:19.8363126Z  Pr = 0.72[m
2026-02-09T19:17:19.8363516Z [31m-ns = NavierStokesEquations{2}(eos, mu=mu, Pr=Pr)[m
2026-02-09T19:17:19.8364059Z [32m+[m[32mns = NavierStokesEquations{2}(eos, mu = mu, Pr = Pr)[m
2026-02-09T19:17:19.8364450Z  [m
2026-02-09T19:17:19.8364734Z  ## Physical parameters (low Mach number)[m
2026-02-09T19:17:19.8365076Z  rho0 = 1.0[m
2026-02-09T19:17:19.8365407Z [36m@@ -51,7 +51,7 @@[m [mprob = HyperbolicProblem2D([m
2026-02-09T19:17:19.8365868Z      ns, mesh, HLLCSolver(), NoReconstruction(),[m
2026-02-09T19:17:19.8366358Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8366849Z      NoSlipBC(), DirichletHyperbolicBC(w_top),[m
2026-02-09T19:17:19.8367274Z [31m-    ic_couette; final_time=0.5, cfl=0.3[m
2026-02-09T19:17:19.8367716Z [32m+[m[32m    ic_couette; final_time = 0.5, cfl = 0.3[m
2026-02-09T19:17:19.8368064Z  )[m
2026-02-09T19:17:19.8368542Z  coords, U, t_final = solve_hyperbolic(prob)[m
2026-02-09T19:17:19.8370120Z  coords |> tc #hide[m
2026-02-09T19:17:19.8370742Z [36m@@ -69,12 +69,14 @@[m [mmax_err = maximum(abs.(vx_num .- vx_exact))[m
2026-02-09T19:17:19.8371390Z  # ## Visualisation[m
2026-02-09T19:17:19.8371793Z  using CairoMakie[m
2026-02-09T19:17:19.8372060Z  [m
2026-02-09T19:17:19.8372350Z [31m-fig = Figure(fontsize=24, size=(600, 500))[m
2026-02-09T19:17:19.8372799Z [31m-ax = Axis(fig[1, 1], xlabel=L"v_x", ylabel="y",[m
2026-02-09T19:17:19.8373266Z [31m-          title="Couette Flow: velocity profile")[m
2026-02-09T19:17:19.8373910Z [31m-lines!(ax, vx_exact, yc, color=:black, linewidth=2, label="Exact")[m
2026-02-09T19:17:19.8374552Z [31m-scatter!(ax, vx_num, yc, color=:blue, markersize=10, label="Numerical")[m
2026-02-09T19:17:19.8375088Z [31m-axislegend(ax, position=:lt)[m
2026-02-09T19:17:19.8375512Z [32m+[m[32mfig = Figure(fontsize = 24, size = (600, 500))[m
2026-02-09T19:17:19.8375925Z [32m+[m[32max = Axis([m
2026-02-09T19:17:19.8376279Z [32m+[m[32m    fig[1, 1], xlabel = L"v_x", ylabel = "y",[m
2026-02-09T19:17:19.8376761Z [32m+[m[32m    title = "Couette Flow: velocity profile"[m
2026-02-09T19:17:19.8377127Z [32m+[m[32m)[m
2026-02-09T19:17:19.8377569Z [32m+[m[32mlines!(ax, vx_exact, yc, color = :black, linewidth = 2, label = "Exact")[m
2026-02-09T19:17:19.8378290Z [32m+[m[32mscatter!(ax, vx_num, yc, color = :blue, markersize = 10, label = "Numerical")[m
2026-02-09T19:17:19.8379076Z [32m+[m[32maxislegend(ax, position = :lt)[m
2026-02-09T19:17:19.8379446Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8379703Z  fig[m
2026-02-09T19:17:19.8380133Z  @test_reference joinpath(@__DIR__, "../figures", "couette_flow.png") fig #src[m
2026-02-09T19:17:19.8380969Z [34m[  7/151] Checking `docs/src/literate_hyperbolic/field_loop_advection.jl` .... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8381748Z [1mdiff --git a/field_loop_advection.jl b/field_loop_advection.jl[m
2026-02-09T19:17:19.8382230Z [1mindex 62ba894..7826498 100644[m
2026-02-09T19:17:19.8382569Z [1m--- a/field_loop_advection.jl[m
2026-02-09T19:17:19.8382924Z [1m+++ b/field_loop_advection.jl[m
2026-02-09T19:17:19.8383316Z [36m@@ -22,7 +22,7 @@[m [meos = IdealGasEOS(gamma)[m
2026-02-09T19:17:19.8383723Z  law = IdealMHDEquations{2}(eos)[m
2026-02-09T19:17:19.8384010Z  [m
2026-02-09T19:17:19.8384210Z  R0 = 0.3[m
2026-02-09T19:17:19.8384431Z [31m-A0 = 1e-3[m
2026-02-09T19:17:19.8384681Z [32m+[m[32mA0 = 1.0e-3[m
2026-02-09T19:17:19.8384964Z  vx_bg, vy_bg = 1.0, 0.5[m
2026-02-09T19:17:19.8385240Z  rho_bg, P_bg = 1.0, 1.0[m
2026-02-09T19:17:19.8385484Z  [m
2026-02-09T19:17:19.8385805Z [36m@@ -60,19 +60,19 @@[m [mprob = HyperbolicProblem2D([m
2026-02-09T19:17:19.8386355Z      law, mesh, HLLDSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.8387109Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8387629Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8388087Z [31m-    loop_ic; final_time=1.0, cfl=0.4[m
2026-02-09T19:17:19.8388631Z [32m+[m[32m    loop_ic; final_time = 1.0, cfl = 0.4[m
2026-02-09T19:17:19.8389301Z  )[m
2026-02-09T19:17:19.8389598Z  [m
2026-02-09T19:17:19.8390246Z  # The `vector_potential` keyword triggers `initialize_ct_from_potential!`,[m
2026-02-09T19:17:19.8391210Z  # which uses Stokes' theorem to compute face-centred $B$ values:[m
2026-02-09T19:17:19.8392176Z [31m-coords, U, t_final, ct = solve_hyperbolic(prob; vector_potential=Az_loop)[m
2026-02-09T19:17:19.8393084Z [32m+[m[32mcoords, U, t_final, ct = solve_hyperbolic(prob; vector_potential = Az_loop)[m
2026-02-09T19:17:19.8393606Z  coords |> tc #hide[m
2026-02-09T19:17:19.8393836Z  [m
2026-02-09T19:17:19.8394084Z  # ## Checking $\nabla\cdot\vb B$[m
2026-02-09T19:17:19.8394595Z  # With CT + vector potential initialisation, the discrete divergence[m
2026-02-09T19:17:19.8395095Z  # remains at machine precision:[m
2026-02-09T19:17:19.8395449Z  divB_max = max_divB(ct, mesh)[m
2026-02-09T19:17:19.8395781Z [31m-@assert divB_max < 1e-12 #hide[m
2026-02-09T19:17:19.8396159Z [32m+[m[32m@assert divB_max < 1.0e-12 #hide[m
2026-02-09T19:17:19.8396462Z  [m
2026-02-09T19:17:19.8396688Z  # ## Visualisation[m
2026-02-09T19:17:19.8396956Z  using CairoMakie[m
2026-02-09T19:17:19.8397259Z [36m@@ -81,21 +81,27 @@[m [mnx, ny = N, N[m
2026-02-09T19:17:19.8397606Z  xc = [coords[1][i] for i in 1:nx][m
2026-02-09T19:17:19.8397946Z  yc = [coords[2][j] for j in 1:ny][m
2026-02-09T19:17:19.8398286Z  ## Compute |B| from the solution[m
2026-02-09T19:17:19.8398595Z [31m-Bmag = [begin[m
2026-02-09T19:17:19.8399179Z [31m-    w = conserved_to_primitive(law, U[i, j])[m
2026-02-09T19:17:19.8399554Z [31m-    sqrt(w[6]^2 + w[7]^2)[m
2026-02-09T19:17:19.8399875Z [31m-end for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.8400188Z [32m+[m[32mBmag = [[m
2026-02-09T19:17:19.8400453Z [32m+[m[32m    begin[m
2026-02-09T19:17:19.8400822Z [32m+[m[32m            w = conserved_to_primitive(law, U[i, j])[m
2026-02-09T19:17:19.8401258Z [32m+[m[32m            sqrt(w[6]^2 + w[7]^2)[m
2026-02-09T19:17:19.8401641Z [32m+[m[32m        end for i in 1:nx, j in 1:ny[m
2026-02-09T19:17:19.8401960Z [32m+[m[32m][m
2026-02-09T19:17:19.8402378Z  rho = [conserved_to_primitive(law, U[i, j])[1] for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.8402799Z  [m
2026-02-09T19:17:19.8403182Z [31m-fig = Figure(fontsize=24, size=(1100, 500))[m
2026-02-09T19:17:19.8403850Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8404670Z [31m-           title="|B| at t = $(round(t_final, digits=2))", aspect=DataAspect())[m
2026-02-09T19:17:19.8405524Z [31m-hm1 = heatmap!(ax1, xc, yc, Bmag, colormap=:viridis)[m
2026-02-09T19:17:19.8406276Z [32m+[m[32mfig = Figure(fontsize = 24, size = (1100, 500))[m
2026-02-09T19:17:19.8406828Z [32m+[m[32max1 = Axis([m
2026-02-09T19:17:19.8407179Z [32m+[m[32m    fig[1, 1], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8407748Z [32m+[m[32m    title = "|B| at t = $(round(t_final, digits = 2))", aspect = DataAspect()[m
2026-02-09T19:17:19.8408368Z [32m+[m[32m)[m
2026-02-09T19:17:19.8408979Z [32m+[m[32mhm1 = heatmap!(ax1, xc, yc, Bmag, colormap = :viridis)[m
2026-02-09T19:17:19.8409448Z  Colorbar(fig[1, 2], hm1)[m
2026-02-09T19:17:19.8409709Z  [m
2026-02-09T19:17:19.8410002Z [31m-ax2 = Axis(fig[1, 3], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8410453Z [31m-           title="Density", aspect=DataAspect())[m
2026-02-09T19:17:19.8410928Z [31m-hm2 = heatmap!(ax2, xc, yc, rho, colormap=:inferno)[m
2026-02-09T19:17:19.8411313Z [32m+[m[32max2 = Axis([m
2026-02-09T19:17:19.8411656Z [32m+[m[32m    fig[1, 3], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8412105Z [32m+[m[32m    title = "Density", aspect = DataAspect()[m
2026-02-09T19:17:19.8412655Z [32m+[m[32m)[m
2026-02-09T19:17:19.8413039Z [32m+[m[32mhm2 = heatmap!(ax2, xc, yc, rho, colormap = :inferno)[m
2026-02-09T19:17:19.8413467Z  Colorbar(fig[1, 4], hm2)[m
2026-02-09T19:17:19.8413763Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8414141Z  fig[m
2026-02-09T19:17:19.8414716Z [34m[  8/151] Checking `docs/src/literate_hyperbolic/imex_stiff_relaxation.jl` ... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8415478Z [1mdiff --git a/imex_stiff_relaxation.jl b/imex_stiff_relaxation.jl[m
2026-02-09T19:17:19.8415962Z [1mindex 2bf046a..bd86f7e 100644[m
2026-02-09T19:17:19.8416307Z [1m--- a/imex_stiff_relaxation.jl[m
2026-02-09T19:17:19.8416653Z [1m+++ b/imex_stiff_relaxation.jl[m
2026-02-09T19:17:19.8417093Z [36m@@ -39,7 +39,7 @@[m [mlambda_rate = 50.0  ## stiff cooling rate[m
2026-02-09T19:17:19.8417686Z  # molecular weight $\mu$. The temperature is computed as $T = P\mu/\rho$.[m
2026-02-09T19:17:19.8418183Z  T_target = P_target * mu_mol[m
2026-02-09T19:17:19.8418577Z  cooling_func = T -> lambda_rate * (T - T_target)[m
2026-02-09T19:17:19.8419207Z [31m-source = CoolingSource(cooling_func; mu_mol=mu_mol)[m
2026-02-09T19:17:19.8419775Z [32m+[m[32msource = CoolingSource(cooling_func; mu_mol = mu_mol)[m
2026-02-09T19:17:19.8420182Z  [m
2026-02-09T19:17:19.8420466Z  w_init = SVector(rho_init, v_init, P_init)[m
2026-02-09T19:17:19.8420784Z  [m
2026-02-09T19:17:19.8421090Z [36m@@ -53,19 +53,19 @@[m [mprob = HyperbolicProblem([m
2026-02-09T19:17:19.8421543Z      law, mesh, HLLSolver(), NoReconstruction(),[m
2026-02-09T19:17:19.8421982Z      TransmissiveBC(), TransmissiveBC(),[m
2026-02-09T19:17:19.8422315Z      x -> w_init;[m
2026-02-09T19:17:19.8422607Z [31m-    final_time=t_final, cfl=0.4[m
2026-02-09T19:17:19.8422983Z [32m+[m[32m    final_time = t_final, cfl = 0.4[m
2026-02-09T19:17:19.8423304Z  )[m
2026-02-09T19:17:19.8423493Z  [m
2026-02-09T19:17:19.8423783Z  # **SSP3(4,3,3)** — 4-stage, 3rd-order SSP scheme:[m
2026-02-09T19:17:19.8424217Z  x_ssp, U_ssp, t_ssp = solve_hyperbolic_imex([m
2026-02-09T19:17:19.8424635Z [31m-    prob, source; scheme=IMEX_SSP3_433(),[m
2026-02-09T19:17:19.8425044Z [31m-    newton_tol=1e-12, newton_maxiter=10[m
2026-02-09T19:17:19.8425471Z [32m+[m[32m    prob, source; scheme = IMEX_SSP3_433(),[m
2026-02-09T19:17:19.8425951Z [32m+[m[32m    newton_tol = 1.0e-12, newton_maxiter = 10[m
2026-02-09T19:17:19.8426294Z  )[m
2026-02-09T19:17:19.8426487Z  [m
2026-02-09T19:17:19.8426788Z  # **ARS(2,2,2)** — 3-stage, 2nd-order L-stable scheme:[m
2026-02-09T19:17:19.8427223Z  x_ars, U_ars, t_ars = solve_hyperbolic_imex([m
2026-02-09T19:17:19.8427734Z [31m-    prob, source; scheme=IMEX_ARS222(),[m
2026-02-09T19:17:19.8428368Z [31m-    newton_tol=1e-12, newton_maxiter=10[m
2026-02-09T19:17:19.8429217Z [32m+[m[32m    prob, source; scheme = IMEX_ARS222(),[m
2026-02-09T19:17:19.8429916Z [32m+[m[32m    newton_tol = 1.0e-12, newton_maxiter = 10[m
2026-02-09T19:17:19.8430449Z  )[m
2026-02-09T19:17:19.8430782Z  x_ars |> tc #hide[m
2026-02-09T19:17:19.8431135Z  [m
2026-02-09T19:17:19.8431494Z [36m@@ -84,21 +84,25 @@[m [mP_avg_ars = sum(P_ars) / length(P_ars)[m
2026-02-09T19:17:19.8431901Z  # ## Visualisation[m
2026-02-09T19:17:19.8432189Z  using CairoMakie[m
2026-02-09T19:17:19.8432418Z  [m
2026-02-09T19:17:19.8432706Z [31m-fig = Figure(fontsize=24, size=(900, 400))[m
2026-02-09T19:17:19.8433142Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel="P",[m
2026-02-09T19:17:19.8433567Z [31m-           title="Pressure relaxation")[m
2026-02-09T19:17:19.8434118Z [31m-scatter!(ax1, x_ssp, P_ssp, color=:blue, markersize=6, label="SSP3(4,3,3)")[m
2026-02-09T19:17:19.8434787Z [31m-scatter!(ax1, x_ars, P_ars, color=:red, markersize=6, label="ARS(2,2,2)")[m
2026-02-09T19:17:19.8435504Z [31m-hlines!(ax1, [P_target], color=:black, linestyle=:dash, label=L"P_{\mathrm{target}}")[m
2026-02-09T19:17:19.8436257Z [31m-hlines!(ax1, [P_init], color=:gray, linestyle=:dot, label=L"P_{\mathrm{init}}")[m
2026-02-09T19:17:19.8436972Z [31m-axislegend(ax1, position=:rt)[m
2026-02-09T19:17:19.8437397Z [32m+[m[32mfig = Figure(fontsize = 24, size = (900, 400))[m
2026-02-09T19:17:19.8437782Z [32m+[m[32max1 = Axis([m
2026-02-09T19:17:19.8438128Z [32m+[m[32m    fig[1, 1], xlabel = "x", ylabel = "P",[m
2026-02-09T19:17:19.8438673Z [32m+[m[32m    title = "Pressure relaxation"[m
2026-02-09T19:17:19.8439350Z [32m+[m[32m)[m
2026-02-09T19:17:19.8439839Z [32m+[m[32mscatter!(ax1, x_ssp, P_ssp, color = :blue, markersize = 6, label = "SSP3(4,3,3)")[m
2026-02-09T19:17:19.8440575Z [32m+[m[32mscatter!(ax1, x_ars, P_ars, color = :red, markersize = 6, label = "ARS(2,2,2)")[m
2026-02-09T19:17:19.8441360Z [32m+[m[32mhlines!(ax1, [P_target], color = :black, linestyle = :dash, label = L"P_{\mathrm{target}}")[m
2026-02-09T19:17:19.8442174Z [32m+[m[32mhlines!(ax1, [P_init], color = :gray, linestyle = :dot, label = L"P_{\mathrm{init}}")[m
2026-02-09T19:17:19.8443105Z [32m+[m[32maxislegend(ax1, position = :rt)[m
2026-02-09T19:17:19.8443604Z  [m
2026-02-09T19:17:19.8444004Z  ## Also check that density is preserved[m
2026-02-09T19:17:19.8444831Z  rho_ssp = [conserved_to_primitive(law, U_ssp[i])[1] for i in eachindex(U_ssp)][m
2026-02-09T19:17:19.8445715Z [31m-ax2 = Axis(fig[1, 2], xlabel="x", ylabel=L"\rho",[m
2026-02-09T19:17:19.8446199Z [31m-           title="Density (should be constant)")[m
2026-02-09T19:17:19.8446720Z [31m-scatter!(ax2, x_ssp, rho_ssp, color=:blue, markersize=6)[m
2026-02-09T19:17:19.8447384Z [31m-hlines!(ax2, [rho_init], color=:black, linestyle=:dash)[m
2026-02-09T19:17:19.8447813Z [32m+[m[32max2 = Axis([m
2026-02-09T19:17:19.8448173Z [32m+[m[32m    fig[1, 2], xlabel = "x", ylabel = L"\rho",[m
2026-02-09T19:17:19.8448638Z [32m+[m[32m    title = "Density (should be constant)"[m
2026-02-09T19:17:19.8449114Z [32m+[m[32m)[m
2026-02-09T19:17:19.8449524Z [32m+[m[32mscatter!(ax2, x_ssp, rho_ssp, color = :blue, markersize = 6)[m
2026-02-09T19:17:19.8450129Z [32m+[m[32mhlines!(ax2, [rho_init], color = :black, linestyle = :dash)[m
2026-02-09T19:17:19.8450544Z  [m
2026-02-09T19:17:19.8450779Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8451031Z  fig[m
2026-02-09T19:17:19.8451648Z [34m[  9/151] Checking `docs/src/literate_hyperbolic/kelvin_helmholtz_instability.jl`  [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8452525Z [1mdiff --git a/kelvin_helmholtz_instability.jl b/kelvin_helmholtz_instability.jl[m
2026-02-09T19:17:19.8453074Z [1mindex 8349924..3a32dde 100644[m
2026-02-09T19:17:19.8453442Z [1m--- a/kelvin_helmholtz_instability.jl[m
2026-02-09T19:17:19.8453844Z [1m+++ b/kelvin_helmholtz_instability.jl[m
2026-02-09T19:17:19.8454251Z [36m@@ -40,11 +40,11 @@[m [mfunction kh_ic(x, y)[m
2026-02-09T19:17:19.8454597Z      sigma = 0.05[m
2026-02-09T19:17:19.8454876Z      rho = rho1 + (rho2 - rho1) * ([m
2026-02-09T19:17:19.8455241Z          0.5 * (1.0 + tanh((y - 0.25) / sigma)) -[m
2026-02-09T19:17:19.8455622Z [31m-        0.5 * (1.0 + tanh((y - 0.75) / sigma))[m
2026-02-09T19:17:19.8456043Z [32m+[m[32m            0.5 * (1.0 + tanh((y - 0.75) / sigma))[m
2026-02-09T19:17:19.8456375Z      )[m
2026-02-09T19:17:19.8456659Z      vx_smooth = -v_shear + 2 * v_shear * ([m
2026-02-09T19:17:19.8457040Z          0.5 * (1.0 + tanh((y - 0.25) / sigma)) -[m
2026-02-09T19:17:19.8457421Z [31m-        0.5 * (1.0 + tanh((y - 0.75) / sigma))[m
2026-02-09T19:17:19.8457825Z [32m+[m[32m            0.5 * (1.0 + tanh((y - 0.75) / sigma))[m
2026-02-09T19:17:19.8458151Z      )[m
2026-02-09T19:17:19.8458517Z      ## Sinusoidal perturbation in vy to seed the instability[m
2026-02-09T19:17:19.8459203Z      vy = A_pert * sin(4 * pi * x)[m
2026-02-09T19:17:19.8459621Z [36m@@ -62,7 +62,7 @@[m [mprob_low = HyperbolicProblem2D([m
2026-02-09T19:17:19.8460181Z      law, mesh_low, HLLCSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.8460761Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8461270Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8461919Z [31m-    kh_ic; final_time=t_final, cfl=0.4[m
2026-02-09T19:17:19.8462352Z [32m+[m[32m    kh_ic; final_time = t_final, cfl = 0.4[m
2026-02-09T19:17:19.8462694Z  )[m
2026-02-09T19:17:19.8463389Z  coords_low, U_low, _ = solve_hyperbolic(prob_low)[m
2026-02-09T19:17:19.8463907Z  [m
2026-02-09T19:17:19.8464255Z [36m@@ -72,7 +72,7 @@[m [mprob_high = HyperbolicProblem2D([m
2026-02-09T19:17:19.8464833Z      law, mesh_high, HLLCSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.8465428Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8465948Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8466412Z [31m-    kh_ic; final_time=t_final, cfl=0.4[m
2026-02-09T19:17:19.8466851Z [32m+[m[32m    kh_ic; final_time = t_final, cfl = 0.4[m
2026-02-09T19:17:19.8467193Z  )[m
2026-02-09T19:17:19.8467563Z  coords_high, U_high, t_end = solve_hyperbolic(prob_high)[m
2026-02-09T19:17:19.8467997Z  coords_high |> tc #hide[m
2026-02-09T19:17:19.8468359Z [36m@@ -80,21 +80,25 @@[m [mcoords_high |> tc #hide[m
2026-02-09T19:17:19.8468846Z  # ## Visualisation[m
2026-02-09T19:17:19.8469129Z  using CairoMakie[m
2026-02-09T19:17:19.8469367Z  [m
2026-02-09T19:17:19.8469657Z [31m-fig = Figure(fontsize=24, size=(1100, 500))[m
2026-02-09T19:17:19.8470119Z [32m+[m[32mfig = Figure(fontsize = 24, size = (1100, 500))[m
2026-02-09T19:17:19.8470468Z  [m
2026-02-09T19:17:19.8470763Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8471249Z [31m-           title="Density (N=$(N_low))", aspect=DataAspect())[m
2026-02-09T19:17:19.8471665Z [32m+[m[32max1 = Axis([m
2026-02-09T19:17:19.8472008Z [32m+[m[32m    fig[1, 1], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8472512Z [32m+[m[32m    title = "Density (N=$(N_low))", aspect = DataAspect()[m
2026-02-09T19:17:19.8472917Z [32m+[m[32m)[m
2026-02-09T19:17:19.8473213Z  xc_l = [coords_low[1][i] for i in 1:N_low][m
2026-02-09T19:17:19.8473611Z  yc_l = [coords_low[2][j] for j in 1:N_low][m
2026-02-09T19:17:19.8474161Z  rho_low = [conserved_to_primitive(law, U_low[i, j])[1] for i in 1:N_low, j in 1:N_low][m
2026-02-09T19:17:19.8474815Z [31m-hm1 = heatmap!(ax1, xc_l, yc_l, rho_low, colormap=:viridis)[m
2026-02-09T19:17:19.8475393Z [32m+[m[32mhm1 = heatmap!(ax1, xc_l, yc_l, rho_low, colormap = :viridis)[m
2026-02-09T19:17:19.8475810Z  [m
2026-02-09T19:17:19.8476096Z [31m-ax2 = Axis(fig[1, 2], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8476581Z [31m-           title="Density (N=$(N_high))", aspect=DataAspect())[m
2026-02-09T19:17:19.8477242Z [32m+[m[32max2 = Axis([m
2026-02-09T19:17:19.8477826Z [32m+[m[32m    fig[1, 2], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8478496Z [32m+[m[32m    title = "Density (N=$(N_high))", aspect = DataAspect()[m
2026-02-09T19:17:19.8479118Z [32m+[m[32m)[m
2026-02-09T19:17:19.8479435Z  xc_h = [coords_high[1][i] for i in 1:N_high][m
2026-02-09T19:17:19.8479851Z  yc_h = [coords_high[2][j] for j in 1:N_high][m
2026-02-09T19:17:19.8480438Z  rho_high = [conserved_to_primitive(law, U_high[i, j])[1] for i in 1:N_high, j in 1:N_high][m
2026-02-09T19:17:19.8481105Z [31m-hm2 = heatmap!(ax2, xc_h, yc_h, rho_high, colormap=:viridis)[m
2026-02-09T19:17:19.8481703Z [32m+[m[32mhm2 = heatmap!(ax2, xc_h, yc_h, rho_high, colormap = :viridis)[m
2026-02-09T19:17:19.8482177Z  Colorbar(fig[1, 3], hm2)[m
2026-02-09T19:17:19.8482573Z  [m
2026-02-09T19:17:19.8482819Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8483450Z [34m[ 10/151] Checking `docs/src/literate_hyperbolic/orszag_tang_vortex.jl` ...... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8484180Z [1mdiff --git a/orszag_tang_vortex.jl b/orszag_tang_vortex.jl[m
2026-02-09T19:17:19.8484641Z [1mindex f26ff44..b806dae 100644[m
2026-02-09T19:17:19.8484975Z [1m--- a/orszag_tang_vortex.jl[m
2026-02-09T19:17:19.8485316Z [1m+++ b/orszag_tang_vortex.jl[m
2026-02-09T19:17:19.8485623Z [36m@@ -47,7 +47,7 @@[m [mend[m
2026-02-09T19:17:19.8486326Z  # $B_x = \partial A_z/\partial y$ and $B_y = -\partial A_z/\partial x$ is:[m
2026-02-09T19:17:19.8486788Z  function Az_ot(x, y)[m
2026-02-09T19:17:19.8487156Z      return cos(2 * pi * y) / (2 * pi * sqrt(4 * pi)) +[m
2026-02-09T19:17:19.8487710Z [31m-           cos(4 * pi * x) / (4 * pi * sqrt(4 * pi))[m
2026-02-09T19:17:19.8488137Z [32m+[m[32m        cos(4 * pi * x) / (4 * pi * sqrt(4 * pi))[m
2026-02-09T19:17:19.8488480Z  end[m
2026-02-09T19:17:19.8488670Z  [m
2026-02-09T19:17:19.8489006Z  # ## Solving[m
2026-02-09T19:17:19.8489346Z [36m@@ -56,12 +56,12 @@[m [mprob = HyperbolicProblem2D([m
2026-02-09T19:17:19.8489886Z      law, mesh, HLLDSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.8490446Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8490971Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.8491426Z [31m-    ot_ic; final_time=0.5, cfl=0.4[m
2026-02-09T19:17:19.8491822Z [32m+[m[32m    ot_ic; final_time = 0.5, cfl = 0.4[m
2026-02-09T19:17:19.8492143Z  )[m
2026-02-09T19:17:19.8492329Z  [m
2026-02-09T19:17:19.8492745Z  # The `vector_potential` keyword tells `solve_hyperbolic` to initialise[m
2026-02-09T19:17:19.8493437Z  # the face-centred magnetic field from $A_z$ via Stokes' theorem:[m
2026-02-09T19:17:19.8494093Z [31m-coords, U, t_final, ct = solve_hyperbolic(prob; vector_potential=Az_ot)[m
2026-02-09T19:17:19.8494806Z [32m+[m[32mcoords, U, t_final, ct = solve_hyperbolic(prob; vector_potential = Az_ot)[m
2026-02-09T19:17:19.8495309Z  coords |> tc #hide[m
2026-02-09T19:17:19.8495547Z  [m
2026-02-09T19:17:19.8495792Z  # ## Checking $\nabla\cdot\vb B$[m
2026-02-09T19:17:19.8496156Z [36m@@ -69,7 +69,7 @@[m [mcoords |> tc #hide[m
2026-02-09T19:17:19.8496728Z  # at machine precision:[m
2026-02-09T19:17:19.8497278Z  divB_max = max_divB(ct, mesh)[m
2026-02-09T19:17:19.8497593Z  [m
2026-02-09T19:17:19.8497848Z [31m-@assert divB_max < 1e-12 #hide[m
2026-02-09T19:17:19.8498229Z [32m+[m[32m@assert divB_max < 1.0e-12 #hide[m
2026-02-09T19:17:19.8498538Z  [m
2026-02-09T19:17:19.8498872Z  # ## Visualisation[m
2026-02-09T19:17:19.8499201Z  using CairoMakie[m
2026-02-09T19:17:19.8499572Z [36m@@ -80,15 +80,19 @@[m [myc = [coords[2][j] for j in 1:ny][m
2026-02-09T19:17:19.8500129Z  rho = [conserved_to_primitive(law, U[i, j])[1] for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.8500766Z  P_vals = [conserved_to_primitive(law, U[i, j])[5] for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.8501198Z  [m
2026-02-09T19:17:19.8501492Z [31m-fig = Figure(fontsize=24, size=(1100, 500))[m
2026-02-09T19:17:19.8501919Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8502496Z [31m-           title="Density at t = $(round(t_final, digits=2))", aspect=DataAspect())[m
2026-02-09T19:17:19.8503100Z [31m-hm1 = heatmap!(ax1, xc, yc, rho, colormap=:viridis)[m
2026-02-09T19:17:19.8503599Z [32m+[m[32mfig = Figure(fontsize = 24, size = (1100, 500))[m
2026-02-09T19:17:19.8503993Z [32m+[m[32max1 = Axis([m
2026-02-09T19:17:19.8504339Z [32m+[m[32m    fig[1, 1], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8504944Z [32m+[m[32m    title = "Density at t = $(round(t_final, digits = 2))", aspect = DataAspect()[m
2026-02-09T19:17:19.8505450Z [32m+[m[32m)[m
2026-02-09T19:17:19.8505821Z [32m+[m[32mhm1 = heatmap!(ax1, xc, yc, rho, colormap = :viridis)[m
2026-02-09T19:17:19.8506250Z  Colorbar(fig[1, 2], hm1)[m
2026-02-09T19:17:19.8506497Z  [m
2026-02-09T19:17:19.8506791Z [31m-ax2 = Axis(fig[1, 3], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.8507236Z [31m-           title="Pressure", aspect=DataAspect())[m
2026-02-09T19:17:19.8507727Z [31m-hm2 = heatmap!(ax2, xc, yc, P_vals, colormap=:magma)[m
2026-02-09T19:17:19.8508127Z [32m+[m[32max2 = Axis([m
2026-02-09T19:17:19.8508472Z [32m+[m[32m    fig[1, 3], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.8509040Z [32m+[m[32m    title = "Pressure", aspect = DataAspect()[m
2026-02-09T19:17:19.8509575Z [32m+[m[32m)[m
2026-02-09T19:17:19.8509949Z [32m+[m[32mhm2 = heatmap!(ax2, xc, yc, P_vals, colormap = :magma)[m
2026-02-09T19:17:19.8510457Z  Colorbar(fig[1, 4], hm2)[m
2026-02-09T19:17:19.8510987Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8511486Z  fig[m
2026-02-09T19:17:19.8512071Z [34m[ 11/151] Checking `docs/src/literate_hyperbolic/sedov_blast_wave.jl` ........ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.8512781Z [1mdiff --git a/sedov_blast_wave.jl b/sedov_blast_wave.jl[m
2026-02-09T19:17:19.8513223Z [1mindex 2e3aa55..c1f6ad0 100644[m
2026-02-09T19:17:19.8513554Z [1m--- a/sedov_blast_wave.jl[m
2026-02-09T19:17:19.8513870Z [1m+++ b/sedov_blast_wave.jl[m
2026-02-09T19:17:19.8514175Z [36m@@ -24,7 +24,7 @@[m [mN = 50[m
2026-02-09T19:17:19.8514556Z  mesh = StructuredMesh2D(-1.0, 1.0, -1.0, 1.0, N, N)[m
2026-02-09T19:17:19.8514891Z  [m
2026-02-09T19:17:19.8515345Z  # The background pressure is very low, with a strong blast in the central cells:[m
2026-02-09T19:17:19.8516001Z [31m-P_bg = 1e-5[m
2026-02-09T19:17:19.8516268Z [32m+[m[32mP_bg = 1.0e-5[m
2026-02-09T19:17:19.8516535Z  P_blast = 1.0[m
2026-02-09T19:17:19.8516793Z  r_blast = 3.0 * mesh.dx[m
2026-02-09T19:17:19.8517035Z  [m
2026-02-09T19:17:19.8517354Z [36m@@ -39,7 +39,7 @@[m [mprob = HyperbolicProblem2D([m
2026-02-09T19:17:19.8517893Z      law, mesh, HLLCSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.8518405Z      TransmissiveBC(), TransmissiveBC(),[m
2026-02-09T19:17:19.8518999Z      TransmissiveBC(), TransmissiveBC(),[m
2026-02-09T19:17:19.8519409Z [31m-    sedov_ic; final_time=0.1, cfl=0.3[m
2026-02-09T19:17:19.8519833Z [32m+[m[32m    sedov_ic; final_time = 0.1, cfl = 0.3[m
2026-02-09T19:17:19.8520165Z  )[m
2026-02-09T19:17:19.8520466Z  coords, U, t_final = solve_hyperbolic(prob)[m
2026-02-09T19:17:19.8520826Z  coords |> tc #hide[m
2026-02-09T19:17:19.8521187Z [36m@@ -53,14 +53,16 @@[m [mxc = [coords[1][i] for i in 1:nx][m
2026-02-09T19:17:19.8521591Z  yc = [coords[2][j] for j in 1:ny][m
2026-02-09T19:17:19.8522084Z  rho = [conserved_to_primitive(law, U[i, j])[1] for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.8522513Z  [m
2026-02-09T19:17:19.8522801Z [31m-fig = Figure(fontsize=24, size=(1000, 500))[m
2026-02-09T19:17:19.8523441Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel="y", title="Density at t = $(round(t_final, digits=3))",[m
2026-02-09T19:17:19.8524021Z [31m-           aspect=DataAspect())[m
2026-02-09T19:17:19.8524452Z [31m-hm = heatmap!(ax1, xc, yc, rho, colormap=:inferno)[m
2026-02-09T19:17:19.8524938Z [32m+[m[32mfig = Figure(fontsize = 24, size = (1000, 500))[m
2026-02-09T19:17:19.8525324Z [32m+[m[32max1 = Axis([m
2026-02-09T19:17:19.8525877Z [32m+[m[32m    fig[1, 1], xlabel = "x", ylabel = "y", title = "Density at t = $(round(t_final, digits = 3))",[m
2026-02-09T19:17:19.8526464Z [32m+[m[32m    aspect = DataAspect()[m
2026-02-09T19:17:19.8526780Z [32m+[m[32m)[m
2026-02-09T19:17:19.8527149Z [32m+[m[32mhm = heatmap!(ax1, xc, yc, rho, colormap = :inferno)[m
2026-02-09T19:17:19.8527584Z  Colorbar(fig[1, 2], hm)[m
2026-02-09T19:17:19.8527829Z  [m
2026-02-09T19:17:19.8528244Z  # We also plot the radial density profile to check cylindrical symmetry:[m
2026-02-09T19:17:19.8529020Z [31m-ax2 = Axis(fig[1, 3], xlabel="r", ylabel=L"\rho", title="Radial profile")[m
2026-02-09T19:17:19.8529708Z [32m+[m[32max2 = Axis(fig[1, 3], xlabel = "r", ylabel = L"\rho", title = "Radial profile")[m
2026-02-09T19:17:19.8530210Z  r_vals = Float64[][m
2026-02-09T19:17:19.8530484Z  rho_vals = Float64[][m
2026-02-09T19:17:19.8530781Z  for i in 1:nx, j in 1:ny[m
2026-02-09T19:17:19.8531126Z [36m@@ -68,7 +70,7 @@[m [mfor i in 1:nx, j in 1:ny[m
2026-02-09T19:17:19.8531487Z      push!(r_vals, r)[m
2026-02-09T19:17:19.8531780Z      push!(rho_vals, rho[i, j])[m
2026-02-09T19:17:19.8532060Z  end[m
2026-02-09T19:17:19.8532426Z [31m-scatter!(ax2, r_vals, rho_vals, color=:blue, markersize=3)[m
2026-02-09T19:17:19.8533035Z [32m+[m[32mscatter!(ax2, r_vals, rho_vals, color = :blue, markersize = 3)[m
2026-02-09T19:17:19.8533668Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.8533929Z  fig[m
2026-02-09T19:17:19.8534374Z  @test_reference joinpath(@__DIR__, "../figures", "sedov_blast_wave.png") fig #src[m
2026-02-09T19:17:19.9315598Z [34m[ 12/151] Checking `docs/src/literate_hyperbolic/sod_shock_tube.jl` .......... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.9334489Z [1mdiff --git a/sod_shock_tube.jl b/sod_shock_tube.jl[m
2026-02-09T19:17:19.9335196Z [1mindex 24d402b..275df09 100644[m
2026-02-09T19:17:19.9335576Z [1m--- a/sod_shock_tube.jl[m
2026-02-09T19:17:19.9335971Z [1m+++ b/sod_shock_tube.jl[m
2026-02-09T19:17:19.9336521Z [36m@@ -46,7 +46,7 @@[m [mic(x) = x < 0.5 ? wL : wR[m
2026-02-09T19:17:19.9337140Z  prob_hllc = HyperbolicProblem([m
2026-02-09T19:17:19.9337864Z      law, mesh, HLLCSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.9338559Z      bc_left, bc_right, ic;[m
2026-02-09T19:17:19.9339338Z [31m-    final_time=0.2, cfl=0.5[m
2026-02-09T19:17:19.9339930Z [32m+[m[32m    final_time = 0.2, cfl = 0.5[m
2026-02-09T19:17:19.9340456Z  )[m
2026-02-09T19:17:19.9340954Z  x_hllc, U_hllc, t_hllc = solve_hyperbolic(prob_hllc)[m
2026-02-09T19:17:19.9341561Z  x_hllc |> tc #hide[m
2026-02-09T19:17:19.9342047Z [36m@@ -57,7 +57,7 @@[m [mx_hllc |> tc #hide[m
2026-02-09T19:17:19.9342632Z  prob_hll = HyperbolicProblem([m
2026-02-09T19:17:19.9343337Z      law, mesh, HLLSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.9344030Z      bc_left, bc_right, ic;[m
2026-02-09T19:17:19.9344515Z [31m-    final_time=0.2, cfl=0.5[m
2026-02-09T19:17:19.9345093Z [32m+[m[32m    final_time = 0.2, cfl = 0.5[m
2026-02-09T19:17:19.9345564Z  )[m
2026-02-09T19:17:19.9346018Z  x_hll, U_hll, t_hll = solve_hyperbolic(prob_hll)[m
2026-02-09T19:17:19.9346534Z  [m
2026-02-09T19:17:19.9347112Z [36m@@ -65,7 +65,7 @@[m [mx_hll, U_hll, t_hll = solve_hyperbolic(prob_hll)[m
2026-02-09T19:17:19.9348121Z  # The exact Riemann solution for the Sod problem consists of five constant[m
2026-02-09T19:17:19.9349385Z  # states separated by a rarefaction, contact, and shock. The pre-computed[m
2026-02-09T19:17:19.9350170Z  # star-region values are:[m
2026-02-09T19:17:19.9350763Z [31m-function sod_exact(x, t; x0=0.5, gamma=1.4)[m
2026-02-09T19:17:19.9351498Z [32m+[m[32mfunction sod_exact(x, t; x0 = 0.5, gamma = 1.4)[m
2026-02-09T19:17:19.9352156Z      rhoL, vL, PL = 1.0, 0.0, 1.0[m
2026-02-09T19:17:19.9352675Z      rhoR, vR, PR = 0.125, 0.0, 0.1[m
2026-02-09T19:17:19.9353198Z      cL = sqrt(gamma * PL / rhoL)[m
2026-02-09T19:17:19.9353908Z [36m@@ -77,7 +77,7 @@[m [mfunction sod_exact(x, t; x0=0.5, gamma=1.4)[m
2026-02-09T19:17:19.9354671Z      c_star_L = sqrt(gamma * P_star / rho_star_L)[m
2026-02-09T19:17:19.9355244Z      ## Shock speed[m
2026-02-09T19:17:19.9355770Z      S_shock = v_star + 1.0 / (gamma * rho_star_R) *[m
2026-02-09T19:17:19.9356459Z [31m-              (P_star - PR) / (v_star - vR + 1e-30)[m
2026-02-09T19:17:19.9357180Z [32m+[m[32m        (P_star - PR) / (v_star - vR + 1.0e-30)[m
2026-02-09T19:17:19.9357782Z      xi = (x - x0) / t[m
2026-02-09T19:17:19.9358205Z      if xi < -cL[m
2026-02-09T19:17:19.9358629Z          return rhoL, vL, PL[m
2026-02-09T19:17:19.9359353Z [36m@@ -101,7 +101,7 @@[m [mend[m
2026-02-09T19:17:19.9360088Z  # We now compare the numerical solutions against the exact solution.[m
2026-02-09T19:17:19.9360811Z  using CairoMakie[m
2026-02-09T19:17:19.9361180Z  [m
2026-02-09T19:17:19.9361610Z [31m-x_exact = range(0.0, 1.0, length=1000)[m
2026-02-09T19:17:19.9362265Z [32m+[m[32mx_exact = range(0.0, 1.0, length = 1000)[m
2026-02-09T19:17:19.9362993Z  rho_exact = [sod_exact(xi, 0.2)[1] for xi in x_exact][m
2026-02-09T19:17:19.9363698Z  v_exact = [sod_exact(xi, 0.2)[2] for xi in x_exact][m
2026-02-09T19:17:19.9364394Z  P_exact = [sod_exact(xi, 0.2)[3] for xi in x_exact][m
2026-02-09T19:17:19.9365462Z [36m@@ -115,20 +115,20 @@[m [mrho_hll = [conserved_to_primitive(law, U_hll[i])[1] for i in eachindex(U_hll)][m
2026-02-09T19:17:19.9366964Z  v_hll = [conserved_to_primitive(law, U_hll[i])[2] for i in eachindex(U_hll)][m
2026-02-09T19:17:19.9368019Z  P_hll = [conserved_to_primitive(law, U_hll[i])[3] for i in eachindex(U_hll)][m
2026-02-09T19:17:19.9369171Z  [m
2026-02-09T19:17:19.9369645Z [31m-fig = Figure(fontsize=24, size=(1200, 400))[m
2026-02-09T19:17:19.9370449Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel=L"\rho", title="Density")[m
2026-02-09T19:17:19.9371401Z [31m-ax2 = Axis(fig[1, 2], xlabel="x", ylabel="v", title="Velocity")[m
2026-02-09T19:17:19.9372331Z [31m-ax3 = Axis(fig[1, 3], xlabel="x", ylabel="P", title="Pressure")[m
2026-02-09T19:17:19.9373332Z [31m-lines!(ax1, x_exact, rho_exact, color=:black, linewidth=2, label="Exact")[m
2026-02-09T19:17:19.9374426Z [31m-scatter!(ax1, x_hllc, rho_hllc, color=:blue, markersize=4, label="HLLC")[m
2026-02-09T19:17:19.9375129Z [31m-scatter!(ax1, x_hll, rho_hll, color=:red, markersize=4, label="HLL")[m
2026-02-09T19:17:19.9375748Z [31m-lines!(ax2, x_exact, v_exact, color=:black, linewidth=2)[m
2026-02-09T19:17:19.9376409Z [31m-scatter!(ax2, x_hllc, v_hllc, color=:blue, markersize=4)[m
2026-02-09T19:17:19.9376962Z [31m-scatter!(ax2, x_hll, v_hll, color=:red, markersize=4)[m
2026-02-09T19:17:19.9377506Z [31m-lines!(ax3, x_exact, P_exact, color=:black, linewidth=2)[m
2026-02-09T19:17:19.9378042Z [31m-scatter!(ax3, x_hllc, P_hllc, color=:blue, markersize=4)[m
2026-02-09T19:17:19.9378573Z [31m-scatter!(ax3, x_hll, P_hll, color=:red, markersize=4)[m
2026-02-09T19:17:19.9379235Z [31m-axislegend(ax1, position=:cb)[m
2026-02-09T19:17:19.9379679Z [32m+[m[32mfig = Figure(fontsize = 24, size = (1200, 400))[m
2026-02-09T19:17:19.9380243Z [32m+[m[32max1 = Axis(fig[1, 1], xlabel = "x", ylabel = L"\rho", title = "Density")[m
2026-02-09T19:17:19.9380875Z [32m+[m[32max2 = Axis(fig[1, 2], xlabel = "x", ylabel = "v", title = "Velocity")[m
2026-02-09T19:17:19.9381486Z [32m+[m[32max3 = Axis(fig[1, 3], xlabel = "x", ylabel = "P", title = "Pressure")[m
2026-02-09T19:17:19.9382173Z [32m+[m[32mlines!(ax1, x_exact, rho_exact, color = :black, linewidth = 2, label = "Exact")[m
2026-02-09T19:17:19.9382914Z [32m+[m[32mscatter!(ax1, x_hllc, rho_hllc, color = :blue, markersize = 4, label = "HLLC")[m
2026-02-09T19:17:19.9383641Z [32m+[m[32mscatter!(ax1, x_hll, rho_hll, color = :red, markersize = 4, label = "HLL")[m
2026-02-09T19:17:19.9384302Z [32m+[m[32mlines!(ax2, x_exact, v_exact, color = :black, linewidth = 2)[m
2026-02-09T19:17:19.9384935Z [32m+[m[32mscatter!(ax2, x_hllc, v_hllc, color = :blue, markersize = 4)[m
2026-02-09T19:17:19.9385526Z [32m+[m[32mscatter!(ax2, x_hll, v_hll, color = :red, markersize = 4)[m
2026-02-09T19:17:19.9386120Z [32m+[m[32mlines!(ax3, x_exact, P_exact, color = :black, linewidth = 2)[m
2026-02-09T19:17:19.9386960Z [32m+[m[32mscatter!(ax3, x_hllc, P_hllc, color = :blue, markersize = 4)[m
2026-02-09T19:17:19.9387775Z [32m+[m[32mscatter!(ax3, x_hll, P_hll, color = :red, markersize = 4)[m
2026-02-09T19:17:19.9388277Z [32m+[m[32maxislegend(ax1, position = :cb)[m
2026-02-09T19:17:19.9388872Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.9389323Z  fig[m
2026-02-09T19:17:19.9390021Z  @test_reference joinpath(@__DIR__, "../figures", "sod_shock_tube.png") fig #src[m
2026-02-09T19:17:19.9390972Z [36m@@ -143,7 +143,7 @@[m [mfunction compute_l1_error(N)[m
2026-02-09T19:17:19.9391718Z      m = StructuredMesh1D(0.0, 1.0, N)[m
2026-02-09T19:17:19.9392281Z      p = HyperbolicProblem([m
2026-02-09T19:17:19.9392982Z          law, m, HLLCSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.9393825Z [31m-        bc_left, bc_right, ic; final_time=0.2, cfl=0.5[m
2026-02-09T19:17:19.9394638Z [32m+[m[32m        bc_left, bc_right, ic; final_time = 0.2, cfl = 0.5[m
2026-02-09T19:17:19.9395255Z      )[m
2026-02-09T19:17:19.9395678Z      xx, UU, _ = solve_hyperbolic(p)[m
2026-02-09T19:17:19.9396165Z      err = 0.0[m
2026-02-09T19:17:19.9397362Z [34m[ 13/151] Checking `docs/src/literate_hyperbolic/taylor_green_vortex.jl` ..... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.9398511Z [1mdiff --git a/taylor_green_vortex.jl b/taylor_green_vortex.jl[m
2026-02-09T19:17:19.9399642Z [1mindex 3f33964..5b7191b 100644[m
2026-02-09T19:17:19.9400178Z [1m--- a/taylor_green_vortex.jl[m
2026-02-09T19:17:19.9400698Z [1m+++ b/taylor_green_vortex.jl[m
2026-02-09T19:17:19.9401234Z [36m@@ -23,7 +23,7 @@[m [mgamma = 1.4[m
2026-02-09T19:17:19.9401764Z  eos = IdealGasEOS(gamma)[m
2026-02-09T19:17:19.9402219Z  mu = 0.01[m
2026-02-09T19:17:19.9402567Z  Pr = 0.72[m
2026-02-09T19:17:19.9403103Z [31m-ns = NavierStokesEquations{2}(eos, mu=mu, Pr=Pr)[m
2026-02-09T19:17:19.9403931Z [32m+[m[32mns = NavierStokesEquations{2}(eos, mu = mu, Pr = Pr)[m
2026-02-09T19:17:19.9404558Z  [m
2026-02-09T19:17:19.9405081Z  # Physical parameters (low Mach number: $U_0 \ll c_s$):[m
2026-02-09T19:17:19.9405693Z  rho0 = 1.0[m
2026-02-09T19:17:19.9406239Z [36m@@ -49,7 +49,7 @@[m [mprob = HyperbolicProblem2D([m
2026-02-09T19:17:19.9407053Z      ns, mesh, HLLCSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.9407892Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.9408668Z      PeriodicHyperbolicBC(), PeriodicHyperbolicBC(),[m
2026-02-09T19:17:19.9409558Z [31m-    ic_tgv; final_time=t_final, cfl=0.3[m
2026-02-09T19:17:19.9410252Z [32m+[m[32m    ic_tgv; final_time = t_final, cfl = 0.3[m
2026-02-09T19:17:19.9410811Z  )[m
2026-02-09T19:17:19.9411287Z  coords, U, t_end = solve_hyperbolic(prob)[m
2026-02-09T19:17:19.9411842Z  coords |> tc #hide[m
2026-02-09T19:17:19.9412687Z [36m@@ -81,15 +81,19 @@[m [mvx_num = [conserved_to_primitive(ns, U[i, j])[2] for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.9413798Z  vy_num = [conserved_to_primitive(ns, U[i, j])[3] for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.9414779Z  vx_ex = [-U0 * cos(k * xc[i]) * sin(k * yc[j]) * decay for i in 1:nx, j in 1:ny][m
2026-02-09T19:17:19.9415426Z  [m
2026-02-09T19:17:19.9415887Z [31m-fig = Figure(fontsize=24, size=(1200, 500))[m
2026-02-09T19:17:19.9416572Z [31m-ax1 = Axis(fig[1, 1], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.9417360Z [31m-           title=L"v_x \text{ (numerical)}", aspect=DataAspect())[m
2026-02-09T19:17:19.9418196Z [31m-hm1 = heatmap!(ax1, xc, yc, vx_num, colormap=:RdBu)[m
2026-02-09T19:17:19.9419144Z [32m+[m[32mfig = Figure(fontsize = 24, size = (1200, 500))[m
2026-02-09T19:17:19.9419774Z [32m+[m[32max1 = Axis([m
2026-02-09T19:17:19.9420330Z [32m+[m[32m    fig[1, 1], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.9421146Z [32m+[m[32m    title = L"v_x \text{ (numerical)}", aspect = DataAspect()[m
2026-02-09T19:17:19.9421806Z [32m+[m[32m)[m
2026-02-09T19:17:19.9422404Z [32m+[m[32mhm1 = heatmap!(ax1, xc, yc, vx_num, colormap = :RdBu)[m
2026-02-09T19:17:19.9423079Z  Colorbar(fig[1, 2], hm1)[m
2026-02-09T19:17:19.9423476Z  [m
2026-02-09T19:17:19.9423940Z [31m-ax2 = Axis(fig[1, 3], xlabel="x", ylabel="y",[m
2026-02-09T19:17:19.9424700Z [31m-           title=L"v_x \text{ (exact)}", aspect=DataAspect())[m
2026-02-09T19:17:19.9425501Z [31m-hm2 = heatmap!(ax2, xc, yc, vx_ex, colormap=:RdBu)[m
2026-02-09T19:17:19.9426099Z [32m+[m[32max2 = Axis([m
2026-02-09T19:17:19.9426672Z [32m+[m[32m    fig[1, 3], xlabel = "x", ylabel = "y",[m
2026-02-09T19:17:19.9427439Z [32m+[m[32m    title = L"v_x \text{ (exact)}", aspect = DataAspect()[m
2026-02-09T19:17:19.9428091Z [32m+[m[32m)[m
2026-02-09T19:17:19.9428687Z [32m+[m[32mhm2 = heatmap!(ax2, xc, yc, vx_ex, colormap = :RdBu)[m
2026-02-09T19:17:19.9429511Z  Colorbar(fig[1, 4], hm2)[m
2026-02-09T19:17:19.9429979Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.9430377Z  fig[m
2026-02-09T19:17:19.9432983Z [34m[ 14/151] Checking `docs/src/literate_hyperbolic/weno_convergence.jl` ........ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:19.9448013Z [1mdiff --git a/weno_convergence.jl b/weno_convergence.jl[m
2026-02-09T19:17:19.9449178Z [1mindex c2eafea..f73ee56 100644[m
2026-02-09T19:17:19.9449700Z [1m--- a/weno_convergence.jl[m
2026-02-09T19:17:19.9450170Z [1m+++ b/weno_convergence.jl[m
2026-02-09T19:17:19.9450720Z [36m@@ -41,7 +41,7 @@[m [mfunction compute_error(N, recon)[m
2026-02-09T19:17:19.9451314Z      prob = HyperbolicProblem([m
2026-02-09T19:17:19.9451686Z          law, mesh, HLLCSolver(), recon,[m
2026-02-09T19:17:19.9452217Z          PeriodicHyperbolicBC(), PeriodicHyperbolicBC(), advection_ic;[m
2026-02-09T19:17:19.9452741Z [31m-        final_time=t_final, cfl=0.4[m
2026-02-09T19:17:19.9453156Z [32m+[m[32m        final_time = t_final, cfl = 0.4[m
2026-02-09T19:17:19.9453490Z      )[m
2026-02-09T19:17:19.9453770Z      x, U, t_end = solve_hyperbolic(prob)[m
2026-02-09T19:17:19.9454092Z      err = 0.0[m
2026-02-09T19:17:19.9454656Z [36m@@ -70,26 +70,36 @@[m [merr_char_weno3 = [compute_error(N, CharacteristicWENO(WENO3())) for N in resolut[m
2026-02-09T19:17:19.9455245Z  using CairoMakie[m
2026-02-09T19:17:19.9455487Z  [m
2026-02-09T19:17:19.9455753Z  function convergence_rate(errs)[m
2026-02-09T19:17:19.9456224Z [31m-    return [log2(errs[i] / errs[i+1]) for i in 1:length(errs)-1][m
2026-02-09T19:17:19.9456834Z [32m+[m[32m    return [log2(errs[i] / errs[i + 1]) for i in 1:(length(errs) - 1)][m
2026-02-09T19:17:19.9457277Z  end[m
2026-02-09T19:17:19.9457475Z  [m
2026-02-09T19:17:19.9457767Z  rates_muscl = convergence_rate(err_muscl)[m
2026-02-09T19:17:19.9458195Z  rates_weno3 = convergence_rate(err_weno3)[m
2026-02-09T19:17:19.9458626Z  rates_char = convergence_rate(err_char_weno3)[m
2026-02-09T19:17:19.9459257Z  [m
2026-02-09T19:17:19.9459559Z [31m-fig = Figure(fontsize=24, size=(600, 500))[m
2026-02-09T19:17:19.9460066Z [31m-ax = Axis(fig[1, 1], xlabel="N", ylabel=L"L^1 \text{ error}",[m
2026-02-09T19:17:19.9460703Z [31m-          xscale=log2, yscale=log10, title="Convergence: smooth density wave")[m
2026-02-09T19:17:19.9461440Z [31m-scatterlines!(ax, resolutions, err_muscl, label="MUSCL (minmod)", marker=:circle,[m
2026-02-09T19:17:19.9462089Z [31m-              color=:blue, linewidth=2, markersize=12)[m
2026-02-09T19:17:19.9462698Z [31m-scatterlines!(ax, resolutions, err_weno3, label="WENO-3", marker=:utriangle,[m
2026-02-09T19:17:19.9463313Z [31m-              color=:red, linewidth=2, markersize=12)[m
2026-02-09T19:17:19.9463957Z [31m-scatterlines!(ax, resolutions, err_char_weno3, label="Char. WENO-3", marker=:diamond,[m
2026-02-09T19:17:19.9464595Z [31m-              color=:green, linewidth=2, markersize=12)[m
2026-02-09T19:17:19.9465093Z [32m+[m[32mfig = Figure(fontsize = 24, size = (600, 500))[m
2026-02-09T19:17:19.9465470Z [32m+[m[32max = Axis([m
2026-02-09T19:17:19.9465876Z [32m+[m[32m    fig[1, 1], xlabel = "N", ylabel = L"L^1 \text{ error}",[m
2026-02-09T19:17:19.9466518Z [32m+[m[32m    xscale = log2, yscale = log10, title = "Convergence: smooth density wave"[m
2026-02-09T19:17:19.9467009Z [32m+[m[32m)[m
2026-02-09T19:17:19.9467275Z [32m+[m[32mscatterlines!([m
2026-02-09T19:17:19.9467782Z [32m+[m[32m    ax, resolutions, err_muscl, label = "MUSCL (minmod)", marker = :circle,[m
2026-02-09T19:17:19.9468401Z [32m+[m[32m    color = :blue, linewidth = 2, markersize = 12[m
2026-02-09T19:17:19.9469006Z [32m+[m[32m)[m
2026-02-09T19:17:19.9469279Z [32m+[m[32mscatterlines!([m
2026-02-09T19:17:19.9469770Z [32m+[m[32m    ax, resolutions, err_weno3, label = "WENO-3", marker = :utriangle,[m
2026-02-09T19:17:19.9470366Z [32m+[m[32m    color = :red, linewidth = 2, markersize = 12[m
2026-02-09T19:17:19.9470750Z [32m+[m[32m)[m
2026-02-09T19:17:19.9471003Z [32m+[m[32mscatterlines!([m
2026-02-09T19:17:19.9471532Z [32m+[m[32m    ax, resolutions, err_char_weno3, label = "Char. WENO-3", marker = :diamond,[m
2026-02-09T19:17:19.9472165Z [32m+[m[32m    color = :green, linewidth = 2, markersize = 12[m
2026-02-09T19:17:19.9472561Z [32m+[m[32m)[m
2026-02-09T19:17:19.9472803Z  ## Reference slope[m
2026-02-09T19:17:19.9473297Z [31m-lines!(ax, resolutions, err_muscl[1] .* (resolutions[1] ./ resolutions) .^ 2,[m
2026-02-09T19:17:19.9474119Z [31m-       color=:gray, linestyle=:dash, linewidth=1, label=L"O(N^{-2})")[m
2026-02-09T19:17:19.9474625Z [31m-axislegend(ax, position=:lb)[m
2026-02-09T19:17:19.9475063Z [32m+[m[32mlines!([m
2026-02-09T19:17:19.9475548Z [32m+[m[32m    ax, resolutions, err_muscl[1] .* (resolutions[1] ./ resolutions) .^ 2,[m
2026-02-09T19:17:19.9476252Z [32m+[m[32m    color = :gray, linestyle = :dash, linewidth = 1, label = L"O(N^{-2})"[m
2026-02-09T19:17:19.9476710Z [32m+[m[32m)[m
2026-02-09T19:17:19.9477016Z [32m+[m[32maxislegend(ax, position = :lb)[m
2026-02-09T19:17:19.9477380Z  resize_to_layout!(fig)[m
2026-02-09T19:17:19.9477643Z  fig[m
2026-02-09T19:17:19.9478117Z  @test_reference joinpath(@__DIR__, "../figures", "weno_convergence_smooth.png") fig #src[m
2026-02-09T19:17:19.9478993Z [36m@@ -107,14 +117,14 @@[m [mmesh_sod = StructuredMesh1D(0.0, 1.0, N_sod)[m
2026-02-09T19:17:19.9479492Z  prob_muscl = HyperbolicProblem([m
2026-02-09T19:17:19.9479992Z      law, mesh_sod, HLLCSolver(), CellCenteredMUSCL(MinmodLimiter()),[m
2026-02-09T19:17:19.9480637Z      DirichletHyperbolicBC(wL), DirichletHyperbolicBC(wR), sod_ic;[m
2026-02-09T19:17:19.9481125Z [31m-    final_time=0.2, cfl=0.4[m
2026-02-09T19:17:19.9481479Z [32m+[m[32m    final_time = 0.2, cfl = 0.4[m
2026-02-09T19:17:19.9481777Z  )[m
2026-02-09T19:17:19.9482067Z  x_m, U_m, _ = solve_hyperbolic(prob_muscl)[m
2026-02-09T19:17:19.9482392Z  [m
2026-02-09T19:17:19.9482654Z  prob_weno = HyperbolicProblem([m
2026-02-09T19:17:19.9483040Z      law, mesh_sod, HLLCSolver(), WENO3(),[m
2026-02-09T19:17:19.9483555Z      DirichletHyperbolicBC(wL), DirichletHyperbolicBC(wR), sod_ic;[m
2026-02-09T19:17:19.9484036Z [31m-    final_time=0.2, cfl=0.4[m
2026-02-09T19:17:19.9484380Z [32m+[m[32m    final_time = 0.2, cfl = 0.4[m
2026-02-09T19:17:19.9484683Z  )[m
2026-02-09T19:17:19.9484964Z  x_w, U_w, _ = solve_hyperbolic(prob_weno)[m
2026-02-09T19:17:19.9485306Z  x_w |> tc #hide[m
2026-02-09T19:17:19.9485590Z [36m@@ -122,12 +132,14 @@[m [mx_w |> tc #hide[m
2026-02-09T19:17:19.9486117Z  rho_muscl = [conserved_to_primitive(law, U_m[i])[1] for i in eachindex(U_m)][m
2026-02-09T19:17:19.9486791Z  rho_weno = [conserved_to_primitive(law, U_w[i])[1] for i in eachindex(U_w)][m
2026-02-09T19:17:19.9487230Z  [m
2026-02-09T19:17:19.9487521Z [31m-fig2 = Figure(fontsize=24, size=(600, 400))[m
2026-02-09T19:17:19.9487968Z [31m-ax2 = Axis(fig2[1, 1], xlabel="x", ylabel=L"\rho",[m
2026-02-09T19:17:19.9488442Z [31m-           title="Sod shock tube: MUSCL vs WENO-3")[m
2026-02-09T19:17:19.9489229Z [31m-scatter!(ax2, x_m, rho_muscl, color=:blue, markersize=4, label="MUSCL")[m
2026-02-09T19:17:19.9489894Z [31m-scatter!(ax2, x_w, rho_weno, color=:red, markersize=4, label="WENO-3")[m
2026-02-09T19:17:19.9490402Z [31m-axislegend(ax2, position=:cb)[m
2026-02-09T19:17:19.9490836Z [32m+[m[32mfig2 = Figure(fontsize = 24, size = (600, 400))[m
2026-02-09T19:17:19.9491233Z [32m+[m[32max2 = Axis([m
2026-02-09T19:17:19.9491592Z [32m+[m[32m    fig2[1, 1], xlabel = "x", ylabel = L"\rho",[m
2026-02-09T19:17:19.9492065Z [32m+[m[32m    title = "Sod shock tube: MUSCL vs WENO-3"[m
2026-02-09T19:17:19.9492432Z [32m+[m[32m)[m
2026-02-09T19:17:19.9492903Z [32m+[m[32mscatter!(ax2, x_m, rho_muscl, color = :blue, markersize = 4, label = "MUSCL")[m
2026-02-09T19:17:19.9493622Z [32m+[m[32mscatter!(ax2, x_w, rho_weno, color = :red, markersize = 4, label = "WENO-3")[m
2026-02-09T19:17:19.9494270Z [32m+[m[32maxislegend(ax2, position = :cb)[m
2026-02-09T19:17:19.9494834Z  resize_to_layout!(fig2)[m
2026-02-09T19:17:19.9495222Z  fig2[m
2026-02-09T19:17:19.9495918Z  @test_reference joinpath(@__DIR__, "../figures", "weno_convergence_sod.png") fig2 #src[m
2026-02-09T19:17:19.9497458Z [34m[ 15/151] Checking `docs/src/literate_tutorials/diffusion_equation_in_a_wedge_with_mixed_boundary_conditions.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9520880Z [34m[ 16/151] Checking `docs/src/literate_tutorials/diffusion_equation_on_a_square_plate.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9550323Z [34m[ 17/151] Checking `docs/src/literate_tutorials/diffusion_equation_on_an_annulus.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9567619Z [34m[ 18/151] Checking `docs/src/literate_tutorials/equilibrium_temperature_distribution_with_mixed_boundary_conditions_and_using_ensembleproblems.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9589457Z [34m[ 19/151] Checking `docs/src/literate_tutorials/gray_scott_model_turing_patterns_from_a_coupled_reaction_diffusion_system.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9603281Z [34m[ 20/151] Checking `docs/src/literate_tutorials/helmholtz_equation_with_inhomogeneous_boundary_conditions.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9617134Z [34m[ 21/151] Checking `docs/src/literate_tutorials/laplaces_equation_with_internal_dirichlet_conditions.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9673180Z [34m[ 22/151] Checking `docs/src/literate_tutorials/mean_exit_time.jl` ........... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9732349Z [34m[ 23/151] Checking `docs/src/literate_tutorials/piecewise_linear_and_natural_neighbour_interpolation_for_an_advection_diffusion_equation.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9751030Z [34m[ 24/151] Checking `docs/src/literate_tutorials/porous_fisher_equation_and_travelling_waves.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9797734Z [34m[ 25/151] Checking `docs/src/literate_tutorials/porous_medium_equation.jl` ... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9825116Z [34m[ 26/151] Checking `docs/src/literate_tutorials/reaction_diffusion_brusselator_system_of_pdes.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9845920Z [34m[ 27/151] Checking `docs/src/literate_tutorials/reaction_diffusion_equation_with_a_time_dependent_dirichlet_boundary_condition_on_a_disk.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9863741Z [34m[ 28/151] Checking `docs/src/literate_tutorials/solving_mazes_with_laplaces_equation.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9934020Z [34m[ 29/151] Checking `docs/src/literate_wyos/diffusion_equations.jl` ........... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9961396Z [34m[ 30/151] Checking `docs/src/literate_wyos/laplaces_equation.jl` ............. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:19.9988214Z [34m[ 31/151] Checking `docs/src/literate_wyos/linear_reaction_diffusion_equations.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.0021306Z [34m[ 32/151] Checking `docs/src/literate_wyos/mean_exit_time.jl` ................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.0073793Z [34m[ 33/151] Checking `docs/src/literate_wyos/poissons_equation.jl` ............. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.0182978Z [34m[ 34/151] Checking `src/FiniteVolumeMethod.jl` ............................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.0202228Z [34m[ 35/151] Checking `src/amr/amr_grid.jl` ..................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0219261Z [1mdiff --git a/amr_grid.jl b/amr_grid.jl[m
2026-02-09T19:17:20.0219900Z [1mindex 287a915..59a8fd3 100644[m
2026-02-09T19:17:20.0220376Z [1m--- a/amr_grid.jl[m
2026-02-09T19:17:20.0220809Z [1m+++ b/amr_grid.jl[m
2026-02-09T19:17:20.0221165Z [36m@@ -47,9 +47,11 @@[m [mend[m
2026-02-09T19:17:20.0221432Z  [m
2026-02-09T19:17:20.0221706Z  Create a zero-initialized AMR block.[m
2026-02-09T19:17:20.0222030Z  """[m
2026-02-09T19:17:20.0227295Z [31m-function AMRBlock(id::Int, level::Int, origin::NTuple{Dim, FT},[m
2026-02-09T19:17:20.0227845Z [32m+[m[32mfunction AMRBlock([m
2026-02-09T19:17:20.0228379Z [32m+[m[32m        id::Int, level::Int, origin::NTuple{Dim, FT},[m
2026-02-09T19:17:20.0229159Z          dims::NTuple{Dim, Int}, dx::NTuple{Dim, FT},[m
2026-02-09T19:17:20.0229620Z [31m-        ::Val{N}) where {N, FT, Dim}[m
2026-02-09T19:17:20.0229983Z [32m+[m[32m        ::Val{N}[m
2026-02-09T19:17:20.0230547Z [32m+[m[32m    ) where {N, FT, Dim}[m
2026-02-09T19:17:20.0230904Z      zero_state = zero(SVector{N, FT})[m
2026-02-09T19:17:20.0231259Z      U = fill(zero_state, dims...)[m
2026-02-09T19:17:20.0231872Z      return AMRBlock{N, FT, Dim}(id, level, origin, dims, dx, U, -1, Int[], true, Dict{Symbol, Int}())[m
2026-02-09T19:17:20.0232847Z [36m@@ -106,10 +108,12 @@[m [mCreate an AMR grid with a single root block covering the entire domain.[m
2026-02-09T19:17:20.0233501Z  - `domain_lo`: Lower corner of the domain (tuple).[m
2026-02-09T19:17:20.0233977Z  - `domain_hi`: Upper corner of the domain (tuple).[m
2026-02-09T19:17:20.0234330Z  """[m
2026-02-09T19:17:20.0234780Z [31m-function AMRGrid(law, criterion::AbstractRefinementCriterion,[m
2026-02-09T19:17:20.0235296Z [32m+[m[32mfunction AMRGrid([m
2026-02-09T19:17:20.0235771Z [32m+[m[32m        law, criterion::AbstractRefinementCriterion,[m
2026-02-09T19:17:20.0236294Z          block_size::NTuple{Dim, Int}, max_level::Int,[m
2026-02-09T19:17:20.0236813Z          domain_lo::NTuple{Dim, FT}, domain_hi::NTuple{Dim, FT},[m
2026-02-09T19:17:20.0237284Z [31m-        ::Val{N}) where {N, FT, Dim}[m
2026-02-09T19:17:20.0237659Z [32m+[m[32m        ::Val{N}[m
2026-02-09T19:17:20.0237967Z [32m+[m[32m    ) where {N, FT, Dim}[m
2026-02-09T19:17:20.0238308Z      # Compute dx for root level[m
2026-02-09T19:17:20.0239045Z      dx = ntuple(d -> (domain_hi[d] - domain_lo[d]) / block_size[d], Val(Dim))[m
2026-02-09T19:17:20.0239491Z  [m
2026-02-09T19:17:20.0319330Z [34m[ 36/151] Checking `src/amr/amr_solve.jl` .................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0335007Z [1mdiff --git a/amr_solve.jl b/amr_solve.jl[m
2026-02-09T19:17:20.0335639Z [1mindex 2605831..b1e5dc8 100644[m
2026-02-09T19:17:20.0336122Z [1m--- a/amr_solve.jl[m
2026-02-09T19:17:20.0336556Z [1m+++ b/amr_solve.jl[m
2026-02-09T19:17:20.0337107Z [36m@@ -40,10 +40,14 @@[m [mstruct AMRProblem{Grid, RS, Rec, BCs, FT}[m
2026-02-09T19:17:20.0337600Z      regrid_interval::Int[m
2026-02-09T19:17:20.0337871Z  end[m
2026-02-09T19:17:20.0338061Z  [m
2026-02-09T19:17:20.0338550Z [31m-function AMRProblem(grid, riemann_solver, reconstruction, boundary_conditions;[m
2026-02-09T19:17:20.0339524Z [31m-        initial_time = 0.0, final_time, cfl = 0.4, regrid_interval = 4)[m
2026-02-09T19:17:20.0356847Z [31m-    return AMRProblem(grid, riemann_solver, reconstruction, boundary_conditions,[m
2026-02-09T19:17:20.0357689Z [31m-        initial_time, final_time, cfl, regrid_interval)[m
2026-02-09T19:17:20.0358149Z [32m+[m[32mfunction AMRProblem([m
2026-02-09T19:17:20.0358672Z [32m+[m[32m        grid, riemann_solver, reconstruction, boundary_conditions;[m
2026-02-09T19:17:20.0359556Z [32m+[m[32m        initial_time = 0.0, final_time, cfl = 0.4, regrid_interval = 4[m
2026-02-09T19:17:20.0360018Z [32m+[m[32m    )[m
2026-02-09T19:17:20.0360304Z [32m+[m[32m    return AMRProblem([m
2026-02-09T19:17:20.0360819Z [32m+[m[32m        grid, riemann_solver, reconstruction, boundary_conditions,[m
2026-02-09T19:17:20.0361431Z [32m+[m[32m        initial_time, final_time, cfl, regrid_interval[m
2026-02-09T19:17:20.0361841Z [32m+[m[32m    )[m
2026-02-09T19:17:20.0362075Z  end[m
2026-02-09T19:17:20.0362281Z  [m
2026-02-09T19:17:20.0362470Z  """[m
2026-02-09T19:17:20.0401496Z [34m[ 37/151] Checking `src/amr/flux_correction.jl` .............................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0415935Z [1mdiff --git a/flux_correction.jl b/flux_correction.jl[m
2026-02-09T19:17:20.0416650Z [1mindex f22f891..43c9f72 100644[m
2026-02-09T19:17:20.0417163Z [1m--- a/flux_correction.jl[m
2026-02-09T19:17:20.0417626Z [1m+++ b/flux_correction.jl[m
2026-02-09T19:17:20.0417925Z [36m@@ -72,8 +72,10 @@[m [mend[m
2026-02-09T19:17:20.0418182Z  [m
2026-02-09T19:17:20.0418524Z  Add a fine flux contribution at a coarse face location.[m
2026-02-09T19:17:20.0419150Z  """[m
2026-02-09T19:17:20.0419653Z [31m-function accumulate_fine_flux!(reg::FluxRegister, face::Symbol,[m
2026-02-09T19:17:20.0420463Z [31m-        coarse_face_idx::Int, flux::SVector)[m
2026-02-09T19:17:20.0420894Z [32m+[m[32mfunction accumulate_fine_flux!([m
2026-02-09T19:17:20.0421355Z [32m+[m[32m        reg::FluxRegister, face::Symbol,[m
2026-02-09T19:17:20.0421966Z [32m+[m[32m        coarse_face_idx::Int, flux::SVector[m
2026-02-09T19:17:20.0422336Z [32m+[m[32m    )[m
2026-02-09T19:17:20.0422865Z      reg.fine_flux_sum[face][coarse_face_idx] = reg.fine_flux_sum[face][coarse_face_idx] + flux[m
2026-02-09T19:17:20.0423407Z      return nothing[m
2026-02-09T19:17:20.0423650Z  end[m
2026-02-09T19:17:20.0423874Z [36m@@ -83,8 +85,10 @@[m [mend[m
2026-02-09T19:17:20.0424139Z  [m
2026-02-09T19:17:20.0424422Z  Store the coarse flux at a face location.[m
2026-02-09T19:17:20.0424758Z  """[m
2026-02-09T19:17:20.0425172Z [31m-function store_coarse_flux!(reg::FluxRegister, face::Symbol,[m
2026-02-09T19:17:20.0425719Z [31m-        coarse_face_idx::Int, flux::SVector)[m
2026-02-09T19:17:20.0426138Z [32m+[m[32mfunction store_coarse_flux!([m
2026-02-09T19:17:20.0426577Z [32m+[m[32m        reg::FluxRegister, face::Symbol,[m
2026-02-09T19:17:20.0427065Z [32m+[m[32m        coarse_face_idx::Int, flux::SVector[m
2026-02-09T19:17:20.0427427Z [32m+[m[32m    )[m
2026-02-09T19:17:20.0427764Z      reg.coarse_flux[face][coarse_face_idx] = flux[m
2026-02-09T19:17:20.0428125Z      return nothing[m
2026-02-09T19:17:20.0428361Z  end[m
2026-02-09T19:17:20.0429027Z [36m@@ -102,7 +106,8 @@[m [mThis is added to the coarse cells adjacent to the interface.[m
2026-02-09T19:17:20.0429509Z  """[m
2026-02-09T19:17:20.0429784Z  function apply_flux_correction_2d!([m
2026-02-09T19:17:20.0430230Z          U::AbstractMatrix, reg::FluxRegister{N, FT},[m
2026-02-09T19:17:20.0430771Z [31m-        dt, dx, dy, nx::Int, ny::Int, face::Symbol) where {N, FT}[m
2026-02-09T19:17:20.0431305Z [32m+[m[32m        dt, dx, dy, nx::Int, ny::Int, face::Symbol[m
2026-02-09T19:17:20.0431709Z [32m+[m[32m    ) where {N, FT}[m
2026-02-09T19:17:20.0432027Z      n_inv = FT(1) / FT(reg.n_fine)[m
2026-02-09T19:17:20.0432307Z  [m
2026-02-09T19:17:20.0432516Z      if face == :left[m
2026-02-09T19:17:20.0432791Z [36m@@ -142,7 +147,8 @@[m [mend[m
2026-02-09T19:17:20.0433052Z  [m
2026-02-09T19:17:20.0433314Z  function apply_flux_correction_3d!([m
2026-02-09T19:17:20.0433758Z          U::AbstractArray{T, 3}, reg::FluxRegister{N, FT},[m
2026-02-09T19:17:20.0434333Z [31m-        dt, dx, dy, dz, nx::Int, ny::Int, nz::Int, face::Symbol) where {T, N, FT}[m
2026-02-09T19:17:20.0434953Z [32m+[m[32m        dt, dx, dy, dz, nx::Int, ny::Int, nz::Int, face::Symbol[m
2026-02-09T19:17:20.0435383Z [32m+[m[32m    ) where {T, N, FT}[m
2026-02-09T19:17:20.0435708Z      n_inv = FT(1) / FT(reg.n_fine)[m
2026-02-09T19:17:20.0435978Z  [m
2026-02-09T19:17:20.0436192Z      if face == :left[m
2026-02-09T19:17:20.0483859Z [34m[ 38/151] Checking `src/amr/prolongation.jl` ................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0497840Z [1mdiff --git a/prolongation.jl b/prolongation.jl[m
2026-02-09T19:17:20.0498527Z [1mindex 6e3bf71..05c43e5 100644[m
2026-02-09T19:17:20.0499223Z [1m--- a/prolongation.jl[m
2026-02-09T19:17:20.0499724Z [1m+++ b/prolongation.jl[m
2026-02-09T19:17:20.0500275Z [36m@@ -138,7 +138,8 @@[m [mUses the Balsara (2001) divergence-preserving interpolation:[m
2026-02-09T19:17:20.0500927Z  function prolongate_B_divergence_preserving_2d!([m
2026-02-09T19:17:20.0501499Z          Bx_coarse::AbstractMatrix, By_coarse::AbstractMatrix,[m
2026-02-09T19:17:20.0502040Z          Bx_fine::AbstractMatrix, By_fine::AbstractMatrix,[m
2026-02-09T19:17:20.0502507Z [31m-        nx_c::Int, ny_c::Int)[m
2026-02-09T19:17:20.0502868Z [32m+[m[32m        nx_c::Int, ny_c::Int[m
2026-02-09T19:17:20.0503183Z [32m+[m[32m    )[m
2026-02-09T19:17:20.0503565Z      # Refinement ratio is 2: each coarse cell -> 4 fine cells[m
2026-02-09T19:17:20.0504169Z      nx_f = 2 * nx_c[m
2026-02-09T19:17:20.0504424Z      ny_f = 2 * ny_c[m
2026-02-09T19:17:20.0591833Z [34m[ 39/151] Checking `src/amr/refinement.jl` ................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0606485Z [1mdiff --git a/refinement.jl b/refinement.jl[m
2026-02-09T19:17:20.0607362Z [1mindex 1597d2b..ac03ff4 100644[m
2026-02-09T19:17:20.0607865Z [1m--- a/refinement.jl[m
2026-02-09T19:17:20.0608319Z [1m+++ b/refinement.jl[m
2026-02-09T19:17:20.0609137Z [36m@@ -24,8 +24,10 @@[m [mstruct GradientRefinement{FT} <: AbstractRefinementCriterion[m
2026-02-09T19:17:20.0609736Z      coarsen_threshold::FT[m
2026-02-09T19:17:20.0610025Z  end[m
2026-02-09T19:17:20.0610224Z  [m
2026-02-09T19:17:20.0610661Z [31m-function GradientRefinement(; variable_index::Int = 1,[m
2026-02-09T19:17:20.0611246Z [31m-        refine_threshold = 0.1, coarsen_threshold = 0.01)[m
2026-02-09T19:17:20.0611719Z [32m+[m[32mfunction GradientRefinement(;[m
2026-02-09T19:17:20.0612160Z [32m+[m[32m        variable_index::Int = 1,[m
2026-02-09T19:17:20.0612646Z [32m+[m[32m        refine_threshold = 0.1, coarsen_threshold = 0.01[m
2026-02-09T19:17:20.0613063Z [32m+[m[32m    )[m
2026-02-09T19:17:20.0613577Z      return GradientRefinement(variable_index, refine_threshold, coarsen_threshold)[m
2026-02-09T19:17:20.0614092Z  end[m
2026-02-09T19:17:20.0614287Z  [m
2026-02-09T19:17:20.0660434Z [34m[ 40/151] Checking `src/amr/restriction.jl` .................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0674031Z [1mdiff --git a/restriction.jl b/restriction.jl[m
2026-02-09T19:17:20.0674671Z [1mindex 8c9a5c7..2c2df95 100644[m
2026-02-09T19:17:20.0675196Z [1m--- a/restriction.jl[m
2026-02-09T19:17:20.0675653Z [1m+++ b/restriction.jl[m
2026-02-09T19:17:20.0676113Z [36m@@ -107,7 +107,8 @@[m [mFor refinement ratio 2 in 2D:[m
2026-02-09T19:17:20.0676544Z  function restrict_B_face_2d!([m
2026-02-09T19:17:20.0677023Z          Bx_coarse::AbstractMatrix, By_coarse::AbstractMatrix,[m
2026-02-09T19:17:20.0677593Z          Bx_fine::AbstractMatrix, By_fine::AbstractMatrix,[m
2026-02-09T19:17:20.0678065Z [31m-        nx_c::Int, ny_c::Int)[m
2026-02-09T19:17:20.0678427Z [32m+[m[32m        nx_c::Int, ny_c::Int[m
2026-02-09T19:17:20.0678959Z [32m+[m[32m    )[m
2026-02-09T19:17:20.0679267Z      # Restrict Bx at x-faces[m
2026-02-09T19:17:20.0679600Z      for j in 1:ny_c, i in 1:(nx_c + 1)[m
2026-02-09T19:17:20.0679927Z          fi = 2 * i - 1[m
2026-02-09T19:17:20.0680434Z [36m@@ -132,7 +133,8 @@[m [mEach coarse face value = average of the 4 fine faces it covers.[m
2026-02-09T19:17:20.0680968Z  function restrict_B_face_3d!([m
2026-02-09T19:17:20.0681603Z          Bx_coarse::AbstractArray{T, 3}, By_coarse::AbstractArray{T, 3}, Bz_coarse::AbstractArray{T, 3},[m
2026-02-09T19:17:20.0682455Z          Bx_fine::AbstractArray{T, 3}, By_fine::AbstractArray{T, 3}, Bz_fine::AbstractArray{T, 3},[m
2026-02-09T19:17:20.0683114Z [31m-        nx_c::Int, ny_c::Int, nz_c::Int) where {T}[m
2026-02-09T19:17:20.0683577Z [32m+[m[32m        nx_c::Int, ny_c::Int, nz_c::Int[m
2026-02-09T19:17:20.0683927Z [32m+[m[32m    ) where {T}[m
2026-02-09T19:17:20.0684375Z      # Restrict Bx at x-faces: coarse face (i,j,k) = avg of 4 fine faces[m
2026-02-09T19:17:20.0684883Z      for k in 1:nz_c, j in 1:ny_c, i in 1:(nx_c + 1)[m
2026-02-09T19:17:20.0685247Z          fi = 2 * i - 1[m
2026-02-09T19:17:20.0685605Z [36m@@ -142,7 +144,7 @@[m [mfunction restrict_B_face_3d!([m
2026-02-09T19:17:20.0685982Z          fk2 = 2 * k[m
2026-02-09T19:17:20.0686260Z          Bx_coarse[i, j, k] = 0.25 * ([m
2026-02-09T19:17:20.0686659Z              Bx_fine[fi, fj1, fk1] + Bx_fine[fi, fj2, fk1] +[m
2026-02-09T19:17:20.0687128Z [31m-            Bx_fine[fi, fj1, fk2] + Bx_fine[fi, fj2, fk2][m
2026-02-09T19:17:20.0687609Z [32m+[m[32m                Bx_fine[fi, fj1, fk2] + Bx_fine[fi, fj2, fk2][m
2026-02-09T19:17:20.0687991Z          )[m
2026-02-09T19:17:20.0688201Z      end[m
2026-02-09T19:17:20.0688595Z  [m
2026-02-09T19:17:20.0689116Z [36m@@ -155,7 +157,7 @@[m [mfunction restrict_B_face_3d!([m
2026-02-09T19:17:20.0689493Z          fk2 = 2 * k[m
2026-02-09T19:17:20.0689770Z          By_coarse[i, j, k] = 0.25 * ([m
2026-02-09T19:17:20.0690304Z              By_fine[fi1, fj, fk1] + By_fine[fi2, fj, fk1] +[m
2026-02-09T19:17:20.0690760Z [31m-            By_fine[fi1, fj, fk2] + By_fine[fi2, fj, fk2][m
2026-02-09T19:17:20.0691241Z [32m+[m[32m                By_fine[fi1, fj, fk2] + By_fine[fi2, fj, fk2][m
2026-02-09T19:17:20.0691617Z          )[m
2026-02-09T19:17:20.0691821Z      end[m
2026-02-09T19:17:20.0692017Z  [m
2026-02-09T19:17:20.0692329Z [36m@@ -168,7 +170,7 @@[m [mfunction restrict_B_face_3d!([m
2026-02-09T19:17:20.0692696Z          fj2 = 2 * j[m
2026-02-09T19:17:20.0692969Z          Bz_coarse[i, j, k] = 0.25 * ([m
2026-02-09T19:17:20.0693353Z              Bz_fine[fi1, fj1, fk] + Bz_fine[fi2, fj1, fk] +[m
2026-02-09T19:17:20.0693795Z [31m-            Bz_fine[fi1, fj2, fk] + Bz_fine[fi2, fj2, fk][m
2026-02-09T19:17:20.0694281Z [32m+[m[32m                Bz_fine[fi1, fj2, fk] + Bz_fine[fi2, fj2, fk][m
2026-02-09T19:17:20.0694651Z          )[m
2026-02-09T19:17:20.0694849Z      end[m
2026-02-09T19:17:20.0695043Z  [m
2026-02-09T19:17:20.0799383Z [34m[ 41/151] Checking `src/conditions.jl` ....................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.0822044Z [34m[ 42/151] Checking `src/conditions/coupled.jl` ............................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0836999Z [1mdiff --git a/coupled.jl b/coupled.jl[m
2026-02-09T19:17:20.0837642Z [1mindex afb2dc7..f772b1b 100644[m
2026-02-09T19:17:20.0838140Z [1m--- a/coupled.jl[m
2026-02-09T19:17:20.0838545Z [1m+++ b/coupled.jl[m
2026-02-09T19:17:20.0839387Z [36m@@ -50,12 +50,12 @@[m [mThe constraint is: `Σᵢ coefficients[i] * u[field_indices[i]] = rhs_value`[m
2026-02-09T19:17:20.0840023Z  coupled_bc = CoupledBC([1, 2], [2.0, 3.0], 5.0)[m
2026-02-09T19:17:20.0840375Z  ```[m
2026-02-09T19:17:20.0840621Z  """[m
2026-02-09T19:17:20.0840879Z [31m-struct CoupledBC{T<:Real}[m
2026-02-09T19:17:20.0841256Z [32m+[m[32mstruct CoupledBC{T <: Real}[m
2026-02-09T19:17:20.0841650Z      field_indices::Vector{Int}[m
2026-02-09T19:17:20.0841998Z      coefficients::Vector{T}[m
2026-02-09T19:17:20.0842297Z      rhs_value::T[m
2026-02-09T19:17:20.0842527Z  [m
2026-02-09T19:17:20.0843188Z [31m-    function CoupledBC(field_indices::Vector{Int}, coefficients::Vector{T}, rhs_value::T) where {T<:Real}[m
2026-02-09T19:17:20.0844229Z [32m+[m[32m    function CoupledBC(field_indices::Vector{Int}, coefficients::Vector{T}, rhs_value::T) where {T <: Real}[m
2026-02-09T19:17:20.0845260Z          @assert length(field_indices) == length(coefficients) "Number of fields must match number of coefficients"[m
2026-02-09T19:17:20.0846070Z          @assert length(field_indices) > 0 "Must specify at least one field"[m
2026-02-09T19:17:20.0846667Z          return new{T}(field_indices, coefficients, rhs_value)[m
2026-02-09T19:17:20.0847238Z [36m@@ -91,13 +91,13 @@[m [mcoupled_dirichlet = CoupledDirichlet([m
2026-02-09T19:17:20.0847641Z  )[m
2026-02-09T19:17:20.0847844Z  ```[m
2026-02-09T19:17:20.0848034Z  """[m
2026-02-09T19:17:20.0848351Z [31m-struct CoupledDirichlet{F<:Function, P}[m
2026-02-09T19:17:20.0849048Z [32m+[m[32mstruct CoupledDirichlet{F <: Function, P}[m
2026-02-09T19:17:20.0849481Z      target_field::Int[m
2026-02-09T19:17:20.0849782Z      coupling_function::F[m
2026-02-09T19:17:20.0850092Z      parameters::P[m
2026-02-09T19:17:20.0850331Z  end[m
2026-02-09T19:17:20.0850526Z  [m
2026-02-09T19:17:20.0851005Z [31m-CoupledDirichlet(target_field::Int, f::Function; parameters=nothing) =[m
2026-02-09T19:17:20.0851800Z [32m+[m[32mCoupledDirichlet(target_field::Int, f::Function; parameters = nothing) =[m
2026-02-09T19:17:20.0852434Z      CoupledDirichlet(target_field, f, parameters)[m
2026-02-09T19:17:20.0852782Z  [m
2026-02-09T19:17:20.0852974Z  """[m
2026-02-09T19:17:20.0853533Z [36m@@ -121,13 +121,13 @@[m [mcoupled_neumann = CoupledNeumann([m
2026-02-09T19:17:20.0853918Z  )[m
2026-02-09T19:17:20.0854109Z  ```[m
2026-02-09T19:17:20.0854300Z  """[m
2026-02-09T19:17:20.0854591Z [31m-struct CoupledNeumann{F<:Function, P}[m
2026-02-09T19:17:20.0855185Z [32m+[m[32mstruct CoupledNeumann{F <: Function, P}[m
2026-02-09T19:17:20.0855583Z      target_field::Int[m
2026-02-09T19:17:20.0855878Z      coupling_function::F[m
2026-02-09T19:17:20.0856218Z      parameters::P[m
2026-02-09T19:17:20.0856454Z  end[m
2026-02-09T19:17:20.0856646Z  [m
2026-02-09T19:17:20.0857115Z [31m-CoupledNeumann(target_field::Int, f::Function; parameters=nothing) =[m
2026-02-09T19:17:20.0857891Z [32m+[m[32mCoupledNeumann(target_field::Int, f::Function; parameters = nothing) =[m
2026-02-09T19:17:20.0858500Z      CoupledNeumann(target_field, f, parameters)[m
2026-02-09T19:17:20.0859042Z  [m
2026-02-09T19:17:20.0859241Z  """[m
2026-02-09T19:17:20.0859575Z [36m@@ -155,13 +155,13 @@[m [mcoupled_robin = CoupledRobin([m
2026-02-09T19:17:20.0859943Z  )[m
2026-02-09T19:17:20.0860132Z  ```[m
2026-02-09T19:17:20.0860329Z  """[m
2026-02-09T19:17:20.0860610Z [31m-struct CoupledRobin{F<:Function, P}[m
2026-02-09T19:17:20.0861056Z [32m+[m[32mstruct CoupledRobin{F <: Function, P}[m
2026-02-09T19:17:20.0861448Z      target_field::Int[m
2026-02-09T19:17:20.0861771Z      coupling_function::F[m
2026-02-09T19:17:20.0862065Z      parameters::P[m
2026-02-09T19:17:20.0862304Z  end[m
2026-02-09T19:17:20.0862490Z  [m
2026-02-09T19:17:20.0862943Z [31m-CoupledRobin(target_field::Int, f::Function; parameters=nothing) =[m
2026-02-09T19:17:20.0863677Z [32m+[m[32mCoupledRobin(target_field::Int, f::Function; parameters = nothing) =[m
2026-02-09T19:17:20.0864257Z      CoupledRobin(target_field, f, parameters)[m
2026-02-09T19:17:20.0864595Z  [m
2026-02-09T19:17:20.0864779Z  """[m
2026-02-09T19:17:20.0865244Z [36m@@ -186,7 +186,7 @@[m [mEvaluate a coupled Dirichlet BC given the current field values.[m
2026-02-09T19:17:20.0865754Z  # Returns[m
2026-02-09T19:17:20.0866109Z  The Dirichlet boundary value for the target field.[m
2026-02-09T19:17:20.0866473Z  """[m
2026-02-09T19:17:20.0867032Z [31m-function evaluate_coupled_bc(bc::CoupledDirichlet, x, y, t, u_values, grad_values=nothing)[m
2026-02-09T19:17:20.0867978Z [32m+[m[32mfunction evaluate_coupled_bc(bc::CoupledDirichlet, x, y, t, u_values, grad_values = nothing)[m
2026-02-09T19:17:20.0868955Z      return bc.coupling_function(x, y, t, u_values, bc.parameters)[m
2026-02-09T19:17:20.0869618Z  end[m
2026-02-09T19:17:20.0869904Z  [m
2026-02-09T19:17:20.0870507Z [34m[ 43/151] Checking `src/conditions/nonlinear.jl` ............................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0884609Z [1mdiff --git a/nonlinear.jl b/nonlinear.jl[m
2026-02-09T19:17:20.0885232Z [1mindex fc7fbe9..4f9fdfa 100644[m
2026-02-09T19:17:20.0885577Z [1m--- a/nonlinear.jl[m
2026-02-09T19:17:20.0885860Z [1m+++ b/nonlinear.jl[m
2026-02-09T19:17:20.0886471Z [36m@@ -126,7 +126,7 @@[m [mFor a single linearization step, we return the linearized Dirichlet value.[m
2026-02-09T19:17:20.0887025Z  # Returns[m
2026-02-09T19:17:20.0887338Z  The linearized Dirichlet boundary value.[m
2026-02-09T19:17:20.0887671Z  """[m
2026-02-09T19:17:20.0888217Z [31m-function linearize_bc(::Type{NonlinearDirichlet}, f, x, y, t, u, grad_u, p; ε=1e-6)[m
2026-02-09T19:17:20.0889289Z [32m+[m[32mfunction linearize_bc(::Type{NonlinearDirichlet}, f, x, y, t, u, grad_u, p; ε = 1.0e-6)[m
2026-02-09T19:17:20.0889882Z      # Evaluate f at current state[m
2026-02-09T19:17:20.0890231Z      f_val = f(x, y, t, u, grad_u, p)[m
2026-02-09T19:17:20.0890513Z  [m
2026-02-09T19:17:20.0891078Z [36m@@ -138,7 +138,7 @@[m [mfunction linearize_bc(::Type{NonlinearDirichlet}, f, x, y, t, u, grad_u, p; ε=1[m
2026-02-09T19:17:20.0891680Z      # u_new = u - (f(u) - u) / (df/du - 1)[m
2026-02-09T19:17:20.0892024Z      denom = df_du - one(df_du)[m
2026-02-09T19:17:20.0892297Z  [m
2026-02-09T19:17:20.0892706Z [31m-    if abs(denom) < 1e-12[m
2026-02-09T19:17:20.0893035Z [32m+[m[32m    if abs(denom) < 1.0e-12[m
2026-02-09T19:17:20.0893486Z          # Near fixed point or singular - return f(u) as estimate[m
2026-02-09T19:17:20.0894018Z          return f_val[m
2026-02-09T19:17:20.0894264Z      end[m
2026-02-09T19:17:20.0894668Z [36m@@ -188,8 +188,8 @@[m [mwith additional metadata for nonlinear handling.[m
2026-02-09T19:17:20.0895365Z  - `nonlinear_types`: Tuple indicating which boundaries have nonlinear conditions[m
2026-02-09T19:17:20.0896080Z  - `gradient_cache`: Pre-allocated storage for gradient computations[m
2026-02-09T19:17:20.0896527Z  """[m
2026-02-09T19:17:20.0896852Z [31m-struct NonlinearBoundaryConditions{F,C,P,N}[m
2026-02-09T19:17:20.0897368Z [31m-    base_conditions::BoundaryConditions{F,C}[m
2026-02-09T19:17:20.0897887Z [32m+[m[32mstruct NonlinearBoundaryConditions{F, C, P, N}[m
2026-02-09T19:17:20.0898448Z [32m+[m[32m    base_conditions::BoundaryConditions{F, C}[m
2026-02-09T19:17:20.0899154Z      nonlinear_types::N[m
2026-02-09T19:17:20.0899458Z      parameters::P[m
2026-02-09T19:17:20.0899692Z  end[m
2026-02-09T19:17:20.0926275Z [34m[ 44/151] Checking `src/conditions/periodic.jl` .............................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.0940920Z [1mdiff --git a/periodic.jl b/periodic.jl[m
2026-02-09T19:17:20.0941562Z [1mindex 43ce09c..82c86a7 100644[m
2026-02-09T19:17:20.0942057Z [1m--- a/periodic.jl[m
2026-02-09T19:17:20.0942475Z [1m+++ b/periodic.jl[m
2026-02-09T19:17:20.0942997Z [36m@@ -54,7 +54,7 @@[m [mperiodic_bc = PeriodicBC(1, 3; direction=:x)[m
2026-02-09T19:17:20.0943622Z  periodic_bc_shifted = PeriodicBC(1, 3; shift=1.0, direction=:x)[m
2026-02-09T19:17:20.0944034Z  ```[m
2026-02-09T19:17:20.0944237Z  """[m
2026-02-09T19:17:20.0944500Z [31m-struct PeriodicBC{T<:Real, F}[m
2026-02-09T19:17:20.0944894Z [32m+[m[32mstruct PeriodicBC{T <: Real, F}[m
2026-02-09T19:17:20.0945306Z      segment_pair::Tuple{Int, Int}[m
2026-02-09T19:17:20.0945640Z      shift::T[m
2026-02-09T19:17:20.0945896Z      direction::Symbol[m
2026-02-09T19:17:20.0946274Z [36m@@ -62,7 +62,7 @@[m [mstruct PeriodicBC{T<:Real, F}[m
2026-02-09T19:17:20.0946623Z  end[m
2026-02-09T19:17:20.0946818Z  [m
2026-02-09T19:17:20.0947058Z  # Default constructors[m
2026-02-09T19:17:20.0947735Z [31m-function PeriodicBC(seg1::Int, seg2::Int; shift::Real=0.0, direction::Symbol=:x, transform=nothing)[m
2026-02-09T19:17:20.0948967Z [32m+[m[32mfunction PeriodicBC(seg1::Int, seg2::Int; shift::Real = 0.0, direction::Symbol = :x, transform = nothing)[m
2026-02-09T19:17:20.0949624Z      T = typeof(float(shift))[m
2026-02-09T19:17:20.0949952Z      if transform === nothing[m
2026-02-09T19:17:20.0950298Z          transform = identity_transform[m
2026-02-09T19:17:20.0950883Z [36m@@ -87,7 +87,7 @@[m [mStores the mapping between nodes on paired periodic boundaries.[m
2026-02-09T19:17:20.0951483Z  - `segment_pair`: The boundary segment indices[m
2026-02-09T19:17:20.0951902Z  - `shift`: The constant shift value[m
2026-02-09T19:17:20.0952206Z  """[m
2026-02-09T19:17:20.0952496Z [31m-struct PeriodicNodeMapping{T<:Real}[m
2026-02-09T19:17:20.0952942Z [32m+[m[32mstruct PeriodicNodeMapping{T <: Real}[m
2026-02-09T19:17:20.0953376Z      node_pairs::Vector{Tuple{Int, Int}}[m
2026-02-09T19:17:20.0953750Z      segment_pair::Tuple{Int, Int}[m
2026-02-09T19:17:20.0954049Z      shift::T[m
2026-02-09T19:17:20.0954489Z [36m@@ -115,7 +115,7 @@[m [mA `PeriodicNodeMapping` containing the paired nodes.[m
2026-02-09T19:17:20.0955115Z     coordinates (after projecting out the periodic direction)[m
2026-02-09T19:17:20.0955597Z  3. Return the list of matched pairs[m
2026-02-09T19:17:20.0955899Z  """[m
2026-02-09T19:17:20.0956409Z [31m-function compute_periodic_mapping(mesh::FVMGeometry, bc::PeriodicBC; tol=1e-10)[m
2026-02-09T19:17:20.0957287Z [32m+[m[32mfunction compute_periodic_mapping(mesh::FVMGeometry, bc::PeriodicBC; tol = 1.0e-10)[m
2026-02-09T19:17:20.0958074Z      tri = mesh.triangulation[m
2026-02-09T19:17:20.0958407Z      seg1, seg2 = bc.segment_pair[m
2026-02-09T19:17:20.0958684Z  [m
2026-02-09T19:17:20.0959379Z [36m@@ -286,7 +286,7 @@[m [mContainer for multiple periodic boundary condition specifications.[m
2026-02-09T19:17:20.0960035Z  # Fields[m
2026-02-09T19:17:20.0960476Z  - `mappings`: Vector of `PeriodicNodeMapping` for each periodic BC pair[m
2026-02-09T19:17:20.0960929Z  """[m
2026-02-09T19:17:20.0961205Z [31m-struct PeriodicConditions{T<:Real}[m
2026-02-09T19:17:20.0961635Z [32m+[m[32mstruct PeriodicConditions{T <: Real}[m
2026-02-09T19:17:20.0962096Z      mappings::Vector{PeriodicNodeMapping{T}}[m
2026-02-09T19:17:20.0962451Z  end[m
2026-02-09T19:17:20.0962633Z  [m
2026-02-09T19:17:20.0962858Z [36m@@ -295,8 +295,8 @@[m [mend[m
2026-02-09T19:17:20.0963113Z  [m
2026-02-09T19:17:20.0963562Z  Construct periodic conditions from a list of periodic BC specifications.[m
2026-02-09T19:17:20.0964043Z  """[m
2026-02-09T19:17:20.0964603Z [31m-function PeriodicConditions(mesh::FVMGeometry, bcs::Vector{<:PeriodicBC}; tol=1e-10)[m
2026-02-09T19:17:20.0965380Z [31m-    mappings = [compute_periodic_mapping(mesh, bc; tol=tol) for bc in bcs][m
2026-02-09T19:17:20.0966224Z [32m+[m[32mfunction PeriodicConditions(mesh::FVMGeometry, bcs::Vector{<:PeriodicBC}; tol = 1.0e-10)[m
2026-02-09T19:17:20.0967066Z [32m+[m[32m    mappings = [compute_periodic_mapping(mesh, bc; tol = tol) for bc in bcs][m
2026-02-09T19:17:20.0967755Z      T = isempty(mappings) ? Float64 : typeof(first(mappings).shift)[m
2026-02-09T19:17:20.0968281Z      return PeriodicConditions{T}(mappings)[m
2026-02-09T19:17:20.0968616Z  end[m
2026-02-09T19:17:20.0973382Z [34m[ 45/151] Checking `src/constrained_transport/ct_data.jl` .................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1023077Z [34m[ 46/151] Checking `src/constrained_transport/ct_data_3d.jl` ................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1037524Z [34m[ 47/151] Checking `src/constrained_transport/ct_update.jl` .................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1051433Z [1mdiff --git a/ct_update.jl b/ct_update.jl[m
2026-02-09T19:17:20.1052071Z [1mindex 033ad41..55126eb 100644[m
2026-02-09T19:17:20.1052432Z [1m--- a/ct_update.jl[m
2026-02-09T19:17:20.1052732Z [1m+++ b/ct_update.jl[m
2026-02-09T19:17:20.1053485Z [36m@@ -52,8 +52,10 @@[m [mPerform a weighted CT update for SSP-RK stages:[m
2026-02-09T19:17:20.1054165Z  [m
2026-02-09T19:17:20.1054734Z  where `ΔB` is the CT update computed from `ct_stage.emf_z`.[m
2026-02-09T19:17:20.1055379Z  """[m
2026-02-09T19:17:20.1056251Z [31m-function ct_weighted_update!(ct_out::CTData2D, ct_old::CTData2D, ct_stage::CTData2D,[m
2026-02-09T19:17:20.1057376Z [31m-        α_old, α_stage, dt, dx, dy, nx::Int, ny::Int)[m
2026-02-09T19:17:20.1058091Z [32m+[m[32mfunction ct_weighted_update!([m
2026-02-09T19:17:20.1059273Z [32m+[m[32m        ct_out::CTData2D, ct_old::CTData2D, ct_stage::CTData2D,[m
2026-02-09T19:17:20.1060271Z [32m+[m[32m        α_old, α_stage, dt, dx, dy, nx::Int, ny::Int[m
2026-02-09T19:17:20.1060877Z [32m+[m[32m    )[m
2026-02-09T19:17:20.1061289Z      Bx_out = ct_out.Bx_face[m
2026-02-09T19:17:20.1061743Z      By_out = ct_out.By_face[m
2026-02-09T19:17:20.1062222Z      Bx_old = ct_old.Bx_face[m
2026-02-09T19:17:20.1088456Z [34m[ 48/151] Checking `src/constrained_transport/ct_update_3d.jl` ............... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1102239Z [1mdiff --git a/ct_update_3d.jl b/ct_update_3d.jl[m
2026-02-09T19:17:20.1102693Z [1mindex 68a7227..bac2aeb 100644[m
2026-02-09T19:17:20.1103027Z [1m--- a/ct_update_3d.jl[m
2026-02-09T19:17:20.1103331Z [1m+++ b/ct_update_3d.jl[m
2026-02-09T19:17:20.1103866Z [36m@@ -61,8 +61,10 @@[m [mPerform a weighted CT update for SSP-RK stages:[m
2026-02-09T19:17:20.1104537Z  [m
2026-02-09T19:17:20.1105106Z  where `dB` is the CT update computed from `ct_stage`'s EMFs.[m
2026-02-09T19:17:20.1105737Z  """[m
2026-02-09T19:17:20.1106872Z [31m-function ct_weighted_update_3d!(ct_out::CTData3D, ct_old::CTData3D, ct_stage::CTData3D,[m
2026-02-09T19:17:20.1108106Z [31m-        a_old, a_stage, dt, dx, dy, dz, nx::Int, ny::Int, nz::Int)[m
2026-02-09T19:17:20.1109131Z [32m+[m[32mfunction ct_weighted_update_3d!([m
2026-02-09T19:17:20.1110284Z [32m+[m[32m        ct_out::CTData3D, ct_old::CTData3D, ct_stage::CTData3D,[m
2026-02-09T19:17:20.1111295Z [32m+[m[32m        a_old, a_stage, dt, dx, dy, dz, nx::Int, ny::Int, nz::Int[m
2026-02-09T19:17:20.1111972Z [32m+[m[32m    )[m
2026-02-09T19:17:20.1112399Z      Bx_out = ct_out.Bx_face[m
2026-02-09T19:17:20.1112881Z      By_out = ct_out.By_face[m
2026-02-09T19:17:20.1113347Z      Bz_out = ct_out.Bz_face[m
2026-02-09T19:17:20.1119406Z [34m[ 49/151] Checking `src/constrained_transport/divb.jl` ....................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1130757Z [34m[ 50/151] Checking `src/constrained_transport/divb_3d.jl` .................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1144156Z [1mdiff --git a/divb_3d.jl b/divb_3d.jl[m
2026-02-09T19:17:20.1144745Z [1mindex 73e181d..ff9ce78 100644[m
2026-02-09T19:17:20.1145101Z [1m--- a/divb_3d.jl[m
2026-02-09T19:17:20.1145375Z [1m+++ b/divb_3d.jl[m
2026-02-09T19:17:20.1146408Z [36m@@ -21,8 +21,8 @@[m [mfunction compute_divB_3d(ct::CTData3D, dx, dy, dz, nx::Int, ny::Int, nz::Int)[m
2026-02-09T19:17:20.1147400Z      divB = Array{FT, 3}(undef, nx, ny, nz)[m
2026-02-09T19:17:20.1148004Z      for k in 1:nz, j in 1:ny, i in 1:nx[m
2026-02-09T19:17:20.1148681Z          divB[i, j, k] = (Bx[i + 1, j, k] - Bx[i, j, k]) / dx +[m
2026-02-09T19:17:20.1149662Z [31m-                         (By[i, j + 1, k] - By[i, j, k]) / dy +[m
2026-02-09T19:17:20.1150389Z [31m-                         (Bz[i, j, k + 1] - Bz[i, j, k]) / dz[m
2026-02-09T19:17:20.1151100Z [32m+[m[32m            (By[i, j + 1, k] - By[i, j, k]) / dy +[m
2026-02-09T19:17:20.1151825Z [32m+[m[32m            (Bz[i, j, k + 1] - Bz[i, j, k]) / dz[m
2026-02-09T19:17:20.1152403Z      end[m
2026-02-09T19:17:20.1152747Z      return divB[m
2026-02-09T19:17:20.1153113Z  end[m
2026-02-09T19:17:20.1182317Z [34m[ 51/151] Checking `src/constrained_transport/emf.jl` ........................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1196064Z [1mdiff --git a/emf.jl b/emf.jl[m
2026-02-09T19:17:20.1196624Z [1mindex 0dbd245..3bd1f57 100644[m
2026-02-09T19:17:20.1196963Z [1m--- a/emf.jl[m
2026-02-09T19:17:20.1197214Z [1m+++ b/emf.jl[m
2026-02-09T19:17:20.1197915Z [36m@@ -34,8 +34,10 @@[m [mThe EMF at y-faces is `Ez_y = +Fy[6]` (positive of the Bx induction flux).[m
2026-02-09T19:17:20.1198919Z  [m
2026-02-09T19:17:20.1199598Z  Corner values are the arithmetic average of the 4 surrounding face EMFs.[m
2026-02-09T19:17:20.1200351Z  """[m
2026-02-09T19:17:20.1201276Z [31m-function compute_emf_2d!(ct::CTData2D, Fx_faces::AbstractMatrix, Fy_faces::AbstractMatrix,[m
2026-02-09T19:17:20.1202277Z [31m-        nx::Int, ny::Int)[m
2026-02-09T19:17:20.1202852Z [32m+[m[32mfunction compute_emf_2d!([m
2026-02-09T19:17:20.1203757Z [32m+[m[32m        ct::CTData2D, Fx_faces::AbstractMatrix, Fy_faces::AbstractMatrix,[m
2026-02-09T19:17:20.1204595Z [32m+[m[32m        nx::Int, ny::Int[m
2026-02-09T19:17:20.1205084Z [32m+[m[32m    )[m
2026-02-09T19:17:20.1205497Z      emf_z = ct.emf_z[m
2026-02-09T19:17:20.1205889Z  [m
2026-02-09T19:17:20.1206458Z      # Interior corners (i=2:nx, j=2:ny) have 4 surrounding faces[m
2026-02-09T19:17:20.1222944Z [34m[ 52/151] Checking `src/constrained_transport/emf_3d.jl` ..................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1236312Z [1mdiff --git a/emf_3d.jl b/emf_3d.jl[m
2026-02-09T19:17:20.1236716Z [1mindex 4aa392d..11e5dad 100644[m
2026-02-09T19:17:20.1237039Z [1m--- a/emf_3d.jl[m
2026-02-09T19:17:20.1237291Z [1m+++ b/emf_3d.jl[m
2026-02-09T19:17:20.1237614Z [36m@@ -39,9 +39,11 @@[m [mEMF from face fluxes:[m
2026-02-09T19:17:20.1238310Z    Ey = -Fz[6] + Fx[8]   (contributions from Bx and Bz induction)[m
2026-02-09T19:17:20.1239662Z    Ez = -Fx[7] + Fy[6]   (contributions from Bx and By induction)[m
2026-02-09T19:17:20.1240286Z  """[m
2026-02-09T19:17:20.1240965Z [31m-function _compute_emf_3d_from_extended!(ct::CTData3D,[m
2026-02-09T19:17:20.1242022Z [32m+[m[32mfunction _compute_emf_3d_from_extended!([m
2026-02-09T19:17:20.1242774Z [32m+[m[32m        ct::CTData3D,[m
2026-02-09T19:17:20.1243506Z          Fx_all::AbstractArray{T, 3}, Fy_all::AbstractArray{T, 3},[m
2026-02-09T19:17:20.1244487Z [31m-        Fz_all::AbstractArray{T, 3}, nx::Int, ny::Int, nz::Int) where {T}[m
2026-02-09T19:17:20.1245545Z [32m+[m[32m        Fz_all::AbstractArray{T, 3}, nx::Int, ny::Int, nz::Int[m
2026-02-09T19:17:20.1246252Z [32m+[m[32m    ) where {T}[m
2026-02-09T19:17:20.1246663Z  [m
2026-02-09T19:17:20.1247112Z      # Ez at z-edges: size (nx+1) x (ny+1) x nz[m
2026-02-09T19:17:20.1247723Z      # Edge (i, j, k) is surrounded by:[m
2026-02-09T19:17:20.1248680Z [34m[ 53/151] Checking `src/eos/eos_interface.jl` ................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1254980Z [34m[ 54/151] Checking `src/eos/ideal_gas.jl` .................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1268181Z [1mdiff --git a/ideal_gas.jl b/ideal_gas.jl[m
2026-02-09T19:17:20.1268980Z [1mindex d5997e6..1344d60 100644[m
2026-02-09T19:17:20.1269314Z [1m--- a/ideal_gas.jl[m
2026-02-09T19:17:20.1269609Z [1m+++ b/ideal_gas.jl[m
2026-02-09T19:17:20.1270293Z [36m@@ -17,7 +17,7 @@[m [mIdealGasEOS(; gamma = 1.4) = IdealGasEOS(gamma)[m
2026-02-09T19:17:20.1270967Z  end[m
2026-02-09T19:17:20.1271286Z  [m
2026-02-09T19:17:20.1271840Z  @inline function sound_speed(eos::IdealGasEOS, ρ, P)[m
2026-02-09T19:17:20.1272682Z [31m-    return sqrt(eos.gamma * max(P, zero(P)) / max(ρ, 1e-30))[m
2026-02-09T19:17:20.1273633Z [32m+[m[32m    return sqrt(eos.gamma * max(P, zero(P)) / max(ρ, 1.0e-30))[m
2026-02-09T19:17:20.1274342Z  end[m
2026-02-09T19:17:20.1274673Z  [m
2026-02-09T19:17:20.1275245Z  @inline function internal_energy(eos::IdealGasEOS, ρ, P)[m
2026-02-09T19:17:20.1283386Z [34m[ 55/151] Checking `src/eos/stiffened_gas.jl` ................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1315589Z [34m[ 56/151] Checking `src/equations/boundary_edge_contributions.jl` ............ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1327063Z [34m[ 57/151] Checking `src/equations/control_volumes.jl` ........................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1343465Z [34m[ 58/151] Checking `src/equations/dirichlet.jl` .............................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1363559Z [34m[ 59/151] Checking `src/equations/individual_flux_contributions.jl` .......... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1373785Z [34m[ 60/151] Checking `src/equations/main_equations.jl` ......................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1383598Z [34m[ 61/151] Checking `src/equations/shape_functions.jl` ........................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1406429Z [34m[ 62/151] Checking `src/equations/source_contributions.jl` ................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1422220Z [34m[ 63/151] Checking `src/equations/triangle_contributions.jl` ................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1453929Z [34m[ 64/151] Checking `src/geometry.jl` ......................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1502472Z [34m[ 65/151] Checking `src/hyperbolic/boundary_conditions_2d.jl` ................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1625929Z [34m[ 66/151] Checking `src/hyperbolic/boundary_conditions_3d.jl` ................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1644682Z [34m[ 67/151] Checking `src/hyperbolic/boundary_conditions_hyp.jl` ............... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1725795Z [34m[ 68/151] Checking `src/hyperbolic/characteristic_projection.jl` ............. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1742904Z [1mdiff --git a/characteristic_projection.jl b/characteristic_projection.jl[m
2026-02-09T19:17:20.1743696Z [1mindex 9914313..ca20976 100644[m
2026-02-09T19:17:20.1744160Z [1m--- a/characteristic_projection.jl[m
2026-02-09T19:17:20.1745043Z [1m+++ b/characteristic_projection.jl[m
2026-02-09T19:17:20.1745844Z [36m@@ -71,8 +71,8 @@[m [mColumns are the right eigenvectors `r₁, r₂, r₃`.[m
2026-02-09T19:17:20.1746965Z  @inline function right_eigenvectors(law::EulerEquations{1}, w::SVector{3}, dir::Int)[m
2026-02-09T19:17:20.1747800Z      ρ, v, P = w[m
2026-02-09T19:17:20.1748216Z      γ = law.eos.gamma[m
2026-02-09T19:17:20.1748674Z [31m-    ρ = max(ρ, 1e-12)[m
2026-02-09T19:17:20.1749384Z [31m-    P = max(P, 1e-12)[m
2026-02-09T19:17:20.1749870Z [32m+[m[32m    ρ = max(ρ, 1.0e-12)[m
2026-02-09T19:17:20.1750407Z [32m+[m[32m    P = max(P, 1.0e-12)[m
2026-02-09T19:17:20.1750940Z      c = sound_speed(law.eos, ρ, P)[m
2026-02-09T19:17:20.1751672Z      H = (total_energy(law.eos, ρ, v, P) + P) / ρ  # specific enthalpy[m
2026-02-09T19:17:20.1752318Z  [m
2026-02-09T19:17:20.1753157Z [36m@@ -95,8 +95,8 @@[m [mLeft eigenvector matrix (rows are left eigenvectors) of the 1D Euler flux Jacobi[m
2026-02-09T19:17:20.1754430Z  @inline function left_eigenvectors(law::EulerEquations{1}, w::SVector{3}, dir::Int)[m
2026-02-09T19:17:20.1755280Z      ρ, v, P = w[m
2026-02-09T19:17:20.1755688Z      γ = law.eos.gamma[m
2026-02-09T19:17:20.1756128Z [31m-    ρ = max(ρ, 1e-12)[m
2026-02-09T19:17:20.1756595Z [31m-    P = max(P, 1e-12)[m
2026-02-09T19:17:20.1757070Z [32m+[m[32m    ρ = max(ρ, 1.0e-12)[m
2026-02-09T19:17:20.1757602Z [32m+[m[32m    P = max(P, 1.0e-12)[m
2026-02-09T19:17:20.1758134Z      c = sound_speed(law.eos, ρ, P)[m
2026-02-09T19:17:20.1758703Z      b1 = (γ - 1) / c^2[m
2026-02-09T19:17:20.1759337Z      b2 = 0.5 * b1 * v^2[m
2026-02-09T19:17:20.1759974Z [36m@@ -126,8 +126,8 @@[m [mPrimitive state: `w = [ρ, vx, vy, P]`.[m
2026-02-09T19:17:20.1761036Z  @inline function right_eigenvectors(law::EulerEquations{2}, w::SVector{4}, dir::Int)[m
2026-02-09T19:17:20.1761890Z      ρ, vx, vy, P = w[m
2026-02-09T19:17:20.1762328Z      γ = law.eos.gamma[m
2026-02-09T19:17:20.1762772Z [31m-    ρ = max(ρ, 1e-12)[m
2026-02-09T19:17:20.1763253Z [31m-    P = max(P, 1e-12)[m
2026-02-09T19:17:20.1763724Z [32m+[m[32m    ρ = max(ρ, 1.0e-12)[m
2026-02-09T19:17:20.1764250Z [32m+[m[32m    P = max(P, 1.0e-12)[m
2026-02-09T19:17:20.1764788Z      c = sound_speed(law.eos, ρ, P)[m
2026-02-09T19:17:20.1765425Z      H = (total_energy(law.eos, ρ, vx, vy, P) + P) / ρ[m
2026-02-09T19:17:20.1765961Z  [m
2026-02-09T19:17:20.1766815Z [36m@@ -159,8 +159,8 @@[m [mLeft eigenvector matrix (rows are left eigenvectors) of the 2D Euler flux Jacobi[m
2026-02-09T19:17:20.1768124Z  @inline function left_eigenvectors(law::EulerEquations{2}, w::SVector{4}, dir::Int)[m
2026-02-09T19:17:20.1769167Z      ρ, vx, vy, P = w[m
2026-02-09T19:17:20.1769613Z      γ = law.eos.gamma[m
2026-02-09T19:17:20.1770063Z [31m-    ρ = max(ρ, 1e-12)[m
2026-02-09T19:17:20.1770524Z [31m-    P = max(P, 1e-12)[m
2026-02-09T19:17:20.1770993Z [32m+[m[32m    ρ = max(ρ, 1.0e-12)[m
2026-02-09T19:17:20.1771516Z [32m+[m[32m    P = max(P, 1.0e-12)[m
2026-02-09T19:17:20.1772075Z      c = sound_speed(law.eos, ρ, P)[m
2026-02-09T19:17:20.1772578Z      b1 = (γ - 1) / c^2[m
2026-02-09T19:17:20.1773027Z      q2 = vx^2 + vy^2[m
2026-02-09T19:17:20.1793235Z [34m[ 69/151] Checking `src/hyperbolic/con2prim.jl` .............................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1807512Z [1mdiff --git a/con2prim.jl b/con2prim.jl[m
2026-02-09T19:17:20.1808131Z [1mindex 4cce644..14ca6c2 100644[m
2026-02-09T19:17:20.1808525Z [1m--- a/con2prim.jl[m
2026-02-09T19:17:20.1809032Z [1m+++ b/con2prim.jl[m
2026-02-09T19:17:20.1810043Z [36m@@ -61,12 +61,12 @@[m [mfunction srmhd_con2prim(eos, u::SVector{8}, tol::Real, maxiter::Int)[m
2026-02-09T19:17:20.1810915Z      SdotB_sq = SdotB^2[m
2026-02-09T19:17:20.1811562Z  [m
2026-02-09T19:17:20.1811966Z      # Floor conserved variables[m
2026-02-09T19:17:20.1812476Z [31m-    D = max(D, 1e-12)[m
2026-02-09T19:17:20.1812976Z [32m+[m[32m    D = max(D, 1.0e-12)[m
2026-02-09T19:17:20.1813428Z  [m
2026-02-09T19:17:20.1814238Z      # Initial guess: from τ + D = ξ + B² - P_tot, with P_tot ≈ P[m
2026-02-09T19:17:20.1815205Z      # Non-relativistic estimate: P ≈ gm1 * (τ + D - B²/2 - S²/(2(τ+D+B²)))[m
2026-02-09T19:17:20.1815922Z      E_approx = tau + D[m
2026-02-09T19:17:20.1816798Z [31m-    P_guess = max(gm1 * (E_approx - 0.5 * B_sq - 0.5 * S_sq / max(E_approx + B_sq, 1e-30)), 1e-16)[m
2026-02-09T19:17:20.1818094Z [32m+[m[32m    P_guess = max(gm1 * (E_approx - 0.5 * B_sq - 0.5 * S_sq / max(E_approx + B_sq, 1.0e-30)), 1.0e-16)[m
2026-02-09T19:17:20.1819324Z      # ξ ≈ τ + D + P_tot - B² ≈ τ + D + P + b²/2 - B² ≈ τ + D + P[m
2026-02-09T19:17:20.1819962Z      xi = E_approx + P_guess[m
2026-02-09T19:17:20.1820380Z  [m
2026-02-09T19:17:20.1821244Z [36m@@ -86,7 +86,7 @@[m [mfunction srmhd_con2prim(eos, u::SVector{8}, tol::Real, maxiter::Int)[m
2026-02-09T19:17:20.1822100Z          v_sq = v_sq_num / v_sq_den[m
2026-02-09T19:17:20.1822529Z  [m
2026-02-09T19:17:20.1822937Z          # Cap v² to prevent superluminal[m
2026-02-09T19:17:20.1823568Z [31m-        v_sq = min(v_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.1824174Z [32m+[m[32m        v_sq = min(v_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.1824779Z          v_sq = max(v_sq, zero(v_sq))[m
2026-02-09T19:17:20.1825237Z  [m
2026-02-09T19:17:20.1825588Z          # Lorentz factor[m
2026-02-09T19:17:20.1826533Z [36m@@ -95,13 +95,13 @@[m [mfunction srmhd_con2prim(eos, u::SVector{8}, tol::Real, maxiter::Int)[m
2026-02-09T19:17:20.1827309Z  [m
2026-02-09T19:17:20.1827670Z          # Recover density[m
2026-02-09T19:17:20.1828113Z          rho = D / W[m
2026-02-09T19:17:20.1828564Z [31m-        rho = max(rho, 1e-12)[m
2026-02-09T19:17:20.1829359Z [32m+[m[32m        rho = max(rho, 1.0e-12)[m
2026-02-09T19:17:20.1829867Z  [m
2026-02-09T19:17:20.1830326Z          # Pressure from ξ = ρhW² with ideal gas EOS[m
2026-02-09T19:17:20.1831010Z          # h = 1 + γ/(γ-1) * P/ρ → ξ = (ρ + γ/(γ-1)*P)*W²[m
2026-02-09T19:17:20.1831627Z          # → P = (γ-1)/γ * (ξ/W² - ρ)[m
2026-02-09T19:17:20.1832206Z          P_val = gm1 / γ * (xi / W_sq - rho)[m
2026-02-09T19:17:20.1832784Z [31m-        P_val = max(P_val, 1e-16)[m
2026-02-09T19:17:20.1833391Z [32m+[m[32m        P_val = max(P_val, 1.0e-16)[m
2026-02-09T19:17:20.1833902Z  [m
2026-02-09T19:17:20.1834271Z          # Magnetic quantities[m
2026-02-09T19:17:20.1834825Z          b_sq = B_sq / W_sq + SdotB_sq / xi^2[m
2026-02-09T19:17:20.1835873Z [36m@@ -117,26 +117,26 @@[m [mfunction srmhd_con2prim(eos, u::SVector{8}, tol::Real, maxiter::Int)[m
2026-02-09T19:17:20.1836692Z          end[m
2026-02-09T19:17:20.1837018Z  [m
2026-02-09T19:17:20.1837390Z          # Numerical derivative[m
2026-02-09T19:17:20.1837953Z [31m-        dxi = max(abs(xi) * 1e-7, 1e-20)[m
2026-02-09T19:17:20.1838627Z [32m+[m[32m        dxi = max(abs(xi) * 1.0e-7, 1.0e-20)[m
2026-02-09T19:17:20.1839378Z          xi_p = xi + dxi[m
2026-02-09T19:17:20.1839759Z  [m
2026-02-09T19:17:20.1840144Z          xi_p_plus_Bsq = xi_p + B_sq[m
2026-02-09T19:17:20.1840826Z          v_sq_p_num = S_sq * xi_p^2 + SdotB_sq * (2 * xi_p + B_sq)[m
2026-02-09T19:17:20.1841522Z          v_sq_p_den = xi_p^2 * xi_p_plus_Bsq^2[m
2026-02-09T19:17:20.1842113Z          v_sq_p = v_sq_p_num / v_sq_p_den[m
2026-02-09T19:17:20.1842689Z [31m-        v_sq_p = min(v_sq_p, 1 - 1e-10)[m
2026-02-09T19:17:20.1843332Z [32m+[m[32m        v_sq_p = min(v_sq_p, 1 - 1.0e-10)[m
2026-02-09T19:17:20.1843972Z          v_sq_p = max(v_sq_p, zero(v_sq_p))[m
2026-02-09T19:17:20.1844522Z          W_sq_p = 1 / (1 - v_sq_p)[m
2026-02-09T19:17:20.1845005Z          W_p = sqrt(W_sq_p)[m
2026-02-09T19:17:20.1845512Z [31m-        rho_p = max(D / W_p, 1e-12)[m
2026-02-09T19:17:20.1846204Z [31m-        P_val_p = max(gm1 / γ * (xi_p / W_sq_p - rho_p), 1e-16)[m
2026-02-09T19:17:20.1847195Z [32m+[m[32m        rho_p = max(D / W_p, 1.0e-12)[m
2026-02-09T19:17:20.1847988Z [32m+[m[32m        P_val_p = max(gm1 / γ * (xi_p / W_sq_p - rho_p), 1.0e-16)[m
2026-02-09T19:17:20.1848908Z          b_sq_p = B_sq / W_sq_p + SdotB_sq / xi_p^2[m
2026-02-09T19:17:20.1849742Z          P_tot_p = P_val_p + 0.5 * b_sq_p[m
2026-02-09T19:17:20.1850350Z          f_val_p = xi_p + B_sq - P_tot_p - tau - D[m
2026-02-09T19:17:20.1850866Z  [m
2026-02-09T19:17:20.1851258Z          df_dxi = (f_val_p - f_val) / dxi[m
2026-02-09T19:17:20.1851722Z  [m
2026-02-09T19:17:20.1852093Z [31m-        if abs(df_dxi) < 1e-30[m
2026-02-09T19:17:20.1852659Z [32m+[m[32m        if abs(df_dxi) < 1.0e-30[m
2026-02-09T19:17:20.1853175Z              break[m
2026-02-09T19:17:20.1853538Z          end[m
2026-02-09T19:17:20.1853861Z  [m
2026-02-09T19:17:20.1854714Z [36m@@ -152,10 +152,10 @@[m [mfunction srmhd_con2prim(eos, u::SVector{8}, tol::Real, maxiter::Int)[m
2026-02-09T19:17:20.1855708Z      vz_val = (Sz + SdotB_over_xi * Bz) / xi_plus_Bsq[m
2026-02-09T19:17:20.1856228Z  [m
2026-02-09T19:17:20.1856639Z      v_sq = vx_val^2 + vy_val^2 + vz_val^2[m
2026-02-09T19:17:20.1857200Z [31m-    v_sq = min(v_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.1857798Z [32m+[m[32m    v_sq = min(v_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.1858343Z      W = 1 / sqrt(1 - v_sq)[m
2026-02-09T19:17:20.1859007Z [31m-    rho = max(D / W, 1e-12)[m
2026-02-09T19:17:20.1859650Z [31m-    P_val = max(gm1 / γ * (xi / W^2 - rho), 1e-16)[m
2026-02-09T19:17:20.1860296Z [32m+[m[32m    rho = max(D / W, 1.0e-12)[m
2026-02-09T19:17:20.1860994Z [32m+[m[32m    P_val = max(gm1 / γ * (xi / W^2 - rho), 1.0e-16)[m
2026-02-09T19:17:20.1861541Z  [m
2026-02-09T19:17:20.1862062Z      w = SVector(rho, vx_val, vy_val, vz_val, P_val, Bx, By, Bz)[m
2026-02-09T19:17:20.1862936Z      result = Con2PrimResult(converged, iterations, residual)[m
2026-02-09T19:17:20.1864140Z [34m[ 70/151] Checking `src/hyperbolic/conservation_laws.jl` ..................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1865500Z [34m[ 71/151] Checking `src/hyperbolic/euler.jl` ................................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1887141Z [34m[ 72/151] Checking `src/hyperbolic/euler_3d.jl` .............................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.1978206Z [34m[ 73/151] Checking `src/hyperbolic/grmhd.jl` ................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.1995702Z [1mdiff --git a/grmhd.jl b/grmhd.jl[m
2026-02-09T19:17:20.1996159Z [1mindex 5c35619..f309797 100644[m
2026-02-09T19:17:20.1996483Z [1m--- a/grmhd.jl[m
2026-02-09T19:17:20.1996737Z [1m+++ b/grmhd.jl[m
2026-02-09T19:17:20.1997328Z [36m@@ -62,8 +62,10 @@[m [mstruct GRMHDEquations{Dim, EOS <: AbstractEOS, M <: AbstractMetric{Dim}} <: Abst[m
2026-02-09T19:17:20.1998328Z      con2prim_maxiter::Int[m
2026-02-09T19:17:20.1998973Z  end[m
2026-02-09T19:17:20.1999301Z  [m
2026-02-09T19:17:20.1999941Z [31m-function GRMHDEquations{Dim}(eos::EOS, metric::M;[m
2026-02-09T19:17:20.2001158Z [31m-        con2prim_tol = 1e-12, con2prim_maxiter = 50) where {Dim, EOS <: AbstractEOS, M <: AbstractMetric{Dim}}[m
2026-02-09T19:17:20.2002239Z [32m+[m[32mfunction GRMHDEquations{Dim}([m
2026-02-09T19:17:20.2002967Z [32m+[m[32m        eos::EOS, metric::M;[m
2026-02-09T19:17:20.2003665Z [32m+[m[32m        con2prim_tol = 1.0e-12, con2prim_maxiter = 50[m
2026-02-09T19:17:20.2004551Z [32m+[m[32m    ) where {Dim, EOS <: AbstractEOS, M <: AbstractMetric{Dim}}[m
2026-02-09T19:17:20.2005605Z      return GRMHDEquations{Dim, EOS, M}(eos, metric, con2prim_tol, con2prim_maxiter)[m
2026-02-09T19:17:20.2006437Z  end[m
2026-02-09T19:17:20.2006738Z  [m
2026-02-09T19:17:20.2007436Z [36m@@ -246,14 +248,14 @@[m [mUses the same formula as SRMHD (flat-space Lorentz factor).[m
2026-02-09T19:17:20.2008251Z      gamma_eos = law.eos.gamma[m
2026-02-09T19:17:20.2008680Z  [m
2026-02-09T19:17:20.2009224Z      v_sq = vx^2 + vy^2 + vz^2[m
2026-02-09T19:17:20.2009976Z [31m-    v_sq = min(v_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.2010562Z [32m+[m[32m    v_sq = min(v_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.2011032Z  [m
2026-02-09T19:17:20.2011374Z      W = 1 / sqrt(1 - v_sq)[m
2026-02-09T19:17:20.2012045Z      eps_val = P / ((gamma_eos - 1) * rho)[m
2026-02-09T19:17:20.2012569Z      h = 1 + eps_val + P / rho[m
2026-02-09T19:17:20.2012966Z  [m
2026-02-09T19:17:20.2013343Z      cs_sq = gamma_eos * P / (rho * h)[m
2026-02-09T19:17:20.2013894Z [31m-    cs_sq = min(cs_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.2014502Z [32m+[m[32m    cs_sq = min(cs_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.2015000Z  [m
2026-02-09T19:17:20.2015355Z      B_sq = Bx^2 + By^2 + Bz^2[m
2026-02-09T19:17:20.2015864Z      vdotB = vx * Bx + vy * By + vz * Bz[m
2026-02-09T19:17:20.2016722Z [36m@@ -261,10 +263,10 @@[m [mUses the same formula as SRMHD (flat-space Lorentz factor).[m
2026-02-09T19:17:20.2017462Z  [m
2026-02-09T19:17:20.2017797Z      rho_h = rho * h[m
2026-02-09T19:17:20.2018269Z      ca_sq = b_sq / (rho_h + b_sq)[m
2026-02-09T19:17:20.2019017Z [31m-    ca_sq = min(ca_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.2019633Z [32m+[m[32m    ca_sq = min(ca_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.2020139Z  [m
2026-02-09T19:17:20.2020548Z      c_ms_sq = cs_sq + ca_sq - cs_sq * ca_sq[m
2026-02-09T19:17:20.2021244Z [31m-    c_ms_sq = clamp(c_ms_sq, zero(c_ms_sq), 1 - 1e-10)[m
2026-02-09T19:17:20.2022040Z [32m+[m[32m    c_ms_sq = clamp(c_ms_sq, zero(c_ms_sq), 1 - 1.0e-10)[m
2026-02-09T19:17:20.2022712Z      c_ms = sqrt(c_ms_sq)[m
2026-02-09T19:17:20.2023142Z  [m
2026-02-09T19:17:20.2023488Z      vn = dir == 1 ? vx : vy[m
2026-02-09T19:17:20.2024385Z [36m@@ -293,8 +295,10 @@[m [mMaximum wave speed in coordinate frame, accounting for lapse and shift:[m
2026-02-09T19:17:20.2025189Z  [m
2026-02-09T19:17:20.2025635Z  Used for CFL condition in the GRMHD solver.[m
2026-02-09T19:17:20.2026151Z  """[m
2026-02-09T19:17:20.2027048Z [31m-@inline function grmhd_max_wave_speed_coord(law::GRMHDEquations, w::SVector{8}, dir::Int,[m
2026-02-09T19:17:20.2027962Z [31m-        alpha, beta_dir)[m
2026-02-09T19:17:20.2028598Z [32m+[m[32m@inline function grmhd_max_wave_speed_coord([m
2026-02-09T19:17:20.2029673Z [32m+[m[32m        law::GRMHDEquations, w::SVector{8}, dir::Int,[m
2026-02-09T19:17:20.2030355Z [32m+[m[32m        alpha, beta_dir[m
2026-02-09T19:17:20.2030850Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2031368Z      lam_m, lam_p = _grmhd_wave_speeds(law, w, dir)[m
2026-02-09T19:17:20.2031998Z      # Transform to coordinate frame[m
2026-02-09T19:17:20.2032583Z      lam_m_coord = alpha * lam_m - beta_dir[m
2026-02-09T19:17:20.2033606Z [36m@@ -332,9 +336,11 @@[m [mThe source terms are computed using the stress-energy tensor contracted with[m
2026-02-09T19:17:20.2034852Z  metric derivatives (Christoffel symbols). We use centered finite differences[m
2026-02-09T19:17:20.2035678Z  for the metric derivatives.[m
2026-02-09T19:17:20.2036124Z  """[m
2026-02-09T19:17:20.2036883Z [31m-@inline function grmhd_source_terms(law::GRMHDEquations{2}, w::SVector{8},[m
2026-02-09T19:17:20.2037799Z [32m+[m[32m@inline function grmhd_source_terms([m
2026-02-09T19:17:20.2038571Z [32m+[m[32m        law::GRMHDEquations{2}, w::SVector{8},[m
2026-02-09T19:17:20.2039482Z          u_densitized::SVector{8}, md::MetricData2D,[m
2026-02-09T19:17:20.2040257Z [31m-        mesh::StructuredMesh2D, ix::Int, iy::Int)[m
2026-02-09T19:17:20.2041070Z [32m+[m[32m        mesh::StructuredMesh2D, ix::Int, iy::Int[m
2026-02-09T19:17:20.2041664Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2042257Z      rho, vx, vy, vz, P, Bx, By, Bz = w[m
2026-02-09T19:17:20.2042826Z      gamma_eos = law.eos.gamma[m
2026-02-09T19:17:20.2043323Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.2043955Z [36m@@ -465,13 +471,13 @@[m [mfor the metric derivatives.[m
2026-02-09T19:17:20.2044506Z  [m
2026-02-09T19:17:20.2044945Z      # Momentum source for x-direction (j=x):[m
2026-02-09T19:17:20.2045768Z      Sx_src = -E_und * dalpha_dx +[m
2026-02-09T19:17:20.2046418Z [31m-             Sx_und * dbetax_dx + Sy_und * dbetay_dx +[m
2026-02-09T19:17:20.2047243Z [31m-             alp * 0.5 * (Txx * dgxx_dx + 2 * Txy * dgxy_dx + Tyy * dgyy_dx)[m
2026-02-09T19:17:20.2048252Z [32m+[m[32m        Sx_und * dbetax_dx + Sy_und * dbetay_dx +[m
2026-02-09T19:17:20.2049266Z [32m+[m[32m        alp * 0.5 * (Txx * dgxx_dx + 2 * Txy * dgxy_dx + Tyy * dgyy_dx)[m
2026-02-09T19:17:20.2049900Z  [m
2026-02-09T19:17:20.2050347Z      # Momentum source for y-direction (j=y):[m
2026-02-09T19:17:20.2050940Z      Sy_src = -E_und * dalpha_dy +[m
2026-02-09T19:17:20.2051573Z [31m-             Sx_und * dbetax_dy + Sy_und * dbetay_dy +[m
2026-02-09T19:17:20.2052384Z [31m-             alp * 0.5 * (Txx * dgxx_dy + 2 * Txy * dgxy_dy + Tyy * dgyy_dy)[m
2026-02-09T19:17:20.2053211Z [32m+[m[32m        Sx_und * dbetax_dy + Sy_und * dbetay_dy +[m
2026-02-09T19:17:20.2054072Z [32m+[m[32m        alp * 0.5 * (Txx * dgxx_dy + 2 * Txy * dgxy_dy + Tyy * dgyy_dy)[m
2026-02-09T19:17:20.2054721Z  [m
2026-02-09T19:17:20.2055463Z      # ---- Energy source: S_tau = sqrt(gamma) * [-S_j partial^j alpha + alpha T^kl K_kl] ----[m
2026-02-09T19:17:20.2056609Z      # Approximate: K_ij ~ (partial_i beta_j_low + partial_j beta_i_low) / (2 alpha)[m
2026-02-09T19:17:20.2057525Z [36m@@ -499,7 +505,9 @@[m [mfor the metric derivatives.[m
2026-02-09T19:17:20.2058136Z      Sz_src = zero(Sx_src)[m
2026-02-09T19:17:20.2058534Z  [m
2026-02-09T19:17:20.2059245Z      # Multiply by sqrt(gamma) for the densitized source[m
2026-02-09T19:17:20.2059923Z [31m-    return SVector(zero(Sx_src),[m
2026-02-09T19:17:20.2060469Z [32m+[m[32m    return SVector([m
2026-02-09T19:17:20.2060972Z [32m+[m[32m        zero(Sx_src),[m
2026-02-09T19:17:20.2061601Z          sg * Sx_src, sg * Sy_src, sg * Sz_src, sg * tau_src,[m
2026-02-09T19:17:20.2062314Z [31m-        zero(Sx_src), zero(Sx_src), zero(Sx_src))[m
2026-02-09T19:17:20.2063057Z [32m+[m[32m        zero(Sx_src), zero(Sx_src), zero(Sx_src)[m
2026-02-09T19:17:20.2063649Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2064009Z  end[m
2026-02-09T19:17:20.2094592Z [34m[ 74/151] Checking `src/hyperbolic/grmhd_con2prim.jl` ........................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.2109692Z [1mdiff --git a/grmhd_con2prim.jl b/grmhd_con2prim.jl[m
2026-02-09T19:17:20.2110419Z [1mindex 0c4a2f4..d061ee5 100644[m
2026-02-09T19:17:20.2110851Z [1m--- a/grmhd_con2prim.jl[m
2026-02-09T19:17:20.2111174Z [1m+++ b/grmhd_con2prim.jl[m
2026-02-09T19:17:20.2111684Z [36m@@ -53,12 +53,16 @@[m [mend[m
2026-02-09T19:17:20.2112489Z  Metric-aware con2prim using precomputed (cached) metric quantities.[m
2026-02-09T19:17:20.2113381Z  This is the fast path used in the solver loop.[m
2026-02-09T19:17:20.2113943Z  """[m
2026-02-09T19:17:20.2114801Z [31m-@inline function grmhd_con2prim_cached(law::GRMHDEquations, u_tilde::SVector{8},[m
2026-02-09T19:17:20.2115787Z [31m-        sg, gixx, gixy, giyy, gxx, gxy, gyy)[m
2026-02-09T19:17:20.2116537Z [32m+[m[32m@inline function grmhd_con2prim_cached([m
2026-02-09T19:17:20.2117390Z [32m+[m[32m        law::GRMHDEquations, u_tilde::SVector{8},[m
2026-02-09T19:17:20.2118222Z [32m+[m[32m        sg, gixx, gixy, giyy, gxx, gxy, gyy[m
2026-02-09T19:17:20.2119014Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2119629Z      gi = StaticArrays.SMatrix{2, 2}(gixx, gixy, gixy, giyy)[m
2026-02-09T19:17:20.2120403Z      gm = StaticArrays.SMatrix{2, 2}(gxx, gxy, gxy, gyy)[m
2026-02-09T19:17:20.2121284Z [31m-    return _grmhd_con2prim_with_metric(law.eos, u_tilde, sg, gi, gm,[m
2026-02-09T19:17:20.2122122Z [31m-        law.con2prim_tol, law.con2prim_maxiter)[m
2026-02-09T19:17:20.2122829Z [32m+[m[32m    return _grmhd_con2prim_with_metric([m
2026-02-09T19:17:20.2123488Z [32m+[m[32m        law.eos, u_tilde, sg, gi, gm,[m
2026-02-09T19:17:20.2124203Z [32m+[m[32m        law.con2prim_tol, law.con2prim_maxiter[m
2026-02-09T19:17:20.2125062Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2125431Z  end[m
2026-02-09T19:17:20.2125745Z  [m
2026-02-09T19:17:20.2126048Z  """[m
2026-02-09T19:17:20.2126660Z [36m@@ -76,9 +80,11 @@[m [mInternal metric-aware con2prim implementation.[m
2026-02-09T19:17:20.2127594Z  - `tol`: Convergence tolerance.[m
2026-02-09T19:17:20.2128152Z  - `maxiter`: Maximum iterations.[m
2026-02-09T19:17:20.2128591Z  """[m
2026-02-09T19:17:20.2129590Z [31m-function _grmhd_con2prim_with_metric(eos, u_tilde::SVector{8}, sg,[m
2026-02-09T19:17:20.2130430Z [32m+[m[32mfunction _grmhd_con2prim_with_metric([m
2026-02-09T19:17:20.2131130Z [32m+[m[32m        eos, u_tilde::SVector{8}, sg,[m
2026-02-09T19:17:20.2131943Z          gi::StaticArrays.SMatrix{2, 2}, gm::StaticArrays.SMatrix{2, 2},[m
2026-02-09T19:17:20.2132732Z [31m-        tol::Real, maxiter::Int)[m
2026-02-09T19:17:20.2133380Z [32m+[m[32m        tol::Real, maxiter::Int[m
2026-02-09T19:17:20.2133900Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2134337Z      gamma_eos = eos.gamma[m
2026-02-09T19:17:20.2134807Z      gm1 = gamma_eos - 1[m
2026-02-09T19:17:20.2135196Z  [m
2026-02-09T19:17:20.2136013Z [36m@@ -94,7 +100,7 @@[m [mfunction _grmhd_con2prim_with_metric(eos, u_tilde::SVector{8}, sg,[m
2026-02-09T19:17:20.2136863Z      Bz = u_tilde[8] * inv_sg[m
2026-02-09T19:17:20.2137274Z  [m
2026-02-09T19:17:20.2137646Z      # Floor conserved density[m
2026-02-09T19:17:20.2138140Z [31m-    D = max(D, 1e-12)[m
2026-02-09T19:17:20.2138631Z [32m+[m[32m    D = max(D, 1.0e-12)[m
2026-02-09T19:17:20.2139241Z  [m
2026-02-09T19:17:20.2139861Z      # Compute S^2 = gamma^ij S_i S_j (raised with inverse spatial metric)[m
2026-02-09T19:17:20.2140761Z      # In 2D: S^2 = gi[1,1]*Sx^2 + 2*gi[1,2]*Sx*Sy + gi[2,2]*Sy^2 + Sz^2[m
2026-02-09T19:17:20.2141871Z [36m@@ -116,7 +122,7 @@[m [mfunction _grmhd_con2prim_with_metric(eos, u_tilde::SVector{8}, sg,[m
2026-02-09T19:17:20.2142935Z      # Initial guess: ξ ≈ τ + D + P_guess (non-relativistic estimate)[m
2026-02-09T19:17:20.2143649Z      SdotB_sq = SdotB^2[m
2026-02-09T19:17:20.2144092Z      E_approx = tau + D[m
2026-02-09T19:17:20.2144944Z [31m-    P_guess = max(gm1 * (E_approx - 0.5 * B_sq - 0.5 * S_sq / max(E_approx + B_sq, 1e-30)), 1e-16)[m
2026-02-09T19:17:20.2146211Z [32m+[m[32m    P_guess = max(gm1 * (E_approx - 0.5 * B_sq - 0.5 * S_sq / max(E_approx + B_sq, 1.0e-30)), 1.0e-16)[m
2026-02-09T19:17:20.2147084Z      xi = E_approx + P_guess[m
2026-02-09T19:17:20.2147489Z  [m
2026-02-09T19:17:20.2147839Z      FT = typeof(xi)[m
2026-02-09T19:17:20.2148905Z [36m@@ -133,13 +139,13 @@[m [mfunction _grmhd_con2prim_with_metric(eos, u_tilde::SVector{8}, sg,[m
2026-02-09T19:17:20.2149862Z          # v^2 from momentum (metric-corrected S^2)[m
2026-02-09T19:17:20.2150548Z          # v² = [S²ξ² + (S·B)²(2ξ + B²)] / [ξ²(ξ + B²)²][m
2026-02-09T19:17:20.2151360Z          v_sq = (S_sq + SdotB_over_xi * SdotB * (2 + B_sq / xi)) / (xi_plus_Bsq^2)[m
2026-02-09T19:17:20.2152194Z [31m-        v_sq = clamp(v_sq, zero(v_sq), 1 - 1e-10)[m
2026-02-09T19:17:20.2152941Z [32m+[m[32m        v_sq = clamp(v_sq, zero(v_sq), 1 - 1.0e-10)[m
2026-02-09T19:17:20.2153509Z  [m
2026-02-09T19:17:20.2153869Z          W_sq = 1 / (1 - v_sq)[m
2026-02-09T19:17:20.2154322Z          W = sqrt(W_sq)[m
2026-02-09T19:17:20.2154719Z  [m
2026-02-09T19:17:20.2155089Z [31m-        rho = max(D / W, 1e-12)[m
2026-02-09T19:17:20.2155777Z [31m-        P_val = max(gm1 / gamma_eos * (xi / W_sq - rho), 1e-16)[m
2026-02-09T19:17:20.2156507Z [32m+[m[32m        rho = max(D / W, 1.0e-12)[m
2026-02-09T19:17:20.2157284Z [32m+[m[32m        P_val = max(gm1 / gamma_eos * (xi / W_sq - rho), 1.0e-16)[m
2026-02-09T19:17:20.2157916Z  [m
2026-02-09T19:17:20.2158359Z          # Magnetic pressure in comoving frame[m
2026-02-09T19:17:20.2159207Z          b_sq_iter = B_sq / W_sq + SdotB^2 / xi^2[m
2026-02-09T19:17:20.2160387Z [36m@@ -155,22 +161,22 @@[m [mfunction _grmhd_con2prim_with_metric(eos, u_tilde::SVector{8}, sg,[m
2026-02-09T19:17:20.2161661Z          end[m
2026-02-09T19:17:20.2162085Z  [m
2026-02-09T19:17:20.2162685Z          # Numerical derivative[m
2026-02-09T19:17:20.2163427Z [31m-        dxi = max(abs(xi) * 1e-7, 1e-20)[m
2026-02-09T19:17:20.2164179Z [32m+[m[32m        dxi = max(abs(xi) * 1.0e-7, 1.0e-20)[m
2026-02-09T19:17:20.2165152Z          xi_p = xi + dxi[m
2026-02-09T19:17:20.2165771Z  [m
2026-02-09T19:17:20.2177899Z          SdotB_over_xi_p = SdotB / xi_p[m
2026-02-09T19:17:20.2179042Z          v_sq_p = (S_sq + SdotB_over_xi_p * SdotB * (2 + B_sq / xi_p)) / ((xi_p + B_sq)^2)[m
2026-02-09T19:17:20.2179979Z [31m-        v_sq_p = clamp(v_sq_p, zero(v_sq_p), 1 - 1e-10)[m
2026-02-09T19:17:20.2180786Z [32m+[m[32m        v_sq_p = clamp(v_sq_p, zero(v_sq_p), 1 - 1.0e-10)[m
2026-02-09T19:17:20.2181469Z          W_sq_p = 1 / (1 - v_sq_p)[m
2026-02-09T19:17:20.2181970Z          W_p = sqrt(W_sq_p)[m
2026-02-09T19:17:20.2182487Z [31m-        rho_p = max(D / W_p, 1e-12)[m
2026-02-09T19:17:20.2183249Z [31m-        P_val_p = max(gm1 / gamma_eos * (xi_p / W_sq_p - rho_p), 1e-16)[m
2026-02-09T19:17:20.2184042Z [32m+[m[32m        rho_p = max(D / W_p, 1.0e-12)[m
2026-02-09T19:17:20.2184883Z [32m+[m[32m        P_val_p = max(gm1 / gamma_eos * (xi_p / W_sq_p - rho_p), 1.0e-16)[m
2026-02-09T19:17:20.2185708Z          b_sq_p = B_sq / W_sq_p + SdotB^2 / xi_p^2[m
2026-02-09T19:17:20.2186313Z          P_tot_p = P_val_p + 0.5 * b_sq_p[m
2026-02-09T19:17:20.2186916Z          f_val_p = xi_p + B_sq - P_tot_p - tau - D[m
2026-02-09T19:17:20.2187423Z  [m
2026-02-09T19:17:20.2187823Z          df_dxi = (f_val_p - f_val) / dxi[m
2026-02-09T19:17:20.2188367Z [31m-        if abs(df_dxi) < 1e-30[m
2026-02-09T19:17:20.2189147Z [32m+[m[32m        if abs(df_dxi) < 1.0e-30[m
2026-02-09T19:17:20.2189673Z              break[m
2026-02-09T19:17:20.2190047Z          end[m
2026-02-09T19:17:20.2190366Z  [m
2026-02-09T19:17:20.2191259Z [36m@@ -209,10 +215,10 @@[m [mfunction _grmhd_con2prim_with_metric(eos, u_tilde::SVector{8}, sg,[m
2026-02-09T19:17:20.2192061Z  [m
2026-02-09T19:17:20.2192501Z      # Compute proper v^2 = gamma_ij v^i v^j[m
2026-02-09T19:17:20.2193349Z      v_sq = gm[1, 1] * vx_val^2 + 2 * gm[1, 2] * vx_val * vy_val + gm[2, 2] * vy_val^2 + vz_val^2[m
2026-02-09T19:17:20.2194129Z [31m-    v_sq = min(v_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.2194717Z [32m+[m[32m    v_sq = min(v_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.2195266Z      W = 1 / sqrt(1 - v_sq)[m
2026-02-09T19:17:20.2195747Z [31m-    rho = max(D / W, 1e-12)[m
2026-02-09T19:17:20.2196405Z [31m-    P_val = max(gm1 / gamma_eos * (xi / W^2 - rho), 1e-16)[m
2026-02-09T19:17:20.2197101Z [32m+[m[32m    rho = max(D / W, 1.0e-12)[m
2026-02-09T19:17:20.2197826Z [32m+[m[32m    P_val = max(gm1 / gamma_eos * (xi / W^2 - rho), 1.0e-16)[m
2026-02-09T19:17:20.2198451Z  [m
2026-02-09T19:17:20.2199157Z      w = SVector(rho, vx_val, vy_val, vz_val, P_val, Bx, By, Bz)[m
2026-02-09T19:17:20.2200032Z      result = Con2PrimResult(converged, iterations, residual)[m
2026-02-09T19:17:20.2200731Z [36m@@ -239,8 +245,10 @@[m [mend[m
2026-02-09T19:17:20.2201155Z  [m
2026-02-09T19:17:20.2201824Z  Convert primitive to densitized conserved using precomputed metric data.[m
2026-02-09T19:17:20.2202559Z  """[m
2026-02-09T19:17:20.2203450Z [31m-@inline function grmhd_prim2con_densitized_cached(law::GRMHDEquations, w::SVector{8},[m
2026-02-09T19:17:20.2204339Z [31m-        sg, gxx, gxy, gyy)[m
2026-02-09T19:17:20.2205024Z [32m+[m[32m@inline function grmhd_prim2con_densitized_cached([m
2026-02-09T19:17:20.2205866Z [32m+[m[32m        law::GRMHDEquations, w::SVector{8},[m
2026-02-09T19:17:20.2206503Z [32m+[m[32m        sg, gxx, gxy, gyy[m
2026-02-09T19:17:20.2206993Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2207545Z      gm = StaticArrays.SMatrix{2, 2}(gxx, gxy, gxy, gyy)[m
2026-02-09T19:17:20.2208330Z      return _grmhd_prim2con_densitized(law.eos, w, sg, gm)[m
2026-02-09T19:17:20.2209068Z  end[m
2026-02-09T19:17:20.2209908Z [36m@@ -253,14 +261,16 @@[m [mInternal: compute densitized conserved from primitives with metric data.[m
2026-02-09T19:17:20.2211329Z  The Lorentz factor uses v^2 = gamma_ij v^i v^j, and the momentum S_j[m
2026-02-09T19:17:20.2212110Z  is covariant (lowered with gamma_ij).[m
2026-02-09T19:17:20.2212785Z  """[m
2026-02-09T19:17:20.2213496Z [31m-@inline function _grmhd_prim2con_densitized(eos, w::SVector{8}, sg,[m
2026-02-09T19:17:20.2214370Z [31m-        gm::StaticArrays.SMatrix{2, 2})[m
2026-02-09T19:17:20.2215089Z [32m+[m[32m@inline function _grmhd_prim2con_densitized([m
2026-02-09T19:17:20.2215826Z [32m+[m[32m        eos, w::SVector{8}, sg,[m
2026-02-09T19:17:20.2216519Z [32m+[m[32m        gm::StaticArrays.SMatrix{2, 2}[m
2026-02-09T19:17:20.2217085Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2217530Z      rho, vx, vy, vz, P, Bx, By, Bz = w[m
2026-02-09T19:17:20.2218136Z      gamma_eos = eos.gamma[m
2026-02-09T19:17:20.2218550Z  [m
2026-02-09T19:17:20.2219149Z      # v^2 = gamma_ij v^i v^j (metric-corrected)[m
2026-02-09T19:17:20.2219912Z      v_sq = gm[1, 1] * vx^2 + 2 * gm[1, 2] * vx * vy + gm[2, 2] * vy^2 + vz^2[m
2026-02-09T19:17:20.2220566Z [31m-    v_sq = min(v_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.2221143Z [32m+[m[32m    v_sq = min(v_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.2221637Z  [m
2026-02-09T19:17:20.2222001Z      W = 1 / sqrt(1 - v_sq)[m
2026-02-09T19:17:20.2222424Z      W_sq = W^2[m
2026-02-09T19:17:20.2223003Z [36m@@ -304,6 +314,8 @@[m [mis covariant (lowered with gamma_ij).[m
2026-02-09T19:17:20.2223704Z      tau = rho_h_W2 + B_sq - Ptot - D[m
2026-02-09T19:17:20.2224174Z  [m
2026-02-09T19:17:20.2224596Z      # Densitize: multiply by sqrt(gamma)[m
2026-02-09T19:17:20.2225318Z [31m-    return SVector(sg * D, sg * Sx_c, sg * Sy_c, sg * Sz_c,[m
2026-02-09T19:17:20.2226050Z [31m-        sg * tau, sg * Bx, sg * By, sg * Bz)[m
2026-02-09T19:17:20.2226614Z [32m+[m[32m    return SVector([m
2026-02-09T19:17:20.2227235Z [32m+[m[32m        sg * D, sg * Sx_c, sg * Sy_c, sg * Sz_c,[m
2026-02-09T19:17:20.2227941Z [32m+[m[32m        sg * tau, sg * Bx, sg * By, sg * Bz[m
2026-02-09T19:17:20.2228495Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2229001Z  end[m
2026-02-09T19:17:20.2274597Z [34m[ 75/151] Checking `src/hyperbolic/grmhd_solve_2d.jl` ........................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.2290754Z [1mdiff --git a/grmhd_solve_2d.jl b/grmhd_solve_2d.jl[m
2026-02-09T19:17:20.2291382Z [1mindex 31156f9..66e9795 100644[m
2026-02-09T19:17:20.2291730Z [1m--- a/grmhd_solve_2d.jl[m
2026-02-09T19:17:20.2292109Z [1m+++ b/grmhd_solve_2d.jl[m
2026-02-09T19:17:20.2292611Z [36m@@ -76,8 +76,10 @@[m [mend[m
2026-02-09T19:17:20.2293317Z  Compute the time step using metric-corrected wave speeds:[m
2026-02-09T19:17:20.2294117Z    `lambda_coord = alpha * lambda_flat - beta`[m
2026-02-09T19:17:20.2294660Z  """[m
2026-02-09T19:17:20.2295450Z [31m-function compute_dt_2d(prob::HyperbolicProblem2D{<:GRMHDEquations{2}},[m
2026-02-09T19:17:20.2296482Z [31m-        U::AbstractMatrix, t, md::MetricData2D)[m
2026-02-09T19:17:20.2297163Z [32m+[m[32mfunction compute_dt_2d([m
2026-02-09T19:17:20.2297956Z [32m+[m[32m        prob::HyperbolicProblem2D{<:GRMHDEquations{2}},[m
2026-02-09T19:17:20.2299076Z [32m+[m[32m        U::AbstractMatrix, t, md::MetricData2D[m
2026-02-09T19:17:20.2299715Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2300143Z      law = prob.law[m
2026-02-09T19:17:20.2300556Z      mesh = prob.mesh[m
2026-02-09T19:17:20.2301016Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.2301685Z [36m@@ -129,7 +131,8 @@[m [mfunction _grmhd_compute_fluxes_2d!([m
2026-02-09T19:17:20.2302462Z          Fx_all::AbstractMatrix, Fy_all::AbstractMatrix,[m
2026-02-09T19:17:20.2303164Z          dU::AbstractMatrix, U::AbstractMatrix,[m
2026-02-09T19:17:20.2303915Z          prob::HyperbolicProblem2D{<:GRMHDEquations{2}}, t,[m
2026-02-09T19:17:20.2304695Z [31m-        md::MetricData2D, face_data)[m
2026-02-09T19:17:20.2305375Z [32m+[m[32m        md::MetricData2D, face_data[m
2026-02-09T19:17:20.2306174Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2306579Z      law = prob.law[m
2026-02-09T19:17:20.2306993Z      mesh = prob.mesh[m
2026-02-09T19:17:20.2307453Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.2307952Z [36m@@ -226,9 +229,11 @@[m [mend[m
2026-02-09T19:17:20.2308555Z  [m
2026-02-09T19:17:20.2309285Z  Add geometric source terms to dU at all interior cells.[m
2026-02-09T19:17:20.2309888Z  """[m
2026-02-09T19:17:20.2310651Z [31m-function _grmhd_add_source_terms!(dU::AbstractMatrix, U::AbstractMatrix,[m
2026-02-09T19:17:20.2311534Z [32m+[m[32mfunction _grmhd_add_source_terms!([m
2026-02-09T19:17:20.2312313Z [32m+[m[32m        dU::AbstractMatrix, U::AbstractMatrix,[m
2026-02-09T19:17:20.2313047Z          law::GRMHDEquations{2}, md::MetricData2D,[m
2026-02-09T19:17:20.2313786Z [31m-        mesh::StructuredMesh2D, nx::Int, ny::Int)[m
2026-02-09T19:17:20.2314584Z [32m+[m[32m        mesh::StructuredMesh2D, nx::Int, ny::Int[m
2026-02-09T19:17:20.2315184Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2315621Z      for iy in 1:ny, ix in 1:nx[m
2026-02-09T19:17:20.2316108Z          ii, jj = ix + 2, iy + 2[m
2026-02-09T19:17:20.2316685Z          w = conserved_to_primitive(law, U[ii, jj])[m
2026-02-09T19:17:20.2317634Z [36m@@ -258,8 +263,10 @@[m [mSolve the 2D GRMHD problem using the Valencia formulation with:[m
2026-02-09T19:17:20.2318496Z  - `t_final`: Final time reached.[m
2026-02-09T19:17:20.2319481Z  - `ct`: Final `CTData2D` for inspecting div(B) and face-centered B.[m
2026-02-09T19:17:20.2320127Z  """[m
2026-02-09T19:17:20.2320922Z [31m-function solve_hyperbolic(prob::HyperbolicProblem2D{<:GRMHDEquations{2}};[m
2026-02-09T19:17:20.2321982Z [31m-        method::Symbol = :ssprk3, vector_potential = nothing)[m
2026-02-09T19:17:20.2322710Z [32m+[m[32mfunction solve_hyperbolic([m
2026-02-09T19:17:20.2323499Z [32m+[m[32m        prob::HyperbolicProblem2D{<:GRMHDEquations{2}};[m
2026-02-09T19:17:20.2324440Z [32m+[m[32m        method::Symbol = :ssprk3, vector_potential = nothing[m
2026-02-09T19:17:20.2325118Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2325526Z      mesh = prob.mesh[m
2026-02-09T19:17:20.2325991Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.2326489Z      dx, dy = mesh.dx, mesh.dy[m
2026-02-09T19:17:20.2348475Z [34m[ 76/151] Checking `src/hyperbolic/hllc_solver.jl` ........................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.2362640Z [1mdiff --git a/hllc_solver.jl b/hllc_solver.jl[m
2026-02-09T19:17:20.2363105Z [1mindex abe8f09..ce7bb20 100644[m
2026-02-09T19:17:20.2363440Z [1m--- a/hllc_solver.jl[m
2026-02-09T19:17:20.2363732Z [1m+++ b/hllc_solver.jl[m
2026-02-09T19:17:20.2364615Z [36m@@ -47,7 +47,7 @@[m [mfunction solve_riemann(::HLLCSolver, law::EulerEquations{1}, wL::SVector{3}, wR:[m
2026-02-09T19:17:20.2365503Z  [m
2026-02-09T19:17:20.2365894Z      # Contact wave speed[m
2026-02-09T19:17:20.2366561Z      S_star = (PR - PL + ρL * vL * (SL - vL) - ρR * vR * (SR - vR)) /[m
2026-02-09T19:17:20.2367352Z [31m-             (ρL * (SL - vL) - ρR * (SR - vR))[m
2026-02-09T19:17:20.2368028Z [32m+[m[32m        (ρL * (SL - vL) - ρR * (SR - vR))[m
2026-02-09T19:17:20.2368575Z  [m
2026-02-09T19:17:20.2369171Z      if SL >= zero(SL)[m
2026-02-09T19:17:20.2369648Z          # Left of all waves[m
2026-02-09T19:17:20.2370473Z [36m@@ -78,7 +78,7 @@[m [mIf P_star > P_K (shock), q > 1; if P_star ≤ P_K (rarefaction), q = 1.[m
2026-02-09T19:17:20.2371255Z      if P_star <= P_K[m
2026-02-09T19:17:20.2371711Z          return one(P_star)[m
2026-02-09T19:17:20.2372130Z      else[m
2026-02-09T19:17:20.2372554Z [31m-        P_K_safe = max(P_K, 1e-30)[m
2026-02-09T19:17:20.2373162Z [32m+[m[32m        P_K_safe = max(P_K, 1.0e-30)[m
2026-02-09T19:17:20.2373905Z          arg = one(P_star) + (γ + 1) / (2γ) * (P_star / P_K_safe - 1)[m
2026-02-09T19:17:20.2374602Z          return sqrt(max(arg, one(P_star)))[m
2026-02-09T19:17:20.2375093Z      end[m
2026-02-09T19:17:20.2376059Z [36m@@ -140,7 +140,7 @@[m [mfunction solve_riemann(::HLLCSolver, law::EulerEquations{2}, wL::SVector{4}, wR:[m
2026-02-09T19:17:20.2377144Z  [m
2026-02-09T19:17:20.2377499Z      # Contact wave speed[m
2026-02-09T19:17:20.2378138Z      S_star = (PR - PL + ρL * vnL * (SL - vnL) - ρR * vnR * (SR - vnR)) /[m
2026-02-09T19:17:20.2379254Z [31m-             (ρL * (SL - vnL) - ρR * (SR - vnR))[m
2026-02-09T19:17:20.2379934Z [32m+[m[32m        (ρL * (SL - vnL) - ρR * (SR - vnR))[m
2026-02-09T19:17:20.2380464Z  [m
2026-02-09T19:17:20.2380815Z      if SL >= zero(SL)[m
2026-02-09T19:17:20.2381318Z          return physical_flux(law, wL, dir)[m
2026-02-09T19:17:20.2432370Z [34m[ 77/151] Checking `src/hyperbolic/hlld_solver.jl` ........................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.2446773Z [1mdiff --git a/hlld_solver.jl b/hlld_solver.jl[m
2026-02-09T19:17:20.2447234Z [1mindex 699c3bd..f85a974 100644[m
2026-02-09T19:17:20.2447571Z [1m--- a/hlld_solver.jl[m
2026-02-09T19:17:20.2447871Z [1m+++ b/hlld_solver.jl[m
2026-02-09T19:17:20.2448978Z [36m@@ -85,8 +85,8 @@[m [mfunction solve_riemann(::HLLDSolver, law::IdealMHDEquations, wL::SVector{8}, wR:[m
2026-02-09T19:17:20.2450005Z      ρR_star = ρR * (SR - vnR) / (SR - SM)[m
2026-02-09T19:17:20.2450539Z  [m
2026-02-09T19:17:20.2450970Z      # Guard against negative densities[m
2026-02-09T19:17:20.2451571Z [31m-    ρL_star = max(ρL_star, 1e-20)[m
2026-02-09T19:17:20.2452214Z [31m-    ρR_star = max(ρR_star, 1e-20)[m
2026-02-09T19:17:20.2452873Z [32m+[m[32m    ρL_star = max(ρL_star, 1.0e-20)[m
2026-02-09T19:17:20.2453548Z [32m+[m[32m    ρR_star = max(ρR_star, 1.0e-20)[m
2026-02-09T19:17:20.2454063Z  [m
2026-02-09T19:17:20.2454516Z      # Star tangential velocities and B-fields[m
2026-02-09T19:17:20.2455343Z      vt1L_star, vt2L_star, Bt1L_star, Bt2L_star = _hlld_tangential_star([m
2026-02-09T19:17:20.2456681Z [36m@@ -118,7 +118,7 @@[m [mfunction solve_riemann(::HLLDSolver, law::IdealMHDEquations, wL::SVector{8}, wR:[m
2026-02-09T19:17:20.2457702Z      SL_star = SM - abs_Bn / sqrt_ρL_star[m
2026-02-09T19:17:20.2458294Z      SR_star = SM + abs_Bn / sqrt_ρR_star[m
2026-02-09T19:17:20.2459017Z  [m
2026-02-09T19:17:20.2459435Z [31m-    if SM >= zero(SM)[m
2026-02-09T19:17:20.2459970Z [32m+[m[32m    return if SM >= zero(SM)[m
2026-02-09T19:17:20.2460524Z          # Left side of contact[m
2026-02-09T19:17:20.2461081Z          fL_star = fL + SL * (uL_star - uL)[m
2026-02-09T19:17:20.2461639Z          if SL_star >= zero(SL_star)[m
2026-02-09T19:17:20.2462390Z [36m@@ -170,7 +170,7 @@[m [mFrom Miyoshi & Kusano (2005), eqs (44)-(47).[m
2026-02-09T19:17:20.2463019Z  [m
2026-02-09T19:17:20.2463410Z      # Scale for tolerance check[m
2026-02-09T19:17:20.2464124Z      scale = max(abs(ρ * (SK - vn) * (SK - SM)), Bn_sq, eps(typeof(vn)))[m
2026-02-09T19:17:20.2464862Z [31m-    if abs(denom) > 1e-8 * scale[m
2026-02-09T19:17:20.2465456Z [32m+[m[32m    if abs(denom) > 1.0e-8 * scale[m
2026-02-09T19:17:20.2466109Z          factor_v = sqrt(Bn_sq) * (SM - vn) / denom[m
2026-02-09T19:17:20.2466799Z          factor_B = (ρ * (SK - vn)^2 - Bn_sq) / denom[m
2026-02-09T19:17:20.2467310Z  [m
2026-02-09T19:17:20.2467880Z [36m@@ -225,7 +225,7 @@[m [mFrom Miyoshi & Kusano (2005), eqs (59)-(63).[m
2026-02-09T19:17:20.2468515Z      )[m
2026-02-09T19:17:20.2469093Z      denom = sqrt_ρL + sqrt_ρR[m
2026-02-09T19:17:20.2469542Z  [m
2026-02-09T19:17:20.2469899Z [31m-    if denom < 1e-30[m
2026-02-09T19:17:20.2470390Z [32m+[m[32m    if denom < 1.0e-30[m
2026-02-09T19:17:20.2471109Z          # Both densities effectively zero — return star state as-is[m
2026-02-09T19:17:20.2471884Z          ρ_ds = side == :left ? ρL_star : ρR_star[m
2026-02-09T19:17:20.2472561Z          vt1_ds = side == :left ? vt1L_star : vt1R_star[m
2026-02-09T19:17:20.2473401Z [36m@@ -238,16 +238,24 @@[m [mFrom Miyoshi & Kusano (2005), eqs (59)-(63).[m
2026-02-09T19:17:20.2474183Z      sign_Bn = Bn >= zero(Bn) ? one(Bn) : -one(Bn)[m
2026-02-09T19:17:20.2474688Z  [m
2026-02-09T19:17:20.2475418Z      # Averaged tangential velocities (eq 59-60)[m
2026-02-09T19:17:20.2476175Z [31m-    vt1_ds = (sqrt_ρL * vt1L_star + sqrt_ρR * vt1R_star +[m
2026-02-09T19:17:20.2476956Z [31m-              (Bt1R_star - Bt1L_star) * sign_Bn) / denom[m
2026-02-09T19:17:20.2477909Z [31m-    vt2_ds = (sqrt_ρL * vt2L_star + sqrt_ρR * vt2R_star +[m
2026-02-09T19:17:20.2478671Z [31m-              (Bt2R_star - Bt2L_star) * sign_Bn) / denom[m
2026-02-09T19:17:20.2479516Z [32m+[m[32m    vt1_ds = ([m
2026-02-09T19:17:20.2480140Z [32m+[m[32m        sqrt_ρL * vt1L_star + sqrt_ρR * vt1R_star +[m
2026-02-09T19:17:20.2480901Z [32m+[m[32m            (Bt1R_star - Bt1L_star) * sign_Bn[m
2026-02-09T19:17:20.2481481Z [32m+[m[32m    ) / denom[m
2026-02-09T19:17:20.2481930Z [32m+[m[32m    vt2_ds = ([m
2026-02-09T19:17:20.2482525Z [32m+[m[32m        sqrt_ρL * vt2L_star + sqrt_ρR * vt2R_star +[m
2026-02-09T19:17:20.2483269Z [32m+[m[32m            (Bt2R_star - Bt2L_star) * sign_Bn[m
2026-02-09T19:17:20.2483863Z [32m+[m[32m    ) / denom[m
2026-02-09T19:17:20.2484301Z  [m
2026-02-09T19:17:20.2484782Z      # Averaged tangential B-fields (eq 61-62)[m
2026-02-09T19:17:20.2485550Z [31m-    Bt1_ds = (sqrt_ρL * Bt1R_star + sqrt_ρR * Bt1L_star +[m
2026-02-09T19:17:20.2486459Z [31m-              sqrt_ρL * sqrt_ρR * (vt1R_star - vt1L_star) * sign_Bn) / denom[m
2026-02-09T19:17:20.2487323Z [31m-    Bt2_ds = (sqrt_ρL * Bt2R_star + sqrt_ρR * Bt2L_star +[m
2026-02-09T19:17:20.2488189Z [31m-              sqrt_ρL * sqrt_ρR * (vt2R_star - vt2L_star) * sign_Bn) / denom[m
2026-02-09T19:17:20.2489071Z [32m+[m[32m    Bt1_ds = ([m
2026-02-09T19:17:20.2489715Z [32m+[m[32m        sqrt_ρL * Bt1R_star + sqrt_ρR * Bt1L_star +[m
2026-02-09T19:17:20.2490574Z [32m+[m[32m            sqrt_ρL * sqrt_ρR * (vt1R_star - vt1L_star) * sign_Bn[m
2026-02-09T19:17:20.2491250Z [32m+[m[32m    ) / denom[m
2026-02-09T19:17:20.2491687Z [32m+[m[32m    Bt2_ds = ([m
2026-02-09T19:17:20.2492269Z [32m+[m[32m        sqrt_ρL * Bt2R_star + sqrt_ρR * Bt2L_star +[m
2026-02-09T19:17:20.2493101Z [32m+[m[32m            sqrt_ρL * sqrt_ρR * (vt2R_star - vt2L_star) * sign_Bn[m
2026-02-09T19:17:20.2493780Z [32m+[m[32m    ) / denom[m
2026-02-09T19:17:20.2494204Z  [m
2026-02-09T19:17:20.2494582Z      # Energy update (eq 63)[m
2026-02-09T19:17:20.2495051Z      if side == :left[m
2026-02-09T19:17:20.2495995Z [34m[ 78/151] Checking `src/hyperbolic/hyperbolic_problem.jl` .................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.2497403Z [34m[ 79/151] Checking `src/hyperbolic/hyperbolic_problem_2d.jl` ................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.2498947Z [34m[ 80/151] Checking `src/hyperbolic/hyperbolic_problem_3d.jl` ................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.2606860Z [34m[ 81/151] Checking `src/hyperbolic/hyperbolic_solve.jl` ...................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.2680466Z [34m[ 82/151] Checking `src/hyperbolic/hyperbolic_solve_2d.jl` ................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.2776717Z [34m[ 83/151] Checking `src/hyperbolic/hyperbolic_solve_3d.jl` ................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.2792132Z [1mdiff --git a/hyperbolic_solve_3d.jl b/hyperbolic_solve_3d.jl[m
2026-02-09T19:17:20.2792839Z [1mindex ecd59d2..cf512ce 100644[m
2026-02-09T19:17:20.2793199Z [1m--- a/hyperbolic_solve_3d.jl[m
2026-02-09T19:17:20.2793786Z [1m+++ b/hyperbolic_solve_3d.jl[m
2026-02-09T19:17:20.2794552Z [36m@@ -186,8 +186,10 @@[m [mdimension-by-dimension flux differencing:[m
2026-02-09T19:17:20.2795411Z                    -1/dy * (Fy_{i,j+1/2,k} - Fy_{i,j-1/2,k})[m
2026-02-09T19:17:20.2796119Z                    -1/dz * (Fz_{i,j,k+1/2} - Fz_{i,j,k-1/2})`[m
2026-02-09T19:17:20.2796664Z  """[m
2026-02-09T19:17:20.2797527Z [31m-function hyperbolic_rhs_3d!(dU::AbstractArray{T, 3}, U::AbstractArray{T, 3},[m
2026-02-09T19:17:20.2798561Z [31m-        prob::HyperbolicProblem3D, t) where {T}[m
2026-02-09T19:17:20.2799785Z [32m+[m[32mfunction hyperbolic_rhs_3d!([m
2026-02-09T19:17:20.2800607Z [32m+[m[32m        dU::AbstractArray{T, 3}, U::AbstractArray{T, 3},[m
2026-02-09T19:17:20.2801454Z [32m+[m[32m        prob::HyperbolicProblem3D, t[m
2026-02-09T19:17:20.2802221Z [32m+[m[32m    ) where {T}[m
2026-02-09T19:17:20.2802670Z      law = prob.law[m
2026-02-09T19:17:20.2803109Z      mesh = prob.mesh[m
2026-02-09T19:17:20.2803609Z      nx, ny, nz = mesh.nx, mesh.ny, mesh.nz[m
2026-02-09T19:17:20.2821185Z [34m[ 84/151] Checking `src/hyperbolic/imex.jl` .................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.2835072Z [1mdiff --git a/imex.jl b/imex.jl[m
2026-02-09T19:17:20.2835663Z [1mindex 523c458..eee704a 100644[m
2026-02-09T19:17:20.2836073Z [1m--- a/imex.jl[m
2026-02-09T19:17:20.2836330Z [1m+++ b/imex.jl[m
2026-02-09T19:17:20.2837077Z [36m@@ -75,13 +75,13 @@[m [mfunction imex_tableau(::IMEX_SSP3_433)[m
2026-02-09T19:17:20.2837704Z  [m
2026-02-09T19:17:20.2838099Z      α = 0.24169426078821[m
2026-02-09T19:17:20.2838545Z      β = 0.06042356519705[m
2026-02-09T19:17:20.2839188Z [31m-    η = 0.12915286960590[m
2026-02-09T19:17:20.2839682Z [32m+[m[32m    η = 0.1291528696059[m
2026-02-09T19:17:20.2840140Z  [m
2026-02-09T19:17:20.2840478Z      A_ex = ([m
2026-02-09T19:17:20.2840898Z          (0.0, 0.0, 0.0, 0.0),[m
2026-02-09T19:17:20.2841349Z          (0.5, 0.0, 0.0, 0.0),[m
2026-02-09T19:17:20.2841795Z          (0.5, 0.5, 0.0, 0.0),[m
2026-02-09T19:17:20.2842332Z [31m-        (1.0 / 6.0, 1.0 / 6.0, 1.0 / 6.0, 0.0)[m
2026-02-09T19:17:20.2842972Z [32m+[m[32m        (1.0 / 6.0, 1.0 / 6.0, 1.0 / 6.0, 0.0),[m
2026-02-09T19:17:20.2843493Z      )[m
2026-02-09T19:17:20.2843929Z      b_ex = (1.0 / 6.0, 1.0 / 6.0, 1.0 / 6.0, 0.5)[m
2026-02-09T19:17:20.2844455Z      c_ex = (0.0, 0.5, 1.0, 0.5)[m
2026-02-09T19:17:20.2845219Z [36m@@ -92,14 +92,16 @@[m [mfunction imex_tableau(::IMEX_SSP3_433)[m
2026-02-09T19:17:20.2845852Z          (α, 0.0, 0.0, 0.0),[m
2026-02-09T19:17:20.2846319Z          (-α, α, 0.0, 0.0),[m
2026-02-09T19:17:20.2846762Z          (0.0, 1.0 - α, α, 0.0),[m
2026-02-09T19:17:20.2847273Z [31m-        (β, η, 1.0 - α - β - η, α)[m
2026-02-09T19:17:20.2847838Z [32m+[m[32m        (β, η, 1.0 - α - β - η, α),[m
2026-02-09T19:17:20.2848355Z      )[m
2026-02-09T19:17:20.2848925Z      b_im = (β, η, 1.0 - α - β - η, α)[m
2026-02-09T19:17:20.2849443Z      c_im = (α, 0.0, 1.0, 1.0)[m
2026-02-09T19:17:20.2849856Z  [m
2026-02-09T19:17:20.2850337Z [31m-    return (A_ex = A_ex, b_ex = b_ex, c_ex = c_ex,[m
2026-02-09T19:17:20.2850932Z [32m+[m[32m    return ([m
2026-02-09T19:17:20.2851505Z [32m+[m[32m        A_ex = A_ex, b_ex = b_ex, c_ex = c_ex,[m
2026-02-09T19:17:20.2852136Z          A_im = A_im, b_im = b_im, c_im = c_im,[m
2026-02-09T19:17:20.2852633Z [31m-        s = 4)[m
2026-02-09T19:17:20.2853027Z [32m+[m[32m        s = 4,[m
2026-02-09T19:17:20.2853430Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2853785Z  end[m
2026-02-09T19:17:20.2854091Z  [m
2026-02-09T19:17:20.2854529Z  # ============================================================[m
2026-02-09T19:17:20.2855365Z [36m@@ -130,7 +132,7 @@[m [mfunction imex_tableau(::IMEX_ARS222)[m
2026-02-09T19:17:20.2855996Z      A_ex = ([m
2026-02-09T19:17:20.2856403Z          (0.0, 0.0, 0.0),[m
2026-02-09T19:17:20.2856826Z          (γ, 0.0, 0.0),[m
2026-02-09T19:17:20.2857268Z [31m-        (δ, 1.0 - δ, 0.0)[m
2026-02-09T19:17:20.2857762Z [32m+[m[32m        (δ, 1.0 - δ, 0.0),[m
2026-02-09T19:17:20.2858224Z      )[m
2026-02-09T19:17:20.2858589Z      b_ex = (0.0, 1.0 - γ, γ)[m
2026-02-09T19:17:20.2859264Z      c_ex = (0.0, γ, 1.0)[m
2026-02-09T19:17:20.2859980Z [36m@@ -139,14 +141,16 @@[m [mfunction imex_tableau(::IMEX_ARS222)[m
2026-02-09T19:17:20.2860605Z      A_im = ([m
2026-02-09T19:17:20.2860973Z          (0.0, 0.0, 0.0),[m
2026-02-09T19:17:20.2861401Z          (0.0, γ, 0.0),[m
2026-02-09T19:17:20.2861831Z [31m-        (0.0, 1.0 - γ, γ)[m
2026-02-09T19:17:20.2862573Z [32m+[m[32m        (0.0, 1.0 - γ, γ),[m
2026-02-09T19:17:20.2863030Z      )[m
2026-02-09T19:17:20.2863394Z      b_im = (0.0, 1.0 - γ, γ)[m
2026-02-09T19:17:20.2863857Z      c_im = (0.0, γ, 1.0)[m
2026-02-09T19:17:20.2864244Z  [m
2026-02-09T19:17:20.2864991Z [31m-    return (A_ex = A_ex, b_ex = b_ex, c_ex = c_ex,[m
2026-02-09T19:17:20.2865585Z [32m+[m[32m    return ([m
2026-02-09T19:17:20.2866162Z [32m+[m[32m        A_ex = A_ex, b_ex = b_ex, c_ex = c_ex,[m
2026-02-09T19:17:20.2866820Z          A_im = A_im, b_im = b_im, c_im = c_im,[m
2026-02-09T19:17:20.2867349Z [31m-        s = 3)[m
2026-02-09T19:17:20.2867762Z [32m+[m[32m        s = 3,[m
2026-02-09T19:17:20.2868184Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2868547Z  end[m
2026-02-09T19:17:20.2869021Z  [m
2026-02-09T19:17:20.2869459Z  # ============================================================[m
2026-02-09T19:17:20.2870262Z [36m@@ -170,19 +174,21 @@[m [mimex_nstages(::IMEX_Midpoint) = 2[m
2026-02-09T19:17:20.2870995Z  function imex_tableau(::IMEX_Midpoint)[m
2026-02-09T19:17:20.2871505Z      A_ex = ([m
2026-02-09T19:17:20.2871876Z          (0.0, 0.0),[m
2026-02-09T19:17:20.2872267Z [31m-        (1.0, 0.0)[m
2026-02-09T19:17:20.2872708Z [32m+[m[32m        (1.0, 0.0),[m
2026-02-09T19:17:20.2873146Z      )[m
2026-02-09T19:17:20.2873486Z      b_ex = (0.5, 0.5)[m
2026-02-09T19:17:20.2873897Z      c_ex = (0.0, 1.0)[m
2026-02-09T19:17:20.2874260Z  [m
2026-02-09T19:17:20.2874581Z      A_im = ([m
2026-02-09T19:17:20.2875010Z          (0.0, 0.0),[m
2026-02-09T19:17:20.2875406Z [31m-        (0.0, 1.0)[m
2026-02-09T19:17:20.2875833Z [32m+[m[32m        (0.0, 1.0),[m
2026-02-09T19:17:20.2876260Z      )[m
2026-02-09T19:17:20.2876598Z      b_im = (0.0, 1.0)[m
2026-02-09T19:17:20.2877004Z      c_im = (0.0, 1.0)[m
2026-02-09T19:17:20.2877361Z  [m
2026-02-09T19:17:20.2877840Z [31m-    return (A_ex = A_ex, b_ex = b_ex, c_ex = c_ex,[m
2026-02-09T19:17:20.2878439Z [32m+[m[32m    return ([m
2026-02-09T19:17:20.2879187Z [32m+[m[32m        A_ex = A_ex, b_ex = b_ex, c_ex = c_ex,[m
2026-02-09T19:17:20.2879858Z          A_im = A_im, b_im = b_im, c_im = c_im,[m
2026-02-09T19:17:20.2880383Z [31m-        s = 2)[m
2026-02-09T19:17:20.2880802Z [32m+[m[32m        s = 2,[m
2026-02-09T19:17:20.2881232Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2881601Z  end[m
2026-02-09T19:17:20.2943011Z [34m[ 85/151] Checking `src/hyperbolic/imex_solve.jl` ............................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.2957976Z [1mdiff --git a/imex_solve.jl b/imex_solve.jl[m
2026-02-09T19:17:20.2958619Z [1mindex 343b784..15d8bde 100644[m
2026-02-09T19:17:20.2959171Z [1m--- a/imex_solve.jl[m
2026-02-09T19:17:20.2959544Z [1m+++ b/imex_solve.jl[m
2026-02-09T19:17:20.2960180Z [36m@@ -38,10 +38,12 @@[m [mRunge-Kutta time integration.[m
2026-02-09T19:17:20.2961202Z  - `U_final::Vector{SVector{N}}`: Final conserved variable vectors at cell centers.[m
2026-02-09T19:17:20.2962121Z  - `t_final::Real`: Final time reached.[m
2026-02-09T19:17:20.2962650Z  """[m
2026-02-09T19:17:20.2963628Z [31m-function solve_hyperbolic_imex(prob::HyperbolicProblem, stiff_source::AbstractStiffSource;[m
2026-02-09T19:17:20.2964706Z [32m+[m[32mfunction solve_hyperbolic_imex([m
2026-02-09T19:17:20.2965671Z [32m+[m[32m        prob::HyperbolicProblem, stiff_source::AbstractStiffSource;[m
2026-02-09T19:17:20.2966573Z          scheme::AbstractIMEXScheme = IMEX_SSP3_433(),[m
2026-02-09T19:17:20.2967208Z [31m-        newton_tol = 1e-10,[m
2026-02-09T19:17:20.2967807Z [31m-        newton_maxiter::Int = 5)[m
2026-02-09T19:17:20.2968378Z [32m+[m[32m        newton_tol = 1.0e-10,[m
2026-02-09T19:17:20.2969319Z [32m+[m[32m        newton_maxiter::Int = 5[m
2026-02-09T19:17:20.2969859Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2970280Z      mesh = prob.mesh[m
2026-02-09T19:17:20.2970713Z      nc = ncells(mesh)[m
2026-02-09T19:17:20.2971149Z      law = prob.law[m
2026-02-09T19:17:20.2972151Z [36m@@ -116,8 +118,10 @@[m [mfunction solve_hyperbolic_imex(prob::HyperbolicProblem, stiff_source::AbstractSt[m
2026-02-09T19:17:20.2973388Z                  #   U* = U_stage + a_kk * dt * S(U*)[m
2026-02-09T19:17:20.2974085Z                  # Newton iteration: given U_guess, solve[m
2026-02-09T19:17:20.2975180Z                  #   (I - a_kk*dt*J) * (U_new - U_guess) = U_stage + a_kk*dt*S(U_guess) - U_guess[m
2026-02-09T19:17:20.2976239Z [31m-                _implicit_solve_1d!(U_stage, law, stiff_source, a_kk * dt, nc, N,[m
2026-02-09T19:17:20.2977098Z [31m-                    newton_tol, newton_maxiter)[m
2026-02-09T19:17:20.2977746Z [32m+[m[32m                _implicit_solve_1d!([m
2026-02-09T19:17:20.2978512Z [32m+[m[32m                    U_stage, law, stiff_source, a_kk * dt, nc, N,[m
2026-02-09T19:17:20.2979530Z [32m+[m[32m                    newton_tol, newton_maxiter[m
2026-02-09T19:17:20.2980134Z [32m+[m[32m                )[m
2026-02-09T19:17:20.2980545Z  [m
2026-02-09T19:17:20.2981133Z                  # After the solve, U_stage contains the updated stage value.[m
2026-02-09T19:17:20.2981870Z                  # K_im[k] = S(U_stage)[m
2026-02-09T19:17:20.2982540Z [36m@@ -219,10 +223,12 @@[m [mRunge-Kutta time integration.[m
2026-02-09T19:17:20.2983475Z  - `U_final::Matrix{SVector{N}}`: Final conserved variable matrix (nx x ny).[m
2026-02-09T19:17:20.2984281Z  - `t_final::Real`: Final time reached.[m
2026-02-09T19:17:20.2984769Z  """[m
2026-02-09T19:17:20.2985545Z [31m-function solve_hyperbolic_imex(prob::HyperbolicProblem2D, stiff_source::AbstractStiffSource;[m
2026-02-09T19:17:20.2985822Z [32m+[m[32mfunction solve_hyperbolic_imex([m
2026-02-09T19:17:20.2986378Z [32m+[m[32m        prob::HyperbolicProblem2D, stiff_source::AbstractStiffSource;[m
2026-02-09T19:17:20.2986773Z          scheme::AbstractIMEXScheme = IMEX_SSP3_433(),[m
2026-02-09T19:17:20.2986990Z [31m-        newton_tol = 1e-10,[m
2026-02-09T19:17:20.2987277Z [31m-        newton_maxiter::Int = 5)[m
2026-02-09T19:17:20.2987531Z [32m+[m[32m        newton_tol = 1.0e-10,[m
2026-02-09T19:17:20.2987837Z [32m+[m[32m        newton_maxiter::Int = 5[m
2026-02-09T19:17:20.2988006Z [32m+[m[32m    )[m
2026-02-09T19:17:20.2988200Z      mesh = prob.mesh[m
2026-02-09T19:17:20.2988418Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.2988596Z      law = prob.law[m
2026-02-09T19:17:20.2989578Z [36m@@ -283,8 +289,10 @@[m [mfunction solve_hyperbolic_imex(prob::HyperbolicProblem2D, stiff_source::Abstract[m
2026-02-09T19:17:20.2989743Z              else[m
2026-02-09T19:17:20.2990193Z                  hyperbolic_rhs_2d!(K_ex[k], U_stage, prob, t + tab.c_ex[k] * dt)[m
2026-02-09T19:17:20.2990334Z  [m
2026-02-09T19:17:20.2990848Z [31m-                _implicit_solve_2d!(U_stage, law, stiff_source, a_kk * dt, nx, ny, N,[m
2026-02-09T19:17:20.2991135Z [31m-                    newton_tol, newton_maxiter)[m
2026-02-09T19:17:20.2991408Z [32m+[m[32m                _implicit_solve_2d!([m
2026-02-09T19:17:20.2991818Z [32m+[m[32m                    U_stage, law, stiff_source, a_kk * dt, nx, ny, N,[m
2026-02-09T19:17:20.2992138Z [32m+[m[32m                    newton_tol, newton_maxiter[m
2026-02-09T19:17:20.2992325Z [32m+[m[32m                )[m
2026-02-09T19:17:20.2992468Z  [m
2026-02-09T19:17:20.2992931Z                  _eval_stiff_source_2d!(K_im[k], U_stage, law, stiff_source, nx, ny)[m
2026-02-09T19:17:20.2993087Z              end[m
2026-02-09T19:17:20.3022264Z [34m[ 86/151] Checking `src/hyperbolic/mhd.jl` ................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3058226Z [34m[ 87/151] Checking `src/hyperbolic/mhd_3d.jl` ................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3155501Z [34m[ 88/151] Checking `src/hyperbolic/mhd_solve_2d.jl` .......................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3171370Z [1mdiff --git a/mhd_solve_2d.jl b/mhd_solve_2d.jl[m
2026-02-09T19:17:20.3171626Z [1mindex 2fe3c05..73f755b 100644[m
2026-02-09T19:17:20.3172053Z [1m--- a/mhd_solve_2d.jl[m
2026-02-09T19:17:20.3172279Z [1m+++ b/mhd_solve_2d.jl[m
2026-02-09T19:17:20.3173132Z [36m@@ -185,8 +185,10 @@[m [mCompute the corner EMF uniformly at all corners from the extended face flux arra[m
2026-02-09T19:17:20.3173621Z  Corner (i,j) for i=1:nx+1, j=1:ny+1:[m
2026-02-09T19:17:20.3174180Z    Ez = 0.25 * (-Fx_all[i,j][7] - Fx_all[i,j+1][7] + Fy_all[i,j][6] + Fy_all[i+1,j][6])[m
2026-02-09T19:17:20.3174352Z  """[m
2026-02-09T19:17:20.3175195Z [31m-function _compute_emf_from_extended!(emf_z::AbstractMatrix, Fx_all::AbstractMatrix,[m
2026-02-09T19:17:20.3175547Z [31m-        Fy_all::AbstractMatrix, nx::Int, ny::Int)[m
2026-02-09T19:17:20.3175805Z [32m+[m[32mfunction _compute_emf_from_extended!([m
2026-02-09T19:17:20.3176141Z [32m+[m[32m        emf_z::AbstractMatrix, Fx_all::AbstractMatrix,[m
2026-02-09T19:17:20.3176439Z [32m+[m[32m        Fy_all::AbstractMatrix, nx::Int, ny::Int[m
2026-02-09T19:17:20.3176565Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3176753Z      for j in 1:(ny + 1), i in 1:(nx + 1)[m
2026-02-09T19:17:20.3177047Z          # x-face EMF: Ez = -F_By (negative of By induction flux)[m
2026-02-09T19:17:20.3177361Z          Ez_x_below = -Fx_all[i, j][7]       # x-face in row below corner[m
2026-02-09T19:17:20.3177842Z [36m@@ -217,8 +219,10 @@[m [mSolve the 2D MHD problem using constrained transport for ∇·B = 0.[m
2026-02-09T19:17:20.3178023Z  - `t_final`: Final time reached.[m
2026-02-09T19:17:20.3178375Z  - `ct`: Final `CTData2D` (for inspecting ∇·B, face-centered B, etc.).[m
2026-02-09T19:17:20.3178483Z  """[m
2026-02-09T19:17:20.3179282Z [31m-function solve_hyperbolic(prob::HyperbolicProblem2D{<:IdealMHDEquations{2}};[m
2026-02-09T19:17:20.3179647Z [31m-        method::Symbol = :ssprk3, vector_potential = nothing)[m
2026-02-09T19:17:20.3179851Z [32m+[m[32mfunction solve_hyperbolic([m
2026-02-09T19:17:20.3180211Z [32m+[m[32m        prob::HyperbolicProblem2D{<:IdealMHDEquations{2}};[m
2026-02-09T19:17:20.3180554Z [32m+[m[32m        method::Symbol = :ssprk3, vector_potential = nothing[m
2026-02-09T19:17:20.3180687Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3180822Z      mesh = prob.mesh[m
2026-02-09T19:17:20.3180975Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.3181140Z      dx, dy = mesh.dx, mesh.dy[m
2026-02-09T19:17:20.3272185Z [34m[ 89/151] Checking `src/hyperbolic/mhd_solve_3d.jl` .......................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3288033Z [1mdiff --git a/mhd_solve_3d.jl b/mhd_solve_3d.jl[m
2026-02-09T19:17:20.3288336Z [1mindex 7b131c5..d41d8bf 100644[m
2026-02-09T19:17:20.3288542Z [1m--- a/mhd_solve_3d.jl[m
2026-02-09T19:17:20.3288982Z [1m+++ b/mhd_solve_3d.jl[m
2026-02-09T19:17:20.3289342Z [36m@@ -73,7 +73,8 @@[m [mfunction _mhd_compute_fluxes_3d!([m
2026-02-09T19:17:20.3289750Z          Fx_all::AbstractArray{T, 3}, Fy_all::AbstractArray{T, 3},[m
2026-02-09T19:17:20.3289997Z          Fz_all::AbstractArray{T, 3},[m
2026-02-09T19:17:20.3290256Z          dU::AbstractArray{T, 3}, U::AbstractArray{T, 3},[m
2026-02-09T19:17:20.3290532Z [31m-        prob::HyperbolicProblem3D, t) where {T}[m
2026-02-09T19:17:20.3290749Z [32m+[m[32m        prob::HyperbolicProblem3D, t[m
2026-02-09T19:17:20.3290866Z [32m+[m[32m    ) where {T}[m
2026-02-09T19:17:20.3290980Z      law = prob.law[m
2026-02-09T19:17:20.3291096Z      mesh = prob.mesh[m
2026-02-09T19:17:20.3291258Z      nx, ny, nz = mesh.nx, mesh.ny, mesh.nz[m
2026-02-09T19:17:20.3291646Z [36m@@ -166,11 +167,13 @@[m [mSolve the 3D MHD problem using constrained transport for div(B) = 0.[m
2026-02-09T19:17:20.3291796Z  - `t_final`: Final time reached.[m
2026-02-09T19:17:20.3292093Z  - `ct`: Final `CTData3D` (for inspecting div(B), face-centered B, etc.).[m
2026-02-09T19:17:20.3292174Z  """[m
2026-02-09T19:17:20.3292577Z [31m-function solve_hyperbolic(prob::HyperbolicProblem3D{<:IdealMHDEquations{3}};[m
2026-02-09T19:17:20.3292735Z [32m+[m[32mfunction solve_hyperbolic([m
2026-02-09T19:17:20.3293023Z [32m+[m[32m        prob::HyperbolicProblem3D{<:IdealMHDEquations{3}};[m
2026-02-09T19:17:20.3293354Z          method::Symbol = :ssprk3,[m
2026-02-09T19:17:20.3293510Z          vector_potential_x = nothing,[m
2026-02-09T19:17:20.3293654Z          vector_potential_y = nothing,[m
2026-02-09T19:17:20.3293990Z [31m-        vector_potential_z = nothing)[m
2026-02-09T19:17:20.3294172Z [32m+[m[32m        vector_potential_z = nothing[m
2026-02-09T19:17:20.3294266Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3294374Z      mesh = prob.mesh[m
2026-02-09T19:17:20.3294527Z      nx, ny, nz = mesh.nx, mesh.ny, mesh.nz[m
2026-02-09T19:17:20.3294686Z      dx, dy, dz = mesh.dx, mesh.dy, mesh.dz[m
2026-02-09T19:17:20.3303935Z [34m[ 90/151] Checking `src/hyperbolic/navier_stokes.jl` ......................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3321967Z [34m[ 91/151] Checking `src/hyperbolic/navier_stokes_solve.jl` ................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3335348Z [1mdiff --git a/navier_stokes_solve.jl b/navier_stokes_solve.jl[m
2026-02-09T19:17:20.3335610Z [1mindex 9e8f14a..045d0d3 100644[m
2026-02-09T19:17:20.3335824Z [1m--- a/navier_stokes_solve.jl[m
2026-02-09T19:17:20.3336039Z [1m+++ b/navier_stokes_solve.jl[m
2026-02-09T19:17:20.3336240Z [36m@@ -55,8 +55,10 @@[m [mend[m
2026-02-09T19:17:20.3336738Z  Compute the RHS including both inviscid Riemann fluxes and viscous fluxes:[m
2026-02-09T19:17:20.3337134Z    `dU[i]/dt = -1/dx * (F_{i+1/2} - F_{i-1/2}) + 1/dx * (Fv_{i+1/2} - Fv_{i-1/2})`[m
2026-02-09T19:17:20.3337221Z  """[m
2026-02-09T19:17:20.3337599Z [31m-function hyperbolic_rhs!(dU::AbstractVector, U::AbstractVector,[m
2026-02-09T19:17:20.3337903Z [31m-        prob::HyperbolicProblem{<:NavierStokesEquations{1}}, t)[m
2026-02-09T19:17:20.3338061Z [32m+[m[32mfunction hyperbolic_rhs!([m
2026-02-09T19:17:20.3338298Z [32m+[m[32m        dU::AbstractVector, U::AbstractVector,[m
2026-02-09T19:17:20.3338597Z [32m+[m[32m        prob::HyperbolicProblem{<:NavierStokesEquations{1}}, t[m
2026-02-09T19:17:20.3338706Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3339167Z      law = prob.law[m
2026-02-09T19:17:20.3339277Z      mesh = prob.mesh[m
2026-02-09T19:17:20.3339389Z      nc = ncells(mesh)[m
2026-02-09T19:17:20.3396084Z [34m[ 92/151] Checking `src/hyperbolic/navier_stokes_solve_2d.jl` ................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3409769Z [1mdiff --git a/navier_stokes_solve_2d.jl b/navier_stokes_solve_2d.jl[m
2026-02-09T19:17:20.3410019Z [1mindex 273bc8f..a93ce92 100644[m
2026-02-09T19:17:20.3410295Z [1m--- a/navier_stokes_solve_2d.jl[m
2026-02-09T19:17:20.3410506Z [1m+++ b/navier_stokes_solve_2d.jl[m
2026-02-09T19:17:20.3410940Z [36m@@ -59,8 +59,10 @@[m [mCompute the 2D RHS including inviscid and viscous fluxes:[m
2026-02-09T19:17:20.3411126Z                  +1/dx * (Fvx_{i+1/2,j} - Fvx_{i-1/2,j})[m
2026-02-09T19:17:20.3411298Z                  +1/dy * (Fvy_{i,j+1/2} - Fvy_{i,j-1/2})`[m
2026-02-09T19:17:20.3411383Z  """[m
2026-02-09T19:17:20.3411792Z [31m-function hyperbolic_rhs_2d!(dU::AbstractMatrix, U::AbstractMatrix,[m
2026-02-09T19:17:20.3412107Z [31m-        prob::HyperbolicProblem2D{<:NavierStokesEquations{2}}, t)[m
2026-02-09T19:17:20.3412276Z [32m+[m[32mfunction hyperbolic_rhs_2d!([m
2026-02-09T19:17:20.3412537Z [32m+[m[32m        dU::AbstractMatrix, U::AbstractMatrix,[m
2026-02-09T19:17:20.3412856Z [32m+[m[32m        prob::HyperbolicProblem2D{<:NavierStokesEquations{2}}, t[m
2026-02-09T19:17:20.3412954Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3413081Z      law = prob.law[m
2026-02-09T19:17:20.3413192Z      mesh = prob.mesh[m
2026-02-09T19:17:20.3413317Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.3413754Z [36m@@ -137,10 +139,14 @@[m [mfunction hyperbolic_rhs_2d!(dU::AbstractMatrix, U::AbstractMatrix,[m
2026-02-09T19:17:20.3413832Z  [m
2026-02-09T19:17:20.3414016Z              # Cross-derivatives via 4-cell average[m
2026-02-09T19:17:20.3414283Z              # ∂vx/∂y ≈ (vx[iL,j+1] + vx[iR,j+1] - vx[iL,j-1] - vx[iR,j-1]) / (4*dy)[m
2026-02-09T19:17:20.3414834Z [31m-            dvx_dy = (W[iL, jj + 1][2] + W[iR, jj + 1][2] -[m
2026-02-09T19:17:20.3415050Z [31m-                       W[iL, jj - 1][2] - W[iR, jj - 1][2]) / (4.0 * dy)[m
2026-02-09T19:17:20.3415367Z [31m-            dvy_dy = (W[iL, jj + 1][3] + W[iR, jj + 1][3] -[m
2026-02-09T19:17:20.3415564Z [31m-                       W[iL, jj - 1][3] - W[iR, jj - 1][3]) / (4.0 * dy)[m
2026-02-09T19:17:20.3415684Z [32m+[m[32m            dvx_dy = ([m
2026-02-09T19:17:20.3415871Z [32m+[m[32m                W[iL, jj + 1][2] + W[iR, jj + 1][2] -[m
2026-02-09T19:17:20.3416063Z [32m+[m[32m                    W[iL, jj - 1][2] - W[iR, jj - 1][2][m
2026-02-09T19:17:20.3416179Z [32m+[m[32m            ) / (4.0 * dy)[m
2026-02-09T19:17:20.3416294Z [32m+[m[32m            dvy_dy = ([m
2026-02-09T19:17:20.3416475Z [32m+[m[32m                W[iL, jj + 1][3] + W[iR, jj + 1][3] -[m
2026-02-09T19:17:20.3416665Z [32m+[m[32m                    W[iL, jj - 1][3] - W[iR, jj - 1][3][m
2026-02-09T19:17:20.3416790Z [32m+[m[32m            ) / (4.0 * dy)[m
2026-02-09T19:17:20.3416866Z  [m
2026-02-09T19:17:20.3417101Z              Fv = viscous_flux_x_2d(law, wL, wR, dvx_dy, dvy_dy, dx)[m
2026-02-09T19:17:20.3417181Z  [m
2026-02-09T19:17:20.3417617Z [36m@@ -166,10 +172,14 @@[m [mfunction hyperbolic_rhs_2d!(dU::AbstractMatrix, U::AbstractMatrix,[m
2026-02-09T19:17:20.3417698Z  [m
2026-02-09T19:17:20.3417881Z              # Cross-derivatives via 4-cell average[m
2026-02-09T19:17:20.3418126Z              # ∂vx/∂x ≈ (vx[i+1,jL] + vx[i+1,jR] - vx[i-1,jL] - vx[i-1,jR]) / (4*dx)[m
2026-02-09T19:17:20.3418315Z [31m-            dvx_dx = (W[ii + 1, jL][2] + W[ii + 1, jR][2] -[m
2026-02-09T19:17:20.3418522Z [31m-                       W[ii - 1, jL][2] - W[ii - 1, jR][2]) / (4.0 * dx)[m
2026-02-09T19:17:20.3418703Z [31m-            dvy_dx = (W[ii + 1, jL][3] + W[ii + 1, jR][3] -[m
2026-02-09T19:17:20.3419042Z [31m-                       W[ii - 1, jL][3] - W[ii - 1, jR][3]) / (4.0 * dx)[m
2026-02-09T19:17:20.3419179Z [32m+[m[32m            dvx_dx = ([m
2026-02-09T19:17:20.3419362Z [32m+[m[32m                W[ii + 1, jL][2] + W[ii + 1, jR][2] -[m
2026-02-09T19:17:20.3419547Z [32m+[m[32m                    W[ii - 1, jL][2] - W[ii - 1, jR][2][m
2026-02-09T19:17:20.3419676Z [32m+[m[32m            ) / (4.0 * dx)[m
2026-02-09T19:17:20.3419790Z [32m+[m[32m            dvy_dx = ([m
2026-02-09T19:17:20.3419965Z [32m+[m[32m                W[ii + 1, jL][3] + W[ii + 1, jR][3] -[m
2026-02-09T19:17:20.3420146Z [32m+[m[32m                    W[ii - 1, jL][3] - W[ii - 1, jR][3][m
2026-02-09T19:17:20.3420265Z [32m+[m[32m            ) / (4.0 * dx)[m
2026-02-09T19:17:20.3420337Z  [m
2026-02-09T19:17:20.3420558Z              Fv = viscous_flux_y_2d(law, wB, wT, dvx_dx, dvy_dx, dy)[m
2026-02-09T19:17:20.3420641Z  [m
2026-02-09T19:17:20.3437834Z [34m[ 93/151] Checking `src/hyperbolic/noslip_bc.jl` ............................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3453260Z [34m[ 94/151] Checking `src/hyperbolic/reconstruction.jl` ........................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3462646Z [34m[ 95/151] Checking `src/hyperbolic/riemann_solvers.jl` ....................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3517305Z [34m[ 96/151] Checking `src/hyperbolic/srmhd.jl` ................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3532220Z [1mdiff --git a/srmhd.jl b/srmhd.jl[m
2026-02-09T19:17:20.3532473Z [1mindex abfe885..11abe0e 100644[m
2026-02-09T19:17:20.3532638Z [1m--- a/srmhd.jl[m
2026-02-09T19:17:20.3532796Z [1m+++ b/srmhd.jl[m
2026-02-09T19:17:20.3533359Z [36m@@ -38,7 +38,7 @@[m [mstruct SRMHDEquations{Dim, EOS <: AbstractEOS} <: AbstractConservationLaw{Dim}[m
2026-02-09T19:17:20.3533523Z      con2prim_maxiter::Int[m
2026-02-09T19:17:20.3533606Z  end[m
2026-02-09T19:17:20.3533781Z  [m
2026-02-09T19:17:20.3534706Z [31m-function SRMHDEquations{Dim}(eos::EOS; con2prim_tol = 1e-12, con2prim_maxiter = 50) where {Dim, EOS <: AbstractEOS}[m
2026-02-09T19:17:20.3535935Z [32m+[m[32mfunction SRMHDEquations{Dim}(eos::EOS; con2prim_tol = 1.0e-12, con2prim_maxiter = 50) where {Dim, EOS <: AbstractEOS}[m
2026-02-09T19:17:20.3536652Z      return SRMHDEquations{Dim, EOS}(eos, con2prim_tol, con2prim_maxiter)[m
2026-02-09T19:17:20.3536814Z  end[m
2026-02-09T19:17:20.3536947Z  [m
2026-02-09T19:17:20.3537353Z [36m@@ -55,7 +55,7 @@[m [mCompute the Lorentz factor W = 1/√(1 − v²).[m
2026-02-09T19:17:20.3537530Z  """[m
2026-02-09T19:17:20.3537842Z  @inline function lorentz_factor(vx, vy, vz)[m
2026-02-09T19:17:20.3538051Z      v_sq = vx^2 + vy^2 + vz^2[m
2026-02-09T19:17:20.3538464Z [31m-    v_sq = min(v_sq, 1 - 1e-10)  # cap to prevent superluminal[m
2026-02-09T19:17:20.3539351Z [32m+[m[32m    v_sq = min(v_sq, 1 - 1.0e-10)  # cap to prevent superluminal[m
2026-02-09T19:17:20.3539608Z      return 1 / sqrt(1 - v_sq)[m
2026-02-09T19:17:20.3539766Z  end[m
2026-02-09T19:17:20.3539933Z  [m
2026-02-09T19:17:20.3540305Z [36m@@ -227,14 +227,14 @@[m [ma² = γP/(ρh), va² = b²/(ρh + b²).[m
2026-02-09T19:17:20.3540510Z      γ_eos = law.eos.gamma[m
2026-02-09T19:17:20.3540653Z  [m
2026-02-09T19:17:20.3540852Z      v_sq = vx^2 + vy^2 + vz^2[m
2026-02-09T19:17:20.3541107Z [31m-    v_sq = min(v_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.3541375Z [32m+[m[32m    v_sq = min(v_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.3541515Z  [m
2026-02-09T19:17:20.3541715Z      W = 1 / sqrt(1 - v_sq)[m
2026-02-09T19:17:20.3541927Z      ε = P / ((γ_eos - 1) * ρ)[m
2026-02-09T19:17:20.3542121Z      h = 1 + ε + P / ρ[m
2026-02-09T19:17:20.3542257Z  [m
2026-02-09T19:17:20.3542463Z      cs_sq = γ_eos * P / (ρ * h)[m
2026-02-09T19:17:20.3542698Z [31m-    cs_sq = min(cs_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.3542986Z [32m+[m[32m    cs_sq = min(cs_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.3543127Z  [m
2026-02-09T19:17:20.3543323Z      B_sq = Bx^2 + By^2 + Bz^2[m
2026-02-09T19:17:20.3543563Z      vdotB = vx * Bx + vy * By + vz * Bz[m
2026-02-09T19:17:20.3543935Z [36m@@ -242,10 +242,10 @@[m [ma² = γP/(ρh), va² = b²/(ρh + b²).[m
2026-02-09T19:17:20.3544073Z  [m
2026-02-09T19:17:20.3544240Z      rho_h = ρ * h[m
2026-02-09T19:17:20.3544460Z      ca_sq = b_sq / (rho_h + b_sq)[m
2026-02-09T19:17:20.3544710Z [31m-    ca_sq = min(ca_sq, 1 - 1e-10)[m
2026-02-09T19:17:20.3544986Z [32m+[m[32m    ca_sq = min(ca_sq, 1 - 1.0e-10)[m
2026-02-09T19:17:20.3545123Z  [m
2026-02-09T19:17:20.3545375Z      c_ms_sq = cs_sq + ca_sq - cs_sq * ca_sq[m
2026-02-09T19:17:20.3545721Z [31m-    c_ms_sq = clamp(c_ms_sq, zero(c_ms_sq), 1 - 1e-10)[m
2026-02-09T19:17:20.3546110Z [32m+[m[32m    c_ms_sq = clamp(c_ms_sq, zero(c_ms_sq), 1 - 1.0e-10)[m
2026-02-09T19:17:20.3546312Z      c_ms = sqrt(c_ms_sq)[m
2026-02-09T19:17:20.3546445Z  [m
2026-02-09T19:17:20.3546640Z      vn = dir == 1 ? vx : vy[m
2026-02-09T19:17:20.3547309Z [34m[ 97/151] Checking `src/hyperbolic/srmhd_solve.jl` ........................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3609765Z [34m[ 98/151] Checking `src/hyperbolic/srmhd_solve_2d.jl` ........................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3623753Z [1mdiff --git a/srmhd_solve_2d.jl b/srmhd_solve_2d.jl[m
2026-02-09T19:17:20.3624022Z [1mindex 35ad700..45753a6 100644[m
2026-02-09T19:17:20.3624169Z [1m--- a/srmhd_solve_2d.jl[m
2026-02-09T19:17:20.3624287Z [1m+++ b/srmhd_solve_2d.jl[m
2026-02-09T19:17:20.3624406Z [36m@@ -64,8 +64,10 @@[m [mend[m
2026-02-09T19:17:20.3624716Z  Solve the 2D SRMHD problem using constrained transport for ∇·B = 0.[m
2026-02-09T19:17:20.3624957Z  Same structure as the IdealMHDEquations{2} solver.[m
2026-02-09T19:17:20.3625047Z  """[m
2026-02-09T19:17:20.3625646Z [31m-function solve_hyperbolic(prob::HyperbolicProblem2D{<:SRMHDEquations{2}};[m
2026-02-09T19:17:20.3626149Z [31m-        method::Symbol = :ssprk3, vector_potential = nothing)[m
2026-02-09T19:17:20.3626421Z [32m+[m[32mfunction solve_hyperbolic([m
2026-02-09T19:17:20.3627156Z [32m+[m[32m        prob::HyperbolicProblem2D{<:SRMHDEquations{2}};[m
2026-02-09T19:17:20.3627658Z [32m+[m[32m        method::Symbol = :ssprk3, vector_potential = nothing[m
2026-02-09T19:17:20.3627841Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3628245Z      mesh = prob.mesh[m
2026-02-09T19:17:20.3628472Z      nx, ny = mesh.nx, mesh.ny[m
2026-02-09T19:17:20.3628677Z      dx, dy = mesh.dx, mesh.dy[m
2026-02-09T19:17:20.3656954Z [34m[ 99/151] Checking `src/hyperbolic/stiff_sources.jl` ......................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3670871Z [1mdiff --git a/stiff_sources.jl b/stiff_sources.jl[m
2026-02-09T19:17:20.3671108Z [1mindex 80697bf..781b3bc 100644[m
2026-02-09T19:17:20.3671309Z [1m--- a/stiff_sources.jl[m
2026-02-09T19:17:20.3671499Z [1m+++ b/stiff_sources.jl[m
2026-02-09T19:17:20.3671653Z [36m@@ -95,8 +95,10 @@[m [mend[m
2026-02-09T19:17:20.3671748Z      Bx = u[6][m
2026-02-09T19:17:20.3671841Z      By = u[7][m
2026-02-09T19:17:20.3671930Z      Bz = u[8][m
2026-02-09T19:17:20.3672336Z [31m-    return SVector(zero(η), zero(η), zero(η), zero(η), zero(η),[m
2026-02-09T19:17:20.3672596Z [31m-        -η * Bx, -η * By, -η * Bz)[m
2026-02-09T19:17:20.3672830Z [32m+[m[32m    return SVector([m
2026-02-09T19:17:20.3673221Z [32m+[m[32m        zero(η), zero(η), zero(η), zero(η), zero(η),[m
2026-02-09T19:17:20.3673492Z [32m+[m[32m        -η * Bx, -η * By, -η * Bz[m
2026-02-09T19:17:20.3673678Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3673823Z  end[m
2026-02-09T19:17:20.3673960Z  [m
2026-02-09T19:17:20.3674816Z  @inline function stiff_source_jacobian(src::ResistiveSource, law::IdealMHDEquations, w::SVector{8}, u::SVector{8})[m
2026-02-09T19:17:20.3697889Z [34m[100/151] Checking `src/hyperbolic/viscous_flux.jl` .......................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3711728Z [1mdiff --git a/viscous_flux.jl b/viscous_flux.jl[m
2026-02-09T19:17:20.3711967Z [1mindex 2040673..58b3998 100644[m
2026-02-09T19:17:20.3712157Z [1m--- a/viscous_flux.jl[m
2026-02-09T19:17:20.3712368Z [1m+++ b/viscous_flux.jl[m
2026-02-09T19:17:20.3712841Z [36m@@ -49,8 +49,10 @@[m [mcross-derivatives `∂vx/∂y` and `∂vy/∂y` must be provided (4-cell average[m
2026-02-09T19:17:20.3712922Z  [m
2026-02-09T19:17:20.3713219Z  Returns `SVector(0, τ_xx, τ_xy, vx*τ_xx + vy*τ_xy - q_x)`.[m
2026-02-09T19:17:20.3713373Z  """[m
2026-02-09T19:17:20.3714181Z [31m-@inline function viscous_flux_x_2d(ns::NavierStokesEquations{2}, wL::SVector{4}, wR::SVector{4},[m
2026-02-09T19:17:20.3714423Z [31m-        dvx_dy, dvy_dy, dx)[m
2026-02-09T19:17:20.3714732Z [32m+[m[32m@inline function viscous_flux_x_2d([m
2026-02-09T19:17:20.3715308Z [32m+[m[32m        ns::NavierStokesEquations{2}, wL::SVector{4}, wR::SVector{4},[m
2026-02-09T19:17:20.3715562Z [32m+[m[32m        dvx_dy, dvy_dy, dx[m
2026-02-09T19:17:20.3715736Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3715945Z      ρL, vxL, vyL, PL = wL[m
2026-02-09T19:17:20.3716144Z      ρR, vxR, vyR, PR = wR[m
2026-02-09T19:17:20.3716326Z      μ = ns.mu[m
2026-02-09T19:17:20.3716949Z [36m@@ -90,8 +92,10 @@[m [mcross-derivatives `∂vx/∂x` and `∂vy/∂x` must be provided (4-cell average[m
2026-02-09T19:17:20.3717127Z  [m
2026-02-09T19:17:20.3717518Z  Returns `SVector(0, τ_yx, τ_yy, vx*τ_yx + vy*τ_yy - q_y)`.[m
2026-02-09T19:17:20.3717692Z  """[m
2026-02-09T19:17:20.3718482Z [31m-@inline function viscous_flux_y_2d(ns::NavierStokesEquations{2}, wB::SVector{4}, wT::SVector{4},[m
2026-02-09T19:17:20.3718705Z [31m-        dvx_dx, dvy_dx, dy)[m
2026-02-09T19:17:20.3719233Z [32m+[m[32m@inline function viscous_flux_y_2d([m
2026-02-09T19:17:20.3719787Z [32m+[m[32m        ns::NavierStokesEquations{2}, wB::SVector{4}, wT::SVector{4},[m
2026-02-09T19:17:20.3720020Z [32m+[m[32m        dvx_dx, dvy_dx, dy[m
2026-02-09T19:17:20.3720190Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3720387Z      ρB, vxB, vyB, PB = wB[m
2026-02-09T19:17:20.3720580Z      ρT, vxT, vyT, PT = wT[m
2026-02-09T19:17:20.3720741Z      μ = ns.mu[m
2026-02-09T19:17:20.3757643Z [34m[101/151] Checking `src/hyperbolic/weno.jl` .................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3772050Z [1mdiff --git a/weno.jl b/weno.jl[m
2026-02-09T19:17:20.3772279Z [1mindex 77d135f..6c7cf12 100644[m
2026-02-09T19:17:20.3772664Z [1m--- a/weno.jl[m
2026-02-09T19:17:20.3772846Z [1m+++ b/weno.jl[m
2026-02-09T19:17:20.3773109Z [36m@@ -27,7 +27,7 @@[m [mstruct WENO5{FT}[m
2026-02-09T19:17:20.3773283Z      p::Int[m
2026-02-09T19:17:20.3773417Z  end[m
2026-02-09T19:17:20.3773550Z  [m
2026-02-09T19:17:20.3773753Z [31m-WENO5() = WENO5(1e-6, 2)[m
2026-02-09T19:17:20.3773990Z [32m+[m[32mWENO5() = WENO5(1.0e-6, 2)[m
2026-02-09T19:17:20.3774136Z  [m
2026-02-09T19:17:20.3774420Z  # ============================================================[m
2026-02-09T19:17:20.3774866Z  # nghost: number of ghost cells required by each reconstruction[m
2026-02-09T19:17:20.3807210Z [34m[102/151] Checking `src/hyperbolic/weno3.jl` ................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3821710Z [1mdiff --git a/weno3.jl b/weno3.jl[m
2026-02-09T19:17:20.3821945Z [1mindex 0804699..1542020 100644[m
2026-02-09T19:17:20.3822123Z [1m--- a/weno3.jl[m
2026-02-09T19:17:20.3822310Z [1m+++ b/weno3.jl[m
2026-02-09T19:17:20.3822573Z [36m@@ -23,7 +23,7 @@[m [mstruct WENO3{FT}[m
2026-02-09T19:17:20.3822764Z      epsilon::FT[m
2026-02-09T19:17:20.3822909Z  end[m
2026-02-09T19:17:20.3823035Z  [m
2026-02-09T19:17:20.3823237Z [31m-WENO3() = WENO3(1e-6)[m
2026-02-09T19:17:20.3823468Z [32m+[m[32mWENO3() = WENO3(1.0e-6)[m
2026-02-09T19:17:20.3823546Z  [m
2026-02-09T19:17:20.3823703Z  # ============================================================[m
2026-02-09T19:17:20.3823850Z  # Scalar WENO-3 reconstruction[m
2026-02-09T19:17:20.3834675Z [34m[103/151] Checking `src/mesh/abstract_mesh.jl` ............................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3879148Z [34m[104/151] Checking `src/mesh/structured_mesh.jl` ............................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3906285Z [34m[105/151] Checking `src/mesh/structured_mesh_3d.jl` .......................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3921104Z [1mdiff --git a/structured_mesh_3d.jl b/structured_mesh_3d.jl[m
2026-02-09T19:17:20.3921425Z [1mindex c1f4eef..b15072d 100644[m
2026-02-09T19:17:20.3921674Z [1m--- a/structured_mesh_3d.jl[m
2026-02-09T19:17:20.3921908Z [1m+++ b/structured_mesh_3d.jl[m
2026-02-09T19:17:20.3922375Z [36m@@ -30,8 +30,10 @@[m [mstruct StructuredMesh3D{FT} <: AbstractMesh{3}[m
2026-02-09T19:17:20.3922575Z      dz::FT[m
2026-02-09T19:17:20.3922741Z  end[m
2026-02-09T19:17:20.3922879Z  [m
2026-02-09T19:17:20.3923464Z [31m-function StructuredMesh3D(xmin::FT, xmax::FT, ymin::FT, ymax::FT,[m
2026-02-09T19:17:20.3923941Z [31m-        zmin::FT, zmax::FT, nx::Int, ny::Int, nz::Int) where {FT}[m
2026-02-09T19:17:20.3924227Z [32m+[m[32mfunction StructuredMesh3D([m
2026-02-09T19:17:20.3924647Z [32m+[m[32m        xmin::FT, xmax::FT, ymin::FT, ymax::FT,[m
2026-02-09T19:17:20.3925107Z [32m+[m[32m        zmin::FT, zmax::FT, nx::Int, ny::Int, nz::Int[m
2026-02-09T19:17:20.3925340Z [32m+[m[32m    ) where {FT}[m
2026-02-09T19:17:20.3925562Z      dx = (xmax - xmin) / nx[m
2026-02-09T19:17:20.3925770Z      dy = (ymax - ymin) / ny[m
2026-02-09T19:17:20.3925982Z      dz = (zmax - zmin) / nz[m
2026-02-09T19:17:20.3929445Z [34m[106/151] Checking `src/metric/abstract_metric.jl` ........................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3947331Z [34m[107/151] Checking `src/metric/kerr.jl` ...................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.3976140Z [34m[108/151] Checking `src/metric/metric_data.jl` ............................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.3990209Z [1mdiff --git a/metric_data.jl b/metric_data.jl[m
2026-02-09T19:17:20.3990452Z [1mindex 04ec291..95d0900 100644[m
2026-02-09T19:17:20.3990675Z [1m--- a/metric_data.jl[m
2026-02-09T19:17:20.3991111Z [1m+++ b/metric_data.jl[m
2026-02-09T19:17:20.3991944Z [36m@@ -148,6 +148,8 @@[m [mfunction precompute_metric_at_faces(metric::AbstractMetric{2}, mesh::StructuredM[m
2026-02-09T19:17:20.3992265Z          sqrtg_yf[i, j] = sqrt_gamma(metric, xf, yf)[m
2026-02-09T19:17:20.3992607Z      end[m
2026-02-09T19:17:20.3992739Z  [m
2026-02-09T19:17:20.3993223Z [31m-    return (alpha_xf, alpha_yf, betax_xf, betay_xf, betax_yf, betay_yf,[m
2026-02-09T19:17:20.3993467Z [31m-            sqrtg_xf, sqrtg_yf)[m
2026-02-09T19:17:20.3993667Z [32m+[m[32m    return ([m
2026-02-09T19:17:20.3994135Z [32m+[m[32m        alpha_xf, alpha_yf, betax_xf, betay_xf, betax_yf, betay_yf,[m
2026-02-09T19:17:20.3994393Z [32m+[m[32m        sqrtg_xf, sqrtg_yf,[m
2026-02-09T19:17:20.3994573Z [32m+[m[32m    )[m
2026-02-09T19:17:20.3994720Z  end[m
2026-02-09T19:17:20.4002689Z [34m[109/151] Checking `src/metric/minkowski.jl` ................................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.4018123Z [34m[110/151] Checking `src/metric/schwarzschild.jl` ............................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.4065171Z [34m[111/151] Checking `src/physics/turbulence/k_epsilon.jl` ..................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.4080171Z [1mdiff --git a/k_epsilon.jl b/k_epsilon.jl[m
2026-02-09T19:17:20.4080448Z [1mindex 21e5aa2..cf30d24 100644[m
2026-02-09T19:17:20.4080673Z [1m--- a/k_epsilon.jl[m
2026-02-09T19:17:20.4080883Z [1m+++ b/k_epsilon.jl[m
2026-02-09T19:17:20.4081250Z [36m@@ -70,7 +70,7 @@[m [mmodel = StandardKEpsilon(;[m
2026-02-09T19:17:20.4081412Z  )[m
2026-02-09T19:17:20.4081571Z  ```[m
2026-02-09T19:17:20.4081727Z  """[m
2026-02-09T19:17:20.4082000Z [31m-struct StandardKEpsilon{T<:Real}[m
2026-02-09T19:17:20.4082332Z [32m+[m[32mstruct StandardKEpsilon{T <: Real}[m
2026-02-09T19:17:20.4082540Z      C_mu::T[m
2026-02-09T19:17:20.4082746Z      sigma_k::T[m
2026-02-09T19:17:20.4082997Z      sigma_epsilon::T[m
2026-02-09T19:17:20.4083461Z [36m@@ -117,18 +117,18 @@[m [mFor dimensional problems with density:[m
2026-02-09T19:17:20.4083634Z  # Returns[m
2026-02-09T19:17:20.4083941Z  Turbulent viscosity (same shape as inputs).[m
2026-02-09T19:17:20.4084090Z  """[m
2026-02-09T19:17:20.4084980Z [31m-function compute_turbulent_viscosity(model::StandardKEpsilon, k::Real, epsilon::Real; rho::Real=1.0)[m
2026-02-09T19:17:20.4085878Z [32m+[m[32mfunction compute_turbulent_viscosity(model::StandardKEpsilon, k::Real, epsilon::Real; rho::Real = 1.0)[m
2026-02-09T19:17:20.4086157Z      # Safeguard against division by zero[m
2026-02-09T19:17:20.4086421Z [31m-    eps_safe = max(epsilon, 1e-10)[m
2026-02-09T19:17:20.4086720Z [32m+[m[32m    eps_safe = max(epsilon, 1.0e-10)[m
2026-02-09T19:17:20.4086922Z      k_safe = max(k, 0.0)[m
2026-02-09T19:17:20.4087243Z      return rho * model.C_mu * k_safe^2 / eps_safe[m
2026-02-09T19:17:20.4087398Z  end[m
2026-02-09T19:17:20.4087755Z  [m
2026-02-09T19:17:20.4088959Z [31m-function compute_turbulent_viscosity(model::StandardKEpsilon, k::AbstractVector, epsilon::AbstractVector; rho=1.0)[m
2026-02-09T19:17:20.4091034Z [32m+[m[32mfunction compute_turbulent_viscosity(model::StandardKEpsilon, k::AbstractVector, epsilon::AbstractVector; rho = 1.0)[m
2026-02-09T19:17:20.4092297Z      nu_t = similar(k)[m
2026-02-09T19:17:20.4092943Z      rho_vec = rho isa Real ? fill(rho, length(k)) : rho[m
2026-02-09T19:17:20.4093685Z      @inbounds for i in eachindex(k)[m
2026-02-09T19:17:20.4094315Z [31m-        eps_safe = max(epsilon[i], 1e-10)[m
2026-02-09T19:17:20.4095106Z [32m+[m[32m        eps_safe = max(epsilon[i], 1.0e-10)[m
2026-02-09T19:17:20.4095750Z          k_safe = max(k[i], 0.0)[m
2026-02-09T19:17:20.4096498Z          nu_t[i] = rho_vec[i] * model.C_mu * k_safe^2 / eps_safe[m
2026-02-09T19:17:20.4097091Z      end[m
2026-02-09T19:17:20.4097772Z [36m@@ -238,7 +238,7 @@[m [mfunction epsilon_source_function(x, y, t, u_tuple, p)[m
2026-02-09T19:17:20.4098696Z      Pk = haskey(p, :Pk) && !isnothing(p.Pk) ? p.Pk : 0.0[m
2026-02-09T19:17:20.4099807Z  [m
2026-02-09T19:17:20.4100204Z      # Safeguards[m
2026-02-09T19:17:20.4100678Z [31m-    k_safe = max(k, 1e-10)[m
2026-02-09T19:17:20.4101275Z [32m+[m[32m    k_safe = max(k, 1.0e-10)[m
2026-02-09T19:17:20.4102163Z      eps_by_k = epsilon / k_safe[m
2026-02-09T19:17:20.4102646Z  [m
2026-02-09T19:17:20.4103020Z      # Source terms[m
2026-02-09T19:17:20.4103723Z [36m@@ -266,7 +266,7 @@[m [mCreate a diffusion function for the k equation.[m
2026-02-09T19:17:20.4104736Z  A diffusion function `(x, y, t, u, p) -> Γk` suitable for `FVMProblem`.[m
2026-02-09T19:17:20.4105439Z  """[m
2026-02-09T19:17:20.4106341Z  function make_k_diffusion_function(model::StandardKEpsilon, nu::Real, nu_t_field::AbstractVector)[m
2026-02-09T19:17:20.4107369Z [31m-    return function(x, y, t, u, p)[m
2026-02-09T19:17:20.4108057Z [32m+[m[32m    return function (x, y, t, u, p)[m
2026-02-09T19:17:20.4108951Z          # Get node index from parameters[m
2026-02-09T19:17:20.4109670Z          i = haskey(p, :node_index) ? p.node_index : 1[m
2026-02-09T19:17:20.4110444Z          nu_t = i <= length(nu_t_field) ? nu_t_field[i] : 0.0[m
2026-02-09T19:17:20.4111348Z [36m@@ -292,7 +292,7 @@[m [mCreate a diffusion function for the ε equation.[m
2026-02-09T19:17:20.4112405Z  A diffusion function `(x, y, t, u, p) -> Γε` suitable for `FVMProblem`.[m
2026-02-09T19:17:20.4113138Z  """[m
2026-02-09T19:17:20.4114112Z  function make_epsilon_diffusion_function(model::StandardKEpsilon, nu::Real, nu_t_field::AbstractVector)[m
2026-02-09T19:17:20.4115197Z [31m-    return function(x, y, t, u, p)[m
2026-02-09T19:17:20.4115848Z [32m+[m[32m    return function (x, y, t, u, p)[m
2026-02-09T19:17:20.4116565Z          i = haskey(p, :node_index) ? p.node_index : 1[m
2026-02-09T19:17:20.4117320Z          nu_t = i <= length(nu_t_field) ? nu_t_field[i] : 0.0[m
2026-02-09T19:17:20.4118134Z          return nu + nu_t / model.sigma_epsilon[m
2026-02-09T19:17:20.4119227Z [36m@@ -321,11 +321,13 @@[m [mwhere $u^+ = u/u_\tau$ and $y^+ = y u_\tau / \nu$.[m
2026-02-09T19:17:20.4119952Z  # Returns[m
2026-02-09T19:17:20.4120371Z  Friction velocity `u_τ`.[m
2026-02-09T19:17:20.4120819Z  """[m
2026-02-09T19:17:20.4121608Z [31m-function compute_friction_velocity(u_tan::Real, y::Real, nu::Real;[m
2026-02-09T19:17:20.4122724Z [31m-        kappa::Real = 0.41, E::Real = 9.8, max_iter::Int = 10, tol::Real = 1e-5)[m
2026-02-09T19:17:20.4123615Z [32m+[m[32mfunction compute_friction_velocity([m
2026-02-09T19:17:20.4124445Z [32m+[m[32m        u_tan::Real, y::Real, nu::Real;[m
2026-02-09T19:17:20.4125576Z [32m+[m[32m        kappa::Real = 0.41, E::Real = 9.8, max_iter::Int = 10, tol::Real = 1.0e-5[m
2026-02-09T19:17:20.4126369Z [32m+[m[32m    )[m
2026-02-09T19:17:20.4126766Z  [m
2026-02-09T19:17:20.4127220Z      # Initial guess from viscous sublayer[m
2026-02-09T19:17:20.4127957Z [31m-    u_tau = sqrt(abs(nu * u_tan / max(y, 1e-10)))[m
2026-02-09T19:17:20.4129009Z [32m+[m[32m    u_tau = sqrt(abs(nu * u_tan / max(y, 1.0e-10)))[m
2026-02-09T19:17:20.4129627Z  [m
2026-02-09T19:17:20.4129994Z      for _ in 1:max_iter[m
2026-02-09T19:17:20.4130474Z          y_plus = y * u_tau / nu[m
2026-02-09T19:17:20.4131546Z [36m@@ -339,7 +341,7 @@[m [mfunction compute_friction_velocity(u_tan::Real, y::Real, nu::Real;[m
2026-02-09T19:17:20.4132577Z              df = -u_tan / u_tau^2 - (1.0 / kappa) / u_tau[m
2026-02-09T19:17:20.4133127Z  [m
2026-02-09T19:17:20.4133491Z              delta = f / df[m
2026-02-09T19:17:20.4134062Z [31m-            u_tau = max(u_tau - delta, 1e-10)[m
2026-02-09T19:17:20.4134791Z [32m+[m[32m            u_tau = max(u_tau - delta, 1.0e-10)[m
2026-02-09T19:17:20.4135354Z  [m
2026-02-09T19:17:20.4135722Z              if abs(delta) < tol[m
2026-02-09T19:17:20.4136187Z                  break[m
2026-02-09T19:17:20.4136973Z [36m@@ -389,7 +391,7 @@[m [mCompute equilibrium ε value at the wall for wall functions.[m
2026-02-09T19:17:20.4138020Z  Wall value of ε.[m
2026-02-09T19:17:20.4138416Z  """[m
2026-02-09T19:17:20.4139398Z  function epsilon_wall_value(u_tau::Real, y::Real; kappa::Real = 0.41, C_mu::Real = 0.09)[m
2026-02-09T19:17:20.4141492Z [31m-    return C_mu^0.75 * k_wall_value(u_tau; C_mu=C_mu)^1.5 / (kappa * max(y, 1e-10))[m
2026-02-09T19:17:20.4143553Z [32m+[m[32m    return C_mu^0.75 * k_wall_value(u_tau; C_mu = C_mu)^1.5 / (kappa * max(y, 1.0e-10))[m
2026-02-09T19:17:20.4144926Z  end[m
2026-02-09T19:17:20.4145273Z  [m
2026-02-09T19:17:20.4145915Z  @doc raw"""[m
2026-02-09T19:17:20.4146914Z [36m@@ -402,7 +404,7 @@[m [mParameters for turbulent wall boundary conditions.[m
2026-02-09T19:17:20.4147957Z  - `C_mu::T`: Model constant[m
2026-02-09T19:17:20.4148553Z  - `kappa::T`: von Kármán constant[m
2026-02-09T19:17:20.4149291Z  """[m
2026-02-09T19:17:20.4149743Z [31m-struct TurbulentWallBC{T<:Real}[m
2026-02-09T19:17:20.4150427Z [32m+[m[32mstruct TurbulentWallBC{T <: Real}[m
2026-02-09T19:17:20.4151054Z      roughness::T[m
2026-02-09T19:17:20.4151520Z      C_mu::T[m
2026-02-09T19:17:20.4151913Z      kappa::T[m
2026-02-09T19:17:20.4152801Z [36m@@ -425,7 +427,7 @@[m [mOnly the coefficients are provided here; implementation is deferred.[m
2026-02-09T19:17:20.4154036Z  - `sigma_k1::T`, `sigma_k2::T`: Blending coefficients for k diffusion[m
2026-02-09T19:17:20.4155155Z  - `sigma_omega1::T`, `sigma_omega2::T`: Blending coefficients for ω diffusion[m
2026-02-09T19:17:20.4155891Z  """[m
2026-02-09T19:17:20.4156319Z [31m-struct KappaOmegaSST{T<:Real}[m
2026-02-09T19:17:20.4156950Z [32m+[m[32mstruct KappaOmegaSST{T <: Real}[m
2026-02-09T19:17:20.4157507Z      a1::T[m
2026-02-09T19:17:20.4157907Z      beta_star::T[m
2026-02-09T19:17:20.4158336Z      sigma_k1::T[m
2026-02-09T19:17:20.4181287Z [34m[112/151] Checking `src/problem.jl` .......................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.4233989Z [34m[113/151] Checking `src/schemes/gradients.jl` ................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.4268937Z [34m[114/151] Checking `src/schemes/limiters.jl` ................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.4285456Z [1mdiff --git a/limiters.jl b/limiters.jl[m
2026-02-09T19:17:20.4286124Z [1mindex 8fe6977..b409188 100644[m
2026-02-09T19:17:20.4286575Z [1m--- a/limiters.jl[m
2026-02-09T19:17:20.4286881Z [1m+++ b/limiters.jl[m
2026-02-09T19:17:20.4287249Z [36m@@ -87,7 +87,7 @@[m [mat the cost of accuracy.[m
2026-02-09T19:17:20.4287620Z  # Returns[m
2026-02-09T19:17:20.4287886Z  The minmod of `a` and `b`.[m
2026-02-09T19:17:20.4288157Z  """[m
2026-02-09T19:17:20.4288566Z [31m-@inline function minmod(a::T, b::T) where {T<:Real}[m
2026-02-09T19:17:20.4289382Z [32m+[m[32m@inline function minmod(a::T, b::T) where {T <: Real}[m
2026-02-09T19:17:20.4289835Z      if a > zero(T) && b > zero(T)[m
2026-02-09T19:17:20.4290152Z          return min(a, b)[m
2026-02-09T19:17:20.4290467Z      elseif a < zero(T) && b < zero(T)[m
2026-02-09T19:17:20.4291171Z [36m@@ -116,7 +116,7 @@[m [mdiscontinuities but may be slightly oscillatory near extrema.[m
2026-02-09T19:17:20.4291698Z  # Returns[m
2026-02-09T19:17:20.4291973Z  The superbee limiter value.[m
2026-02-09T19:17:20.4292265Z  """[m
2026-02-09T19:17:20.4292647Z [31m-@inline function superbee(a::T, b::T) where {T<:Real}[m
2026-02-09T19:17:20.4293217Z [32m+[m[32m@inline function superbee(a::T, b::T) where {T <: Real}[m
2026-02-09T19:17:20.4293713Z      return max(minmod(2a, b), minmod(a, 2b))[m
2026-02-09T19:17:20.4294040Z  end[m
2026-02-09T19:17:20.4294232Z  [m
2026-02-09T19:17:20.4294565Z [36m@@ -142,7 +142,7 @@[m [musing a harmonic mean formulation.[m
2026-02-09T19:17:20.4294952Z  # Returns[m
2026-02-09T19:17:20.4295219Z  The van Leer limiter value.[m
2026-02-09T19:17:20.4295489Z  """[m
2026-02-09T19:17:20.4295851Z [31m-@inline function van_leer(a::T, b::T) where {T<:Real}[m
2026-02-09T19:17:20.4296412Z [32m+[m[32m@inline function van_leer(a::T, b::T) where {T <: Real}[m
2026-02-09T19:17:20.4297036Z      ab = a * b[m
2026-02-09T19:17:20.4297278Z      if ab > zero(T)[m
2026-02-09T19:17:20.4297558Z          return 2ab / (a + b)[m
2026-02-09T19:17:20.4297986Z [36m@@ -171,7 +171,7 @@[m [ma smoothing factor for very small values.[m
2026-02-09T19:17:20.4298522Z  # Returns[m
2026-02-09T19:17:20.4299025Z  The Venkatakrishnan limiter value in [0, 1].[m
2026-02-09T19:17:20.4299434Z  """[m
2026-02-09T19:17:20.4299894Z [31m-@inline function venkatakrishnan(r::T, ε::T=T(1e-6)) where {T<:Real}[m
2026-02-09T19:17:20.4300613Z [32m+[m[32m@inline function venkatakrishnan(r::T, ε::T = T(1.0e-6)) where {T <: Real}[m
2026-02-09T19:17:20.4301105Z      if r < ε[m
2026-02-09T19:17:20.4301349Z          return zero(T)[m
2026-02-09T19:17:20.4301635Z      end[m
2026-02-09T19:17:20.4302035Z [36m@@ -204,7 +204,7 @@[m [mgradient reconstruction on unstructured meshes.[m
2026-02-09T19:17:20.4302475Z  # Returns[m
2026-02-09T19:17:20.4302741Z  The limiting factor in [0, 1].[m
2026-02-09T19:17:20.4303045Z  """[m
2026-02-09T19:17:20.4303586Z [31m-@inline function barth_jespersen(φ_center::T, φ_min::T, φ_max::T, φ_face::T) where {T<:Real}[m
2026-02-09T19:17:20.4304493Z [32m+[m[32m@inline function barth_jespersen(φ_center::T, φ_min::T, φ_max::T, φ_face::T) where {T <: Real}[m
2026-02-09T19:17:20.4305085Z      Δ = φ_face - φ_center[m
2026-02-09T19:17:20.4305368Z      if abs(Δ) < eps(T)[m
2026-02-09T19:17:20.4305644Z          return one(T)[m
2026-02-09T19:17:20.4306035Z [36m@@ -234,7 +234,7 @@[m [mwhile maintaining TVD properties.[m
2026-02-09T19:17:20.4306425Z  # Returns[m
2026-02-09T19:17:20.4306677Z  The Koren limiter value.[m
2026-02-09T19:17:20.4306948Z  """[m
2026-02-09T19:17:20.4307320Z [31m-@inline function koren(r::T, β::T=T(1//3)) where {T<:Real}[m
2026-02-09T19:17:20.4307916Z [32m+[m[32m@inline function koren(r::T, β::T = T(1 // 3)) where {T <: Real}[m
2026-02-09T19:17:20.4308472Z      return max(zero(T), min(2r, min((one(T) + 2r) / 3, T(2))))[m
2026-02-09T19:17:20.4308980Z  end[m
2026-02-09T19:17:20.4309171Z  [m
2026-02-09T19:17:20.4309519Z [36m@@ -256,7 +256,7 @@[m [moptimized for second-order accuracy.[m
2026-02-09T19:17:20.4309917Z  # Returns[m
2026-02-09T19:17:20.4310171Z  The OSPRE limiter value.[m
2026-02-09T19:17:20.4310452Z  """[m
2026-02-09T19:17:20.4310862Z [31m-@inline function ospre(r::T) where {T<:Real}[m
2026-02-09T19:17:20.4311372Z [32m+[m[32m@inline function ospre(r::T) where {T <: Real}[m
2026-02-09T19:17:20.4311756Z      r² = r * r[m
2026-02-09T19:17:20.4312009Z      denom = r² + r + one(T)[m
2026-02-09T19:17:20.4312300Z      if denom < eps(T)[m
2026-02-09T19:17:20.4312577Z [36m@@ -270,42 +270,42 @@[m [mend[m
2026-02-09T19:17:20.4312842Z  [m
2026-02-09T19:17:20.4313084Z  Apply the minmod limiter.[m
2026-02-09T19:17:20.4313357Z  """[m
2026-02-09T19:17:20.4313836Z [31m-@inline apply_limiter(::MinmodLimiter, a::T, b::T) where {T<:Real} = minmod(a, b)[m
2026-02-09T19:17:20.4314661Z [32m+[m[32m@inline apply_limiter(::MinmodLimiter, a::T, b::T) where {T <: Real} = minmod(a, b)[m
2026-02-09T19:17:20.4315183Z  [m
2026-02-09T19:17:20.4315387Z  """[m
2026-02-09T19:17:20.4315760Z      apply_limiter(::SuperbeeLimiter, a::T, b::T) where {T<:Real}[m
2026-02-09T19:17:20.4316156Z  [m
2026-02-09T19:17:20.4316407Z  Apply the superbee limiter.[m
2026-02-09T19:17:20.4316687Z  """[m
2026-02-09T19:17:20.4317194Z [31m-@inline apply_limiter(::SuperbeeLimiter, a::T, b::T) where {T<:Real} = superbee(a, b)[m
2026-02-09T19:17:20.4318035Z [32m+[m[32m@inline apply_limiter(::SuperbeeLimiter, a::T, b::T) where {T <: Real} = superbee(a, b)[m
2026-02-09T19:17:20.4318568Z  [m
2026-02-09T19:17:20.4318910Z  """[m
2026-02-09T19:17:20.4319572Z      apply_limiter(::VanLeerLimiter, a::T, b::T) where {T<:Real}[m
2026-02-09T19:17:20.4320049Z  [m
2026-02-09T19:17:20.4320387Z  Apply the van Leer limiter.[m
2026-02-09T19:17:20.4320708Z  """[m
2026-02-09T19:17:20.4330707Z [31m-@inline apply_limiter(::VanLeerLimiter, a::T, b::T) where {T<:Real} = van_leer(a, b)[m
2026-02-09T19:17:20.4331812Z [32m+[m[32m@inline apply_limiter(::VanLeerLimiter, a::T, b::T) where {T <: Real} = van_leer(a, b)[m
2026-02-09T19:17:20.4332349Z  [m
2026-02-09T19:17:20.4332549Z  """[m
2026-02-09T19:17:20.4333125Z      apply_limiter(::VenkatakrishnanLimiter, r::T) where {T<:Real}[m
2026-02-09T19:17:20.4333541Z  [m
2026-02-09T19:17:20.4333825Z  Apply the Venkatakrishnan limiter.[m
2026-02-09T19:17:20.4334136Z  """[m
2026-02-09T19:17:20.4334698Z [31m-@inline apply_limiter(::VenkatakrishnanLimiter, r::T) where {T<:Real} = venkatakrishnan(r)[m
2026-02-09T19:17:20.4335632Z [32m+[m[32m@inline apply_limiter(::VenkatakrishnanLimiter, r::T) where {T <: Real} = venkatakrishnan(r)[m
2026-02-09T19:17:20.4336210Z  [m
2026-02-09T19:17:20.4336405Z  """[m
2026-02-09T19:17:20.4336740Z      apply_limiter(::KorenLimiter, r::T) where {T<:Real}[m
2026-02-09T19:17:20.4337109Z  [m
2026-02-09T19:17:20.4337349Z  Apply the Koren limiter.[m
2026-02-09T19:17:20.4337635Z  """[m
2026-02-09T19:17:20.4338074Z [31m-@inline apply_limiter(::KorenLimiter, r::T) where {T<:Real} = koren(r)[m
2026-02-09T19:17:20.4339007Z [32m+[m[32m@inline apply_limiter(::KorenLimiter, r::T) where {T <: Real} = koren(r)[m
2026-02-09T19:17:20.4339533Z  [m
2026-02-09T19:17:20.4339733Z  """[m
2026-02-09T19:17:20.4340065Z      apply_limiter(::OspreLimiter, r::T) where {T<:Real}[m
2026-02-09T19:17:20.4340429Z  [m
2026-02-09T19:17:20.4340671Z  Apply the OSPRE limiter.[m
2026-02-09T19:17:20.4340939Z  """[m
2026-02-09T19:17:20.4341470Z [31m-@inline apply_limiter(::OspreLimiter, r::T) where {T<:Real} = ospre(r)[m
2026-02-09T19:17:20.4342194Z [32m+[m[32m@inline apply_limiter(::OspreLimiter, r::T) where {T <: Real} = ospre(r)[m
2026-02-09T19:17:20.4342661Z  [m
2026-02-09T19:17:20.4342863Z  @doc raw"""[m
2026-02-09T19:17:20.4343288Z      compute_slope_ratio(φ_L::T, φ_C::T, φ_R::T) where {T<:Real} -> T[m
2026-02-09T19:17:20.4343866Z [36m@@ -324,11 +324,11 @@[m [mr = \frac{\phi_C - \phi_L}{\phi_R - \phi_C}[m
2026-02-09T19:17:20.4344295Z  # Returns[m
2026-02-09T19:17:20.4344721Z  The slope ratio, or a large value if the denominator is near zero.[m
2026-02-09T19:17:20.4345152Z  """[m
2026-02-09T19:17:20.4345619Z [31m-@inline function compute_slope_ratio(φ_L::T, φ_C::T, φ_R::T) where {T<:Real}[m
2026-02-09T19:17:20.4346392Z [32m+[m[32m@inline function compute_slope_ratio(φ_L::T, φ_C::T, φ_R::T) where {T <: Real}[m
2026-02-09T19:17:20.4346913Z      Δ_down = φ_R - φ_C[m
2026-02-09T19:17:20.4347179Z      Δ_up = φ_C - φ_L[m
2026-02-09T19:17:20.4347462Z      if abs(Δ_down) < eps(T)[m
2026-02-09T19:17:20.4347797Z [31m-        return sign(Δ_up) * T(1e10)[m
2026-02-09T19:17:20.4348180Z [32m+[m[32m        return sign(Δ_up) * T(1.0e10)[m
2026-02-09T19:17:20.4348511Z      end[m
2026-02-09T19:17:20.4348868Z      return Δ_up / Δ_down[m
2026-02-09T19:17:20.4349134Z  end[m
2026-02-09T19:17:20.4349619Z [36m@@ -345,7 +345,7 @@[m [mSelect an appropriate limiter based on problem characteristics.[m
2026-02-09T19:17:20.4350152Z  # Returns[m
2026-02-09T19:17:20.4350434Z  An appropriate limiter instance.[m
2026-02-09T19:17:20.4350747Z  """[m
2026-02-09T19:17:20.4351238Z [31m-function select_limiter(problem_type::Symbol, mesh_type::Symbol=:structured)[m
2026-02-09T19:17:20.4352080Z [32m+[m[32mfunction select_limiter(problem_type::Symbol, mesh_type::Symbol = :structured)[m
2026-02-09T19:17:20.4352670Z      if mesh_type == :unstructured[m
2026-02-09T19:17:20.4353050Z          return VenkatakrishnanLimiter()[m
2026-02-09T19:17:20.4353374Z      end[m
2026-02-09T19:17:20.5142140Z [34m[115/151] Checking `src/schemes/muscl.jl` .................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.5160547Z [1mdiff --git a/muscl.jl b/muscl.jl[m
2026-02-09T19:17:20.5161172Z [1mindex 1755054..3d8a393 100644[m
2026-02-09T19:17:20.5161538Z [1m--- a/muscl.jl[m
2026-02-09T19:17:20.5161817Z [1m+++ b/muscl.jl[m
2026-02-09T19:17:20.5162420Z [36m@@ -19,7 +19,7 @@[m [mMUSCL reconstruction scheme configuration.[m
2026-02-09T19:17:20.5163554Z  - `limiter::L`: The flux limiter to use[m
2026-02-09T19:17:20.5164298Z  - `gradient_method::G`: The gradient reconstruction method[m
2026-02-09T19:17:20.5164913Z  """[m
2026-02-09T19:17:20.5165820Z [31m-struct MUSCLScheme{L<:AbstractLimiter, G<:AbstractGradientMethod}[m
2026-02-09T19:17:20.5166944Z [32m+[m[32mstruct MUSCLScheme{L <: AbstractLimiter, G <: AbstractGradientMethod}[m
2026-02-09T19:17:20.5167769Z      limiter::L[m
2026-02-09T19:17:20.5168191Z      gradient_method::G[m
2026-02-09T19:17:20.5168607Z  end[m
2026-02-09T19:17:20.5169201Z [36m@@ -30,8 +30,8 @@[m [mend[m
2026-02-09T19:17:20.5169929Z  Create a MUSCL scheme with specified limiter and gradient method.[m
2026-02-09T19:17:20.5170591Z  """[m
2026-02-09T19:17:20.5170974Z  function MUSCLScheme(;[m
2026-02-09T19:17:20.5171720Z [31m-        limiter::AbstractLimiter=VanLeerLimiter(),[m
2026-02-09T19:17:20.5172681Z [31m-        gradient_method::AbstractGradientMethod=GreenGaussGradient()[m
2026-02-09T19:17:20.5173698Z [32m+[m[32m        limiter::AbstractLimiter = VanLeerLimiter(),[m
2026-02-09T19:17:20.5174713Z [32m+[m[32m        gradient_method::AbstractGradientMethod = GreenGaussGradient()[m
2026-02-09T19:17:20.5175455Z      )[m
2026-02-09T19:17:20.5175922Z      return MUSCLScheme(limiter, gradient_method)[m
2026-02-09T19:17:20.5176456Z  end[m
2026-02-09T19:17:20.5177174Z [36m@@ -235,13 +235,13 @@[m [mA flux function wrapper that applies MUSCL reconstruction.[m
2026-02-09T19:17:20.5178242Z  This can be used to create a flux function compatible with FVMProblem[m
2026-02-09T19:17:20.5179243Z  that uses MUSCL reconstruction internally.[m
2026-02-09T19:17:20.5179770Z  """[m
2026-02-09T19:17:20.5180283Z [31m-struct MUSCLFluxFunction{S<:MUSCLScheme, D, V}[m
2026-02-09T19:17:20.5181088Z [32m+[m[32mstruct MUSCLFluxFunction{S <: MUSCLScheme, D, V}[m
2026-02-09T19:17:20.5181733Z      scheme::S[m
2026-02-09T19:17:20.5182221Z      diffusion::D  # D(x, y, t, u, p) -> scalar[m
2026-02-09T19:17:20.5183087Z      velocity::V   # v(x, y, t, u, p) -> (vx, vy), or nothing for pure diffusion[m
2026-02-09T19:17:20.5183754Z  end[m
2026-02-09T19:17:20.5184061Z  [m
2026-02-09T19:17:20.5184873Z [31m-function MUSCLFluxFunction(scheme::MUSCLScheme; diffusion, velocity=nothing)[m
2026-02-09T19:17:20.5186236Z [32m+[m[32mfunction MUSCLFluxFunction(scheme::MUSCLScheme; diffusion, velocity = nothing)[m
2026-02-09T19:17:20.5187322Z      return MUSCLFluxFunction(scheme, diffusion, velocity)[m
2026-02-09T19:17:20.5187928Z  end[m
2026-02-09T19:17:20.5188226Z  [m
2026-02-09T19:17:20.5189106Z [36m@@ -321,41 +321,41 @@[m [mAn FVMProblem configured with MUSCL reconstruction.[m
2026-02-09T19:17:20.5189932Z  function create_muscl_problem([m
2026-02-09T19:17:20.5190470Z          mesh::FVMGeometry,[m
2026-02-09T19:17:20.5190983Z          BCs::BoundaryConditions,[m
2026-02-09T19:17:20.5191729Z [31m-        ICs::InternalConditions=InternalConditions();[m
2026-02-09T19:17:20.5192648Z [32m+[m[32m        ICs::InternalConditions = InternalConditions();[m
2026-02-09T19:17:20.5193360Z          diffusion_function,[m
2026-02-09T19:17:20.5193917Z [31m-        diffusion_parameters=nothing,[m
2026-02-09T19:17:20.5194531Z [31m-        velocity_function=nothing,[m
2026-02-09T19:17:20.5195138Z [31m-        velocity_parameters=nothing,[m
2026-02-09T19:17:20.5195864Z [31m-        source_function=(x, y, t, u, p) -> zero(typeof(x)),[m
2026-02-09T19:17:20.5196581Z [31m-        source_parameters=nothing,[m
2026-02-09T19:17:20.5197232Z [32m+[m[32m        diffusion_parameters = nothing,[m
2026-02-09T19:17:20.5197922Z [32m+[m[32m        velocity_function = nothing,[m
2026-02-09T19:17:20.5198599Z [32m+[m[32m        velocity_parameters = nothing,[m
2026-02-09T19:17:20.5199573Z [32m+[m[32m        source_function = (x, y, t, u, p) -> zero(typeof(x)),[m
2026-02-09T19:17:20.5200365Z [32m+[m[32m        source_parameters = nothing,[m
2026-02-09T19:17:20.5200964Z          initial_condition,[m
2026-02-09T19:17:20.5201719Z [31m-        initial_time=0.0,[m
2026-02-09T19:17:20.5202273Z [32m+[m[32m        initial_time = 0.0,[m
2026-02-09T19:17:20.5202792Z          final_time,[m
2026-02-09T19:17:20.5203432Z [31m-        limiter::AbstractLimiter=VanLeerLimiter(),[m
2026-02-09T19:17:20.5204624Z [31m-        gradient_method::AbstractGradientMethod=GreenGaussGradient(),[m
2026-02-09T19:17:20.5205629Z [32m+[m[32m        limiter::AbstractLimiter = VanLeerLimiter(),[m
2026-02-09T19:17:20.5206689Z [32m+[m[32m        gradient_method::AbstractGradientMethod = GreenGaussGradient(),[m
2026-02-09T19:17:20.5207471Z          kwargs...[m
2026-02-09T19:17:20.5207845Z      )[m
2026-02-09T19:17:20.5208533Z [31m-    scheme = MUSCLScheme(limiter=limiter, gradient_method=gradient_method)[m
2026-02-09T19:17:20.5209890Z [32m+[m[32m    scheme = MUSCLScheme(limiter = limiter, gradient_method = gradient_method)[m
2026-02-09T19:17:20.5210674Z  [m
2026-02-09T19:17:20.5211201Z      # Wrap functions to include parameters[m
2026-02-09T19:17:20.5212103Z      D_wrapped = (x, y, t, u, p) -> diffusion_function(x, y, t, u, diffusion_parameters)[m
2026-02-09T19:17:20.5213033Z      v_wrapped = isnothing(velocity_function) ? nothing :[m
2026-02-09T19:17:20.5213960Z [31m-                (x, y, t, u, p) -> velocity_function(x, y, t, u, velocity_parameters)[m
2026-02-09T19:17:20.5214982Z [32m+[m[32m        (x, y, t, u, p) -> velocity_function(x, y, t, u, velocity_parameters)[m
2026-02-09T19:17:20.5215682Z  [m
2026-02-09T19:17:20.5216413Z [31m-    flux_fn = MUSCLFluxFunction(scheme; diffusion=D_wrapped, velocity=v_wrapped)[m
2026-02-09T19:17:20.5217689Z [32m+[m[32m    flux_fn = MUSCLFluxFunction(scheme; diffusion = D_wrapped, velocity = v_wrapped)[m
2026-02-09T19:17:20.5218531Z  [m
2026-02-09T19:17:20.5219326Z      # The flux function signature for FVMProblem is q(x, y, t, α, β, γ, p)[m
2026-02-09T19:17:20.5220227Z      flux = (x, y, t, α, β, γ, p) -> flux_fn(x, y, t, α, β, γ, p)[m
2026-02-09T19:17:20.5220800Z  [m
2026-02-09T19:17:20.5221171Z      return FVMProblem([m
2026-02-09T19:17:20.5221621Z          mesh, BCs, ICs;[m
2026-02-09T19:17:20.5222081Z [31m-        flux_function=flux,[m
2026-02-09T19:17:20.5222631Z [31m-        flux_parameters=nothing,[m
2026-02-09T19:17:20.5223256Z [31m-        source_function=source_function,[m
2026-02-09T19:17:20.5223937Z [31m-        source_parameters=source_parameters,[m
2026-02-09T19:17:20.5224620Z [31m-        initial_condition=initial_condition,[m
2026-02-09T19:17:20.5225257Z [31m-        initial_time=initial_time,[m
2026-02-09T19:17:20.5225819Z [31m-        final_time=final_time,[m
2026-02-09T19:17:20.5226394Z [32m+[m[32m        flux_function = flux,[m
2026-02-09T19:17:20.5227022Z [32m+[m[32m        flux_parameters = nothing,[m
2026-02-09T19:17:20.5227721Z [32m+[m[32m        source_function = source_function,[m
2026-02-09T19:17:20.5228477Z [32m+[m[32m        source_parameters = source_parameters,[m
2026-02-09T19:17:20.5229454Z [32m+[m[32m        initial_condition = initial_condition,[m
2026-02-09T19:17:20.5230170Z [32m+[m[32m        initial_time = initial_time,[m
2026-02-09T19:17:20.5230801Z [32m+[m[32m        final_time = final_time,[m
2026-02-09T19:17:20.5231340Z          kwargs...[m
2026-02-09T19:17:20.5231710Z      )[m
2026-02-09T19:17:20.5232031Z  end[m
2026-02-09T19:17:20.5238637Z [34m[116/151] Checking `src/solve.jl` ............................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5298546Z [34m[117/151] Checking `src/specific_problems/abstract_templates.jl` ............. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5354415Z [34m[118/151] Checking `src/specific_problems/advection_diffusion_equation.jl` ... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.5371473Z [1mdiff --git a/advection_diffusion_equation.jl b/advection_diffusion_equation.jl[m
2026-02-09T19:17:20.5372228Z [1mindex d1dc182..0f225af 100644[m
2026-02-09T19:17:20.5372705Z [1m--- a/advection_diffusion_equation.jl[m
2026-02-09T19:17:20.5373617Z [1m+++ b/advection_diffusion_equation.jl[m
2026-02-09T19:17:20.5374184Z [36m@@ -134,15 +134,15 @@[m [mend[m
2026-02-09T19:17:20.5374746Z  function AdvectionDiffusionEquation([m
2026-02-09T19:17:20.5375555Z          mesh::FVMGeometry,[m
2026-02-09T19:17:20.5376077Z          BCs::BoundaryConditions,[m
2026-02-09T19:17:20.5376850Z [31m-        ICs::InternalConditions=InternalConditions();[m
2026-02-09T19:17:20.5377767Z [32m+[m[32m        ICs::InternalConditions = InternalConditions();[m
2026-02-09T19:17:20.5378460Z          diffusion_function,[m
2026-02-09T19:17:20.5379250Z [31m-        diffusion_parameters=nothing,[m
2026-02-09T19:17:20.5379913Z [32m+[m[32m        diffusion_parameters = nothing,[m
2026-02-09T19:17:20.5380510Z          velocity_function,[m
2026-02-09T19:17:20.5381036Z [31m-        velocity_parameters=nothing,[m
2026-02-09T19:17:20.5381769Z [31m-        source_function=(x, y, t, u, p) -> zero(typeof(x)),[m
2026-02-09T19:17:20.5382479Z [31m-        source_parameters=nothing,[m
2026-02-09T19:17:20.5383119Z [32m+[m[32m        velocity_parameters = nothing,[m
2026-02-09T19:17:20.5383909Z [32m+[m[32m        source_function = (x, y, t, u, p) -> zero(typeof(x)),[m
2026-02-09T19:17:20.5384684Z [32m+[m[32m        source_parameters = nothing,[m
2026-02-09T19:17:20.5385274Z          initial_condition,[m
2026-02-09T19:17:20.5385746Z [31m-        initial_time=0.0,[m
2026-02-09T19:17:20.5386259Z [32m+[m[32m        initial_time = 0.0,[m
2026-02-09T19:17:20.5386746Z          final_time,[m
2026-02-09T19:17:20.5387137Z          kwargs...[m
2026-02-09T19:17:20.5387486Z      )[m
2026-02-09T19:17:20.5439479Z [34m[119/151] Checking `src/specific_problems/anisotropic_diffusion.jl` .......... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.5455646Z [1mdiff --git a/anisotropic_diffusion.jl b/anisotropic_diffusion.jl[m
2026-02-09T19:17:20.5456423Z [1mindex 153830e..a64004f 100644[m
2026-02-09T19:17:20.5456958Z [1m--- a/anisotropic_diffusion.jl[m
2026-02-09T19:17:20.5457495Z [1m+++ b/anisotropic_diffusion.jl[m
2026-02-09T19:17:20.5458092Z [36m@@ -201,10 +201,10 @@[m [mfunction anisotropic_neumann_boundary_edge_contributions!([m
2026-02-09T19:17:20.5458694Z          D_eff_j = sqrt(Dxx_j * Dyy_j - Dxy_j^2)[m
2026-02-09T19:17:20.5459415Z  [m
2026-02-09T19:17:20.5459760Z          # Fallback to average of diagonal if det is small[m
2026-02-09T19:17:20.5460166Z [31m-        if D_eff_i < 1e-10[m
2026-02-09T19:17:20.5460501Z [32m+[m[32m        if D_eff_i < 1.0e-10[m
2026-02-09T19:17:20.5460844Z              D_eff_i = (Dxx_i + Dyy_i) / 2[m
2026-02-09T19:17:20.5461152Z          end[m
2026-02-09T19:17:20.5461408Z [31m-        if D_eff_j < 1e-10[m
2026-02-09T19:17:20.5461732Z [32m+[m[32m        if D_eff_j < 1.0e-10[m
2026-02-09T19:17:20.5462078Z              D_eff_j = (Dxx_j + Dyy_j) / 2[m
2026-02-09T19:17:20.5462367Z          end[m
2026-02-09T19:17:20.5462574Z  [m
2026-02-09T19:17:20.5471650Z [34m[120/151] Checking `src/specific_problems/diffusion_equation.jl` ............. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5479707Z [34m[121/151] Checking `src/specific_problems/laplaces_equation.jl` .............. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5492894Z [34m[122/151] Checking `src/specific_problems/linear_reaction_diffusion_equations.jl`  [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5502343Z [34m[123/151] Checking `src/specific_problems/mean_exit_time.jl` ................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5510818Z [34m[124/151] Checking `src/specific_problems/poissons_equation.jl` .............. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5525847Z [34m[125/151] Checking `src/utils.jl` ............................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5531896Z [34m[126/151] Checking `test/README.jl` .......................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5605115Z [34m[127/151] Checking `test/advanced_bcs.jl` .................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.5620433Z [1mdiff --git a/advanced_bcs.jl b/advanced_bcs.jl[m
2026-02-09T19:17:20.5621123Z [1mindex a1832b9..68cfd8d 100644[m
2026-02-09T19:17:20.5621478Z [1m--- a/advanced_bcs.jl[m
2026-02-09T19:17:20.5621978Z [1m+++ b/advanced_bcs.jl[m
2026-02-09T19:17:20.5622293Z [36m@@ -25,7 +25,7 @@[m [musing Test[m
2026-02-09T19:17:20.5622679Z              # Test near fixed point (golden ratio)[m
2026-02-09T19:17:20.5623060Z              φ = (1 + sqrt(5)) / 2[m
2026-02-09T19:17:20.5623628Z              result_near = linearize_bc(NonlinearDirichlet, f, 0.0, 0.0, 0.0, φ, (0.0, 0.0), nothing)[m
2026-02-09T19:17:20.5624278Z [31m-            @test isapprox(result_near, φ, atol=1e-4)[m
2026-02-09T19:17:20.5624783Z [32m+[m[32m            @test isapprox(result_near, φ, atol = 1.0e-4)[m
2026-02-09T19:17:20.5625166Z          end[m
2026-02-09T19:17:20.5625383Z  [m
2026-02-09T19:17:20.5625870Z          @testset "linearize_bc for NonlinearNeumann" begin[m
2026-02-09T19:17:20.5626322Z [36m@@ -48,7 +48,7 @@[m [musing Test[m
2026-02-09T19:17:20.5626602Z  [m
2026-02-09T19:17:20.5626920Z          @testset "compute_boundary_gradient" begin[m
2026-02-09T19:17:20.5627315Z              # Create a simple mesh[m
2026-02-09T19:17:20.5627825Z [31m-            tri = triangulate_rectangle(0, 1, 0, 1, 3, 3, single_boundary=true)[m
2026-02-09T19:17:20.5628505Z [32m+[m[32m            tri = triangulate_rectangle(0, 1, 0, 1, 3, 3, single_boundary = true)[m
2026-02-09T19:17:20.5629279Z              mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.5629592Z  [m
2026-02-09T19:17:20.5629840Z              # Linear solution u = x + y[m
2026-02-09T19:17:20.5630183Z [36m@@ -68,8 +68,8 @@[m [musing Test[m
2026-02-09T19:17:20.5630596Z              grad = compute_boundary_gradient(mesh, u, i, j)[m
2026-02-09T19:17:20.5630963Z  [m
2026-02-09T19:17:20.5631245Z              # Gradient of (x + y) should be (1, 1)[m
2026-02-09T19:17:20.5631669Z [31m-            @test isapprox(grad[1], 1.0, atol=0.1)[m
2026-02-09T19:17:20.5632117Z [31m-            @test isapprox(grad[2], 1.0, atol=0.1)[m
2026-02-09T19:17:20.5632577Z [32m+[m[32m            @test isapprox(grad[1], 1.0, atol = 0.1)[m
2026-02-09T19:17:20.5633059Z [32m+[m[32m            @test isapprox(grad[2], 1.0, atol = 0.1)[m
2026-02-09T19:17:20.5633418Z          end[m
2026-02-09T19:17:20.5633634Z      end[m
2026-02-09T19:17:20.5633825Z  [m
2026-02-09T19:17:20.5634069Z [36m@@ -80,17 +80,17 @@[m [musing Test[m
2026-02-09T19:17:20.5634415Z              @test bc1.shift ≈ 0.0[m
2026-02-09T19:17:20.5634747Z              @test bc1.direction == :x[m
2026-02-09T19:17:20.5635039Z  [m
2026-02-09T19:17:20.5635363Z [31m-            bc2 = PeriodicBC(1, 3; shift=1.0, direction=:y)[m
2026-02-09T19:17:20.5635897Z [32m+[m[32m            bc2 = PeriodicBC(1, 3; shift = 1.0, direction = :y)[m
2026-02-09T19:17:20.5636330Z              @test bc2.shift ≈ 1.0[m
2026-02-09T19:17:20.5636671Z              @test bc2.direction == :y[m
2026-02-09T19:17:20.5636958Z  [m
2026-02-09T19:17:20.5637246Z [31m-            bc3 = PeriodicBC((2, 4); shift=0.5)[m
2026-02-09T19:17:20.5637685Z [32m+[m[32m            bc3 = PeriodicBC((2, 4); shift = 0.5)[m
2026-02-09T19:17:20.5638103Z              @test bc3.segment_pair == (2, 4)[m
2026-02-09T19:17:20.5638414Z          end[m
2026-02-09T19:17:20.5638609Z  [m
2026-02-09T19:17:20.5639128Z          @testset "get_segment_nodes" begin[m
2026-02-09T19:17:20.5639576Z              # Create mesh with distinct boundary segments[m
2026-02-09T19:17:20.5640158Z [31m-            tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=false)[m
2026-02-09T19:17:20.5640849Z [32m+[m[32m            tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = false)[m
2026-02-09T19:17:20.5641380Z              mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.5641666Z  [m
2026-02-09T19:17:20.5641930Z              # Get nodes on segment 1 (bottom)[m
2026-02-09T19:17:20.5642303Z [36m@@ -101,17 +101,17 @@[m [musing Test[m
2026-02-09T19:17:20.5642800Z              for n in nodes1[m
2026-02-09T19:17:20.5643115Z                  p = get_point(mesh, n)[m
2026-02-09T19:17:20.5643431Z                  _, y = getxy(p)[m
2026-02-09T19:17:20.5643905Z [31m-                @test isapprox(y, 0.0, atol=1e-10)[m
2026-02-09T19:17:20.5644352Z [32m+[m[32m                @test isapprox(y, 0.0, atol = 1.0e-10)[m
2026-02-09T19:17:20.5644715Z              end[m
2026-02-09T19:17:20.5644938Z          end[m
2026-02-09T19:17:20.5645134Z  [m
2026-02-09T19:17:20.5645437Z          @testset "compute_periodic_mapping" begin[m
2026-02-09T19:17:20.5645892Z              # Create mesh with left-right periodicity[m
2026-02-09T19:17:20.5646460Z [31m-            tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=false)[m
2026-02-09T19:17:20.5647141Z [32m+[m[32m            tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = false)[m
2026-02-09T19:17:20.5647662Z              mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.5647945Z  [m
2026-02-09T19:17:20.5648269Z              # Segment 4 is left (x=0), segment 2 is right (x=1)[m
2026-02-09T19:17:20.5648935Z [31m-            bc = PeriodicBC(4, 2; direction=:x)[m
2026-02-09T19:17:20.5649459Z [32m+[m[32m            bc = PeriodicBC(4, 2; direction = :x)[m
2026-02-09T19:17:20.5649942Z              mapping = compute_periodic_mapping(mesh, bc)[m
2026-02-09T19:17:20.5650293Z  [m
2026-02-09T19:17:20.5650556Z              # Should have matched pairs[m
2026-02-09T19:17:20.5650909Z [36m@@ -123,7 +123,7 @@[m [musing Test[m
2026-02-09T19:17:20.5651260Z                  p2 = get_point(mesh, n2)[m
2026-02-09T19:17:20.5651589Z                  _, y1 = getxy(p1)[m
2026-02-09T19:17:20.5651900Z                  _, y2 = getxy(p2)[m
2026-02-09T19:17:20.5652269Z [31m-                @test isapprox(y1, y2, atol=1e-8)[m
2026-02-09T19:17:20.5652716Z [32m+[m[32m                @test isapprox(y1, y2, atol = 1.0e-8)[m
2026-02-09T19:17:20.5653084Z              end[m
2026-02-09T19:17:20.5653303Z          end[m
2026-02-09T19:17:20.5653510Z  [m
2026-02-09T19:17:20.5653749Z [36m@@ -135,8 +135,8 @@[m [musing Test[m
2026-02-09T19:17:20.5654148Z              apply_periodic_constraints!(u, mapping)[m
2026-02-09T19:17:20.5654495Z  [m
2026-02-09T19:17:20.5654793Z              # After constraint: u[1] ≈ u[3] and u[2] ≈ u[4][m
2026-02-09T19:17:20.5655236Z [31m-            @test isapprox(u[1], u[3], atol=1e-10)[m
2026-02-09T19:17:20.5655662Z [31m-            @test isapprox(u[2], u[4], atol=1e-10)[m
2026-02-09T19:17:20.5656117Z [32m+[m[32m            @test isapprox(u[1], u[3], atol = 1.0e-10)[m
2026-02-09T19:17:20.5656605Z [32m+[m[32m            @test isapprox(u[2], u[4], atol = 1.0e-10)[m
2026-02-09T19:17:20.5656958Z          end[m
2026-02-09T19:17:20.5657161Z  [m
2026-02-09T19:17:20.5657509Z          @testset "apply_periodic_constraints! with shift" begin[m
2026-02-09T19:17:20.5657958Z [36m@@ -146,14 +146,14 @@[m [musing Test[m
2026-02-09T19:17:20.5658358Z              apply_periodic_constraints!(u, mapping)[m
2026-02-09T19:17:20.5658699Z  [m
2026-02-09T19:17:20.5659132Z              # After constraint: u[1] - u[2] = shift = 2.0[m
2026-02-09T19:17:20.5659583Z [31m-            @test isapprox(u[1] - u[2], 2.0, atol=1e-10)[m
2026-02-09T19:17:20.5660082Z [32m+[m[32m            @test isapprox(u[1] - u[2], 2.0, atol = 1.0e-10)[m
2026-02-09T19:17:20.5660452Z          end[m
2026-02-09T19:17:20.5660652Z  [m
2026-02-09T19:17:20.5660928Z          @testset "PeriodicConditions" begin[m
2026-02-09T19:17:20.5661483Z [31m-            tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=false)[m
2026-02-09T19:17:20.5662174Z [32m+[m[32m            tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = false)[m
2026-02-09T19:17:20.5662701Z              mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.5662985Z  [m
2026-02-09T19:17:20.5663275Z [31m-            bcs = [PeriodicBC(4, 2; direction=:x)][m
2026-02-09T19:17:20.5663890Z [32m+[m[32m            bcs = [PeriodicBC(4, 2; direction = :x)][m
2026-02-09T19:17:20.5664339Z              pc = PeriodicConditions(mesh, bcs)[m
2026-02-09T19:17:20.5664662Z  [m
2026-02-09T19:17:20.5664941Z              @test has_periodic_conditions(pc)[m
2026-02-09T19:17:20.5665193Z [36m@@ -186,7 +186,7 @@[m [musing Test[m
2026-02-09T19:17:20.5665268Z  [m
2026-02-09T19:17:20.5665419Z          @testset "CoupledNeumann" begin[m
2026-02-09T19:17:20.5665618Z              # flux depends on gradient of another field[m
2026-02-09T19:17:20.5665996Z [31m-            cn = CoupledNeumann(1, (x, y, t, u, grad, p) -> -p.D * grad[2][1]; parameters=(D=0.5,))[m
2026-02-09T19:17:20.5666380Z [32m+[m[32m            cn = CoupledNeumann(1, (x, y, t, u, grad, p) -> -p.D * grad[2][1]; parameters = (D = 0.5,))[m
2026-02-09T19:17:20.5666536Z              @test get_target_field(cn) == 1[m
2026-02-09T19:17:20.5666613Z  [m
2026-02-09T19:17:20.5666726Z              u_vals = (1.0, 2.0)[m
2026-02-09T19:17:20.5765232Z [34m[128/151] Checking `test/amr.jl` ............................................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5808615Z [34m[129/151] Checking `test/conditions.jl` ...................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5839571Z [34m[130/151] Checking `test/equations.jl` ....................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5841035Z [34m[131/151] Checking `test/explicit_imports.jl` ................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5864287Z [34m[132/151] Checking `test/geometry.jl` ........................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.5900159Z [34m[133/151] Checking `test/grmhd.jl` ........................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.5915771Z [1mdiff --git a/grmhd.jl b/grmhd.jl[m
2026-02-09T19:17:20.5916025Z [1mindex 22c56e7..9d48ee1 100644[m
2026-02-09T19:17:20.5916190Z [1m--- a/grmhd.jl[m
2026-02-09T19:17:20.5916372Z [1m+++ b/grmhd.jl[m
2026-02-09T19:17:20.5916635Z [36m@@ -52,7 +52,7 @@[m [musing LinearAlgebra[m
2026-02-09T19:17:20.5916788Z          m_kerr0 = KerrMetric(M, 0.0)[m
2026-02-09T19:17:20.5916944Z          m_sch = SchwarzschildMetric(M)[m
2026-02-09T19:17:20.5917219Z          for (x, y) in [(5.0, 0.0), (3.0, 4.0), (0.0, 6.0)][m
2026-02-09T19:17:20.5917677Z [31m-            @test lapse(m_kerr0, x, y) ≈ lapse(m_sch, x, y) atol = 1e-10[m
2026-02-09T19:17:20.5918177Z [32m+[m[32m            @test lapse(m_kerr0, x, y) ≈ lapse(m_sch, x, y) atol = 1.0e-10[m
2026-02-09T19:17:20.5918359Z          end[m
2026-02-09T19:17:20.5918507Z      end[m
2026-02-09T19:17:20.5918638Z  [m
2026-02-09T19:17:20.5919059Z [36m@@ -101,10 +101,10 @@[m [mend[m
2026-02-09T19:17:20.5919396Z              u_gr = primitive_to_conserved(law_gr, w)[m
2026-02-09T19:17:20.5919706Z              u_sr = primitive_to_conserved(law_sr, w)[m
2026-02-09T19:17:20.5920123Z              # In Minkowski with √γ=1, GRMHD conserved = SRMHD conserved[m
2026-02-09T19:17:20.5920429Z [31m-            @test u_gr ≈ u_sr atol = 1e-12[m
2026-02-09T19:17:20.5920738Z [32m+[m[32m            @test u_gr ≈ u_sr atol = 1.0e-12[m
2026-02-09T19:17:20.5920876Z  [m
2026-02-09T19:17:20.5921198Z              w_gr = conserved_to_primitive(law_gr, u_gr)[m
2026-02-09T19:17:20.5921489Z [31m-            @test w_gr ≈ w atol = 1e-9[m
2026-02-09T19:17:20.5921790Z [32m+[m[32m            @test w_gr ≈ w atol = 1.0e-9[m
2026-02-09T19:17:20.5921953Z          end[m
2026-02-09T19:17:20.5922122Z      end[m
2026-02-09T19:17:20.5922260Z  [m
2026-02-09T19:17:20.5922468Z [36m@@ -115,7 +115,7 @@[m [mend[m
2026-02-09T19:17:20.5922821Z          mesh_src = StructuredMesh2D(0.0, 1.0, 0.0, 1.0, 4, 4)[m
2026-02-09T19:17:20.5923280Z          md_src = FiniteVolumeMethod.precompute_metric(metric, mesh_src)[m
2026-02-09T19:17:20.5923869Z          src = FiniteVolumeMethod.grmhd_source_terms(law_gr, w, u, md_src, mesh_src, 2, 2)[m
2026-02-09T19:17:20.5924121Z [31m-        @test all(abs.(src) .< 1e-14)[m
2026-02-09T19:17:20.5924676Z [32m+[m[32m        @test all(abs.(src) .< 1.0e-14)[m
2026-02-09T19:17:20.5924827Z      end[m
2026-02-09T19:17:20.5924974Z  end[m
2026-02-09T19:17:20.5925116Z  [m
2026-02-09T19:17:20.5925505Z [36m@@ -131,7 +131,7 @@[m [mend[m
2026-02-09T19:17:20.5925813Z          w = SVector(1.0, 0.3, 0.2, 0.0, 2.0, 0.5, 0.8, 0.3)[m
2026-02-09T19:17:20.5926079Z          u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.5926353Z          w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.5926582Z [31m-        @test w2 ≈ w atol = 1e-9[m
2026-02-09T19:17:20.5926854Z [32m+[m[32m        @test w2 ≈ w atol = 1.0e-9[m
2026-02-09T19:17:20.5927004Z      end[m
2026-02-09T19:17:20.5927126Z  [m
2026-02-09T19:17:20.5927452Z      @testset "Schwarzschild con2prim roundtrip" begin[m
2026-02-09T19:17:20.5927643Z [36m@@ -141,7 +141,7 @@[m [mend[m
2026-02-09T19:17:20.5927938Z          w = SVector(1.0, 0.1, 0.0, 0.0, 1.0, 0.5, 0.0, 0.0)[m
2026-02-09T19:17:20.5928203Z          u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.5928463Z          w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.5928910Z [31m-        @test w2[1] ≈ w[1] rtol = 1e-6[m
2026-02-09T19:17:20.5929171Z [31m-        @test w2[5] ≈ w[5] rtol = 1e-6[m
2026-02-09T19:17:20.5929473Z [32m+[m[32m        @test w2[1] ≈ w[1] rtol = 1.0e-6[m
2026-02-09T19:17:20.5929760Z [32m+[m[32m        @test w2[5] ≈ w[5] rtol = 1.0e-6[m
2026-02-09T19:17:20.5929913Z      end[m
2026-02-09T19:17:20.5930055Z  end[m
2026-02-09T19:17:20.5955647Z [34m[134/151] Checking `test/grmhd_2d.jl` ........................................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.5969717Z [1mdiff --git a/grmhd_2d.jl b/grmhd_2d.jl[m
2026-02-09T19:17:20.5969963Z [1mindex da9fe50..8fe4089 100644[m
2026-02-09T19:17:20.5970143Z [1m--- a/grmhd_2d.jl[m
2026-02-09T19:17:20.5970308Z [1m+++ b/grmhd_2d.jl[m
2026-02-09T19:17:20.5970571Z [36m@@ -36,7 +36,7 @@[m [musing StaticArrays[m
2026-02-09T19:17:20.5970884Z      D_total_0 = sum(U0[ix, iy][1] for ix in 1:nx, iy in 1:ny) * dV[m
2026-02-09T19:17:20.5970969Z  [m
2026-02-09T19:17:20.5971315Z      # In Minkowski spacetime, geometric sources vanish → perfect conservation[m
2026-02-09T19:17:20.5971506Z [31m-    @test D_total ≈ D_total_0 rtol = 1e-10[m
2026-02-09T19:17:20.5971713Z [32m+[m[32m    @test D_total ≈ D_total_0 rtol = 1.0e-10[m
2026-02-09T19:17:20.5971795Z  end[m
2026-02-09T19:17:20.5971868Z  [m
2026-02-09T19:17:20.5972057Z  @testset "CT DivB Preservation (GRMHD)" begin[m
2026-02-09T19:17:20.5972175Z [36m@@ -59,7 +59,7 @@[m [mend[m
2026-02-09T19:17:20.5972444Z      coords, U, t, ct = solve_hyperbolic(prob; vector_potential = Az)[m
2026-02-09T19:17:20.5972517Z  [m
2026-02-09T19:17:20.5972723Z      divB_max = max_divB(ct, mesh.dx, mesh.dy, nx, ny)[m
2026-02-09T19:17:20.5972847Z [31m-    @test divB_max < 1e-13[m
2026-02-09T19:17:20.5972989Z [32m+[m[32m    @test divB_max < 1.0e-13[m
2026-02-09T19:17:20.5973076Z  end[m
2026-02-09T19:17:20.5973155Z  [m
2026-02-09T19:17:20.5973356Z  @testset "GRMHD matches SRMHD in Minkowski" begin[m
2026-02-09T19:17:20.5973463Z [36m@@ -93,7 +93,7 @@[m [mend[m
2026-02-09T19:17:20.5973541Z  [m
2026-02-09T19:17:20.5973713Z      # Density profiles should match closely[m
2026-02-09T19:17:20.5973841Z      for iy in 1:ny, ix in 1:nx[m
2026-02-09T19:17:20.5974054Z [31m-        @test W_gr[ix, iy][1] ≈ W_sr[ix, iy][1] rtol = 1e-10[m
2026-02-09T19:17:20.5974293Z [32m+[m[32m        @test W_gr[ix, iy][1] ≈ W_sr[ix, iy][1] rtol = 1.0e-10[m
2026-02-09T19:17:20.5974376Z      end[m
2026-02-09T19:17:20.5974454Z  end[m
2026-02-09T19:17:20.5974536Z  [m
2026-02-09T19:17:20.6083878Z [34m[135/151] Checking `test/hyperbolic.jl` ...................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.6099918Z [1mdiff --git a/hyperbolic.jl b/hyperbolic.jl[m
2026-02-09T19:17:20.6100189Z [1mindex e7cd740..4c124eb 100644[m
2026-02-09T19:17:20.6100381Z [1m--- a/hyperbolic.jl[m
2026-02-09T19:17:20.6100794Z [1m+++ b/hyperbolic.jl[m
2026-02-09T19:17:20.6100997Z [36m@@ -125,7 +125,7 @@[m [mend[m
2026-02-09T19:17:20.6101231Z      w = SVector(1.0, 0.5, 1.0)  # ρ, v, P[m
2026-02-09T19:17:20.6101473Z      u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.6101868Z      w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.6102002Z [31m-    @test w2 ≈ w atol = 1e-14[m
2026-02-09T19:17:20.6102154Z [32m+[m[32m    @test w2 ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.6102229Z  [m
2026-02-09T19:17:20.6102366Z      # Test flux computation[m
2026-02-09T19:17:20.6102518Z      f = physical_flux(law, w, 1)[m
2026-02-09T19:17:20.6102642Z [36m@@ -170,10 +170,10 @@[m [mend[m
2026-02-09T19:17:20.6102802Z          f_exact = physical_flux(law, w, 1)[m
2026-02-09T19:17:20.6102876Z  [m
2026-02-09T19:17:20.6103132Z          f_lf = solve_riemann(LaxFriedrichsSolver(), law, w, w, 1)[m
2026-02-09T19:17:20.6103303Z [31m-        @test f_lf ≈ f_exact atol = 1e-14[m
2026-02-09T19:17:20.6103502Z [32m+[m[32m        @test f_lf ≈ f_exact atol = 1.0e-14[m
2026-02-09T19:17:20.6103577Z  [m
2026-02-09T19:17:20.6103781Z          f_hll = solve_riemann(HLLSolver(), law, w, w, 1)[m
2026-02-09T19:17:20.6103942Z [31m-        @test f_hll ≈ f_exact atol = 1e-14[m
2026-02-09T19:17:20.6104134Z [32m+[m[32m        @test f_hll ≈ f_exact atol = 1.0e-14[m
2026-02-09T19:17:20.6104225Z      end[m
2026-02-09T19:17:20.6104305Z  end[m
2026-02-09T19:17:20.6104378Z  [m
2026-02-09T19:17:20.6104491Z [36m@@ -199,7 +199,7 @@[m [mend[m
2026-02-09T19:17:20.6104653Z          x, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6104782Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.6104855Z  [m
2026-02-09T19:17:20.6104997Z [31m-        @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.6105153Z [32m+[m[32m        @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.6105226Z  [m
2026-02-09T19:17:20.6105441Z          # Compare against exact solution at sample points[m
2026-02-09T19:17:20.6105682Z          # Use L1 error norm — should decrease with resolution[m
2026-02-09T19:17:20.6105791Z [36m@@ -277,9 +277,9 @@[m [mend[m
2026-02-09T19:17:20.6105985Z      # The solution should be symmetric about x=0.5[m
2026-02-09T19:17:20.6106098Z      N = length(W)[m
2026-02-09T19:17:20.6106230Z      for i in 1:div(N, 4)[m
2026-02-09T19:17:20.6106407Z [31m-        @test W[i][1] ≈ W[N + 1 - i][1] atol = 1e-10[m
2026-02-09T19:17:20.6106605Z [31m-        @test W[i][2] ≈ -W[N + 1 - i][2] atol = 1e-10[m
2026-02-09T19:17:20.6106782Z [31m-        @test W[i][3] ≈ W[N + 1 - i][3] atol = 1e-10[m
2026-02-09T19:17:20.6106989Z [32m+[m[32m        @test W[i][1] ≈ W[N + 1 - i][1] atol = 1.0e-10[m
2026-02-09T19:17:20.6107189Z [32m+[m[32m        @test W[i][2] ≈ -W[N + 1 - i][2] atol = 1.0e-10[m
2026-02-09T19:17:20.6107385Z [32m+[m[32m        @test W[i][3] ≈ W[N + 1 - i][3] atol = 1.0e-10[m
2026-02-09T19:17:20.6107467Z      end[m
2026-02-09T19:17:20.6107546Z  end[m
2026-02-09T19:17:20.6107626Z  [m
2026-02-09T19:17:20.6107742Z [36m@@ -315,9 +315,9 @@[m [mend[m
2026-02-09T19:17:20.6107945Z      energy_final = sum(U_final[i][3] for i in 1:100) * dx[m
2026-02-09T19:17:20.6108016Z  [m
2026-02-09T19:17:20.6108334Z      # Conservation should hold to near machine precision for periodic BCs[m
2026-02-09T19:17:20.6108512Z [31m-    @test mass_final ≈ mass0 rtol = 1e-12[m
2026-02-09T19:17:20.6108918Z [31m-    @test momentum_final ≈ momentum0 rtol = 1e-12[m
2026-02-09T19:17:20.6109144Z [31m-    @test energy_final ≈ energy0 rtol = 1e-12[m
2026-02-09T19:17:20.6109340Z [32m+[m[32m    @test mass_final ≈ mass0 rtol = 1.0e-12[m
2026-02-09T19:17:20.6109568Z [32m+[m[32m    @test momentum_final ≈ momentum0 rtol = 1.0e-12[m
2026-02-09T19:17:20.6109774Z [32m+[m[32m    @test energy_final ≈ energy0 rtol = 1.0e-12[m
2026-02-09T19:17:20.6109858Z  end[m
2026-02-09T19:17:20.6109931Z  [m
2026-02-09T19:17:20.6110069Z  @testset "CFL Stability" begin[m
2026-02-09T19:17:20.6110183Z [36m@@ -341,7 +341,7 @@[m [mend[m
2026-02-09T19:17:20.6110595Z      # dt should be positive and bounded by CFL * dx / max_wave_speed[m
2026-02-09T19:17:20.6110696Z      @test dt > 0[m
2026-02-09T19:17:20.6110960Z      c_max = sound_speed(eos, 1.0, 1.0)  # max sound speed in left state[m
2026-02-09T19:17:20.6111240Z [31m-    @test dt <= 0.5 * mesh.dx / c_max + 1e-14[m
2026-02-09T19:17:20.6111430Z [32m+[m[32m    @test dt <= 0.5 * mesh.dx / c_max + 1.0e-14[m
2026-02-09T19:17:20.6111504Z  [m
2026-02-09T19:17:20.6111673Z      # dt should not exceed final_time - t[m
2026-02-09T19:17:20.6111814Z      prob2 = HyperbolicProblem([m
2026-02-09T19:17:20.6111927Z [36m@@ -391,12 +391,12 @@[m [mend[m
2026-02-09T19:17:20.6112017Z              end[m
2026-02-09T19:17:20.6112090Z  [m
2026-02-09T19:17:20.6112224Z              # Should reach final time[m
2026-02-09T19:17:20.6112367Z [31m-            @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.6112539Z [32m+[m[32m            @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.6112619Z  [m
2026-02-09T19:17:20.6112776Z              # L1 error should be reasonable[m
2026-02-09T19:17:20.6112883Z              dx = 1.0 / 100[m
2026-02-09T19:17:20.6113151Z              ρ_err = sum(abs(W[i][1] - sod_exact(x[i], 0.2)[1]) * dx for i in 1:100)[m
2026-02-09T19:17:20.6113452Z [31m-            @test ρ_err < 0.10  # All limiters should give reasonable results[m
2026-02-09T19:17:20.6113762Z [32m+[m[32m            @test ρ_err < 0.1  # All limiters should give reasonable results[m
2026-02-09T19:17:20.6113853Z          end[m
2026-02-09T19:17:20.6113936Z      end[m
2026-02-09T19:17:20.6114013Z  end[m
2026-02-09T19:17:20.6114131Z [36m@@ -420,7 +420,7 @@[m [mend[m
2026-02-09T19:17:20.6114259Z      W = to_primitive(law, U)[m
2026-02-09T19:17:20.6114332Z  [m
2026-02-09T19:17:20.6114627Z      # Should complete and give valid results (more diffusive than MUSCL)[m
2026-02-09T19:17:20.6114760Z [31m-    @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.6114906Z [32m+[m[32m    @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.6115015Z      for i in 1:100[m
2026-02-09T19:17:20.6115130Z          @test W[i][1] > 0[m
2026-02-09T19:17:20.6115234Z          @test W[i][3] > 0[m
2026-02-09T19:17:20.6115343Z [36m@@ -483,7 +483,7 @@[m [mend[m
2026-02-09T19:17:20.6115522Z      w = SVector(1.0, 0.5, 0.3, 1.0)  # ρ, vx, vy, P[m
2026-02-09T19:17:20.6115677Z      u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.6115833Z      w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.6115959Z [31m-    @test w2 ≈ w atol = 1e-14[m
2026-02-09T19:17:20.6116112Z [32m+[m[32m    @test w2 ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.6116186Z  [m
2026-02-09T19:17:20.6116274Z      # X-flux[m
2026-02-09T19:17:20.6116413Z      fx = physical_flux(law, w, 1)[m
2026-02-09T19:17:20.6235392Z [34m[136/151] Checking `test/hyperbolic_2d.jl` ................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.6252539Z [1mdiff --git a/hyperbolic_2d.jl b/hyperbolic_2d.jl[m
2026-02-09T19:17:20.6252837Z [1mindex 68d6aa2..e6475ea 100644[m
2026-02-09T19:17:20.6253038Z [1m--- a/hyperbolic_2d.jl[m
2026-02-09T19:17:20.6253237Z [1m+++ b/hyperbolic_2d.jl[m
2026-02-09T19:17:20.6253426Z [36m@@ -56,7 +56,7 @@[m [mend[m
2026-02-09T19:17:20.6253656Z              w = SVector(1.0, 0.5, 1.0)[m
2026-02-09T19:17:20.6253922Z              f_exact = physical_flux(law, w, 1)[m
2026-02-09T19:17:20.6254266Z              f_hllc = solve_riemann(HLLCSolver(), law, w, w, 1)[m
2026-02-09T19:17:20.6254573Z [31m-            @test f_hllc ≈ f_exact atol = 1e-13[m
2026-02-09T19:17:20.6254817Z [32m+[m[32m            @test f_hllc ≈ f_exact atol = 1.0e-13[m
2026-02-09T19:17:20.6254914Z          end[m
2026-02-09T19:17:20.6254989Z  [m
2026-02-09T19:17:20.6255140Z          @testset "Sod shock tube" begin[m
2026-02-09T19:17:20.6255255Z [36m@@ -73,7 +73,7 @@[m [mend[m
2026-02-09T19:17:20.6255415Z              x, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6255552Z              W = to_primitive(law, U)[m
2026-02-09T19:17:20.6255924Z  [m
2026-02-09T19:17:20.6256184Z [31m-            @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.6256457Z [32m+[m[32m            @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.6256582Z  [m
2026-02-09T19:17:20.6256961Z              dx = 1.0 / 200[m
2026-02-09T19:17:20.6257250Z              ρ_err = sum(abs(W[i][1] - sod_exact(x[i], 0.2)[1]) * dx for i in 1:200)[m
2026-02-09T19:17:20.6257372Z [36m@@ -134,7 +134,7 @@[m [mend[m
2026-02-09T19:17:20.6257505Z              for dir in (1, 2)[m
2026-02-09T19:17:20.6257688Z                  f_exact = physical_flux(law, w, dir)[m
2026-02-09T19:17:20.6257924Z                  f_hllc = solve_riemann(HLLCSolver(), law, w, w, dir)[m
2026-02-09T19:17:20.6258111Z [31m-                @test f_hllc ≈ f_exact atol = 1e-13[m
2026-02-09T19:17:20.6258320Z [32m+[m[32m                @test f_hllc ≈ f_exact atol = 1.0e-13[m
2026-02-09T19:17:20.6258408Z              end[m
2026-02-09T19:17:20.6258491Z          end[m
2026-02-09T19:17:20.6258580Z  [m
2026-02-09T19:17:20.6258691Z [36m@@ -150,9 +150,9 @@[m [mend[m
2026-02-09T19:17:20.6259181Z              f2d = solve_riemann(HLLCSolver(), law, wL_2d, wR_2d, 1)[m
2026-02-09T19:17:20.6259256Z  [m
2026-02-09T19:17:20.6259403Z              # Mass flux should match[m
2026-02-09T19:17:20.6259566Z [31m-            @test f2d[1] ≈ f1d[1] atol = 1e-12[m
2026-02-09T19:17:20.6259750Z [32m+[m[32m            @test f2d[1] ≈ f1d[1] atol = 1.0e-12[m
2026-02-09T19:17:20.6259910Z              # x-momentum flux should match[m
2026-02-09T19:17:20.6260064Z [31m-            @test f2d[2] ≈ f1d[2] atol = 1e-12[m
2026-02-09T19:17:20.6260242Z [32m+[m[32m            @test f2d[2] ≈ f1d[2] atol = 1.0e-12[m
2026-02-09T19:17:20.6260333Z          end[m
2026-02-09T19:17:20.6260412Z      end[m
2026-02-09T19:17:20.6260490Z  end[m
2026-02-09T19:17:20.6260602Z [36m@@ -183,14 +183,14 @@[m [mend[m
2026-02-09T19:17:20.6260779Z          coords, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6260918Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.6260991Z  [m
2026-02-09T19:17:20.6261129Z [31m-        @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.6261283Z [32m+[m[32m        @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.6261363Z  [m
2026-02-09T19:17:20.6261568Z          # Check that solution is uniform in y-direction[m
2026-02-09T19:17:20.6261682Z          for ix in 1:N[m
2026-02-09T19:17:20.6261791Z              for iy in 2:4[m
2026-02-09T19:17:20.6261991Z [31m-                @test W[ix, iy][1] ≈ W[ix, 1][1] atol = 1e-12[m
2026-02-09T19:17:20.6262193Z [31m-                @test W[ix, iy][2] ≈ W[ix, 1][2] atol = 1e-12[m
2026-02-09T19:17:20.6262381Z [31m-                @test W[ix, iy][4] ≈ W[ix, 1][4] atol = 1e-12[m
2026-02-09T19:17:20.6262599Z [32m+[m[32m                @test W[ix, iy][1] ≈ W[ix, 1][1] atol = 1.0e-12[m
2026-02-09T19:17:20.6262809Z [32m+[m[32m                @test W[ix, iy][2] ≈ W[ix, 1][2] atol = 1.0e-12[m
2026-02-09T19:17:20.6263029Z [32m+[m[32m                @test W[ix, iy][4] ≈ W[ix, 1][4] atol = 1.0e-12[m
2026-02-09T19:17:20.6263115Z              end[m
2026-02-09T19:17:20.6263198Z          end[m
2026-02-09T19:17:20.6263277Z  [m
2026-02-09T19:17:20.6263389Z [36m@@ -219,12 +219,12 @@[m [mend[m
2026-02-09T19:17:20.6263567Z          coords, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6263701Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.6263775Z  [m
2026-02-09T19:17:20.6263903Z [31m-        @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.6264062Z [32m+[m[32m        @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.6264141Z  [m
2026-02-09T19:17:20.6264262Z          # Check uniform in x[m
2026-02-09T19:17:20.6264367Z          for iy in 1:N[m
2026-02-09T19:17:20.6264482Z              for ix in 2:4[m
2026-02-09T19:17:20.6264673Z [31m-                @test W[ix, iy][1] ≈ W[1, iy][1] atol = 1e-12[m
2026-02-09T19:17:20.6264882Z [32m+[m[32m                @test W[ix, iy][1] ≈ W[1, iy][1] atol = 1.0e-12[m
2026-02-09T19:17:20.6265118Z              end[m
2026-02-09T19:17:20.6265207Z          end[m
2026-02-09T19:17:20.6265283Z  [m
2026-02-09T19:17:20.6265394Z [36m@@ -268,10 +268,10 @@[m [mend[m
2026-02-09T19:17:20.6265655Z          mom_yf = sum(U_final[ix, iy][3] for ix in 1:50, iy in 1:50) * dx * dy[m
2026-02-09T19:17:20.6266029Z          energy_f = sum(U_final[ix, iy][4] for ix in 1:50, iy in 1:50) * dx * dy[m
2026-02-09T19:17:20.6266103Z  [m
2026-02-09T19:17:20.6266261Z [31m-        @test mass_f ≈ mass0 rtol = 1e-12[m
2026-02-09T19:17:20.6266424Z [31m-        @test mom_xf ≈ mom_x0 rtol = 1e-12[m
2026-02-09T19:17:20.6266575Z [31m-        @test mom_yf ≈ mom_y0 rtol = 1e-12[m
2026-02-09T19:17:20.6266748Z [31m-        @test energy_f ≈ energy0 rtol = 1e-12[m
2026-02-09T19:17:20.6266936Z [32m+[m[32m        @test mass_f ≈ mass0 rtol = 1.0e-12[m
2026-02-09T19:17:20.6267119Z [32m+[m[32m        @test mom_xf ≈ mom_x0 rtol = 1.0e-12[m
2026-02-09T19:17:20.6267294Z [32m+[m[32m        @test mom_yf ≈ mom_y0 rtol = 1.0e-12[m
2026-02-09T19:17:20.6267504Z [32m+[m[32m        @test energy_f ≈ energy0 rtol = 1.0e-12[m
2026-02-09T19:17:20.6267586Z      end[m
2026-02-09T19:17:20.6267661Z  [m
2026-02-09T19:17:20.6267851Z      @testset "2D Sedov blast (qualitative)" begin[m
2026-02-09T19:17:20.6267976Z [36m@@ -281,7 +281,7 @@[m [mend[m
2026-02-09T19:17:20.6268177Z          mesh = StructuredMesh2D(-1.0, 1.0, -1.0, 1.0, N, N)[m
2026-02-09T19:17:20.6268250Z  [m
2026-02-09T19:17:20.6268534Z          # Background state + small region of high pressure at center[m
2026-02-09T19:17:20.6268645Z [31m-        P_bg = 1e-5[m
2026-02-09T19:17:20.6269084Z [32m+[m[32m        P_bg = 1.0e-5[m
2026-02-09T19:17:20.6269221Z          P_blast = 1.0[m
2026-02-09T19:17:20.6269389Z          r_blast = 3.0 * mesh.dx  # few cells[m
2026-02-09T19:17:20.6269463Z  [m
2026-02-09T19:17:20.6269580Z [36m@@ -348,10 +348,10 @@[m [mend[m
2026-02-09T19:17:20.6269660Z  [m
2026-02-09T19:17:20.6269985Z          # Uniform state with zero velocity + reflective walls should stay uniform[m
2026-02-09T19:17:20.6270118Z          for iy in 1:N, ix in 1:N[m
2026-02-09T19:17:20.6270291Z [31m-            @test W[ix, iy][1] ≈ 1.0 atol = 1e-10[m
2026-02-09T19:17:20.6270466Z [31m-            @test W[ix, iy][2] ≈ 0.0 atol = 1e-10[m
2026-02-09T19:17:20.6270622Z [31m-            @test W[ix, iy][3] ≈ 0.0 atol = 1e-10[m
2026-02-09T19:17:20.6270779Z [31m-            @test W[ix, iy][4] ≈ 1.0 atol = 1e-10[m
2026-02-09T19:17:20.6270982Z [32m+[m[32m            @test W[ix, iy][1] ≈ 1.0 atol = 1.0e-10[m
2026-02-09T19:17:20.6271166Z [32m+[m[32m            @test W[ix, iy][2] ≈ 0.0 atol = 1.0e-10[m
2026-02-09T19:17:20.6271347Z [32m+[m[32m            @test W[ix, iy][3] ≈ 0.0 atol = 1.0e-10[m
2026-02-09T19:17:20.6271533Z [32m+[m[32m            @test W[ix, iy][4] ≈ 1.0 atol = 1.0e-10[m
2026-02-09T19:17:20.6271619Z          end[m
2026-02-09T19:17:20.6271700Z      end[m
2026-02-09T19:17:20.6271773Z  [m
2026-02-09T19:17:20.6271899Z [36m@@ -377,7 +377,7 @@[m [mend[m
2026-02-09T19:17:20.6272110Z          # CFL: dt ≤ cfl / (c/dx + c/dy) where c = sound speed[m
2026-02-09T19:17:20.6272249Z          c = sound_speed(eos, 1.0, 1.0)[m
2026-02-09T19:17:20.6272428Z          dt_max = 0.5 / (c / mesh.dx + c / mesh.dy)[m
2026-02-09T19:17:20.6272571Z [31m-        @test dt <= dt_max + 1e-14[m
2026-02-09T19:17:20.6272729Z [32m+[m[32m        @test dt <= dt_max + 1.0e-14[m
2026-02-09T19:17:20.6272811Z      end[m
2026-02-09T19:17:20.6272889Z  [m
2026-02-09T19:17:20.6273118Z      @testset "2D All solvers produce valid results" begin[m
2026-02-09T19:17:20.6273229Z [36m@@ -398,7 +398,7 @@[m [mend[m
2026-02-09T19:17:20.6273421Z                  coords, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6273562Z                  W = to_primitive(law, U)[m
2026-02-09T19:17:20.6273634Z  [m
2026-02-09T19:17:20.6273778Z [31m-                @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.6273955Z [32m+[m[32m                @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.6274237Z                  for iy in 1:4, ix in 1:50[m
2026-02-09T19:17:20.6274400Z                      @test W[ix, iy][1] > 0  # ρ > 0[m
2026-02-09T19:17:20.6274552Z                      @test W[ix, iy][4] > 0  # P > 0[m
2026-02-09T19:17:20.6363854Z [34m[137/151] Checking `test/hyperbolic_3d.jl` ................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.6379517Z [1mdiff --git a/hyperbolic_3d.jl b/hyperbolic_3d.jl[m
2026-02-09T19:17:20.6379760Z [1mindex ec036ea..baf30db 100644[m
2026-02-09T19:17:20.6379957Z [1m--- a/hyperbolic_3d.jl[m
2026-02-09T19:17:20.6380144Z [1m+++ b/hyperbolic_3d.jl[m
2026-02-09T19:17:20.6380431Z [36m@@ -20,13 +20,13 @@[m [musing LinearAlgebra[m
2026-02-09T19:17:20.6380785Z          w = SVector(1.0, 0.5, -0.3, 0.2, 1.0)  # ρ, vx, vy, vz, P[m
2026-02-09T19:17:20.6381043Z          u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.6381293Z          w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.6381581Z [31m-        @test w2 ≈ w atol = 1e-14[m
2026-02-09T19:17:20.6381771Z [32m+[m[32m        @test w2 ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.6381854Z  [m
2026-02-09T19:17:20.6381968Z          # Another state[m
2026-02-09T19:17:20.6382132Z          w3 = SVector(0.125, -1.0, 0.7, 0.4, 0.1)[m
2026-02-09T19:17:20.6382310Z          u3 = primitive_to_conserved(law, w3)[m
2026-02-09T19:17:20.6382477Z          w4 = conserved_to_primitive(law, u3)[m
2026-02-09T19:17:20.6382614Z [31m-        @test w4 ≈ w3 atol = 1e-14[m
2026-02-09T19:17:20.6382774Z [32m+[m[32m        @test w4 ≈ w3 atol = 1.0e-14[m
2026-02-09T19:17:20.6382866Z      end[m
2026-02-09T19:17:20.6382941Z  [m
2026-02-09T19:17:20.6383147Z      @testset "physical_flux dir=$dir" for dir in 1:3[m
2026-02-09T19:17:20.6383267Z [36m@@ -152,7 +152,7 @@[m [mend[m
2026-02-09T19:17:20.6383442Z          coords, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6383572Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.6383652Z  [m
2026-02-09T19:17:20.6383795Z [31m-        @test t ≈ 0.05 atol = 1e-10[m
2026-02-09T19:17:20.6383953Z [32m+[m[32m        @test t ≈ 0.05 atol = 1.0e-10[m
2026-02-09T19:17:20.6384027Z  [m
2026-02-09T19:17:20.6384262Z          # Density should vary along x: left side > right side[m
2026-02-09T19:17:20.6384385Z          jmid, kmid = 2, 2[m
2026-02-09T19:17:20.6384496Z [36m@@ -166,7 +166,7 @@[m [mend[m
2026-02-09T19:17:20.6384673Z          # Solution should be uniform in y and z[m
2026-02-09T19:17:20.6384788Z          for ix in 1:nx[m
2026-02-09T19:17:20.6384924Z              for iy in 2:ny, iz in 1:nz[m
2026-02-09T19:17:20.6385141Z [31m-                @test W[ix, iy, iz][1] ≈ W[ix, 1, 1][1] atol = 1e-10[m
2026-02-09T19:17:20.6385386Z [32m+[m[32m                @test W[ix, iy, iz][1] ≈ W[ix, 1, 1][1] atol = 1.0e-10[m
2026-02-09T19:17:20.6385474Z              end[m
2026-02-09T19:17:20.6385557Z          end[m
2026-02-09T19:17:20.6385629Z  [m
2026-02-09T19:17:20.6385744Z [36m@@ -196,7 +196,7 @@[m [mend[m
2026-02-09T19:17:20.6385921Z          coords, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6386049Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.6386132Z  [m
2026-02-09T19:17:20.6386267Z [31m-        @test t ≈ 0.05 atol = 1e-10[m
2026-02-09T19:17:20.6386432Z [32m+[m[32m        @test t ≈ 0.05 atol = 1.0e-10[m
2026-02-09T19:17:20.6386512Z  [m
2026-02-09T19:17:20.6386626Z          imid, kmid = 2, 2[m
2026-02-09T19:17:20.6386811Z          # Bottom state has higher density than top[m
2026-02-09T19:17:20.6386921Z [36m@@ -210,7 +210,7 @@[m [mend[m
2026-02-09T19:17:20.6387050Z          # Uniform in x and z[m
2026-02-09T19:17:20.6387158Z          for iy in 1:ny[m
2026-02-09T19:17:20.6387290Z              for ix in 2:nx, iz in 1:nz[m
2026-02-09T19:17:20.6387506Z [31m-                @test W[ix, iy, iz][1] ≈ W[1, iy, 1][1] atol = 1e-10[m
2026-02-09T19:17:20.6387736Z [32m+[m[32m                @test W[ix, iy, iz][1] ≈ W[1, iy, 1][1] atol = 1.0e-10[m
2026-02-09T19:17:20.6388030Z              end[m
2026-02-09T19:17:20.6388123Z          end[m
2026-02-09T19:17:20.6388202Z  [m
2026-02-09T19:17:20.6388311Z [36m@@ -240,7 +240,7 @@[m [mend[m
2026-02-09T19:17:20.6388480Z          coords, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6388932Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.6389031Z  [m
2026-02-09T19:17:20.6389172Z [31m-        @test t ≈ 0.05 atol = 1e-10[m
2026-02-09T19:17:20.6389331Z [32m+[m[32m        @test t ≈ 0.05 atol = 1.0e-10[m
2026-02-09T19:17:20.6389412Z  [m
2026-02-09T19:17:20.6389523Z          imid, jmid = 2, 2[m
2026-02-09T19:17:20.6389752Z          # Front (low z) has higher density than back (high z)[m
2026-02-09T19:17:20.6389869Z [36m@@ -254,7 +254,7 @@[m [mend[m
2026-02-09T19:17:20.6389987Z          # Uniform in x and y[m
2026-02-09T19:17:20.6390093Z          for iz in 1:nz[m
2026-02-09T19:17:20.6390227Z              for ix in 2:nx, iy in 1:ny[m
2026-02-09T19:17:20.6390450Z [31m-                @test W[ix, iy, iz][1] ≈ W[1, 1, iz][1] atol = 1e-10[m
2026-02-09T19:17:20.6390688Z [32m+[m[32m                @test W[ix, iy, iz][1] ≈ W[1, 1, iz][1] atol = 1.0e-10[m
2026-02-09T19:17:20.6390777Z              end[m
2026-02-09T19:17:20.6390876Z          end[m
2026-02-09T19:17:20.6390947Z  [m
2026-02-09T19:17:20.6391058Z [36m@@ -314,11 +314,11 @@[m [mend[m
2026-02-09T19:17:20.6391346Z      mom_zf = sum(U_final[ix, iy, iz][4] for ix in 1:N, iy in 1:N, iz in 1:N) * vol[m
2026-02-09T19:17:20.6391648Z      energy_f = sum(U_final[ix, iy, iz][5] for ix in 1:N, iy in 1:N, iz in 1:N) * vol[m
2026-02-09T19:17:20.6391720Z  [m
2026-02-09T19:17:20.6391879Z [31m-    @test mass_f ≈ mass0 rtol = 1e-10[m
2026-02-09T19:17:20.6392043Z [31m-    @test mom_xf ≈ mom_x0 rtol = 1e-10[m
2026-02-09T19:17:20.6392189Z [31m-    @test mom_yf ≈ mom_y0 rtol = 1e-10[m
2026-02-09T19:17:20.6392334Z [31m-    @test mom_zf ≈ mom_z0 rtol = 1e-10[m
2026-02-09T19:17:20.6392503Z [31m-    @test energy_f ≈ energy0 rtol = 1e-10[m
2026-02-09T19:17:20.6392689Z [32m+[m[32m    @test mass_f ≈ mass0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6392869Z [32m+[m[32m    @test mom_xf ≈ mom_x0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6393039Z [32m+[m[32m    @test mom_yf ≈ mom_y0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6393221Z [32m+[m[32m    @test mom_zf ≈ mom_z0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6393413Z [32m+[m[32m    @test energy_f ≈ energy0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6393493Z  end[m
2026-02-09T19:17:20.6393572Z  [m
2026-02-09T19:17:20.6393721Z  # ============================================================[m
2026-02-09T19:17:20.6393832Z [36m@@ -334,7 +334,7 @@[m [mend[m
2026-02-09T19:17:20.6393995Z      dx, dy, dz = mesh.dx, mesh.dy, mesh.dz[m
2026-02-09T19:17:20.6394101Z      vol = dx * dy * dz[m
2026-02-09T19:17:20.6394175Z  [m
2026-02-09T19:17:20.6394277Z [31m-    P_bg = 1e-5[m
2026-02-09T19:17:20.6394397Z [32m+[m[32m    P_bg = 1.0e-5[m
2026-02-09T19:17:20.6394497Z      P_blast = 1.0[m
2026-02-09T19:17:20.6394635Z      r_blast = 3.0 * dx  # a few cells[m
2026-02-09T19:17:20.6394714Z  [m
2026-02-09T19:17:20.6394819Z [36m@@ -392,6 +392,6 @@[m [mend[m
2026-02-09T19:17:20.6395124Z          energy0 = sum(U0[ix + 2, iy + 2, iz + 2][5] for ix in 1:N, iy in 1:N, iz in 1:N) * vol[m
2026-02-09T19:17:20.6395395Z          energy_f = sum(U[ix, iy, iz][5] for ix in 1:N, iy in 1:N, iz in 1:N) * vol[m
2026-02-09T19:17:20.6395475Z  [m
2026-02-09T19:17:20.6395644Z [31m-        @test energy_f ≈ energy0 rtol = 1e-8[m
2026-02-09T19:17:20.6395843Z [32m+[m[32m        @test energy_f ≈ energy0 rtol = 1.0e-8[m
2026-02-09T19:17:20.6395931Z      end[m
2026-02-09T19:17:20.6396008Z  end[m
2026-02-09T19:17:20.6474477Z [34m[138/151] Checking `test/imex.jl` ............................................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.6489675Z [1mdiff --git a/imex.jl b/imex.jl[m
2026-02-09T19:17:20.6490199Z [1mindex 4fd210d..0d6f69b 100644[m
2026-02-09T19:17:20.6490391Z [1m--- a/imex.jl[m
2026-02-09T19:17:20.6490796Z [1m+++ b/imex.jl[m
2026-02-09T19:17:20.6491354Z [36m@@ -57,21 +57,21 @@[m [musing FiniteVolumeMethod, Test, StaticArrays, LinearAlgebra[m
2026-02-09T19:17:20.6491584Z              @test has_implicit_stage[m
2026-02-09T19:17:20.6491879Z  [m
2026-02-09T19:17:20.6492110Z              # b_ex sums to 1 (consistency)[m
2026-02-09T19:17:20.6492311Z [31m-            @test sum(tab.b_ex) ≈ 1.0 atol = 1e-14[m
2026-02-09T19:17:20.6492528Z [32m+[m[32m            @test sum(tab.b_ex) ≈ 1.0 atol = 1.0e-14[m
2026-02-09T19:17:20.6492610Z  [m
2026-02-09T19:17:20.6492763Z              # b_im sums to 1 (consistency)[m
2026-02-09T19:17:20.6492944Z [31m-            @test sum(tab.b_im) ≈ 1.0 atol = 1e-14[m
2026-02-09T19:17:20.6493151Z [32m+[m[32m            @test sum(tab.b_im) ≈ 1.0 atol = 1.0e-14[m
2026-02-09T19:17:20.6493231Z  [m
2026-02-09T19:17:20.6493427Z              # c_ex = A_ex * ones (row sums match abscissae)[m
2026-02-09T19:17:20.6493538Z              for k in 1:s[m
2026-02-09T19:17:20.6493739Z                  row_sum = sum(tab.A_ex[k][j] for j in 1:s)[m
2026-02-09T19:17:20.6493936Z [31m-                @test row_sum ≈ tab.c_ex[k] atol = 1e-14[m
2026-02-09T19:17:20.6494159Z [32m+[m[32m                @test row_sum ≈ tab.c_ex[k] atol = 1.0e-14[m
2026-02-09T19:17:20.6494257Z              end[m
2026-02-09T19:17:20.6494337Z  [m
2026-02-09T19:17:20.6494645Z              # c_im = A_im * ones (row sums match abscissae)[m
2026-02-09T19:17:20.6494801Z              for k in 1:s[m
2026-02-09T19:17:20.6495001Z                  row_sum = sum(tab.A_im[k][j] for j in 1:s)[m
2026-02-09T19:17:20.6495199Z [31m-                @test row_sum ≈ tab.c_im[k] atol = 1e-14[m
2026-02-09T19:17:20.6495416Z [32m+[m[32m                @test row_sum ≈ tab.c_im[k] atol = 1.0e-14[m
2026-02-09T19:17:20.6495509Z              end[m
2026-02-09T19:17:20.6495594Z          end[m
2026-02-09T19:17:20.6495675Z      end[m
2026-02-09T19:17:20.6495791Z [36m@@ -142,13 +142,15 @@[m [mend[m
2026-02-09T19:17:20.6495953Z      W_ref = to_primitive(law, U_ref)[m
2026-02-09T19:17:20.6496027Z  [m
2026-02-09T19:17:20.6496287Z      # IMEX solve with NullSource (should behave like explicit)[m
2026-02-09T19:17:20.6496590Z [31m-    x_imex, U_imex, t_imex = solve_hyperbolic_imex(prob, NullSource();[m
2026-02-09T19:17:20.6496747Z [31m-        scheme = IMEX_Midpoint())[m
2026-02-09T19:17:20.6496975Z [32m+[m[32m    x_imex, U_imex, t_imex = solve_hyperbolic_imex([m
2026-02-09T19:17:20.6497118Z [32m+[m[32m        prob, NullSource();[m
2026-02-09T19:17:20.6497287Z [32m+[m[32m        scheme = IMEX_Midpoint()[m
2026-02-09T19:17:20.6497381Z [32m+[m[32m    )[m
2026-02-09T19:17:20.6497529Z      W_imex = to_primitive(law, U_imex)[m
2026-02-09T19:17:20.6497632Z  [m
2026-02-09T19:17:20.6497779Z      # Both should reach the final time[m
2026-02-09T19:17:20.6497949Z [31m-    @test t_ref ≈ t_final atol = 1e-10[m
2026-02-09T19:17:20.6498116Z [31m-    @test t_imex ≈ t_final atol = 1e-10[m
2026-02-09T19:17:20.6498308Z [32m+[m[32m    @test t_ref ≈ t_final atol = 1.0e-10[m
2026-02-09T19:17:20.6498491Z [32m+[m[32m    @test t_imex ≈ t_final atol = 1.0e-10[m
2026-02-09T19:17:20.6498570Z  [m
2026-02-09T19:17:20.6499039Z      # The solutions should be close (not identical due to different time[m
2026-02-09T19:17:20.6499285Z      # stepping structure, but the physics should match)[m
2026-02-09T19:17:20.6499408Z [36m@@ -215,8 +217,10 @@[m [mend[m
2026-02-09T19:17:20.6499538Z          final_time = 0.05, cfl = 0.4[m
2026-02-09T19:17:20.6499618Z      )[m
2026-02-09T19:17:20.6499691Z  [m
2026-02-09T19:17:20.6499957Z [31m-    x, U_final, t_final = solve_hyperbolic_imex(prob, source;[m
2026-02-09T19:17:20.6500233Z [31m-        scheme = IMEX_ARS222(), newton_tol = 1e-12, newton_maxiter = 10)[m
2026-02-09T19:17:20.6500451Z [32m+[m[32m    x, U_final, t_final = solve_hyperbolic_imex([m
2026-02-09T19:17:20.6500582Z [32m+[m[32m        prob, source;[m
2026-02-09T19:17:20.6500876Z [32m+[m[32m        scheme = IMEX_ARS222(), newton_tol = 1.0e-12, newton_maxiter = 10[m
2026-02-09T19:17:20.6501128Z [32m+[m[32m    )[m
2026-02-09T19:17:20.6501285Z      W_final = to_primitive(law, U_final)[m
2026-02-09T19:17:20.6501366Z  [m
2026-02-09T19:17:20.6501780Z      # After evolution, pressure should have relaxed toward P_target[m
2026-02-09T19:17:20.6501894Z [36m@@ -278,17 +282,19 @@[m [mend[m
2026-02-09T19:17:20.6502102Z      energy0 = sum(U0[i][3] for i in 3:(N_cells + 2)) * dx[m
2026-02-09T19:17:20.6502175Z  [m
2026-02-09T19:17:20.6502446Z      # Solve with IMEX + NullSource (purely explicit, conservative)[m
2026-02-09T19:17:20.6502725Z [31m-    x, U_final, t_final = solve_hyperbolic_imex(prob, NullSource();[m
2026-02-09T19:17:20.6502863Z [31m-        scheme = IMEX_SSP3_433())[m
2026-02-09T19:17:20.6503079Z [32m+[m[32m    x, U_final, t_final = solve_hyperbolic_imex([m
2026-02-09T19:17:20.6503227Z [32m+[m[32m        prob, NullSource();[m
2026-02-09T19:17:20.6503387Z [32m+[m[32m        scheme = IMEX_SSP3_433()[m
2026-02-09T19:17:20.6503486Z [32m+[m[32m    )[m
2026-02-09T19:17:20.6503558Z  [m
2026-02-09T19:17:20.6503780Z      mass_final = sum(U_final[i][1] for i in 1:N_cells) * dx[m
2026-02-09T19:17:20.6504018Z      momentum_final = sum(U_final[i][2] for i in 1:N_cells) * dx[m
2026-02-09T19:17:20.6504244Z      energy_final = sum(U_final[i][3] for i in 1:N_cells) * dx[m
2026-02-09T19:17:20.6504323Z  [m
2026-02-09T19:17:20.6504623Z      # Conservation should hold (NullSource adds no energy/mass/momentum)[m
2026-02-09T19:17:20.6504795Z [31m-    @test mass_final ≈ mass0 rtol = 1e-10[m
2026-02-09T19:17:20.6504997Z [31m-    @test momentum_final ≈ momentum0 rtol = 1e-10[m
2026-02-09T19:17:20.6505184Z [31m-    @test energy_final ≈ energy0 rtol = 1e-10[m
2026-02-09T19:17:20.6505377Z [32m+[m[32m    @test mass_final ≈ mass0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6505605Z [32m+[m[32m    @test momentum_final ≈ momentum0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6505817Z [32m+[m[32m    @test energy_final ≈ energy0 rtol = 1.0e-10[m
2026-02-09T19:17:20.6505907Z  end[m
2026-02-09T19:17:20.6505978Z  [m
2026-02-09T19:17:20.6506123Z  # ============================================================[m
2026-02-09T19:17:20.6506243Z [36m@@ -313,11 +319,13 @@[m [mend[m
2026-02-09T19:17:20.6506388Z          ic; final_time = 0.01, cfl = 0.3[m
2026-02-09T19:17:20.6506468Z      )[m
2026-02-09T19:17:20.6506547Z  [m
2026-02-09T19:17:20.6506846Z [31m-    coords, U_final, t_final = solve_hyperbolic_imex(prob, NullSource();[m
2026-02-09T19:17:20.6506993Z [31m-        scheme = IMEX_Midpoint())[m
2026-02-09T19:17:20.6507228Z [32m+[m[32m    coords, U_final, t_final = solve_hyperbolic_imex([m
2026-02-09T19:17:20.6507375Z [32m+[m[32m        prob, NullSource();[m
2026-02-09T19:17:20.6507529Z [32m+[m[32m        scheme = IMEX_Midpoint()[m
2026-02-09T19:17:20.6507623Z [32m+[m[32m    )[m
2026-02-09T19:17:20.6507702Z  [m
2026-02-09T19:17:20.6507831Z      # Should reach final time[m
2026-02-09T19:17:20.6507984Z [31m-    @test t_final ≈ 0.01 atol = 1e-10[m
2026-02-09T19:17:20.6508159Z [32m+[m[32m    @test t_final ≈ 0.01 atol = 1.0e-10[m
2026-02-09T19:17:20.6508233Z  [m
2026-02-09T19:17:20.6508409Z      # Solution should have correct dimensions[m
2026-02-09T19:17:20.6508546Z      @test size(U_final) == (nx, ny)[m
2026-02-09T19:17:20.6508661Z [36m@@ -363,15 +371,15 @@[m [mend[m
2026-02-09T19:17:20.6508876Z      )[m
2026-02-09T19:17:20.6508953Z  [m
2026-02-09T19:17:20.6509077Z      for (name, scheme) in [[m
2026-02-09T19:17:20.6509221Z [31m-        ("SSP3_433", IMEX_SSP3_433()),[m
2026-02-09T19:17:20.6509354Z [31m-        ("ARS222", IMEX_ARS222()),[m
2026-02-09T19:17:20.6509510Z [31m-        ("Midpoint", IMEX_Midpoint()),[m
2026-02-09T19:17:20.6509605Z [31m-    ][m
2026-02-09T19:17:20.6509775Z [32m+[m[32m            ("SSP3_433", IMEX_SSP3_433()),[m
2026-02-09T19:17:20.6509937Z [32m+[m[32m            ("ARS222", IMEX_ARS222()),[m
2026-02-09T19:17:20.6510123Z [32m+[m[32m            ("Midpoint", IMEX_Midpoint()),[m
2026-02-09T19:17:20.6510348Z [32m+[m[32m        ][m
2026-02-09T19:17:20.6510474Z          @testset "$name" begin[m
2026-02-09T19:17:20.6510766Z              x, U, t = solve_hyperbolic_imex(prob, NullSource(); scheme = scheme)[m
2026-02-09T19:17:20.6511009Z              W = to_primitive(law, U)[m
2026-02-09T19:17:20.6511083Z  [m
2026-02-09T19:17:20.6511224Z [31m-            @test t ≈ 0.05 atol = 1e-10[m
2026-02-09T19:17:20.6511400Z [32m+[m[32m            @test t ≈ 0.05 atol = 1.0e-10[m
2026-02-09T19:17:20.6511473Z  [m
2026-02-09T19:17:20.6511598Z              # Physical results[m
2026-02-09T19:17:20.6511712Z              for i in 1:N_cells[m
2026-02-09T19:17:20.6699742Z [34m[139/151] Checking `test/mhd.jl` ............................................. [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.6719005Z [1mdiff --git a/mhd.jl b/mhd.jl[m
2026-02-09T19:17:20.6719608Z [1mindex b2758cf..779aafc 100644[m
2026-02-09T19:17:20.6720081Z [1m--- a/mhd.jl[m
2026-02-09T19:17:20.6720440Z [1m+++ b/mhd.jl[m
2026-02-09T19:17:20.6720703Z [36m@@ -40,7 +40,7 @@[m [mend[m
2026-02-09T19:17:20.6721092Z          for w in states[m
2026-02-09T19:17:20.6721654Z              u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.6722352Z              w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.6723000Z [31m-            @test w2 ≈ w atol = 1e-14[m
2026-02-09T19:17:20.6723643Z [32m+[m[32m            @test w2 ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.6724178Z          end[m
2026-02-09T19:17:20.6724529Z      end[m
2026-02-09T19:17:20.6724845Z  [m
2026-02-09T19:17:20.6725249Z [36m@@ -170,10 +170,10 @@[m [mend[m
2026-02-09T19:17:20.6725918Z          w_hydro = SVector(1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0)[m
2026-02-09T19:17:20.6726682Z          cf = fast_magnetosonic_speed(law, w_hydro, 1)[m
2026-02-09T19:17:20.6727418Z          cs_hydro = sqrt(eos.gamma * 1.0 / 1.0)  # √(γP/ρ)[m
2026-02-09T19:17:20.6728090Z [31m-        @test cf ≈ cs_hydro atol = 1e-14[m
2026-02-09T19:17:20.6729000Z [32m+[m[32m        @test cf ≈ cs_hydro atol = 1.0e-14[m
2026-02-09T19:17:20.6729557Z  [m
2026-02-09T19:17:20.6730049Z          cs = slow_magnetosonic_speed(law, w_hydro, 1)[m
2026-02-09T19:17:20.6730722Z [31m-        @test cs ≈ 0.0 atol = 1e-14[m
2026-02-09T19:17:20.6731340Z [32m+[m[32m        @test cs ≈ 0.0 atol = 1.0e-14[m
2026-02-09T19:17:20.6731859Z      end[m
2026-02-09T19:17:20.6732181Z  [m
2026-02-09T19:17:20.6732635Z      @testset "Perpendicular B only (Bn=0)" begin[m
2026-02-09T19:17:20.6733246Z [36m@@ -184,8 +184,8 @@[m [mend[m
2026-02-09T19:17:20.6733673Z  [m
2026-02-09T19:17:20.6734063Z          a_sq = eos.gamma * 1.0 / 1.0[m
2026-02-09T19:17:20.6734584Z          b_sq = 1.0 / 1.0  # By² / ρ[m
2026-02-09T19:17:20.6735210Z [31m-        @test cf ≈ sqrt(a_sq + b_sq) atol = 1e-14[m
2026-02-09T19:17:20.6735843Z [31m-        @test cs ≈ 0.0 atol = 1e-14[m
2026-02-09T19:17:20.6736515Z [32m+[m[32m        @test cf ≈ sqrt(a_sq + b_sq) atol = 1.0e-14[m
2026-02-09T19:17:20.6737252Z [32m+[m[32m        @test cs ≈ 0.0 atol = 1.0e-14[m
2026-02-09T19:17:20.6737757Z      end[m
2026-02-09T19:17:20.6738079Z  [m
2026-02-09T19:17:20.6738558Z      @testset "wave_speeds and max_wave_speed" begin[m
2026-02-09T19:17:20.6739351Z [36m@@ -236,7 +236,7 @@[m [mend[m
2026-02-09T19:17:20.6739833Z          for w in states[m
2026-02-09T19:17:20.6740372Z              F_exact = physical_flux(law, w, 1)[m
2026-02-09T19:17:20.6741046Z              F_hlld = solve_riemann(hlld, law, w, w, 1)[m
2026-02-09T19:17:20.6741735Z [31m-            @test F_hlld ≈ F_exact atol = 1e-12[m
2026-02-09T19:17:20.6742447Z [32m+[m[32m            @test F_hlld ≈ F_exact atol = 1.0e-12[m
2026-02-09T19:17:20.6743017Z          end[m
2026-02-09T19:17:20.6743372Z      end[m
2026-02-09T19:17:20.6743683Z  [m
2026-02-09T19:17:20.6744052Z [36m@@ -269,7 +269,7 @@[m [mend[m
2026-02-09T19:17:20.6744561Z          @test all(isfinite.(F_lf))[m
2026-02-09T19:17:20.6745277Z  [m
2026-02-09T19:17:20.6745797Z          # Mass flux should have the same sign for all three[m
2026-02-09T19:17:20.6746468Z [31m-        if abs(F_hlld[1]) > 1e-10[m
2026-02-09T19:17:20.6747077Z [32m+[m[32m        if abs(F_hlld[1]) > 1.0e-10[m
2026-02-09T19:17:20.6747936Z              @test sign(F_hlld[1]) == sign(F_hll[1])[m
2026-02-09T19:17:20.6748465Z          end[m
2026-02-09T19:17:20.6748973Z      end[m
2026-02-09T19:17:20.6749374Z [36m@@ -283,7 +283,7 @@[m [mend[m
2026-02-09T19:17:20.6749797Z  [m
2026-02-09T19:17:20.6750225Z          # Just check it's finite and reasonable[m
2026-02-09T19:17:20.6750808Z          @test all(isfinite.(F_hlld))[m
2026-02-09T19:17:20.6751459Z [31m-        @test F_hlld[6] ≈ 0.0 atol = 1e-14  # No Bx flux[m
2026-02-09T19:17:20.6752236Z [32m+[m[32m        @test F_hlld[6] ≈ 0.0 atol = 1.0e-14  # No Bx flux[m
2026-02-09T19:17:20.6752829Z      end[m
2026-02-09T19:17:20.6753129Z  [m
2026-02-09T19:17:20.6753614Z      @testset "Degenerate: Bn=0 (no Alfvén waves)" begin[m
2026-02-09T19:17:20.6754240Z [36m@@ -323,7 +323,7 @@[m [mend[m
2026-02-09T19:17:20.6754783Z          x, U, t_final = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6755363Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.6755804Z  [m
2026-02-09T19:17:20.6756220Z [31m-        @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.6756854Z [32m+[m[32m        @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.6757468Z          @test length(x) == 800[m
2026-02-09T19:17:20.6757984Z          @test length(W) == 800[m
2026-02-09T19:17:20.6758408Z  [m
2026-02-09T19:17:20.6758944Z [36m@@ -339,7 +339,7 @@[m [mend[m
2026-02-09T19:17:20.6759382Z  [m
2026-02-09T19:17:20.6760034Z          # Bx should remain constant throughout (trivially satisfied in 1D)[m
2026-02-09T19:17:20.6760815Z          Bx_sol = [w[6] for w in W][m
2026-02-09T19:17:20.6761457Z [31m-        @test all(b -> abs(b - Bx) < 1e-10, Bx_sol)[m
2026-02-09T19:17:20.6762207Z [32m+[m[32m        @test all(b -> abs(b - Bx) < 1.0e-10, Bx_sol)[m
2026-02-09T19:17:20.6762872Z  [m
2026-02-09T19:17:20.6763480Z          # Check that the solution has structure (not all the same value)[m
2026-02-09T19:17:20.6764247Z          @test maximum(ρ) > minimum(ρ) + 0.01[m
2026-02-09T19:17:20.6764820Z [36m@@ -368,7 +368,7 @@[m [mend[m
2026-02-09T19:17:20.6765309Z          ρ = [w[1] for w in W][m
2026-02-09T19:17:20.6765789Z          P = [w[5] for w in W][m
2026-02-09T19:17:20.6766197Z  [m
2026-02-09T19:17:20.6766624Z [31m-        @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.6767279Z [32m+[m[32m        @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.6767871Z          @test all(ρ .> 0)[m
2026-02-09T19:17:20.6768333Z          @test all(P .> 0)[m
2026-02-09T19:17:20.6769017Z          @test all(isfinite.(ρ))[m
2026-02-09T19:17:20.6769548Z [36m@@ -423,7 +423,7 @@[m [mend[m
2026-02-09T19:17:20.6770031Z          ρ = [w[1] for w in W][m
2026-02-09T19:17:20.6770508Z          P = [w[5] for w in W][m
2026-02-09T19:17:20.6771159Z  [m
2026-02-09T19:17:20.6771595Z [31m-        @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.6772256Z [32m+[m[32m        @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.6772845Z          @test all(ρ .> 0)[m
2026-02-09T19:17:20.6773490Z          @test all(P .> 0)[m
2026-02-09T19:17:20.6773907Z      end[m
2026-02-09T19:17:20.6774303Z [36m@@ -479,10 +479,10 @@[m [mend[m
2026-02-09T19:17:20.6774857Z          energy_0 = sum(u[5] for u in U0) * dx[m
2026-02-09T19:17:20.6775509Z          energy_f = sum(u[5] for u in U_final) * dx[m
2026-02-09T19:17:20.6776019Z  [m
2026-02-09T19:17:20.6776452Z [31m-        @test mass_f ≈ mass_0 atol = 1e-10[m
2026-02-09T19:17:20.6777084Z [31m-        @test mom_x_f ≈ mom_x_0 atol = 1e-10[m
2026-02-09T19:17:20.6777724Z [31m-        @test mom_y_f ≈ mom_y_0 atol = 1e-10[m
2026-02-09T19:17:20.6778375Z [31m-        @test energy_f ≈ energy_0 atol = 1e-10[m
2026-02-09T19:17:20.6779255Z [32m+[m[32m        @test mass_f ≈ mass_0 atol = 1.0e-10[m
2026-02-09T19:17:20.6779994Z [32m+[m[32m        @test mom_x_f ≈ mom_x_0 atol = 1.0e-10[m
2026-02-09T19:17:20.6780706Z [32m+[m[32m        @test mom_y_f ≈ mom_y_0 atol = 1.0e-10[m
2026-02-09T19:17:20.6781442Z [32m+[m[32m        @test energy_f ≈ energy_0 atol = 1.0e-10[m
2026-02-09T19:17:20.6782028Z      end[m
2026-02-09T19:17:20.6782357Z  end[m
2026-02-09T19:17:20.6782654Z  [m
2026-02-09T19:17:20.6783023Z [36m@@ -522,7 +522,7 @@[m [mend[m
2026-02-09T19:17:20.6783514Z              ρ = [w[1] for w in W][m
2026-02-09T19:17:20.6784017Z              P = [w[5] for w in W][m
2026-02-09T19:17:20.6784441Z  [m
2026-02-09T19:17:20.6784882Z [31m-            @test t_final ≈ 0.05 atol = 1e-10[m
2026-02-09T19:17:20.6785560Z [32m+[m[32m            @test t_final ≈ 0.05 atol = 1.0e-10[m
2026-02-09T19:17:20.6786155Z              @test all(ρ .> 0)[m
2026-02-09T19:17:20.6786635Z              @test all(P .> 0)[m
2026-02-09T19:17:20.6787126Z              @test all(isfinite.(ρ))[m
2026-02-09T19:17:20.6787663Z [36m@@ -678,7 +678,7 @@[m [mend[m
2026-02-09T19:17:20.6788135Z      ρ = [w[1] for w in W][m
2026-02-09T19:17:20.6788598Z      P = [w[5] for w in W][m
2026-02-09T19:17:20.6789156Z  [m
2026-02-09T19:17:20.6789575Z [31m-    @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.6790217Z [32m+[m[32m    @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.6790912Z      @test all(ρ .> 0)    # Density should stay positive[m
2026-02-09T19:17:20.6791679Z      @test all(P .> 0)    # Pressure should stay positive[m
2026-02-09T19:17:20.6792302Z      @test all(isfinite.(ρ))[m
2026-02-09T19:17:20.6792792Z [36m@@ -758,7 +758,7 @@[m [mend[m
2026-02-09T19:17:20.6793266Z      ρ = [w[1] for w in W][m
2026-02-09T19:17:20.6793726Z      P = [w[5] for w in W][m
2026-02-09T19:17:20.6794120Z  [m
2026-02-09T19:17:20.6794541Z [31m-    @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.6795169Z [32m+[m[32m    @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.6795743Z      @test all(ρ .> 0)[m
2026-02-09T19:17:20.6796177Z      @test all(P .> 0)[m
2026-02-09T19:17:20.6796559Z  end[m
2026-02-09T19:17:20.6936040Z [34m[140/151] Checking `test/mhd_2d.jl` .......................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.6952606Z [1mdiff --git a/mhd_2d.jl b/mhd_2d.jl[m
2026-02-09T19:17:20.6953267Z [1mindex b84b863..f33ed16 100644[m
2026-02-09T19:17:20.6953735Z [1m--- a/mhd_2d.jl[m
2026-02-09T19:17:20.6954103Z [1m+++ b/mhd_2d.jl[m
2026-02-09T19:17:20.6954437Z [36m@@ -25,9 +25,9 @@[m [musing StaticArrays[m
2026-02-09T19:17:20.6954752Z  [m
2026-02-09T19:17:20.6955280Z          u_ref = primitive_to_conserved(law, w_const)[m
2026-02-09T19:17:20.6955927Z          for iy in 1:20, ix in 1:20[m
2026-02-09T19:17:20.6956597Z [31m-            @test U_final[ix, iy] ≈ u_ref atol = 1e-12[m
2026-02-09T19:17:20.6957403Z [32m+[m[32m            @test U_final[ix, iy] ≈ u_ref atol = 1.0e-12[m
2026-02-09T19:17:20.6958021Z          end[m
2026-02-09T19:17:20.6959051Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1e-13[m
2026-02-09T19:17:20.6959955Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1.0e-13[m
2026-02-09T19:17:20.6960662Z      end[m
2026-02-09T19:17:20.6973129Z  [m
2026-02-09T19:17:20.6973613Z      @testset "Return value structure" begin[m
2026-02-09T19:17:20.6974282Z [36m@@ -45,7 +45,7 @@[m [musing StaticArrays[m
2026-02-09T19:17:20.6974870Z          coords, U, t, ct = result[m
2026-02-09T19:17:20.6975400Z          @test size(U) == (10, 10)[m
2026-02-09T19:17:20.6975990Z          @test size(coords) == (10, 10)[m
2026-02-09T19:17:20.6976583Z [31m-        @test t ≈ 0.01 atol = 1e-10[m
2026-02-09T19:17:20.6977199Z [32m+[m[32m        @test t ≈ 0.01 atol = 1.0e-10[m
2026-02-09T19:17:20.6977772Z          @test ct isa CTData2D[m
2026-02-09T19:17:20.6978222Z      end[m
2026-02-09T19:17:20.6978541Z  end[m
2026-02-09T19:17:20.6979133Z [36m@@ -68,7 +68,7 @@[m [mend[m
2026-02-09T19:17:20.6979582Z          )[m
2026-02-09T19:17:20.6979909Z  [m
2026-02-09T19:17:20.6980331Z          _, _, _, ct = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6981042Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 30, 30) < 1e-12[m
2026-02-09T19:17:20.6981882Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 30, 30) < 1.0e-12[m
2026-02-09T19:17:20.6982491Z      end[m
2026-02-09T19:17:20.6982791Z  [m
2026-02-09T19:17:20.6983309Z      @testset "Non-uniform field: ∇·B = 0 maintained" begin[m
2026-02-09T19:17:20.6983938Z [36m@@ -95,7 +95,7 @@[m [mend[m
2026-02-09T19:17:20.6984340Z  [m
2026-02-09T19:17:20.6984748Z          _, _, _, ct = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.6985403Z          divB_max = max_divB(ct, mesh.dx, mesh.dy, 30, 30)[m
2026-02-09T19:17:20.6986031Z [31m-        @test divB_max < 1e-12[m
2026-02-09T19:17:20.6986578Z [32m+[m[32m        @test divB_max < 1.0e-12[m
2026-02-09T19:17:20.6987066Z      end[m
2026-02-09T19:17:20.6987389Z  [m
2026-02-09T19:17:20.6987828Z      @testset "Euler method: ∇·B = 0" begin[m
2026-02-09T19:17:20.6988393Z [36m@@ -109,7 +109,7 @@[m [mend[m
2026-02-09T19:17:20.6989019Z          )[m
2026-02-09T19:17:20.6989346Z  [m
2026-02-09T19:17:20.6989845Z          _, _, _, ct = solve_hyperbolic(prob; method = :euler)[m
2026-02-09T19:17:20.6990653Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1e-12[m
2026-02-09T19:17:20.6991502Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1.0e-12[m
2026-02-09T19:17:20.6992137Z      end[m
2026-02-09T19:17:20.6992454Z  end[m
2026-02-09T19:17:20.6992760Z  [m
2026-02-09T19:17:20.6993123Z [36m@@ -148,11 +148,11 @@[m [mend[m
2026-02-09T19:17:20.6993611Z          ρ = [w[1] for w in W][m
2026-02-09T19:17:20.6994096Z          P = [w[5] for w in W][m
2026-02-09T19:17:20.6994499Z  [m
2026-02-09T19:17:20.6994919Z [31m-        @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.6995570Z [32m+[m[32m        @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.6996168Z          @test all(ρ .> 0)[m
2026-02-09T19:17:20.6996617Z          @test all(P .> 0)[m
2026-02-09T19:17:20.6997103Z          @test all(isfinite.(ρ))[m
2026-02-09T19:17:20.6997769Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 50, 50) < 1e-12[m
2026-02-09T19:17:20.6998628Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 50, 50) < 1.0e-12[m
2026-02-09T19:17:20.6999408Z  [m
2026-02-09T19:17:20.6999987Z          # Orszag-Tang should develop structure (not remain uniform)[m
2026-02-09T19:17:20.7000743Z          @test maximum(ρ) > minimum(ρ) + 0.1[m
2026-02-09T19:17:20.7001284Z [36m@@ -172,10 +172,10 @@[m [mend[m
2026-02-09T19:17:20.7001773Z          ρ = [w[1] for w in W][m
2026-02-09T19:17:20.7002236Z          P = [w[5] for w in W][m
2026-02-09T19:17:20.7002645Z  [m
2026-02-09T19:17:20.7003065Z [31m-        @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.7003722Z [32m+[m[32m        @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.7004303Z          @test all(ρ .> 0)[m
2026-02-09T19:17:20.7005010Z          @test all(P .> 0)[m
2026-02-09T19:17:20.7005642Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 40, 40) < 1e-12[m
2026-02-09T19:17:20.7006483Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 40, 40) < 1.0e-12[m
2026-02-09T19:17:20.7007321Z      end[m
2026-02-09T19:17:20.7007635Z  [m
2026-02-09T19:17:20.7008078Z      @testset "HLLD vs HLL comparison" begin[m
2026-02-09T19:17:20.7008649Z [36m@@ -206,7 +206,7 @@[m [mend[m
2026-02-09T19:17:20.7009526Z          # HLLD should give a different (generally sharper) solution[m
2026-02-09T19:17:20.7010267Z          ρ_hlld = [w[1] for w in W_hlld][m
2026-02-09T19:17:20.7010833Z          ρ_hll = [w[1] for w in W_hll][m
2026-02-09T19:17:20.7011477Z [31m-        @test maximum(abs.(ρ_hlld .- ρ_hll)) > 1e-6[m
2026-02-09T19:17:20.7012234Z [32m+[m[32m        @test maximum(abs.(ρ_hlld .- ρ_hll)) > 1.0e-6[m
2026-02-09T19:17:20.7012839Z      end[m
2026-02-09T19:17:20.7013158Z  end[m
2026-02-09T19:17:20.7013484Z  [m
2026-02-09T19:17:20.7013841Z [36m@@ -224,7 +224,7 @@[m [mend[m
2026-02-09T19:17:20.7014303Z      ρ_bg = 1.0[m
2026-02-09T19:17:20.7014679Z      P_bg = 1.0[m
2026-02-09T19:17:20.7015088Z      R0 = 0.3  # loop radius[m
2026-02-09T19:17:20.7015727Z [31m-    A0 = 1e-3  # amplitude (weak field → linear regime)[m
2026-02-09T19:17:20.7016546Z [32m+[m[32m    A0 = 1.0e-3  # amplitude (weak field → linear regime)[m
2026-02-09T19:17:20.7017153Z  [m
2026-02-09T19:17:20.7017521Z      function loop_ic(x, y)[m
2026-02-09T19:17:20.7018007Z          # Center at (0.5, 0.5)[m
2026-02-09T19:17:20.7018501Z [36m@@ -258,8 +258,8 @@[m [mend[m
2026-02-09T19:17:20.7019145Z          )[m
2026-02-09T19:17:20.7019466Z  [m
2026-02-09T19:17:20.7020091Z          _, _, t_final, ct = solve_hyperbolic(prob; vector_potential = Az_loop)[m
2026-02-09T19:17:20.7020898Z [31m-        @test t_final ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.7021608Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 50, 50) < 1e-12[m
2026-02-09T19:17:20.7022371Z [32m+[m[32m        @test t_final ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.7023148Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 50, 50) < 1.0e-12[m
2026-02-09T19:17:20.7023783Z      end[m
2026-02-09T19:17:20.7024103Z  [m
2026-02-09T19:17:20.7024633Z      @testset "Density and pressure remain positive" begin[m
2026-02-09T19:17:20.7025276Z [36m@@ -352,10 +352,10 @@[m [mend[m
2026-02-09T19:17:20.7025831Z          energy_0 = sum(u[5] for u in U0) * dA[m
2026-02-09T19:17:20.7026477Z          energy_f = sum(u[5] for u in U_final) * dA[m
2026-02-09T19:17:20.7026981Z  [m
2026-02-09T19:17:20.7027416Z [31m-        @test mass_f ≈ mass_0 atol = 1e-10[m
2026-02-09T19:17:20.7028041Z [31m-        @test momx_f ≈ momx_0 atol = 1e-10[m
2026-02-09T19:17:20.7028663Z [31m-        @test momy_f ≈ momy_0 atol = 1e-10[m
2026-02-09T19:17:20.7029747Z [31m-        @test energy_f ≈ energy_0 atol = 1e-8  # Energy may have slightly larger error[m
2026-02-09T19:17:20.7030719Z [32m+[m[32m        @test mass_f ≈ mass_0 atol = 1.0e-10[m
2026-02-09T19:17:20.7031423Z [32m+[m[32m        @test momx_f ≈ momx_0 atol = 1.0e-10[m
2026-02-09T19:17:20.7032129Z [32m+[m[32m        @test momy_f ≈ momy_0 atol = 1.0e-10[m
2026-02-09T19:17:20.7033134Z [32m+[m[32m        @test energy_f ≈ energy_0 atol = 1.0e-8  # Energy may have slightly larger error[m
2026-02-09T19:17:20.7033934Z      end[m
2026-02-09T19:17:20.7034264Z  end[m
2026-02-09T19:17:20.7034564Z  [m
2026-02-09T19:17:20.7034931Z [36m@@ -380,7 +380,7 @@[m [mend[m
2026-02-09T19:17:20.7035435Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.7035966Z          @test all(w -> w[1] > 0, W)[m
2026-02-09T19:17:20.7036484Z          @test all(w -> w[5] > 0, W)[m
2026-02-09T19:17:20.7037148Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1e-12[m
2026-02-09T19:17:20.7037992Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1.0e-12[m
2026-02-09T19:17:20.7038617Z      end[m
2026-02-09T19:17:20.7039354Z  [m
2026-02-09T19:17:20.7039754Z      @testset "ReflectiveBC" begin[m
2026-02-09T19:17:20.7040291Z [36m@@ -401,7 +401,7 @@[m [mend[m
2026-02-09T19:17:20.7040809Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.7041597Z          @test all(w -> w[1] > 0, W)[m
2026-02-09T19:17:20.7042116Z          @test all(w -> w[5] > 0, W)[m
2026-02-09T19:17:20.7042782Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1e-12[m
2026-02-09T19:17:20.7043627Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1.0e-12[m
2026-02-09T19:17:20.7044265Z      end[m
2026-02-09T19:17:20.7044570Z  [m
2026-02-09T19:17:20.7044962Z      @testset "PeriodicBC" begin[m
2026-02-09T19:17:20.7045468Z [36m@@ -422,7 +422,7 @@[m [mend[m
2026-02-09T19:17:20.7045974Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.7046492Z          @test all(w -> w[1] > 0, W)[m
2026-02-09T19:17:20.7047001Z          @test all(w -> w[5] > 0, W)[m
2026-02-09T19:17:20.7047674Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1e-12[m
2026-02-09T19:17:20.7048518Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1.0e-12[m
2026-02-09T19:17:20.7049309Z      end[m
2026-02-09T19:17:20.7049626Z  end[m
2026-02-09T19:17:20.7049932Z  [m
2026-02-09T19:17:20.7050282Z [36m@@ -461,7 +461,7 @@[m [mend[m
2026-02-09T19:17:20.7050798Z              W = to_primitive(law, U)[m
2026-02-09T19:17:20.7051333Z              @test all(w -> w[1] > 0, W)[m
2026-02-09T19:17:20.7051873Z              @test all(w -> w[5] > 0, W)[m
2026-02-09T19:17:20.7052559Z [31m-            @test max_divB(ct, mesh.dx, mesh.dy, 30, 30) < 1e-12[m
2026-02-09T19:17:20.7053417Z [32m+[m[32m            @test max_divB(ct, mesh.dx, mesh.dy, 30, 30) < 1.0e-12[m
2026-02-09T19:17:20.7054067Z          end[m
2026-02-09T19:17:20.7054401Z      end[m
2026-02-09T19:17:20.7054721Z  end[m
2026-02-09T19:17:20.7055085Z [36m@@ -495,7 +495,7 @@[m [mend[m
2026-02-09T19:17:20.7055605Z              @test all(w -> w[1] > 0, W)[m
2026-02-09T19:17:20.7056153Z              @test all(w -> w[5] > 0, W)[m
2026-02-09T19:17:20.7056730Z              @test all(w -> all(isfinite, w), W)[m
2026-02-09T19:17:20.7057454Z [31m-            @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1e-12[m
2026-02-09T19:17:20.7058319Z [32m+[m[32m            @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1.0e-12[m
2026-02-09T19:17:20.7059167Z          end[m
2026-02-09T19:17:20.7059502Z      end[m
2026-02-09T19:17:20.7059826Z  end[m
2026-02-09T19:17:20.7060192Z [36m@@ -529,7 +529,7 @@[m [mend[m
2026-02-09T19:17:20.7060737Z          # Solution should be uniform in y[m
2026-02-09T19:17:20.7061262Z          for ix in 1:200[m
2026-02-09T19:17:20.7061717Z              for iy in 2:4[m
2026-02-09T19:17:20.7062328Z [31m-                @test W[ix, iy][1] ≈ W[ix, 1][1] atol = 1e-10[m
2026-02-09T19:17:20.7063117Z [32m+[m[32m                @test W[ix, iy][1] ≈ W[ix, 1][1] atol = 1.0e-10[m
2026-02-09T19:17:20.7063734Z              end[m
2026-02-09T19:17:20.7064091Z          end[m
2026-02-09T19:17:20.7064415Z  [m
2026-02-09T19:17:20.7064773Z [36m@@ -570,7 +570,7 @@[m [mend[m
2026-02-09T19:17:20.7065290Z              W = to_primitive(law, U)[m
2026-02-09T19:17:20.7065839Z              @test all(w -> w[1] > 0, W)[m
2026-02-09T19:17:20.7066379Z              @test all(w -> w[5] > 0, W)[m
2026-02-09T19:17:20.7067055Z [31m-            @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1e-12[m
2026-02-09T19:17:20.7067926Z [32m+[m[32m            @test max_divB(ct, mesh.dx, mesh.dy, 20, 20) < 1.0e-12[m
2026-02-09T19:17:20.7068571Z          end[m
2026-02-09T19:17:20.7069073Z      end[m
2026-02-09T19:17:20.7069394Z  end[m
2026-02-09T19:17:20.7069756Z [36m@@ -621,10 +621,10 @@[m [mend[m
2026-02-09T19:17:20.7070251Z          ρ = [w[1] for w in W][m
2026-02-09T19:17:20.7070724Z          P = [w[5] for w in W][m
2026-02-09T19:17:20.7071137Z  [m
2026-02-09T19:17:20.7071533Z [31m-        @test t ≈ 0.02 atol = 1e-10[m
2026-02-09T19:17:20.7072364Z [32m+[m[32m        @test t ≈ 0.02 atol = 1.0e-10[m
2026-02-09T19:17:20.7072927Z          @test all(ρ .> 0)[m
2026-02-09T19:17:20.7073378Z          @test all(P .> 0)[m
2026-02-09T19:17:20.7074008Z [31m-        @test max_divB(ct, mesh.dx, mesh.dy, 40, 40) < 1e-12[m
2026-02-09T19:17:20.7075020Z [32m+[m[32m        @test max_divB(ct, mesh.dx, mesh.dy, 40, 40) < 1.0e-12[m
2026-02-09T19:17:20.7075650Z      end[m
2026-02-09T19:17:20.7076038Z  end[m
2026-02-09T19:17:20.7076341Z  [m
2026-02-09T19:17:20.7076702Z [36m@@ -659,8 +659,8 @@[m [mend[m
2026-02-09T19:17:20.7077240Z          # Uniform Bx, zero By → ∇·B = 0[m
2026-02-09T19:17:20.7077753Z          ct.Bx_face .= 1.0[m
2026-02-09T19:17:20.7078209Z          ct.By_face .= 0.0[m
2026-02-09T19:17:20.7079039Z [31m-        @test max_divB(ct, 0.1, 0.1, 10, 10) ≈ 0.0 atol = 1e-15[m
2026-02-09T19:17:20.7079852Z [31m-        @test l2_divB(ct, 0.1, 0.1, 10, 10) ≈ 0.0 atol = 1e-15[m
2026-02-09T19:17:20.7080693Z [32m+[m[32m        @test max_divB(ct, 0.1, 0.1, 10, 10) ≈ 0.0 atol = 1.0e-15[m
2026-02-09T19:17:20.7081579Z [32m+[m[32m        @test l2_divB(ct, 0.1, 0.1, 10, 10) ≈ 0.0 atol = 1.0e-15[m
2026-02-09T19:17:20.7082189Z  [m
2026-02-09T19:17:20.7082561Z          # Non-zero divergence[m
2026-02-09T19:17:20.7083080Z          ct.Bx_face[5, 5] = 2.0[m
2026-02-09T19:17:20.7157594Z [34m[141/151] Checking `test/mhd_3d.jl` .......................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.7174299Z [1mdiff --git a/mhd_3d.jl b/mhd_3d.jl[m
2026-02-09T19:17:20.7174926Z [1mindex a452e04..f163322 100644[m
2026-02-09T19:17:20.7175266Z [1m--- a/mhd_3d.jl[m
2026-02-09T19:17:20.7175536Z [1m+++ b/mhd_3d.jl[m
2026-02-09T19:17:20.7175799Z [36m@@ -82,8 +82,8 @@[m [mend[m
2026-02-09T19:17:20.7176165Z              # Alfven speed for this direction[m
2026-02-09T19:17:20.7176725Z              Bn = dir == 1 ? w[6] : (dir == 2 ? w[7] : w[8])[m
2026-02-09T19:17:20.7177367Z              ca = abs(Bn) / sqrt(w[1])[m
2026-02-09T19:17:20.7177978Z [31m-            @test cf >= ca - 1e-14[m
2026-02-09T19:17:20.7178562Z [31m-            @test ca >= cs - 1e-14[m
2026-02-09T19:17:20.7179390Z [32m+[m[32m            @test cf >= ca - 1.0e-14[m
2026-02-09T19:17:20.7180050Z [32m+[m[32m            @test ca >= cs - 1.0e-14[m
2026-02-09T19:17:20.7180582Z          end[m
2026-02-09T19:17:20.7180952Z      end[m
2026-02-09T19:17:20.7181290Z  [m
2026-02-09T19:17:20.7181676Z [36m@@ -103,10 +103,10 @@[m [mend[m
2026-02-09T19:17:20.7182250Z          cs_hydro = sqrt(gamma * 1.0 / 1.0)[m
2026-02-09T19:17:20.7182809Z          for dir in 1:3[m
2026-02-09T19:17:20.7183421Z              cf = fast_magnetosonic_speed(law, w_hydro, dir)[m
2026-02-09T19:17:20.7184208Z [31m-            @test cf ≈ cs_hydro atol = 1e-14[m
2026-02-09T19:17:20.7184948Z [32m+[m[32m            @test cf ≈ cs_hydro atol = 1.0e-14[m
2026-02-09T19:17:20.7185513Z  [m
2026-02-09T19:17:20.7186028Z              cs = slow_magnetosonic_speed(law, w_hydro, dir)[m
2026-02-09T19:17:20.7186745Z [31m-            @test cs ≈ 0.0 atol = 1e-14[m
2026-02-09T19:17:20.7187421Z [32m+[m[32m            @test cs ≈ 0.0 atol = 1.0e-14[m
2026-02-09T19:17:20.7187984Z          end[m
2026-02-09T19:17:20.7188340Z      end[m
2026-02-09T19:17:20.7188696Z  end[m
2026-02-09T19:17:20.7189279Z [36m@@ -136,7 +136,7 @@[m [mend[m
2026-02-09T19:17:20.7189978Z      coords, U_final, t_final, ct = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.7190671Z      W = to_primitive(law, U_final)[m
2026-02-09T19:17:20.7191130Z  [m
2026-02-09T19:17:20.7191545Z [31m-    @test t_final ≈ 0.05 atol = 1e-10[m
2026-02-09T19:17:20.7192178Z [32m+[m[32m    @test t_final ≈ 0.05 atol = 1.0e-10[m
2026-02-09T19:17:20.7192855Z      @test size(U_final) == (nx, ny, nz)[m
2026-02-09T19:17:20.7193323Z  [m
2026-02-09T19:17:20.7193755Z      # Extract density along x at iy=1, iz=1[m
2026-02-09T19:17:20.7194315Z [36m@@ -153,7 +153,7 @@[m [mend[m
2026-02-09T19:17:20.7194741Z  [m
2026-02-09T19:17:20.7195512Z      # Solution should be approximately uniform in y and z[m
2026-02-09T19:17:20.7196225Z      for ix in 1:nx, iy in 1:ny, iz in 1:nz[m
2026-02-09T19:17:20.7196917Z [31m-        @test W[ix, iy, iz][1] ≈ W[ix, 1, 1][1] atol = 1e-8[m
2026-02-09T19:17:20.7197925Z [32m+[m[32m        @test W[ix, iy, iz][1] ≈ W[ix, 1, 1][1] atol = 1.0e-8[m
2026-02-09T19:17:20.7198537Z      end[m
2026-02-09T19:17:20.7199038Z  [m
2026-02-09T19:17:20.7199495Z      # Bx should remain approximately constant[m
2026-02-09T19:17:20.7200081Z [36m@@ -188,7 +188,7 @@[m [mend[m
2026-02-09T19:17:20.7200737Z      coords, U_final, t_final, ct = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.7201399Z      W = to_primitive(law, U_final)[m
2026-02-09T19:17:20.7201855Z  [m
2026-02-09T19:17:20.7202265Z [31m-    @test t_final ≈ 0.05 atol = 1e-10[m
2026-02-09T19:17:20.7202901Z [32m+[m[32m    @test t_final ≈ 0.05 atol = 1.0e-10[m
2026-02-09T19:17:20.7203405Z  [m
2026-02-09T19:17:20.7203861Z      # Extract density along z at ix=1, iy=1[m
2026-02-09T19:17:20.7204492Z      rho_z = [W[1, 1, iz][1] for iz in 1:nz][m
2026-02-09T19:17:20.7205044Z [36m@@ -203,7 +203,7 @@[m [mend[m
2026-02-09T19:17:20.7205454Z  [m
2026-02-09T19:17:20.7205952Z      # Solution should be approximately uniform in x and y[m
2026-02-09T19:17:20.7206647Z      for ix in 1:nx, iy in 1:ny, iz in 1:nz[m
2026-02-09T19:17:20.7207299Z [31m-        @test W[ix, iy, iz][1] ≈ W[1, 1, iz][1] atol = 1e-8[m
2026-02-09T19:17:20.7208075Z [32m+[m[32m        @test W[ix, iy, iz][1] ≈ W[1, 1, iz][1] atol = 1.0e-8[m
2026-02-09T19:17:20.7208663Z      end[m
2026-02-09T19:17:20.7209143Z  end[m
2026-02-09T19:17:20.7209433Z  [m
2026-02-09T19:17:20.7209780Z [36m@@ -227,7 +227,7 @@[m [mend[m
2026-02-09T19:17:20.7210522Z          initialize_ct_3d_from_potential!(ct, Ax_func, Ay_func, Az_func, mesh)[m
2026-02-09T19:17:20.7211206Z  [m
2026-02-09T19:17:20.7211757Z          divB = max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz)[m
2026-02-09T19:17:20.7212429Z [31m-        @test divB < 1e-14[m
2026-02-09T19:17:20.7212957Z [32m+[m[32m        @test divB < 1.0e-14[m
2026-02-09T19:17:20.7213452Z      end[m
2026-02-09T19:17:20.7213770Z  [m
2026-02-09T19:17:20.7214252Z      @testset "DivB preserved after evolution" begin[m
2026-02-09T19:17:20.7214885Z [36m@@ -267,8 +267,8 @@[m [mend[m
2026-02-09T19:17:20.7215323Z          )[m
2026-02-09T19:17:20.7215648Z  [m
2026-02-09T19:17:20.7216211Z          divB = max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz)[m
2026-02-09T19:17:20.7216895Z [31m-        @test divB < 1e-14[m
2026-02-09T19:17:20.7217456Z [31m-        @test t_final ≈ 0.02 atol = 1e-10[m
2026-02-09T19:17:20.7218052Z [32m+[m[32m        @test divB < 1.0e-14[m
2026-02-09T19:17:20.7218694Z [32m+[m[32m        @test t_final ≈ 0.02 atol = 1.0e-10[m
2026-02-09T19:17:20.7219405Z      end[m
2026-02-09T19:17:20.7219728Z  [m
2026-02-09T19:17:20.7220150Z      @testset "Uniform field: divB = 0" begin[m
2026-02-09T19:17:20.7220716Z [36m@@ -286,7 +286,7 @@[m [mend[m
2026-02-09T19:17:20.7221163Z  [m
2026-02-09T19:17:20.7221691Z          coords, U_final, t_final, ct = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.7222546Z          divB = max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz)[m
2026-02-09T19:17:20.7223238Z [31m-        @test divB < 1e-12[m
2026-02-09T19:17:20.7223768Z [32m+[m[32m        @test divB < 1.0e-12[m
2026-02-09T19:17:20.7224241Z      end[m
2026-02-09T19:17:20.7224556Z  [m
2026-02-09T19:17:20.7224977Z      @testset "Euler method: divB = 0" begin[m
2026-02-09T19:17:20.7225537Z [36m@@ -304,7 +304,7 @@[m [mend[m
2026-02-09T19:17:20.7225957Z  [m
2026-02-09T19:17:20.7226459Z          _, _, _, ct = solve_hyperbolic(prob; method = :euler)[m
2026-02-09T19:17:20.7227295Z          divB = max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz)[m
2026-02-09T19:17:20.7227978Z [31m-        @test divB < 1e-12[m
2026-02-09T19:17:20.7228509Z [32m+[m[32m        @test divB < 1.0e-12[m
2026-02-09T19:17:20.7229142Z      end[m
2026-02-09T19:17:20.7229698Z  end[m
2026-02-09T19:17:20.7230013Z  [m
2026-02-09T19:17:20.7230380Z [36m@@ -323,7 +323,7 @@[m [mend[m
2026-02-09T19:17:20.7230857Z      rho_bg = 1.0[m
2026-02-09T19:17:20.7231243Z      P_bg = 1.0[m
2026-02-09T19:17:20.7231798Z      R0 = 0.3[m
2026-02-09T19:17:20.7232175Z [31m-    A0 = 1e-3[m
2026-02-09T19:17:20.7232599Z [32m+[m[32m    A0 = 1.0e-3[m
2026-02-09T19:17:20.7233003Z  [m
2026-02-09T19:17:20.7233402Z      function loop_ic_3d(x, y, z)[m
2026-02-09T19:17:20.7234115Z          # B will be overwritten by CT, just set hydrodynamic part[m
2026-02-09T19:17:20.7234801Z [36m@@ -360,8 +360,8 @@[m [mend[m
2026-02-09T19:17:20.7235235Z          )[m
2026-02-09T19:17:20.7235556Z  [m
2026-02-09T19:17:20.7236119Z          divB = max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz)[m
2026-02-09T19:17:20.7236808Z [31m-        @test divB < 1e-14[m
2026-02-09T19:17:20.7237376Z [31m-        @test t_final ≈ 0.02 atol = 1e-10[m
2026-02-09T19:17:20.7237974Z [32m+[m[32m        @test divB < 1.0e-14[m
2026-02-09T19:17:20.7238626Z [32m+[m[32m        @test t_final ≈ 0.02 atol = 1.0e-10[m
2026-02-09T19:17:20.7239329Z      end[m
2026-02-09T19:17:20.7239656Z  [m
2026-02-09T19:17:20.7240317Z      @testset "Density and pressure remain positive and nearly uniform" begin[m
2026-02-09T19:17:20.7241116Z [36m@@ -437,7 +437,7 @@[m [mend[m
2026-02-09T19:17:20.7241559Z      )[m
2026-02-09T19:17:20.7242048Z      _, U_final, t_final, ct = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.7242589Z  [m
2026-02-09T19:17:20.7243000Z [31m-    @test t_final ≈ 0.02 atol = 1e-10[m
2026-02-09T19:17:20.7243636Z [32m+[m[32m    @test t_final ≈ 0.02 atol = 1.0e-10[m
2026-02-09T19:17:20.7244147Z  [m
2026-02-09T19:17:20.7244533Z      # Compute conserved totals[m
2026-02-09T19:17:20.7245068Z      mass_0 = sum(u[1] for u in U0) * dV[m
2026-02-09T19:17:20.7245603Z [36m@@ -451,15 +451,15 @@[m [mend[m
2026-02-09T19:17:20.7246143Z      energy_0 = sum(u[5] for u in U0) * dV[m
2026-02-09T19:17:20.7246776Z      energy_f = sum(u[5] for u in U_final) * dV[m
2026-02-09T19:17:20.7247286Z  [m
2026-02-09T19:17:20.7247703Z [31m-    @test mass_f ≈ mass_0 atol = 1e-10[m
2026-02-09T19:17:20.7248308Z [31m-    @test momx_f ≈ momx_0 atol = 1e-10[m
2026-02-09T19:17:20.7249071Z [31m-    @test momy_f ≈ momy_0 atol = 1e-10[m
2026-02-09T19:17:20.7249686Z [31m-    @test momz_f ≈ momz_0 atol = 1e-10[m
2026-02-09T19:17:20.7250304Z [31m-    @test energy_f ≈ energy_0 atol = 1e-8[m
2026-02-09T19:17:20.7250982Z [32m+[m[32m    @test mass_f ≈ mass_0 atol = 1.0e-10[m
2026-02-09T19:17:20.7251657Z [32m+[m[32m    @test momx_f ≈ momx_0 atol = 1.0e-10[m
2026-02-09T19:17:20.7252334Z [32m+[m[32m    @test momy_f ≈ momy_0 atol = 1.0e-10[m
2026-02-09T19:17:20.7253004Z [32m+[m[32m    @test momz_f ≈ momz_0 atol = 1.0e-10[m
2026-02-09T19:17:20.7253693Z [32m+[m[32m    @test energy_f ≈ energy_0 atol = 1.0e-8[m
2026-02-09T19:17:20.7254234Z  [m
2026-02-09T19:17:20.7254631Z      # divB should also be preserved[m
2026-02-09T19:17:20.7255047Z      divB = max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz)[m
2026-02-09T19:17:20.7255249Z [31m-    @test divB < 1e-12[m
2026-02-09T19:17:20.7255476Z [32m+[m[32m    @test divB < 1.0e-12[m
2026-02-09T19:17:20.7255633Z  end[m
2026-02-09T19:17:20.7255775Z  [m
2026-02-09T19:17:20.7256045Z  # ============================================================[m
2026-02-09T19:17:20.7256251Z [36m@@ -503,7 +503,7 @@[m [mend[m
2026-02-09T19:17:20.7256454Z          ct.Bx_face .= 1.0[m
2026-02-09T19:17:20.7256644Z          ct.By_face .= 0.0[m
2026-02-09T19:17:20.7256831Z          ct.Bz_face .= 0.0[m
2026-02-09T19:17:20.7257254Z [31m-        @test max_divB_3d(ct, dx, dy, dz, nx, ny, nz) ≈ 0.0 atol = 1e-15[m
2026-02-09T19:17:20.7257741Z [32m+[m[32m        @test max_divB_3d(ct, dx, dy, dz, nx, ny, nz) ≈ 0.0 atol = 1.0e-15[m
2026-02-09T19:17:20.7257878Z  [m
2026-02-09T19:17:20.7258122Z          # Introduce non-zero divergence[m
2026-02-09T19:17:20.7258549Z          ct.Bx_face[5, 5, 5] = 2.0[m
2026-02-09T19:17:20.7258940Z [36m@@ -547,7 +547,7 @@[m [mend[m
2026-02-09T19:17:20.7259178Z              @test all(w -> w[1] > 0, W)[m
2026-02-09T19:17:20.7259403Z              @test all(w -> w[5] > 0, W)[m
2026-02-09T19:17:20.7259865Z              @test all(w -> all(isfinite, w), W)[m
2026-02-09T19:17:20.7260347Z [31m-            @test max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz) < 1e-12[m
2026-02-09T19:17:20.7260873Z [32m+[m[32m            @test max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz) < 1.0e-12[m
2026-02-09T19:17:20.7261038Z          end[m
2026-02-09T19:17:20.7261186Z      end[m
2026-02-09T19:17:20.7261324Z  end[m
2026-02-09T19:17:20.7261530Z [36m@@ -576,7 +576,7 @@[m [mend[m
2026-02-09T19:17:20.7261835Z      u_ref = primitive_to_conserved(law, w_const)[m
2026-02-09T19:17:20.7261971Z  [m
2026-02-09T19:17:20.7262226Z      for iz in 1:nz, iy in 1:ny, ix in 1:nx[m
2026-02-09T19:17:20.7262572Z [31m-        @test U_final[ix, iy, iz] ≈ u_ref atol = 1e-12[m
2026-02-09T19:17:20.7262952Z [32m+[m[32m        @test U_final[ix, iy, iz] ≈ u_ref atol = 1.0e-12[m
2026-02-09T19:17:20.7263100Z      end[m
2026-02-09T19:17:20.7263552Z [31m-    @test max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz) < 1e-13[m
2026-02-09T19:17:20.7264057Z [32m+[m[32m    @test max_divB_3d(ct, mesh.dx, mesh.dy, mesh.dz, nx, ny, nz) < 1.0e-13[m
2026-02-09T19:17:20.7264202Z  end[m
2026-02-09T19:17:20.7382375Z [34m[142/151] Checking `test/navier_stokes.jl` ................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.7398548Z [1mdiff --git a/navier_stokes.jl b/navier_stokes.jl[m
2026-02-09T19:17:20.7398963Z [1mindex 70d87d6..323b08f 100644[m
2026-02-09T19:17:20.7399174Z [1m--- a/navier_stokes.jl[m
2026-02-09T19:17:20.7399358Z [1m+++ b/navier_stokes.jl[m
2026-02-09T19:17:20.7399548Z [36m@@ -64,11 +64,11 @@[m [mend[m
2026-02-09T19:17:20.7399882Z          for (ρ, P) in [(1000.0, 1.0e9), (800.0, 5.0e8), (1200.0, 2.0e9)][m
2026-02-09T19:17:20.7400063Z              ε = internal_energy(eos, ρ, P)[m
2026-02-09T19:17:20.7400211Z              P_back = pressure(eos, ρ, ε)[m
2026-02-09T19:17:20.7400383Z [31m-            @test P_back ≈ P rtol = 1e-12[m
2026-02-09T19:17:20.7400582Z [32m+[m[32m            @test P_back ≈ P rtol = 1.0e-12[m
2026-02-09T19:17:20.7400658Z  [m
2026-02-09T19:17:20.7400912Z              c = sound_speed(eos, ρ, P)[m
2026-02-09T19:17:20.7401118Z              @test c > 0[m
2026-02-09T19:17:20.7401537Z [31m-            @test c^2 ≈ eos.gamma * (P + eos.P_inf) / ρ rtol = 1e-12[m
2026-02-09T19:17:20.7402009Z [32m+[m[32m            @test c^2 ≈ eos.gamma * (P + eos.P_inf) / ρ rtol = 1.0e-12[m
2026-02-09T19:17:20.7402189Z          end[m
2026-02-09T19:17:20.7402341Z      end[m
2026-02-09T19:17:20.7402477Z  [m
2026-02-09T19:17:20.7402687Z [36m@@ -79,11 +79,11 @@[m [mend[m
2026-02-09T19:17:20.7402833Z  [m
2026-02-09T19:17:20.7403003Z          ρ = 1.0[m
2026-02-09T19:17:20.7403169Z          P = 1.0[m
2026-02-09T19:17:20.7403772Z [31m-        @test pressure(eos_stiff, ρ, internal_energy(eos_ideal, ρ, P)) ≈ P rtol = 1e-12[m
2026-02-09T19:17:20.7404338Z [31m-        @test sound_speed(eos_stiff, ρ, P) ≈ sound_speed(eos_ideal, ρ, P) rtol = 1e-12[m
2026-02-09T19:17:20.7404991Z [31m-        @test internal_energy(eos_stiff, ρ, P) ≈ internal_energy(eos_ideal, ρ, P) rtol = 1e-12[m
2026-02-09T19:17:20.7405737Z [31m-        @test total_energy(eos_stiff, ρ, 0.5, P) ≈ total_energy(eos_ideal, ρ, 0.5, P) rtol = 1e-12[m
2026-02-09T19:17:20.7406438Z [31m-        @test total_energy(eos_stiff, ρ, 0.5, 0.3, P) ≈ total_energy(eos_ideal, ρ, 0.5, 0.3, P) rtol = 1e-12[m
2026-02-09T19:17:20.7407062Z [32m+[m[32m        @test pressure(eos_stiff, ρ, internal_energy(eos_ideal, ρ, P)) ≈ P rtol = 1.0e-12[m
2026-02-09T19:17:20.7407657Z [32m+[m[32m        @test sound_speed(eos_stiff, ρ, P) ≈ sound_speed(eos_ideal, ρ, P) rtol = 1.0e-12[m
2026-02-09T19:17:20.7408318Z [32m+[m[32m        @test internal_energy(eos_stiff, ρ, P) ≈ internal_energy(eos_ideal, ρ, P) rtol = 1.0e-12[m
2026-02-09T19:17:20.7409426Z [32m+[m[32m        @test total_energy(eos_stiff, ρ, 0.5, P) ≈ total_energy(eos_ideal, ρ, 0.5, P) rtol = 1.0e-12[m
2026-02-09T19:17:20.7410153Z [32m+[m[32m        @test total_energy(eos_stiff, ρ, 0.5, 0.3, P) ≈ total_energy(eos_ideal, ρ, 0.5, 0.3, P) rtol = 1.0e-12[m
2026-02-09T19:17:20.7410515Z      end[m
2026-02-09T19:17:20.7410653Z  [m
2026-02-09T19:17:20.7410920Z      @testset "Total energy formulas" begin[m
2026-02-09T19:17:20.7411142Z [36m@@ -95,12 +95,12 @@[m [mend[m
2026-02-09T19:17:20.7411306Z          v = 10.0[m
2026-02-09T19:17:20.7411558Z          E_1d = total_energy(eos, ρ, v, P)[m
2026-02-09T19:17:20.7411803Z          ε = internal_energy(eos, ρ, P)[m
2026-02-09T19:17:20.7412108Z [31m-        @test E_1d ≈ ρ * ε + 0.5 * ρ * v^2 rtol = 1e-12[m
2026-02-09T19:17:20.7412444Z [32m+[m[32m        @test E_1d ≈ ρ * ε + 0.5 * ρ * v^2 rtol = 1.0e-12[m
2026-02-09T19:17:20.7412570Z  [m
2026-02-09T19:17:20.7412749Z          # 2D[m
2026-02-09T19:17:20.7412927Z          vx, vy = 10.0, 5.0[m
2026-02-09T19:17:20.7413186Z          E_2d = total_energy(eos, ρ, vx, vy, P)[m
2026-02-09T19:17:20.7413530Z [31m-        @test E_2d ≈ ρ * ε + 0.5 * ρ * (vx^2 + vy^2) rtol = 1e-12[m
2026-02-09T19:17:20.7413943Z [32m+[m[32m        @test E_2d ≈ ρ * ε + 0.5 * ρ * (vx^2 + vy^2) rtol = 1.0e-12[m
2026-02-09T19:17:20.7414095Z      end[m
2026-02-09T19:17:20.7414243Z  [m
2026-02-09T19:17:20.7414685Z      @testset "Euler solver with StiffenedGasEOS (shock tube)" begin[m
2026-02-09T19:17:20.7414892Z [36m@@ -179,7 +179,7 @@[m [mend[m
2026-02-09T19:17:20.7415142Z          eos = IdealGasEOS(gamma = 1.4)[m
2026-02-09T19:17:20.7415523Z          ns = NavierStokesEquations{1}(eos, mu = 0.01, Pr = 0.72)[m
2026-02-09T19:17:20.7415768Z          κ = thermal_conductivity(ns)[m
2026-02-09T19:17:20.7416092Z [31m-        @test κ ≈ 0.01 * 1.4 / (0.72 * 0.4) rtol = 1e-12[m
2026-02-09T19:17:20.7416454Z [32m+[m[32m        @test κ ≈ 0.01 * 1.4 / (0.72 * 0.4) rtol = 1.0e-12[m
2026-02-09T19:17:20.7416622Z      end[m
2026-02-09T19:17:20.7416754Z  [m
2026-02-09T19:17:20.7416998Z      @testset "HLLC forwarding" begin[m
2026-02-09T19:17:20.7417195Z [36m@@ -216,7 +216,7 @@[m [mend[m
2026-02-09T19:17:20.7417469Z          # Uniform state → zero viscous flux[m
2026-02-09T19:17:20.7417724Z          w_uniform = SVector(1.0, 1.0, 1.0)[m
2026-02-09T19:17:20.7418072Z          Fv = viscous_flux_1d(ns, w_uniform, w_uniform, 0.1)[m
2026-02-09T19:17:20.7418396Z [31m-        @test Fv ≈ SVector(0.0, 0.0, 0.0) atol = 1e-15[m
2026-02-09T19:17:20.7418988Z [32m+[m[32m        @test Fv ≈ SVector(0.0, 0.0, 0.0) atol = 1.0e-15[m
2026-02-09T19:17:20.7419151Z  [m
2026-02-09T19:17:20.7419383Z          # Linear velocity gradient[m
2026-02-09T19:17:20.7419596Z          wL = SVector(1.0, 0.0, 1.0)[m
2026-02-09T19:17:20.7419803Z [36m@@ -226,7 +226,7 @@[m [mend[m
2026-02-09T19:17:20.7420104Z          # τ_xx = (4/3) * μ * dv/dx = (4/3) * 0.01 * (1-0)/0.1[m
2026-02-09T19:17:20.7420384Z          τ_xx_expected = (4.0 / 3.0) * 0.01 * 10.0[m
2026-02-09T19:17:20.7420581Z          @test Fv[1] == 0.0[m
2026-02-09T19:17:20.7420895Z [31m-        @test Fv[2] ≈ τ_xx_expected rtol = 1e-12[m
2026-02-09T19:17:20.7421259Z [32m+[m[32m        @test Fv[2] ≈ τ_xx_expected rtol = 1.0e-12[m
2026-02-09T19:17:20.7421408Z      end[m
2026-02-09T19:17:20.7421550Z  [m
2026-02-09T19:17:20.7421852Z      @testset "2D viscous flux x-direction" begin[m
2026-02-09T19:17:20.7422053Z [36m@@ -236,7 +236,7 @@[m [mend[m
2026-02-09T19:17:20.7422257Z          # Uniform state[m
2026-02-09T19:17:20.7422530Z          w_uniform = SVector(1.0, 1.0, 0.5, 1.0)[m
2026-02-09T19:17:20.7422936Z          Fv = viscous_flux_x_2d(ns, w_uniform, w_uniform, 0.0, 0.0, 0.1)[m
2026-02-09T19:17:20.7423286Z [31m-        @test Fv ≈ SVector(0.0, 0.0, 0.0, 0.0) atol = 1e-15[m
2026-02-09T19:17:20.7423700Z [32m+[m[32m        @test Fv ≈ SVector(0.0, 0.0, 0.0, 0.0) atol = 1.0e-15[m
2026-02-09T19:17:20.7424082Z      end[m
2026-02-09T19:17:20.7424216Z  [m
2026-02-09T19:17:20.7424533Z      @testset "2D viscous flux y-direction" begin[m
2026-02-09T19:17:20.7424740Z [36m@@ -246,7 +246,7 @@[m [mend[m
2026-02-09T19:17:20.7424934Z          # Uniform state[m
2026-02-09T19:17:20.7425382Z          w_uniform = SVector(1.0, 1.0, 0.5, 1.0)[m
2026-02-09T19:17:20.7425800Z          Fv = viscous_flux_y_2d(ns, w_uniform, w_uniform, 0.0, 0.0, 0.1)[m
2026-02-09T19:17:20.7426148Z [31m-        @test Fv ≈ SVector(0.0, 0.0, 0.0, 0.0) atol = 1e-15[m
2026-02-09T19:17:20.7426533Z [32m+[m[32m        @test Fv ≈ SVector(0.0, 0.0, 0.0, 0.0) atol = 1.0e-15[m
2026-02-09T19:17:20.7426692Z      end[m
2026-02-09T19:17:20.7426835Z  end[m
2026-02-09T19:17:20.7426966Z  [m
2026-02-09T19:17:20.7427167Z [36m@@ -282,7 +282,7 @@[m [mend[m
2026-02-09T19:17:20.7427307Z  [m
2026-02-09T19:17:20.7427497Z          @test t_e ≈ t_ns[m
2026-02-09T19:17:20.7427716Z          for i in eachindex(U_e)[m
2026-02-09T19:17:20.7428020Z [31m-            @test U_e[i] ≈ U_ns[i] rtol = 1e-12[m
2026-02-09T19:17:20.7428346Z [32m+[m[32m            @test U_e[i] ≈ U_ns[i] rtol = 1.0e-12[m
2026-02-09T19:17:20.7428502Z          end[m
2026-02-09T19:17:20.7428651Z      end[m
2026-02-09T19:17:20.7429011Z  end[m
2026-02-09T19:17:20.7429219Z [36m@@ -544,8 +544,8 @@[m [mend[m
2026-02-09T19:17:20.7429464Z          mass_f = sum(u[1] for u in U) * dx[m
2026-02-09T19:17:20.7429710Z          mom_f = sum(u[2] for u in U) * dx[m
2026-02-09T19:17:20.7429845Z  [m
2026-02-09T19:17:20.7430116Z [31m-        @test mass_f ≈ mass_0 rtol = 1e-10[m
2026-02-09T19:17:20.7430552Z [31m-        @test abs(mom_f - mom_0) < 1e-12  # momentum near zero, use atol[m
2026-02-09T19:17:20.7430875Z [32m+[m[32m        @test mass_f ≈ mass_0 rtol = 1.0e-10[m
2026-02-09T19:17:20.7431355Z [32m+[m[32m        @test abs(mom_f - mom_0) < 1.0e-12  # momentum near zero, use atol[m
2026-02-09T19:17:20.7431506Z      end[m
2026-02-09T19:17:20.7431648Z  [m
2026-02-09T19:17:20.7431921Z      @testset "2D mass conservation" begin[m
2026-02-09T19:17:20.7432121Z [36m@@ -590,7 +590,7 @@[m [mend[m
2026-02-09T19:17:20.7432304Z          # Final mass[m
2026-02-09T19:17:20.7432683Z          mass_f = sum(U[ix, iy][1] for iy in 1:N, ix in 1:N) * dx * dy[m
2026-02-09T19:17:20.7432827Z  [m
2026-02-09T19:17:20.7433090Z [31m-        @test mass_f ≈ mass_0 rtol = 1e-10[m
2026-02-09T19:17:20.7433406Z [32m+[m[32m        @test mass_f ≈ mass_0 rtol = 1.0e-10[m
2026-02-09T19:17:20.7433553Z      end[m
2026-02-09T19:17:20.7433696Z  end[m
2026-02-09T19:17:20.7433837Z  [m
2026-02-09T19:17:20.7472872Z [34m[143/151] Checking `test/physics.jl` ......................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.7487222Z [1mdiff --git a/physics.jl b/physics.jl[m
2026-02-09T19:17:20.7487496Z [1mindex b4a0010..817cb7d 100644[m
2026-02-09T19:17:20.7487676Z [1m--- a/physics.jl[m
2026-02-09T19:17:20.7487849Z [1m+++ b/physics.jl[m
2026-02-09T19:17:20.7488066Z [36m@@ -7,7 +7,7 @@[m [musing Test[m
2026-02-09T19:17:20.7488349Z      @testset "Anisotropic Diffusion" begin[m
2026-02-09T19:17:20.7488924Z          @testset "AnisotropicDiffusionEquation construction" begin[m
2026-02-09T19:17:20.7489124Z              # Create mesh[m
2026-02-09T19:17:20.7489624Z [31m-            tri = triangulate_rectangle(0, 1, 0, 1, 10, 10, single_boundary=true)[m
2026-02-09T19:17:20.7490126Z [32m+[m[32m            tri = triangulate_rectangle(0, 1, 0, 1, 10, 10, single_boundary = true)[m
2026-02-09T19:17:20.7490274Z              mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.7490349Z  [m
2026-02-09T19:17:20.7490516Z              # Dirichlet boundary conditions[m
2026-02-09T19:17:20.7490652Z [36m@@ -18,7 +18,7 @@[m [musing Test[m
2026-02-09T19:17:20.7490884Z              diffusion_tensor = (x, y, p) -> (1.0, 0.0, 1.0)  # D = I[m
2026-02-09T19:17:20.7490959Z  [m
2026-02-09T19:17:20.7491085Z              # Initial condition[m
2026-02-09T19:17:20.7491463Z [31m-            u0 = [exp(-((x-0.5)^2 + (y-0.5)^2)/0.01) for (x, y) in DelaunayTriangulation.each_point(tri)][m
2026-02-09T19:17:20.7492048Z [32m+[m[32m            u0 = [exp(-((x - 0.5)^2 + (y - 0.5)^2) / 0.01) for (x, y) in DelaunayTriangulation.each_point(tri)][m
2026-02-09T19:17:20.7492225Z  [m
2026-02-09T19:17:20.7492422Z              prob = AnisotropicDiffusionEquation([m
2026-02-09T19:17:20.7492534Z                  mesh, BCs;[m
2026-02-09T19:17:20.7492668Z [36m@@ -37,22 +37,22 @@[m [musing Test[m
2026-02-09T19:17:20.7492858Z              D_func = make_rotation_tensor(0.0, 2.0, 0.5)[m
2026-02-09T19:17:20.7493036Z              Dxx, Dxy, Dyy = D_func(0.0, 0.0, nothing)[m
2026-02-09T19:17:20.7493153Z              @test Dxx ≈ 2.0[m
2026-02-09T19:17:20.7493303Z [31m-            @test Dxy ≈ 0.0 atol=1e-10[m
2026-02-09T19:17:20.7493486Z [32m+[m[32m            @test Dxy ≈ 0.0 atol = 1.0e-10[m
2026-02-09T19:17:20.7493599Z              @test Dyy ≈ 0.5[m
2026-02-09T19:17:20.7493673Z  [m
2026-02-09T19:17:20.7493902Z              # 90 degree rotation - should swap coefficients[m
2026-02-09T19:17:20.7494117Z [31m-            D_func_90 = make_rotation_tensor(π/2, 2.0, 0.5)[m
2026-02-09T19:17:20.7494347Z [32m+[m[32m            D_func_90 = make_rotation_tensor(π / 2, 2.0, 0.5)[m
2026-02-09T19:17:20.7494533Z              Dxx, Dxy, Dyy = D_func_90(0.0, 0.0, nothing)[m
2026-02-09T19:17:20.7494681Z [31m-            @test Dxx ≈ 0.5 atol=1e-10[m
2026-02-09T19:17:20.7494820Z [31m-            @test Dxy ≈ 0.0 atol=1e-10[m
2026-02-09T19:17:20.7494955Z [31m-            @test Dyy ≈ 2.0 atol=1e-10[m
2026-02-09T19:17:20.7495130Z [32m+[m[32m            @test Dxx ≈ 0.5 atol = 1.0e-10[m
2026-02-09T19:17:20.7495290Z [32m+[m[32m            @test Dxy ≈ 0.0 atol = 1.0e-10[m
2026-02-09T19:17:20.7495451Z [32m+[m[32m            @test Dyy ≈ 2.0 atol = 1.0e-10[m
2026-02-09T19:17:20.7495524Z  [m
2026-02-09T19:17:20.7495735Z              # 45 degree rotation - should give mixed terms[m
2026-02-09T19:17:20.7495940Z [31m-            D_func_45 = make_rotation_tensor(π/4, 2.0, 0.5)[m
2026-02-09T19:17:20.7496176Z [32m+[m[32m            D_func_45 = make_rotation_tensor(π / 4, 2.0, 0.5)[m
2026-02-09T19:17:20.7496355Z              Dxx, Dxy, Dyy = D_func_45(0.0, 0.0, nothing)[m
2026-02-09T19:17:20.7496523Z              # Average of 2 and 0.5 for diagonal[m
2026-02-09T19:17:20.7496667Z [31m-            @test Dxx ≈ 1.25 atol=1e-10[m
2026-02-09T19:17:20.7496803Z [31m-            @test Dyy ≈ 1.25 atol=1e-10[m
2026-02-09T19:17:20.7496976Z [32m+[m[32m            @test Dxx ≈ 1.25 atol = 1.0e-10[m
2026-02-09T19:17:20.7497138Z [32m+[m[32m            @test Dyy ≈ 1.25 atol = 1.0e-10[m
2026-02-09T19:17:20.7497300Z              # Off-diagonal should be non-zero[m
2026-02-09T19:17:20.7497424Z              @test abs(Dxy) > 0.5[m
2026-02-09T19:17:20.7497509Z          end[m
2026-02-09T19:17:20.7497636Z [36m@@ -83,7 +83,7 @@[m [musing Test[m
2026-02-09T19:17:20.7497778Z              @test model.kappa ≈ 0.41[m
2026-02-09T19:17:20.7497861Z  [m
2026-02-09T19:17:20.7497971Z              # Custom model[m
2026-02-09T19:17:20.7498245Z [31m-            model_custom = StandardKEpsilon(C_mu=0.1, C1_epsilon=1.5)[m
2026-02-09T19:17:20.7498554Z [32m+[m[32m            model_custom = StandardKEpsilon(C_mu = 0.1, C1_epsilon = 1.5)[m
2026-02-09T19:17:20.7498911Z              @test model_custom.C_mu ≈ 0.1[m
2026-02-09T19:17:20.7499106Z              @test model_custom.C1_epsilon ≈ 1.5[m
2026-02-09T19:17:20.7499199Z          end[m
2026-02-09T19:17:20.7499330Z [36m@@ -99,7 +99,7 @@[m [musing Test[m
2026-02-09T19:17:20.7499403Z  [m
2026-02-09T19:17:20.7499514Z              # With density[m
2026-02-09T19:17:20.7499621Z              rho = 1000.0[m
2026-02-09T19:17:20.7499916Z [31m-            mu_t = compute_turbulent_viscosity(model, k, epsilon; rho=rho)[m
2026-02-09T19:17:20.7500227Z [32m+[m[32m            mu_t = compute_turbulent_viscosity(model, k, epsilon; rho = rho)[m
2026-02-09T19:17:20.7500383Z              @test mu_t ≈ rho * 0.09 * 1.0^2 / 0.1[m
2026-02-09T19:17:20.7500593Z  [m
2026-02-09T19:17:20.7500709Z              # Vector inputs[m
2026-02-09T19:17:20.7500854Z [36m@@ -148,12 +148,12 @@[m [musing Test[m
2026-02-09T19:17:20.7500928Z  [m
2026-02-09T19:17:20.7501232Z          @testset "compute_friction_velocity" begin[m
2026-02-09T19:17:20.7501411Z              # Viscous sublayer (low u_tan, small y)[m
2026-02-09T19:17:20.7501645Z [31m-            u_tau = compute_friction_velocity(0.1, 0.001, 1e-6)[m
2026-02-09T19:17:20.7501893Z [32m+[m[32m            u_tau = compute_friction_velocity(0.1, 0.001, 1.0e-6)[m
2026-02-09T19:17:20.7502023Z              @test isfinite(u_tau)[m
2026-02-09T19:17:20.7502139Z              @test u_tau > 0[m
2026-02-09T19:17:20.7502215Z  [m
2026-02-09T19:17:20.7502388Z              # Log layer (higher Reynolds number)[m
2026-02-09T19:17:20.7502627Z [31m-            u_tau_log = compute_friction_velocity(10.0, 0.01, 1e-6)[m
2026-02-09T19:17:20.7502894Z [32m+[m[32m            u_tau_log = compute_friction_velocity(10.0, 0.01, 1.0e-6)[m
2026-02-09T19:17:20.7503038Z              @test isfinite(u_tau_log)[m
2026-02-09T19:17:20.7503158Z              @test u_tau_log > 0[m
2026-02-09T19:17:20.7503395Z              @test u_tau_log < 10.0  # Must be less than bulk velocity[m
2026-02-09T19:17:20.7503532Z [36m@@ -171,7 +171,7 @@[m [musing Test[m
2026-02-09T19:17:20.7503642Z              @test eps_w > 0[m
2026-02-09T19:17:20.7503719Z  [m
2026-02-09T19:17:20.7503907Z              # Epsilon should increase as y decreases[m
2026-02-09T19:17:20.7504121Z [31m-            eps_w_closer = epsilon_wall_value(u_tau, y/2)[m
2026-02-09T19:17:20.7504357Z [32m+[m[32m            eps_w_closer = epsilon_wall_value(u_tau, y / 2)[m
2026-02-09T19:17:20.7504501Z              @test eps_w_closer > eps_w[m
2026-02-09T19:17:20.7504586Z          end[m
2026-02-09T19:17:20.7504659Z  [m
2026-02-09T19:17:20.7504791Z [36m@@ -181,7 +181,7 @@[m [musing Test[m
2026-02-09T19:17:20.7504911Z              @test bc.C_mu ≈ 0.09[m
2026-02-09T19:17:20.7505041Z              @test bc.kappa ≈ 0.41[m
2026-02-09T19:17:20.7505115Z  [m
2026-02-09T19:17:20.7505334Z [31m-            bc_rough = TurbulentWallBC(roughness=0.001)[m
2026-02-09T19:17:20.7505568Z [32m+[m[32m            bc_rough = TurbulentWallBC(roughness = 0.001)[m
2026-02-09T19:17:20.7505732Z              @test bc_rough.roughness ≈ 0.001[m
2026-02-09T19:17:20.7505823Z          end[m
2026-02-09T19:17:20.7505895Z  [m
2026-02-09T19:17:20.7598879Z [34m[144/151] Checking `test/problem.jl` ......................................... [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.7623583Z [34m[145/151] Checking `test/robin.jl` ........................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.7637839Z [1mdiff --git a/robin.jl b/robin.jl[m
2026-02-09T19:17:20.7638078Z [1mindex d902655..ee4a36e 100644[m
2026-02-09T19:17:20.7638270Z [1m--- a/robin.jl[m
2026-02-09T19:17:20.7638390Z [1m+++ b/robin.jl[m
2026-02-09T19:17:20.7638541Z [36m@@ -13,21 +13,21 @@[m [musing Test[m
2026-02-09T19:17:20.7638644Z      end[m
2026-02-09T19:17:20.7638934Z  [m
2026-02-09T19:17:20.7639196Z      @testset "BoundaryConditions with Robin" begin[m
2026-02-09T19:17:20.7639507Z [31m-        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=true)[m
2026-02-09T19:17:20.7639850Z [32m+[m[32m        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = true)[m
2026-02-09T19:17:20.7639987Z          mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.7640061Z  [m
2026-02-09T19:17:20.7640259Z          # Robin BC function returns (a, b, c) tuple[m
2026-02-09T19:17:20.7640445Z          robin_fn = (x, y, t, u, p) -> (p.a, p.b, p.c)[m
2026-02-09T19:17:20.7640598Z [31m-        params = (a=1.0, b=2.0, c=3.0)[m
2026-02-09T19:17:20.7640797Z [32m+[m[32m        params = (a = 1.0, b = 2.0, c = 3.0)[m
2026-02-09T19:17:20.7640876Z  [m
2026-02-09T19:17:20.7641192Z [31m-        BCs = BoundaryConditions(mesh, robin_fn, Robin; parameters=params)[m
2026-02-09T19:17:20.7641734Z [32m+[m[32m        BCs = BoundaryConditions(mesh, robin_fn, Robin; parameters = params)[m
2026-02-09T19:17:20.7641816Z  [m
2026-02-09T19:17:20.7641986Z          @test BCs.condition_types == (Robin,)[m
2026-02-09T19:17:20.7642273Z          @test length(BCs.functions) == 1[m
2026-02-09T19:17:20.7642362Z      end[m
2026-02-09T19:17:20.7642437Z  [m
2026-02-09T19:17:20.7642680Z      @testset "Conditions with Robin edges" begin[m
2026-02-09T19:17:20.7643065Z [31m-        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=true)[m
2026-02-09T19:17:20.7643398Z [32m+[m[32m        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = true)[m
2026-02-09T19:17:20.7643531Z          mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.7643604Z  [m
2026-02-09T19:17:20.7643780Z          robin_fn = (x, y, t, u, p) -> (1.0, 2.0, 3.0)[m
2026-02-09T19:17:20.7643909Z [36m@@ -47,7 +47,7 @@[m [musing Test[m
2026-02-09T19:17:20.7643982Z  [m
2026-02-09T19:17:20.7644216Z      @testset "Mixed boundary conditions with Robin" begin[m
2026-02-09T19:17:20.7644434Z          # Create a mesh with multiple boundary segments[m
2026-02-09T19:17:20.7644724Z [31m-        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=false)[m
2026-02-09T19:17:20.7645050Z [32m+[m[32m        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = false)[m
2026-02-09T19:17:20.7645184Z          mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.7645267Z  [m
2026-02-09T19:17:20.7645460Z          # Different BC types on different segments[m
2026-02-09T19:17:20.7645595Z [36m@@ -59,9 +59,11 @@[m [musing Test[m
2026-02-09T19:17:20.7645740Z          neumann_fn = (x, y, t, u, p) -> 0.0[m
2026-02-09T19:17:20.7645942Z          robin_fn = (x, y, t, u, p) -> (1.0, 1.0, 0.0)  # (a, b, c)[m
2026-02-09T19:17:20.7646015Z  [m
2026-02-09T19:17:20.7646182Z [31m-        BCs = BoundaryConditions(mesh,[m
2026-02-09T19:17:20.7646347Z [32m+[m[32m        BCs = BoundaryConditions([m
2026-02-09T19:17:20.7646458Z [32m+[m[32m            mesh,[m
2026-02-09T19:17:20.7646691Z              (dirichlet_fn, neumann_fn, robin_fn, dirichlet_fn),[m
2026-02-09T19:17:20.7646891Z [31m-            (Dirichlet, Neumann, Robin, Dirichlet))[m
2026-02-09T19:17:20.7647104Z [32m+[m[32m            (Dirichlet, Neumann, Robin, Dirichlet)[m
2026-02-09T19:17:20.7647213Z [32m+[m[32m        )[m
2026-02-09T19:17:20.7647289Z  [m
2026-02-09T19:17:20.7647451Z          conditions = Conditions(mesh, BCs)[m
2026-02-09T19:17:20.7647522Z  [m
2026-02-09T19:17:20.7647654Z [36m@@ -75,7 +77,7 @@[m [musing Test[m
2026-02-09T19:17:20.7647737Z      end[m
2026-02-09T19:17:20.7647809Z  [m
2026-02-09T19:17:20.7647969Z      @testset "Robin BC evaluation" begin[m
2026-02-09T19:17:20.7648256Z [31m-        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=true)[m
2026-02-09T19:17:20.7648563Z [32m+[m[32m        tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = true)[m
2026-02-09T19:17:20.7648693Z          mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.7649005Z  [m
2026-02-09T19:17:20.7649267Z          # Robin BC that returns position-dependent coefficients[m
2026-02-09T19:17:20.7680054Z [34m[146/151] Checking `test/runtests.jl` ........................................ [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.7710146Z [34m[147/151] Checking `test/schemes.jl` ......................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.7725834Z [1mdiff --git a/schemes.jl b/schemes.jl[m
2026-02-09T19:17:20.7726080Z [1mindex e641ad7..b5db3d1 100644[m
2026-02-09T19:17:20.7726261Z [1m--- a/schemes.jl[m
2026-02-09T19:17:20.7726426Z [1m+++ b/schemes.jl[m
2026-02-09T19:17:20.7726620Z [36m@@ -105,12 +105,12 @@[m [mend[m
2026-02-09T19:17:20.7726710Z  [m
2026-02-09T19:17:20.7726895Z  @testset "Gradient Reconstruction" begin[m
2026-02-09T19:17:20.7727032Z      # Create a simple test mesh[m
2026-02-09T19:17:20.7727481Z [31m-    tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary=true)[m
2026-02-09T19:17:20.7728286Z [32m+[m[32m    tri = triangulate_rectangle(0, 1, 0, 1, 5, 5, single_boundary = true)[m
2026-02-09T19:17:20.7728518Z      mesh = FVMGeometry(tri)[m
2026-02-09T19:17:20.7728655Z  [m
2026-02-09T19:17:20.7729320Z      # Linear function: u(x, y) = 2x + 3y[m
2026-02-09T19:17:20.7729552Z      # Gradient should be (2, 3)[m
2026-02-09T19:17:20.7729999Z [31m-    u = [2*x + 3*y for (x, y) in DelaunayTriangulation.each_point(tri)][m
2026-02-09T19:17:20.7730507Z [32m+[m[32m    u = [2 * x + 3 * y for (x, y) in DelaunayTriangulation.each_point(tri)][m
2026-02-09T19:17:20.7730647Z  [m
2026-02-09T19:17:20.7730904Z      @testset "GreenGaussGradient" begin[m
2026-02-09T19:17:20.7731153Z          method = GreenGaussGradient()[m
2026-02-09T19:17:20.7731391Z [36m@@ -145,7 +145,7 @@[m [mend[m
2026-02-09T19:17:20.7731704Z          @test scheme.limiter isa VanLeerLimiter[m
2026-02-09T19:17:20.7732098Z          @test scheme.gradient_method isa GreenGaussGradient[m
2026-02-09T19:17:20.7732257Z  [m
2026-02-09T19:17:20.7732931Z [31m-        scheme2 = MUSCLScheme(limiter=MinmodLimiter(), gradient_method=LeastSquaresGradient())[m
2026-02-09T19:17:20.7733657Z [32m+[m[32m        scheme2 = MUSCLScheme(limiter = MinmodLimiter(), gradient_method = LeastSquaresGradient())[m
2026-02-09T19:17:20.7733962Z          @test scheme2.limiter isa MinmodLimiter[m
2026-02-09T19:17:20.7734357Z          @test scheme2.gradient_method isa LeastSquaresGradient[m
2026-02-09T19:17:20.7734511Z      end[m
2026-02-09T19:17:20.7856660Z [34m[148/151] Checking `test/srmhd.jl` ........................................... [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.7872260Z [1mdiff --git a/srmhd.jl b/srmhd.jl[m
2026-02-09T19:17:20.7872499Z [1mindex 88b47a4..de5dbd7 100644[m
2026-02-09T19:17:20.7872676Z [1m--- a/srmhd.jl[m
2026-02-09T19:17:20.7872902Z [1m+++ b/srmhd.jl[m
2026-02-09T19:17:20.7873195Z [36m@@ -12,7 +12,7 @@[m [musing StaticArrays[m
2026-02-09T19:17:20.7873402Z          law = SRMHDEquations{1}(eos)[m
2026-02-09T19:17:20.7873564Z          @test nvariables(law) == 8[m
2026-02-09T19:17:20.7873685Z          @test law.eos === eos[m
2026-02-09T19:17:20.7873961Z [31m-        @test law.con2prim_tol == 1e-12[m
2026-02-09T19:17:20.7874299Z [32m+[m[32m        @test law.con2prim_tol == 1.0e-12[m
2026-02-09T19:17:20.7874552Z          @test law.con2prim_maxiter == 50[m
2026-02-09T19:17:20.7874711Z      end[m
2026-02-09T19:17:20.7874850Z  [m
2026-02-09T19:17:20.7875139Z [36m@@ -22,8 +22,8 @@[m [musing StaticArrays[m
2026-02-09T19:17:20.7875299Z      end[m
2026-02-09T19:17:20.7875448Z  [m
2026-02-09T19:17:20.7875741Z      @testset "Custom con2prim params" begin[m
2026-02-09T19:17:20.7876297Z [31m-        law = SRMHDEquations{1}(eos; con2prim_tol = 1e-10, con2prim_maxiter = 100)[m
2026-02-09T19:17:20.7876592Z [31m-        @test law.con2prim_tol == 1e-10[m
2026-02-09T19:17:20.7877188Z [32m+[m[32m        law = SRMHDEquations{1}(eos; con2prim_tol = 1.0e-10, con2prim_maxiter = 100)[m
2026-02-09T19:17:20.7877524Z [32m+[m[32m        @test law.con2prim_tol == 1.0e-10[m
2026-02-09T19:17:20.7877786Z          @test law.con2prim_maxiter == 100[m
2026-02-09T19:17:20.7877951Z      end[m
2026-02-09T19:17:20.7878093Z  end[m
2026-02-09T19:17:20.7878302Z [36m@@ -44,7 +44,7 @@[m [mend[m
2026-02-09T19:17:20.7878502Z          for w in states[m
2026-02-09T19:17:20.7878975Z              u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.7879288Z              w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.7879566Z [31m-            @test w2 ≈ w atol = 1e-10[m
2026-02-09T19:17:20.7879859Z [32m+[m[32m            @test w2 ≈ w atol = 1.0e-10[m
2026-02-09T19:17:20.7880015Z          end[m
2026-02-09T19:17:20.7880169Z      end[m
2026-02-09T19:17:20.7880310Z  [m
2026-02-09T19:17:20.7880512Z [36m@@ -58,7 +58,7 @@[m [mend[m
2026-02-09T19:17:20.7880701Z          for w in states[m
2026-02-09T19:17:20.7880978Z              u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.7881486Z              w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.7881735Z [31m-            @test w2 ≈ w atol = 1e-9[m
2026-02-09T19:17:20.7882021Z [32m+[m[32m            @test w2 ≈ w atol = 1.0e-9[m
2026-02-09T19:17:20.7882387Z          end[m
2026-02-09T19:17:20.7882541Z      end[m
2026-02-09T19:17:20.7882669Z  [m
2026-02-09T19:17:20.7882871Z [36m@@ -71,7 +71,7 @@[m [mend[m
2026-02-09T19:17:20.7883056Z          for w in states[m
2026-02-09T19:17:20.7883326Z              u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.7883595Z              w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.7883842Z [31m-            @test w2 ≈ w atol = 1e-8[m
2026-02-09T19:17:20.7884122Z [32m+[m[32m            @test w2 ≈ w atol = 1.0e-8[m
2026-02-09T19:17:20.7884272Z          end[m
2026-02-09T19:17:20.7884427Z      end[m
2026-02-09T19:17:20.7884566Z  [m
2026-02-09T19:17:20.7884769Z [36m@@ -81,16 +81,16 @@[m [mend[m
2026-02-09T19:17:20.7885092Z          w = SVector(1.0, v, 0.0, 0.0, 10.0, 0.5, 0.0, 0.0)[m
2026-02-09T19:17:20.7885362Z          u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.7885627Z          w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.7885942Z [31m-        @test w2[1] ≈ w[1] rtol = 1e-6   # density[m
2026-02-09T19:17:20.7886258Z [31m-        @test w2[2] ≈ w[2] rtol = 1e-6   # velocity[m
2026-02-09T19:17:20.7886545Z [31m-        @test w2[5] ≈ w[5] rtol = 1e-6   # pressure[m
2026-02-09T19:17:20.7886871Z [32m+[m[32m        @test w2[1] ≈ w[1] rtol = 1.0e-6   # density[m
2026-02-09T19:17:20.7887201Z [32m+[m[32m        @test w2[2] ≈ w[2] rtol = 1.0e-6   # velocity[m
2026-02-09T19:17:20.7887521Z [32m+[m[32m        @test w2[5] ≈ w[5] rtol = 1.0e-6   # pressure[m
2026-02-09T19:17:20.7887664Z      end[m
2026-02-09T19:17:20.7887789Z  [m
2026-02-09T19:17:20.7888038Z      @testset "B=0 (SR hydro limit)" begin[m
2026-02-09T19:17:20.7888336Z          w = SVector(1.0, 0.5, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0)[m
2026-02-09T19:17:20.7888621Z          u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.7889094Z          w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.7889341Z [31m-        @test w2 ≈ w atol = 1e-10[m
2026-02-09T19:17:20.7889624Z [32m+[m[32m        @test w2 ≈ w atol = 1.0e-10[m
2026-02-09T19:17:20.7889774Z      end[m
2026-02-09T19:17:20.7889912Z  [m
2026-02-09T19:17:20.7890167Z      @testset "Random valid states" begin[m
2026-02-09T19:17:20.7890374Z [36m@@ -109,11 +109,11 @@[m [mend[m
2026-02-09T19:17:20.7890675Z              w = SVector(ρ, vx, vy, vz, P, Bx, By, Bz)[m
2026-02-09T19:17:20.7890941Z              u = primitive_to_conserved(law, w)[m
2026-02-09T19:17:20.7891210Z              w2 = conserved_to_primitive(law, u)[m
2026-02-09T19:17:20.7891467Z [31m-            @test w2[1] ≈ w[1] rtol = 1e-8[m
2026-02-09T19:17:20.7891734Z [31m-            @test w2[2] ≈ w[2] atol = 1e-8[m
2026-02-09T19:17:20.7891991Z [31m-            @test w2[3] ≈ w[3] atol = 1e-8[m
2026-02-09T19:17:20.7892253Z [31m-            @test w2[4] ≈ w[4] atol = 1e-8[m
2026-02-09T19:17:20.7892508Z [31m-            @test w2[5] ≈ w[5] rtol = 1e-8[m
2026-02-09T19:17:20.7892808Z [32m+[m[32m            @test w2[1] ≈ w[1] rtol = 1.0e-8[m
2026-02-09T19:17:20.7893116Z [32m+[m[32m            @test w2[2] ≈ w[2] atol = 1.0e-8[m
2026-02-09T19:17:20.7893412Z [32m+[m[32m            @test w2[3] ≈ w[3] atol = 1.0e-8[m
2026-02-09T19:17:20.7893697Z [32m+[m[32m            @test w2[4] ≈ w[4] atol = 1.0e-8[m
2026-02-09T19:17:20.7893985Z [32m+[m[32m            @test w2[5] ≈ w[5] rtol = 1.0e-8[m
2026-02-09T19:17:20.7894140Z          end[m
2026-02-09T19:17:20.7894293Z      end[m
2026-02-09T19:17:20.7894434Z  end[m
2026-02-09T19:17:20.7894635Z [36m@@ -127,10 +127,10 @@[m [mend[m
2026-02-09T19:17:20.7894930Z      w = SVector(1.0, 0.5, 0.3, 0.0, 2.0, 0.5, 0.8, 0.3)[m
2026-02-09T19:17:20.7895461Z      u = FiniteVolumeMethod.primitive_to_conserved(SRMHDEquations{1}(eos), w)[m
2026-02-09T19:17:20.7895811Z  [m
2026-02-09T19:17:20.7896305Z [31m-    w_rec, result = FiniteVolumeMethod.srmhd_con2prim(eos, u, 1e-12, 50)[m
2026-02-09T19:17:20.7896851Z [32m+[m[32m    w_rec, result = FiniteVolumeMethod.srmhd_con2prim(eos, u, 1.0e-12, 50)[m
2026-02-09T19:17:20.7897261Z      @test result.converged == true[m
2026-02-09T19:17:20.7897501Z      @test result.iterations < 50[m
2026-02-09T19:17:20.7897759Z [31m-    @test result.residual < 1e-10[m
2026-02-09T19:17:20.7898043Z [32m+[m[32m    @test result.residual < 1.0e-10[m
2026-02-09T19:17:20.7898184Z  end[m
2026-02-09T19:17:20.7898323Z  [m
2026-02-09T19:17:20.7898591Z  # ============================================================[m
2026-02-09T19:17:20.7898980Z [36m@@ -153,12 +153,12 @@[m [mend[m
2026-02-09T19:17:20.7899194Z          Sx = ρ * h * W^2 * vx[m
2026-02-09T19:17:20.7899412Z          tau = ρ * h * W^2 - P - D[m
2026-02-09T19:17:20.7899549Z  [m
2026-02-09T19:17:20.7899870Z [31m-        @test f[1] ≈ D * vx atol = 1e-14           # D*vx[m
2026-02-09T19:17:20.7900302Z [31m-        @test f[5] ≈ Sx - D * vx atol = 1e-12       # τ flux = Sx - D*vx[m
2026-02-09T19:17:20.7900684Z [32m+[m[32m        @test f[1] ≈ D * vx atol = 1.0e-14           # D*vx[m
2026-02-09T19:17:20.7901134Z [32m+[m[32m        @test f[5] ≈ Sx - D * vx atol = 1.0e-12       # τ flux = Sx - D*vx[m
2026-02-09T19:17:20.7901309Z      end[m
2026-02-09T19:17:20.7901450Z  [m
2026-02-09T19:17:20.7901814Z      @testset "v≪1 approaches Newtonian MHD flux" begin[m
2026-02-09T19:17:20.7902018Z [31m-        v_small = 1e-4[m
2026-02-09T19:17:20.7902247Z [32m+[m[32m        v_small = 1.0e-4[m
2026-02-09T19:17:20.7902585Z          w = SVector(1.0, v_small, 0.0, 0.0, 1.0, 0.5, 1.0, 0.0)[m
2026-02-09T19:17:20.7902831Z          f_sr = physical_flux(law, w, 1)[m
2026-02-09T19:17:20.7902972Z  [m
2026-02-09T19:17:20.7903173Z [36m@@ -168,23 +168,23 @@[m [mend[m
2026-02-09T19:17:20.7903306Z  [m
2026-02-09T19:17:20.7903753Z          # At low v, SRMHD flux ≈ Newtonian MHD flux (to leading order in v)[m
2026-02-09T19:17:20.7903993Z          # D flux ≈ ρv (since W ≈ 1)[m
2026-02-09T19:17:20.7904273Z [31m-        @test f_sr[1] ≈ f_mhd[1] rtol = 1e-3[m
2026-02-09T19:17:20.7904593Z [32m+[m[32m        @test f_sr[1] ≈ f_mhd[1] rtol = 1.0e-3[m
2026-02-09T19:17:20.7904817Z          # Bx flux = 0 in both[m
2026-02-09T19:17:20.7905070Z [31m-        @test f_sr[6] ≈ 0.0 atol = 1e-14[m
2026-02-09T19:17:20.7905365Z [32m+[m[32m        @test f_sr[6] ≈ 0.0 atol = 1.0e-14[m
2026-02-09T19:17:20.7905634Z          # Induction fluxes should be similar[m
2026-02-09T19:17:20.7905904Z [31m-        @test f_sr[7] ≈ f_mhd[7] rtol = 1e-3[m
2026-02-09T19:17:20.7906166Z [31m-        @test f_sr[8] ≈ f_mhd[8] atol = 1e-3[m
2026-02-09T19:17:20.7906479Z [32m+[m[32m        @test f_sr[7] ≈ f_mhd[7] rtol = 1.0e-3[m
2026-02-09T19:17:20.7906792Z [32m+[m[32m        @test f_sr[8] ≈ f_mhd[8] atol = 1.0e-3[m
2026-02-09T19:17:20.7906942Z      end[m
2026-02-09T19:17:20.7907070Z  [m
2026-02-09T19:17:20.7907428Z      @testset "Flux consistency (F·n = 0 for Bn)" begin[m
2026-02-09T19:17:20.7907917Z          # The normal B flux should be zero (Bx flux for dir=1, By flux for dir=2)[m
2026-02-09T19:17:20.7908214Z          w = SVector(1.0, 0.5, 0.3, 0.0, 2.0, 0.5, 0.8, 0.3)[m
2026-02-09T19:17:20.7908463Z          f1 = physical_flux(law, w, 1)[m
2026-02-09T19:17:20.7909032Z [31m-        @test f1[6] ≈ 0.0 atol = 1e-14  # Bx flux = 0 for x-direction[m
2026-02-09T19:17:20.7909502Z [32m+[m[32m        @test f1[6] ≈ 0.0 atol = 1.0e-14  # Bx flux = 0 for x-direction[m
2026-02-09T19:17:20.7909632Z  [m
2026-02-09T19:17:20.7909883Z          law2d = SRMHDEquations{2}(eos)[m
2026-02-09T19:17:20.7910123Z          f2 = physical_flux(law2d, w, 2)[m
2026-02-09T19:17:20.7910521Z [31m-        @test f2[7] ≈ 0.0 atol = 1e-14  # By flux = 0 for y-direction[m
2026-02-09T19:17:20.7910977Z [32m+[m[32m        @test f2[7] ≈ 0.0 atol = 1.0e-14  # By flux = 0 for y-direction[m
2026-02-09T19:17:20.7911126Z      end[m
2026-02-09T19:17:20.7911480Z  end[m
2026-02-09T19:17:20.7911614Z  [m
2026-02-09T19:17:20.7911829Z [36m@@ -199,13 +199,13 @@[m [mend[m
2026-02-09T19:17:20.7912222Z          # Use a genuinely non-relativistic state (P << ρ, B² << ρ)[m
2026-02-09T19:17:20.7912857Z          # so the classical fast magnetosonic speed is a good approximation[m
2026-02-09T19:17:20.7913028Z          ρ = 1.0[m
2026-02-09T19:17:20.7913209Z [31m-        P = 1e-4[m
2026-02-09T19:17:20.7913405Z [32m+[m[32m        P = 1.0e-4[m
2026-02-09T19:17:20.7913574Z          Bx = 0.01[m
2026-02-09T19:17:20.7913870Z          w = SVector(ρ, 0.0, 0.0, 0.0, P, Bx, 0.0, 0.0)[m
2026-02-09T19:17:20.7914110Z          λm, λp = wave_speeds(law, w, 1)[m
2026-02-09T19:17:20.7914294Z          @test λp > 0[m
2026-02-09T19:17:20.7914476Z          @test λm < 0[m
2026-02-09T19:17:20.7914842Z [31m-        @test λp ≈ -λm atol = 1e-14  # symmetric when v=0[m
2026-02-09T19:17:20.7915237Z [32m+[m[32m        @test λp ≈ -λm atol = 1.0e-14  # symmetric when v=0[m
2026-02-09T19:17:20.7915393Z  [m
2026-02-09T19:17:20.7915904Z          # In the non-relativistic limit (h ≈ 1), should match classical fast speed[m
2026-02-09T19:17:20.7916081Z          γ = eos.gamma[m
2026-02-09T19:17:20.7916284Z [36m@@ -222,8 +222,8 @@[m [mend[m
2026-02-09T19:17:20.7916505Z          ε = 1.0 / ((γ - 1) * 1.0)[m
2026-02-09T19:17:20.7916684Z          h = 1 + ε + 1.0[m
2026-02-09T19:17:20.7916895Z          cs = sqrt(γ * 1.0 / (1.0 * h))[m
2026-02-09T19:17:20.7917140Z [31m-        @test λp ≈ cs atol = 1e-12[m
2026-02-09T19:17:20.7917381Z [31m-        @test λm ≈ -cs atol = 1e-12[m
2026-02-09T19:17:20.7917654Z [32m+[m[32m        @test λp ≈ cs atol = 1.0e-12[m
2026-02-09T19:17:20.7917942Z [32m+[m[32m        @test λm ≈ -cs atol = 1.0e-12[m
2026-02-09T19:17:20.7918097Z      end[m
2026-02-09T19:17:20.7918227Z  [m
2026-02-09T19:17:20.7918600Z      @testset "Wave speeds bounded by speed of light" begin[m
2026-02-09T19:17:20.7918973Z [36m@@ -363,9 +363,9 @@[m [mend[m
2026-02-09T19:17:20.7919266Z      Sx_total_0 = sum(u[2] for u in U0) * dx[m
2026-02-09T19:17:20.7919528Z      tau_total_0 = sum(u[5] for u in U0) * dx[m
2026-02-09T19:17:20.7919659Z  [m
2026-02-09T19:17:20.7919942Z [31m-    @test D_total ≈ D_total_0 rtol = 1e-10[m
2026-02-09T19:17:20.7920240Z [31m-    @test Sx_total ≈ Sx_total_0 atol = 1e-12[m
2026-02-09T19:17:20.7920539Z [31m-    @test tau_total ≈ tau_total_0 rtol = 1e-10[m
2026-02-09T19:17:20.7920878Z [32m+[m[32m    @test D_total ≈ D_total_0 rtol = 1.0e-10[m
2026-02-09T19:17:20.7921211Z [32m+[m[32m    @test Sx_total ≈ Sx_total_0 atol = 1.0e-12[m
2026-02-09T19:17:20.7921556Z [32m+[m[32m    @test tau_total ≈ tau_total_0 rtol = 1.0e-10[m
2026-02-09T19:17:20.7921705Z  end[m
2026-02-09T19:17:20.7921842Z  [m
2026-02-09T19:17:20.7922107Z  # ============================================================[m
2026-02-09T19:17:20.7922308Z [36m@@ -382,8 +382,10 @@[m [mend[m
2026-02-09T19:17:20.7922527Z      A = 0.01  # small amplitude[m
2026-02-09T19:17:20.7922725Z      γ_eos = eos.gamma[m
2026-02-09T19:17:20.7922861Z  [m
2026-02-09T19:17:20.7923223Z [31m-    ic(x) = SVector(ρ0, 0.0, A * sin(2π * x), A * cos(2π * x),[m
2026-02-09T19:17:20.7923536Z [31m-        P0, Bx0, A * sin(2π * x), A * cos(2π * x))[m
2026-02-09T19:17:20.7923767Z [32m+[m[32m    ic(x) = SVector([m
2026-02-09T19:17:20.7924092Z [32m+[m[32m        ρ0, 0.0, A * sin(2π * x), A * cos(2π * x),[m
2026-02-09T19:17:20.7924424Z [32m+[m[32m        P0, Bx0, A * sin(2π * x), A * cos(2π * x)[m
2026-02-09T19:17:20.7924593Z [32m+[m[32m    )[m
2026-02-09T19:17:20.7924727Z  [m
2026-02-09T19:17:20.7924926Z      for N in [100, 200][m
2026-02-09T19:17:20.7925190Z          mesh = StructuredMesh1D(0.0, 1.0, N)[m
2026-02-09T19:17:20.7925387Z [36m@@ -423,7 +425,7 @@[m [mend[m
2026-02-09T19:17:20.7925626Z      x, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.7925851Z      W = to_primitive(law, U)[m
2026-02-09T19:17:20.7925986Z  [m
2026-02-09T19:17:20.7926413Z [31m-    @test t ≈ 0.1 atol = 1e-10[m
2026-02-09T19:17:20.7926674Z [32m+[m[32m    @test t ≈ 0.1 atol = 1.0e-10[m
2026-02-09T19:17:20.7926927Z      @test all(isfinite.(w[1]) for w in W)[m
2026-02-09T19:17:20.7927144Z      @test all(w[1] > 0 for w in W)[m
2026-02-09T19:17:20.7927464Z  end[m
2026-02-09T19:17:20.7927678Z [36m@@ -440,8 +442,10 @@[m [mend[m
2026-02-09T19:17:20.7928003Z      wR = SVector(0.125, 0.0, 0.0, 0.0, 0.1, 0.5, -1.0, 0.0)[m
2026-02-09T19:17:20.7928204Z      ic(x) = x < 0.5 ? wL : wR[m
2026-02-09T19:17:20.7928346Z  [m
2026-02-09T19:17:20.7929021Z [31m-    limiters = [MinmodLimiter(), SuperbeeLimiter(), VanLeerLimiter(),[m
2026-02-09T19:17:20.7929311Z [31m-        KorenLimiter(), OspreLimiter()][m
2026-02-09T19:17:20.7929516Z [32m+[m[32m    limiters = [[m
2026-02-09T19:17:20.7929959Z [32m+[m[32m        MinmodLimiter(), SuperbeeLimiter(), VanLeerLimiter(),[m
2026-02-09T19:17:20.7930265Z [32m+[m[32m        KorenLimiter(), OspreLimiter(),[m
2026-02-09T19:17:20.7930459Z [32m+[m[32m    ][m
2026-02-09T19:17:20.7930598Z  [m
2026-02-09T19:17:20.7930792Z      for lim in limiters[m
2026-02-09T19:17:20.7931024Z          prob = HyperbolicProblem([m
2026-02-09T19:17:20.7943851Z [34m[149/151] Checking `test/srmhd_2d.jl` ........................................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.7957926Z [1mdiff --git a/srmhd_2d.jl b/srmhd_2d.jl[m
2026-02-09T19:17:20.7958177Z [1mindex cb0ef84..72d70db 100644[m
2026-02-09T19:17:20.7958359Z [1m--- a/srmhd_2d.jl[m
2026-02-09T19:17:20.7958525Z [1m+++ b/srmhd_2d.jl[m
2026-02-09T19:17:20.7958955Z [36m@@ -28,7 +28,7 @@[m [musing StaticArrays[m
2026-02-09T19:17:20.7959181Z      # Solution should be uniform in y[m
2026-02-09T19:17:20.7959288Z      for iy in 2:ny[m
2026-02-09T19:17:20.7959396Z          for ix in 1:nx[m
2026-02-09T19:17:20.7959661Z [31m-            @test W[ix, iy][1] ≈ W[ix, 1][1] atol = 1e-10[m
2026-02-09T19:17:20.7960061Z [32m+[m[32m            @test W[ix, iy][1] ≈ W[ix, 1][1] atol = 1.0e-10[m
2026-02-09T19:17:20.7960259Z          end[m
2026-02-09T19:17:20.7960419Z      end[m
2026-02-09T19:17:20.7960569Z  [m
2026-02-09T19:17:20.7960773Z [36m@@ -60,7 +60,7 @@[m [mend[m
2026-02-09T19:17:20.7961032Z      # Solution should be uniform in x[m
2026-02-09T19:17:20.7961232Z      for ix in 2:nx[m
2026-02-09T19:17:20.7961430Z          for iy in 1:ny[m
2026-02-09T19:17:20.7961776Z [31m-            @test W[ix, iy][1] ≈ W[1, iy][1] atol = 1e-10[m
2026-02-09T19:17:20.7962145Z [32m+[m[32m            @test W[ix, iy][1] ≈ W[1, iy][1] atol = 1.0e-10[m
2026-02-09T19:17:20.7962316Z          end[m
2026-02-09T19:17:20.7962467Z      end[m
2026-02-09T19:17:20.7962602Z  [m
2026-02-09T19:17:20.7962799Z [36m@@ -92,7 +92,7 @@[m [mend[m
2026-02-09T19:17:20.7963235Z      coords, U, t, ct = solve_hyperbolic(prob; vector_potential = Az)[m
2026-02-09T19:17:20.7963385Z  [m
2026-02-09T19:17:20.7963730Z      divB_max = max_divB(ct, mesh.dx, mesh.dy, nx, ny)[m
2026-02-09T19:17:20.7963969Z [31m-    @test divB_max < 1e-13[m
2026-02-09T19:17:20.7964231Z [32m+[m[32m    @test divB_max < 1.0e-13[m
2026-02-09T19:17:20.7964383Z  end[m
2026-02-09T19:17:20.7964523Z  [m
2026-02-09T19:17:20.7964804Z  # ============================================================[m
2026-02-09T19:17:20.7965022Z [36m@@ -129,7 +129,7 @@[m [mend[m
2026-02-09T19:17:20.7965764Z      U0 = [FiniteVolumeMethod.primitive_to_conserved(law, ic(coords[ix, iy]...)) for ix in 1:nx, iy in 1:ny][m
2026-02-09T19:17:20.7966230Z      D_total_0 = sum(U0[ix, iy][1] for ix in 1:nx, iy in 1:ny) * dV[m
2026-02-09T19:17:20.7966374Z  [m
2026-02-09T19:17:20.7966667Z [31m-    @test D_total ≈ D_total_0 rtol = 1e-10[m
2026-02-09T19:17:20.7967005Z [32m+[m[32m    @test D_total ≈ D_total_0 rtol = 1.0e-10[m
2026-02-09T19:17:20.7967150Z  end[m
2026-02-09T19:17:20.7967289Z  [m
2026-02-09T19:17:20.7967563Z  # ============================================================[m
2026-02-09T19:17:20.8284980Z [34m[150/151] Checking `test/test_functions.jl` .................................. [39m[32m[1m✔[22m[39m
2026-02-09T19:17:20.8512602Z [34m[151/151] Checking `test/weno.jl` ............................................ [39m[31m[1m✖[22m[39m
2026-02-09T19:17:20.8529175Z [1mdiff --git a/weno.jl b/weno.jl[m
2026-02-09T19:17:20.8529644Z [1mindex f7a8685..7f65fc2 100644[m
2026-02-09T19:17:20.8529820Z [1m--- a/weno.jl[m
2026-02-09T19:17:20.8529963Z [1m+++ b/weno.jl[m
2026-02-09T19:17:20.8530082Z [36m@@ -51,9 +51,9 @@[m [mend[m
2026-02-09T19:17:20.8530340Z      @test nghost(CellCenteredMUSCL(MinmodLimiter())) == 2[m
2026-02-09T19:17:20.8530603Z      @test nghost(CellCenteredMUSCL(SuperbeeLimiter())) == 2[m
2026-02-09T19:17:20.8530741Z      @test nghost(WENO3()) == 2[m
2026-02-09T19:17:20.8530898Z [31m-    @test nghost(WENO3(1e-10)) == 2[m
2026-02-09T19:17:20.8531075Z [32m+[m[32m    @test nghost(WENO3(1.0e-10)) == 2[m
2026-02-09T19:17:20.8531203Z      @test nghost(WENO5()) == 3[m
2026-02-09T19:17:20.8531362Z [31m-    @test nghost(WENO5(1e-10, 2)) == 3[m
2026-02-09T19:17:20.8531547Z [32m+[m[32m    @test nghost(WENO5(1.0e-10, 2)) == 3[m
2026-02-09T19:17:20.8531750Z      @test nghost(CharacteristicWENO(WENO3())) == 2[m
2026-02-09T19:17:20.8531958Z      @test nghost(CharacteristicWENO(WENO5())) == 3[m
2026-02-09T19:17:20.8532046Z  end[m
2026-02-09T19:17:20.8532160Z [36m@@ -66,20 +66,20 @@[m [mend[m
2026-02-09T19:17:20.8532270Z      recon = WENO3()[m
2026-02-09T19:17:20.8532351Z  [m
2026-02-09T19:17:20.8532558Z      @testset "Default epsilon" begin[m
2026-02-09T19:17:20.8532712Z [31m-        @test recon.epsilon == 1e-6[m
2026-02-09T19:17:20.8532895Z [32m+[m[32m        @test recon.epsilon == 1.0e-6[m
2026-02-09T19:17:20.8532979Z      end[m
2026-02-09T19:17:20.8533053Z  [m
2026-02-09T19:17:20.8533200Z      @testset "Custom epsilon" begin[m
2026-02-09T19:17:20.8533323Z [31m-        r = WENO3(1e-12)[m
2026-02-09T19:17:20.8533458Z [31m-        @test r.epsilon == 1e-12[m
2026-02-09T19:17:20.8533590Z [32m+[m[32m        r = WENO3(1.0e-12)[m
2026-02-09T19:17:20.8533760Z [32m+[m[32m        @test r.epsilon == 1.0e-12[m
2026-02-09T19:17:20.8533842Z      end[m
2026-02-09T19:17:20.8533915Z  [m
2026-02-09T19:17:20.8534126Z      @testset "Uniform data returns cell value" begin[m
2026-02-09T19:17:20.8534456Z          # For uniform data, reconstruction should return the cell value exactly[m
2026-02-09T19:17:20.8534555Z          val = 3.5[m
2026-02-09T19:17:20.8534839Z          wL_face, wR_face = reconstruct_interface(recon, val, val, val, val)[m
2026-02-09T19:17:20.8535015Z [31m-        @test wL_face ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8535174Z [31m-        @test wR_face ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8535358Z [32m+[m[32m        @test wL_face ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8535539Z [32m+[m[32m        @test wR_face ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8535621Z      end[m
2026-02-09T19:17:20.8535695Z  [m
2026-02-09T19:17:20.8535903Z      @testset "Linear data (exact for 3rd order)" begin[m
2026-02-09T19:17:20.8536028Z [36m@@ -95,8 +95,8 @@[m [mend[m
2026-02-09T19:17:20.8536537Z          wL_face, wR_face = reconstruct_interface(recon, wLL, wL, wR, wRR)[m
2026-02-09T19:17:20.8536700Z  [m
2026-02-09T19:17:20.8537038Z          # Both left and right reconstructions should give 4.0 for linear data[m
2026-02-09T19:17:20.8537206Z [31m-        @test wL_face ≈ 4.0 atol = 1e-10[m
2026-02-09T19:17:20.8537352Z [31m-        @test wR_face ≈ 4.0 atol = 1e-10[m
2026-02-09T19:17:20.8537531Z [32m+[m[32m        @test wL_face ≈ 4.0 atol = 1.0e-10[m
2026-02-09T19:17:20.8537702Z [32m+[m[32m        @test wR_face ≈ 4.0 atol = 1.0e-10[m
2026-02-09T19:17:20.8537783Z      end[m
2026-02-09T19:17:20.8537856Z  [m
2026-02-09T19:17:20.8538029Z      @testset "Smooth quadratic data" begin[m
2026-02-09T19:17:20.8538144Z [36m@@ -149,30 +149,30 @@[m [mend[m
2026-02-09T19:17:20.8538415Z          wL_face, wR_face = reconstruct_interface(recon, wLL, wL, wR, wRR)[m
2026-02-09T19:17:20.8538663Z  [m
2026-02-09T19:17:20.8539084Z          # By symmetry, both face values should be equal[m
2026-02-09T19:17:20.8539265Z [31m-        @test wL_face ≈ wR_face atol = 1e-14[m
2026-02-09T19:17:20.8539462Z [32m+[m[32m        @test wL_face ≈ wR_face atol = 1.0e-14[m
2026-02-09T19:17:20.8539693Z      end[m
2026-02-09T19:17:20.8539767Z  [m
2026-02-09T19:17:20.8539954Z      @testset "Internal _weno3 functions" begin[m
2026-02-09T19:17:20.8540065Z [31m-        eps = 1e-6[m
2026-02-09T19:17:20.8540180Z [32m+[m[32m        eps = 1.0e-6[m
2026-02-09T19:17:20.8540252Z  [m
2026-02-09T19:17:20.8540451Z          # Test left reconstruction with uniform data[m
2026-02-09T19:17:20.8540552Z          val = 5.0[m
2026-02-09T19:17:20.8540877Z          result = FiniteVolumeMethod._weno3_reconstruct_left(val, val, val, eps)[m
2026-02-09T19:17:20.8541033Z [31m-        @test result ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8541218Z [32m+[m[32m        @test result ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8541303Z  [m
2026-02-09T19:17:20.8541504Z          # Test right reconstruction with uniform data[m
2026-02-09T19:17:20.8541849Z          result_r = FiniteVolumeMethod._weno3_reconstruct_right(val, val, val, eps)[m
2026-02-09T19:17:20.8542006Z [31m-        @test result_r ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8542197Z [32m+[m[32m        @test result_r ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8542270Z  [m
2026-02-09T19:17:20.8542535Z          # Test left reconstruction with linear data: v0=0, v1=1, v2=2[m
2026-02-09T19:17:20.8542680Z          # Face at x=1.5 should give 1.5[m
2026-02-09T19:17:20.8542991Z          left_val = FiniteVolumeMethod._weno3_reconstruct_left(0.0, 1.0, 2.0, eps)[m
2026-02-09T19:17:20.8543149Z [31m-        @test left_val ≈ 1.5 atol = 1e-10[m
2026-02-09T19:17:20.8543324Z [32m+[m[32m        @test left_val ≈ 1.5 atol = 1.0e-10[m
2026-02-09T19:17:20.8543398Z  [m
2026-02-09T19:17:20.8543657Z          # Test right reconstruction with linear data: v0=0, v1=1, v2=2[m
2026-02-09T19:17:20.8543810Z          # Face at x=0.5 should give 0.5[m
2026-02-09T19:17:20.8544131Z          right_val = FiniteVolumeMethod._weno3_reconstruct_right(0.0, 1.0, 2.0, eps)[m
2026-02-09T19:17:20.8544287Z [31m-        @test right_val ≈ 0.5 atol = 1e-10[m
2026-02-09T19:17:20.8544482Z [32m+[m[32m        @test right_val ≈ 0.5 atol = 1.0e-10[m
2026-02-09T19:17:20.8544565Z      end[m
2026-02-09T19:17:20.8544645Z  end[m
2026-02-09T19:17:20.8544723Z  [m
2026-02-09T19:17:20.8544839Z [36m@@ -184,21 +184,21 @@[m [mend[m
2026-02-09T19:17:20.8544945Z      recon = WENO5()[m
2026-02-09T19:17:20.8545019Z  [m
2026-02-09T19:17:20.8545181Z      @testset "Default parameters" begin[m
2026-02-09T19:17:20.8545328Z [31m-        @test recon.epsilon == 1e-6[m
2026-02-09T19:17:20.8545498Z [32m+[m[32m        @test recon.epsilon == 1.0e-6[m
2026-02-09T19:17:20.8545624Z          @test recon.p == 2[m
2026-02-09T19:17:20.8545704Z      end[m
2026-02-09T19:17:20.8545777Z  [m
2026-02-09T19:17:20.8545933Z      @testset "Custom parameters" begin[m
2026-02-09T19:17:20.8546062Z [31m-        r = WENO5(1e-12, 1)[m
2026-02-09T19:17:20.8546198Z [31m-        @test r.epsilon == 1e-12[m
2026-02-09T19:17:20.8546340Z [32m+[m[32m        r = WENO5(1.0e-12, 1)[m
2026-02-09T19:17:20.8546510Z [32m+[m[32m        @test r.epsilon == 1.0e-12[m
2026-02-09T19:17:20.8546618Z          @test r.p == 1[m
2026-02-09T19:17:20.8546699Z      end[m
2026-02-09T19:17:20.8546771Z  [m
2026-02-09T19:17:20.8546917Z      @testset "Uniform data" begin[m
2026-02-09T19:17:20.8547012Z          val = 2.7[m
2026-02-09T19:17:20.8547408Z          left_face, right_face = reconstruct_interface_weno5(recon, val, val, val, val, val, val)[m
2026-02-09T19:17:20.8547576Z [31m-        @test left_face ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8547741Z [31m-        @test right_face ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8547926Z [32m+[m[32m        @test left_face ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8548114Z [32m+[m[32m        @test right_face ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8548328Z      end[m
2026-02-09T19:17:20.8548402Z  [m
2026-02-09T19:17:20.8548555Z      @testset "Linear data (exact)" begin[m
2026-02-09T19:17:20.8548672Z [36m@@ -212,8 +212,8 @@[m [mend[m
2026-02-09T19:17:20.8549057Z  [m
2026-02-09T19:17:20.8549375Z          # Interface between v3 and v4, at x = 0.5; exact = 2.5[m
2026-02-09T19:17:20.8549741Z          left_face, right_face = reconstruct_interface_weno5(recon, v1, v2, v3, v4, v5, v6)[m
2026-02-09T19:17:20.8549908Z [31m-        @test left_face ≈ 2.5 atol = 1e-10[m
2026-02-09T19:17:20.8550069Z [31m-        @test right_face ≈ 2.5 atol = 1e-10[m
2026-02-09T19:17:20.8550250Z [32m+[m[32m        @test left_face ≈ 2.5 atol = 1.0e-10[m
2026-02-09T19:17:20.8550443Z [32m+[m[32m        @test right_face ≈ 2.5 atol = 1.0e-10[m
2026-02-09T19:17:20.8550525Z      end[m
2026-02-09T19:17:20.8550598Z  [m
2026-02-09T19:17:20.8550750Z      @testset "Quadratic data" begin[m
2026-02-09T19:17:20.8550861Z [36m@@ -277,27 +277,27 @@[m [mend[m
2026-02-09T19:17:20.8550952Z      end[m
2026-02-09T19:17:20.8551025Z  [m
2026-02-09T19:17:20.8551215Z      @testset "Internal _weno5 functions" begin[m
2026-02-09T19:17:20.8551330Z [31m-        eps_val = 1e-6[m
2026-02-09T19:17:20.8551465Z [32m+[m[32m        eps_val = 1.0e-6[m
2026-02-09T19:17:20.8551569Z          p_val = 2[m
2026-02-09T19:17:20.8551643Z  [m
2026-02-09T19:17:20.8551750Z          # Uniform data[m
2026-02-09T19:17:20.8551844Z          val = 4.2[m
2026-02-09T19:17:20.8552286Z          result = FiniteVolumeMethod._weno5_reconstruct_left(val, val, val, val, val, eps_val, p_val)[m
2026-02-09T19:17:20.8552443Z [31m-        @test result ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8552621Z [32m+[m[32m        @test result ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8552705Z  [m
2026-02-09T19:17:20.8553140Z          result_r = FiniteVolumeMethod._weno5_reconstruct_right(val, val, val, val, val, eps_val, p_val)[m
2026-02-09T19:17:20.8553296Z [31m-        @test result_r ≈ val atol = 1e-14[m
2026-02-09T19:17:20.8553492Z [32m+[m[32m        @test result_r ≈ val atol = 1.0e-14[m
2026-02-09T19:17:20.8553566Z  [m
2026-02-09T19:17:20.8553702Z          # Linear data: v = [1, 2, 3, 4, 5][m
2026-02-09T19:17:20.8554107Z          left_val = FiniteVolumeMethod._weno5_reconstruct_left(1.0, 2.0, 3.0, 4.0, 5.0, eps_val, p_val)[m
2026-02-09T19:17:20.8554263Z [31m-        @test left_val ≈ 3.5 atol = 1e-10[m
2026-02-09T19:17:20.8554437Z [32m+[m[32m        @test left_val ≈ 3.5 atol = 1.0e-10[m
2026-02-09T19:17:20.8554509Z  [m
2026-02-09T19:17:20.8554937Z          right_val = FiniteVolumeMethod._weno5_reconstruct_right(1.0, 2.0, 3.0, 4.0, 5.0, eps_val, p_val)[m
2026-02-09T19:17:20.8555094Z [31m-        @test right_val ≈ 2.5 atol = 1e-10[m
2026-02-09T19:17:20.8555272Z [32m+[m[32m        @test right_val ≈ 2.5 atol = 1.0e-10[m
2026-02-09T19:17:20.8555347Z  [m
2026-02-09T19:17:20.8555475Z          # Right = mirror of left[m
2026-02-09T19:17:20.8555889Z          left_mirror = FiniteVolumeMethod._weno5_reconstruct_left(5.0, 4.0, 3.0, 2.0, 1.0, eps_val, p_val)[m
2026-02-09T19:17:20.8556091Z [31m-        @test right_val ≈ left_mirror atol = 1e-14[m
2026-02-09T19:17:20.8556321Z [32m+[m[32m        @test right_val ≈ left_mirror atol = 1.0e-14[m
2026-02-09T19:17:20.8556411Z      end[m
2026-02-09T19:17:20.8556489Z  end[m
2026-02-09T19:17:20.8556567Z  [m
2026-02-09T19:17:20.8556675Z [36m@@ -312,8 +312,8 @@[m [mend[m
2026-02-09T19:17:20.8556805Z          # Uniform SVector data[m
2026-02-09T19:17:20.8556925Z          w = SVector(1.0, 2.0, 3.0)[m
2026-02-09T19:17:20.8557178Z          wL_face, wR_face = reconstruct_interface(recon, w, w, w, w)[m
2026-02-09T19:17:20.8557326Z [31m-        @test wL_face ≈ w atol = 1e-14[m
2026-02-09T19:17:20.8557470Z [31m-        @test wR_face ≈ w atol = 1e-14[m
2026-02-09T19:17:20.8557647Z [32m+[m[32m        @test wL_face ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.8557816Z [32m+[m[32m        @test wR_face ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.8558034Z  [m
2026-02-09T19:17:20.8558161Z          # Linear SVector data[m
2026-02-09T19:17:20.8558294Z          wLL = SVector(0.0, 0.0, 0.0)[m
2026-02-09T19:17:20.8558402Z [36m@@ -325,8 +325,8 @@[m [mend[m
2026-02-09T19:17:20.8558644Z  [m
2026-02-09T19:17:20.8559091Z          # For linear data, face value = 1.5 * (1,2,3)[m
2026-02-09T19:17:20.8559284Z          expected = SVector(1.5, 3.0, 4.5)[m
2026-02-09T19:17:20.8559468Z [31m-        @test wL_face ≈ expected atol = 1e-10[m
2026-02-09T19:17:20.8559640Z [31m-        @test wR_face ≈ expected atol = 1e-10[m
2026-02-09T19:17:20.8559848Z [32m+[m[32m        @test wL_face ≈ expected atol = 1.0e-10[m
2026-02-09T19:17:20.8560043Z [32m+[m[32m        @test wR_face ≈ expected atol = 1.0e-10[m
2026-02-09T19:17:20.8560125Z      end[m
2026-02-09T19:17:20.8560205Z  [m
2026-02-09T19:17:20.8560458Z      @testset "WENO3 SVector component-wise consistency" begin[m
2026-02-09T19:17:20.8560570Z [36m@@ -342,8 +342,8 @@[m [mend[m
2026-02-09T19:17:20.8560831Z          # Each component should match the scalar reconstruction[m
2026-02-09T19:17:20.8560938Z          for k in 1:3[m
2026-02-09T19:17:20.8561220Z              sL, sR = reconstruct_interface(recon, wLL[k], wL[k], wR[k], wRR[k])[m
2026-02-09T19:17:20.8561393Z [31m-            @test wL_face[k] ≈ sL atol = 1e-14[m
2026-02-09T19:17:20.8561560Z [31m-            @test wR_face[k] ≈ sR atol = 1e-14[m
2026-02-09T19:17:20.8561749Z [32m+[m[32m            @test wL_face[k] ≈ sL atol = 1.0e-14[m
2026-02-09T19:17:20.8561931Z [32m+[m[32m            @test wR_face[k] ≈ sR atol = 1.0e-14[m
2026-02-09T19:17:20.8562023Z          end[m
2026-02-09T19:17:20.8562103Z      end[m
2026-02-09T19:17:20.8562177Z  [m
2026-02-09T19:17:20.8562284Z [36m@@ -353,8 +353,8 @@[m [mend[m
2026-02-09T19:17:20.8562417Z          # Uniform SVector data[m
2026-02-09T19:17:20.8562539Z          w = SVector(1.0, 2.0, 3.0)[m
2026-02-09T19:17:20.8562864Z          left_face, right_face = reconstruct_interface_weno5(recon, w, w, w, w, w, w)[m
2026-02-09T19:17:20.8563035Z [31m-        @test left_face ≈ w atol = 1e-14[m
2026-02-09T19:17:20.8563193Z [31m-        @test right_face ≈ w atol = 1e-14[m
2026-02-09T19:17:20.8563370Z [32m+[m[32m        @test left_face ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.8563563Z [32m+[m[32m        @test right_face ≈ w atol = 1.0e-14[m
2026-02-09T19:17:20.8563638Z  [m
2026-02-09T19:17:20.8563763Z          # Linear SVector data[m
2026-02-09T19:17:20.8563885Z          v1 = SVector(0.0, 0.0, 0.0)[m
2026-02-09T19:17:20.8563999Z [36m@@ -368,8 +368,8 @@[m [mend[m
2026-02-09T19:17:20.8564072Z  [m
2026-02-09T19:17:20.8564322Z          # Face between v3 and v4 at midpoint: expected = 2.5 * (1,2,3)[m
2026-02-09T19:17:20.8564472Z          expected = SVector(2.5, 5.0, 7.5)[m
2026-02-09T19:17:20.8564655Z [31m-        @test left_face ≈ expected atol = 1e-10[m
2026-02-09T19:17:20.8564840Z [31m-        @test right_face ≈ expected atol = 1e-10[m
2026-02-09T19:17:20.8565056Z [32m+[m[32m        @test left_face ≈ expected atol = 1.0e-10[m
2026-02-09T19:17:20.8565276Z [32m+[m[32m        @test right_face ≈ expected atol = 1.0e-10[m
2026-02-09T19:17:20.8565357Z      end[m
2026-02-09T19:17:20.8565428Z  [m
2026-02-09T19:17:20.8565704Z      @testset "WENO5 SVector component-wise consistency" begin[m
2026-02-09T19:17:20.8565814Z [36m@@ -387,8 +387,8 @@[m [mend[m
2026-02-09T19:17:20.8566053Z          # Each component should match the scalar reconstruction[m
2026-02-09T19:17:20.8566165Z          for k in 1:3[m
2026-02-09T19:17:20.8566513Z              sL, sR = reconstruct_interface_weno5(recon, v1[k], v2[k], v3[k], v4[k], v5[k], v6[k])[m
2026-02-09T19:17:20.8566684Z [31m-            @test left_face[k] ≈ sL atol = 1e-14[m
2026-02-09T19:17:20.8566862Z [31m-            @test right_face[k] ≈ sR atol = 1e-14[m
2026-02-09T19:17:20.8567059Z [32m+[m[32m            @test left_face[k] ≈ sL atol = 1.0e-14[m
2026-02-09T19:17:20.8567259Z [32m+[m[32m            @test right_face[k] ≈ sR atol = 1.0e-14[m
2026-02-09T19:17:20.8567484Z          end[m
2026-02-09T19:17:20.8567574Z      end[m
2026-02-09T19:17:20.8567652Z  end[m
2026-02-09T19:17:20.8567765Z [36m@@ -416,11 +416,11 @@[m [mend[m
2026-02-09T19:17:20.8568034Z              R = right_eigenvectors(law, w, 1)[m
2026-02-09T19:17:20.8568116Z  [m
2026-02-09T19:17:20.8568235Z              product = L * R[m
2026-02-09T19:17:20.8568404Z [31m-            @test product ≈ I(3) atol = 1e-12[m
2026-02-09T19:17:20.8568616Z [32m+[m[32m            @test product ≈ I(3) atol = 1.0e-12[m
2026-02-09T19:17:20.8568694Z  [m
2026-02-09T19:17:20.8568945Z              # Also check R * L = I[m
2026-02-09T19:17:20.8569065Z              product2 = R * L[m
2026-02-09T19:17:20.8569250Z [31m-            @test product2 ≈ I(3) atol = 1e-12[m
2026-02-09T19:17:20.8569449Z [32m+[m[32m            @test product2 ≈ I(3) atol = 1.0e-12[m
2026-02-09T19:17:20.8569535Z          end[m
2026-02-09T19:17:20.8569625Z      end[m
2026-02-09T19:17:20.8569705Z  [m
2026-02-09T19:17:20.8569858Z [36m@@ -439,7 +439,7 @@[m [mend[m
2026-02-09T19:17:20.8570070Z                  R = right_eigenvectors(law, w, dir)[m
2026-02-09T19:17:20.8579125Z  [m
2026-02-09T19:17:20.8579328Z                  product = L * R[m
2026-02-09T19:17:20.8579554Z [31m-                @test product ≈ I(4) atol = 1e-12[m
2026-02-09T19:17:20.8579772Z [32m+[m[32m                @test product ≈ I(4) atol = 1.0e-12[m
2026-02-09T19:17:20.8579871Z              end[m
2026-02-09T19:17:20.8579959Z          end[m
2026-02-09T19:17:20.8580042Z      end[m
2026-02-09T19:17:20.8580165Z [36m@@ -471,8 +471,8 @@[m [mend[m
2026-02-09T19:17:20.8580429Z          wL_char, wR_char = reconstruct_interface(cw, wLL, wL, wR, wRR)[m
2026-02-09T19:17:20.8580718Z          wL_plain, wR_plain = reconstruct_interface(plain, wLL, wL, wR, wRR)[m
2026-02-09T19:17:20.8580794Z  [m
2026-02-09T19:17:20.8580981Z [31m-        @test wL_char ≈ wL_plain atol = 1e-14[m
2026-02-09T19:17:20.8581151Z [31m-        @test wR_char ≈ wR_plain atol = 1e-14[m
2026-02-09T19:17:20.8581365Z [32m+[m[32m        @test wL_char ≈ wL_plain atol = 1.0e-14[m
2026-02-09T19:17:20.8581570Z [32m+[m[32m        @test wR_char ≈ wR_plain atol = 1.0e-14[m
2026-02-09T19:17:20.8581662Z      end[m
2026-02-09T19:17:20.8581739Z  [m
2026-02-09T19:17:20.8582074Z      @testset "Characteristic WENO3 1D dispatch" begin[m
2026-02-09T19:17:20.8582293Z [36m@@ -622,7 +622,7 @@[m [mend[m
2026-02-09T19:17:20.8582498Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.8582623Z  [m
2026-02-09T19:17:20.8582831Z          # Should reach final time[m
2026-02-09T19:17:20.8583046Z [31m-        @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.8583324Z [32m+[m[32m        @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.8583492Z  [m
2026-02-09T19:17:20.8583692Z          # No NaN or Inf[m
2026-02-09T19:17:20.8583885Z          for i in 1:N[m
2026-02-09T19:17:20.8584097Z [36m@@ -644,7 +644,7 @@[m [mend[m
2026-02-09T19:17:20.8584369Z          # L1 error should be reasonable[m
2026-02-09T19:17:20.8584559Z          dx = 1.0 / N[m
2026-02-09T19:17:20.8585042Z          rho_err = sum(abs(W[i][1] - sod_exact_weno(x[i], 0.2)[1]) * dx for i in 1:N)[m
2026-02-09T19:17:20.8585263Z [31m-        @test rho_err < 0.10[m
2026-02-09T19:17:20.8585415Z [32m+[m[32m        @test rho_err < 0.1[m
2026-02-09T19:17:20.8585501Z      end[m
2026-02-09T19:17:20.8585578Z  [m
2026-02-09T19:17:20.8585714Z      @testset "WENO3 + HLL" begin[m
2026-02-09T19:17:20.8585823Z [36m@@ -661,7 +661,7 @@[m [mend[m
2026-02-09T19:17:20.8585972Z          x, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.8586107Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.8586217Z  [m
2026-02-09T19:17:20.8586353Z [31m-        @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.8586510Z [32m+[m[32m        @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.8586625Z          for i in 1:N[m
2026-02-09T19:17:20.8586761Z              @test all(isfinite, W[i])[m
2026-02-09T19:17:20.8587060Z              @test W[i][1] > 0[m
2026-02-09T19:17:20.8587181Z [36m@@ -683,7 +683,7 @@[m [mend[m
2026-02-09T19:17:20.8587331Z          x, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.8587462Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.8587648Z  [m
2026-02-09T19:17:20.8587788Z [31m-        @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.8587944Z [32m+[m[32m        @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.8588104Z          for i in 1:N[m
2026-02-09T19:17:20.8588333Z              @test all(isfinite, W[i])[m
2026-02-09T19:17:20.8588524Z              @test W[i][1] > 0[m
2026-02-09T19:17:20.8588707Z [36m@@ -717,9 +717,9 @@[m [mend[m
2026-02-09T19:17:20.8589173Z          momentum_final = sum(U_final[i][2] for i in 1:N) * dx[m
2026-02-09T19:17:20.8589388Z          energy_final = sum(U_final[i][3] for i in 1:N) * dx[m
2026-02-09T19:17:20.8589465Z  [m
2026-02-09T19:17:20.8589642Z [31m-        @test mass_final ≈ mass0 rtol = 1e-12[m
2026-02-09T19:17:20.8589876Z [31m-        @test momentum_final ≈ momentum0 rtol = 1e-12[m
2026-02-09T19:17:20.8590065Z [31m-        @test energy_final ≈ energy0 rtol = 1e-12[m
2026-02-09T19:17:20.8590265Z [32m+[m[32m        @test mass_final ≈ mass0 rtol = 1.0e-12[m
2026-02-09T19:17:20.8590511Z [32m+[m[32m        @test momentum_final ≈ momentum0 rtol = 1.0e-12[m
2026-02-09T19:17:20.8590735Z [32m+[m[32m        @test energy_final ≈ energy0 rtol = 1.0e-12[m
2026-02-09T19:17:20.8590822Z      end[m
2026-02-09T19:17:20.8590898Z  [m
2026-02-09T19:17:20.8591097Z      @testset "CharacteristicWENO3 on Sod" begin[m
2026-02-09T19:17:20.8591210Z [36m@@ -736,7 +736,7 @@[m [mend[m
2026-02-09T19:17:20.8591361Z          x, U, t = solve_hyperbolic(prob)[m
2026-02-09T19:17:20.8591496Z          W = to_primitive(law, U)[m
2026-02-09T19:17:20.8591569Z  [m
2026-02-09T19:17:20.8591701Z [31m-        @test t ≈ 0.2 atol = 1e-10[m
2026-02-09T19:17:20.8591861Z [32m+[m[32m        @test t ≈ 0.2 atol = 1.0e-10[m
2026-02-09T19:17:20.8591981Z          for i in 1:N[m
2026-02-09T19:17:20.8592118Z              @test all(isfinite, W[i])[m
2026-02-09T19:17:20.8592228Z              @test W[i][1] > 0[m
2026-02-09T19:17:20.8592344Z [36m@@ -746,6 +746,6 @@[m [mend[m
2026-02-09T19:17:20.8592500Z          # L1 error should be reasonable[m
2026-02-09T19:17:20.8592596Z          dx = 1.0 / N[m
2026-02-09T19:17:20.8592878Z          rho_err = sum(abs(W[i][1] - sod_exact_weno(x[i], 0.2)[1]) * dx for i in 1:N)[m
2026-02-09T19:17:20.8593010Z [31m-        @test rho_err < 0.10[m
2026-02-09T19:17:20.8593144Z [32m+[m[32m        @test rho_err < 0.1[m
2026-02-09T19:17:20.8593228Z      end[m
2026-02-09T19:17:20.8593314Z  end[m
2026-02-09T19:17:20.8749982Z ##[error]Process completed with exit code 1.
